2025-11-30 21:38:10,038 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:38:10,051 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:38:10,053 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:38:10,054 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 21:38:10,067 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 21:38:10,071 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:38:10,072 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:38:10,072 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:38:10,073 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:10,073 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:38:10,074 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:38:10,075 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:10,075 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:38:10,076 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:38:10,076 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:38:10,076 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 21:38:10,077 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 21:38:10,081 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 21:38:10,081 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 21:38:10,084 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 21:38:10,085 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:38:10,085 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:38:10,086 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:38:10,086 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:10,087 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:38:10,087 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:38:10,087 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:10,088 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:38:10,088 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:38:10,088 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:38:10,088 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 21:38:10,094 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 21:38:10,096 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 21:38:10,098 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 21:38:10,099 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 83.2ms
2025-11-30 21:38:10,099 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 82.2ms
2025-11-30 21:38:10,099 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 23.1ms
2025-11-30 21:38:10,294 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 21:38:10,295 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.6ms
2025-11-30 21:38:10,296 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 21:38:10,298 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:38:10,298 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 21:38:10,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 21:38:10,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:10,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 21:38:10,302 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 21:38:10,302 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:10,303 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 21:38:10,304 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 21:38:10,304 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 21:38:10,304 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/refresh/
2025-11-30 21:38:10,307 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 21:38:10,311 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 3.6ms
2025-11-30 21:38:10,312 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 21:38:10,314 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 1.9ms
2025-11-30 21:38:10,315 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:38:10,322 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 2
2025-11-30 21:38:10,323 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-11-30 21:38:10,324 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:38:10,329 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:38:10,330 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-11-30 21:38:10,331 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 21:38:10,332 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:38:10,333 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': global.app.local:5173
2025-11-30 21:38:10,333 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'global.app.local'
2025-11-30 21:38:10,333 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:10,333 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-11-30 21:38:10,336 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'global.app.local'
2025-11-30 21:38:10,337 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:10,337 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-11-30 21:38:10,337 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='global', Código='GLOBAL004', ID=5
2025-11-30 21:38:10,339 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 5: single - bd_sistema
2025-11-30 21:38:10,339 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_sistema, servidor=localhost
2025-11-30 21:38:10,339 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=5, db_type=single, bd=bd_sistema, path=/api/v1/auth/refresh/
2025-11-30 21:38:10,342 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 21:38:10,342 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 44.8ms
2025-11-30 21:38:10,343 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:38:10,344 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': techcorp.app.local:5173
2025-11-30 21:38:10,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.app.local'
2025-11-30 21:38:10,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:10,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-30 21:38:10,346 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.app.local'
2025-11-30 21:38:10,347 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:10,347 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-30 21:38:10,348 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-30 21:38:10,349 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 4: single - bd_sistema
2025-11-30 21:38:10,349 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_sistema, servidor=localhost
2025-11-30 21:38:10,349 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_sistema, path=/api/v1/auth/refresh/
2025-11-30 21:38:10,353 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 5
2025-11-30 21:38:10,353 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-11-30 21:38:10,359 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:38:10,359 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-11-30 21:38:10,361 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 4
2025-11-30 21:38:10,361 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-11-30 21:38:10,363 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:38:10,363 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-11-30 21:38:10,364 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 32.5ms
2025-11-30 21:38:10,365 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 24.2ms
2025-11-30 21:38:12,518 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:38:12,518 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:38:12,518 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:38:12,518 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:38:12,519 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:12,519 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:38:12,519 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:38:12,519 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:12,519 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:38:12,519 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:38:12,519 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:38:12,520 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:38:12,522 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:38:12,522 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:38:12,523 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:38:12,523 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:38:12,528 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 18, Página: 1
2025-11-30 21:38:12,529 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 11.1ms
2025-11-30 21:38:12,532 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:38:12,533 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:38:12,533 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:38:12,533 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:38:12,533 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:12,533 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:38:12,534 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:38:12,534 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:38:12,534 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:38:12,534 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:38:12,534 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:38:12,534 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:38:12,537 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:38:12,537 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:38:12,538 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:38:12,538 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:38:12,539 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 18, Página: 1
2025-11-30 21:38:12,541 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 9.8ms
2025-11-30 21:39:24,551 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/1021/
2025-11-30 21:39:24,551 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/1021/ 200 0.6ms
2025-11-30 21:39:24,554 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/1021/
2025-11-30 21:39:24,554 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:39:24,554 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:39:24,555 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:39:24,555 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:39:24,555 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:39:24,555 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:39:24,555 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:39:24,555 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:39:24,555 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:39:24,556 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:39:24,556 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/1021/
2025-11-30 21:39:24,570 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo log de autenticación ID 1021, cliente_id: None
2025-11-30 21:39:24,570 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Contexto de SuperAdmin detectado, identificando tenant del log 1021
2025-11-30 21:39:24,574 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1021 no encontrado en BD central, buscando en BDs Multi-DB
2025-11-30 21:39:24,578 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:39:24,587 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Cliente_id del log 1021 obtenido desde BD del cliente 2: 2
2025-11-30 21:39:24,587 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Consultando log 1021 completo en BD del cliente 2 (execute_query determinará BD automáticamente)
2025-11-30 21:39:24,588 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:39:24,592 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1021 encontrado en BD del cliente 2
2025-11-30 21:39:24,595 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/1021/ 200 41.2ms
2025-11-30 21:39:43,497 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/1021/
2025-11-30 21:39:43,498 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:39:43,498 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:39:43,498 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:39:43,498 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:39:43,498 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:39:43,499 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:39:43,499 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:39:43,499 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:39:43,499 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:39:43,499 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:39:43,499 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/1021/
2025-11-30 21:39:43,522 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo log de autenticación ID 1021, cliente_id: None
2025-11-30 21:39:43,522 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Contexto de SuperAdmin detectado, identificando tenant del log 1021
2025-11-30 21:39:43,526 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1021 no encontrado en BD central, buscando en BDs Multi-DB
2025-11-30 21:39:43,529 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:39:43,537 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Cliente_id del log 1021 obtenido desde BD del cliente 2: 2
2025-11-30 21:39:43,537 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Consultando log 1021 completo en BD del cliente 2 (execute_query determinará BD automáticamente)
2025-11-30 21:39:43,537 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:39:43,542 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1021 encontrado en BD del cliente 2
2025-11-30 21:39:43,544 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/1021/ 200 45.9ms
2025-11-30 21:45:10,373 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-30 21:45:10,373 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host '127.0.0.1:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:45:10,375 - app.core.tenant.middleware - WARNING - [HOST_DETECTION] No se pudo extraer tenant real de origin/referer, usando cliente por defecto (SYSTEM)
2025-11-30 21:45:10,375 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-30 21:45:10,375 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:45:10,375 - app.core.tenant.middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='app.local'
2025-11-30 21:45:10,375 - app.core.tenant.middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-30 21:45:10,375 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:45:10,375 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-30 21:45:10,403 - app.modules.auth.presentation.endpoints - INFO - Cliente 1 resuelto y validado para login.
2025-11-30 21:45:10,403 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-30 21:45:10,403 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-30 21:45:10,644 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 21:45:10,644 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-30 21:45:10,644 - app.modules.auth.presentation.endpoints - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-30 21:45:10,644 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 21:45:10,649 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:45:10,649 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14445, Rotación: False
2025-11-30 21:45:10,649 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: 14445
2025-11-30 21:45:10,651 - app.modules.auth.presentation.endpoints - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-30 21:45:10,664 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:45:10,664 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=1, usuario_id=1, exito=True
2025-11-30 21:45:10,665 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 291.1ms
2025-11-30 21:45:22,881 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/1006/
2025-11-30 21:45:22,882 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host '127.0.0.1:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:45:22,882 - app.core.tenant.middleware - WARNING - [HOST_DETECTION] No se pudo extraer tenant real de origin/referer, usando cliente por defecto (SYSTEM)
2025-11-30 21:45:22,882 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-30 21:45:22,882 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:45:22,883 - app.core.tenant.middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='app.local'
2025-11-30 21:45:22,883 - app.core.tenant.middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-30 21:45:22,883 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:45:22,883 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/1006/
2025-11-30 21:45:22,885 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo log de autenticación ID 1006, cliente_id: 2
2025-11-30 21:45:22,885 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Cliente_id proporcionado (2), consultando log 1006 directamente en BD del tenant
2025-11-30 21:45:22,885 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:45:22,902 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1006 encontrado en BD del cliente 2
2025-11-30 21:45:22,904 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/1006/ 200 23.4ms
2025-11-30 21:45:43,355 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/1006/
2025-11-30 21:45:43,356 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host '127.0.0.1:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:45:43,356 - app.core.tenant.middleware - WARNING - [HOST_DETECTION] No se pudo extraer tenant real de origin/referer, usando cliente por defecto (SYSTEM)
2025-11-30 21:45:43,356 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-30 21:45:43,356 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:45:43,356 - app.core.tenant.middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='app.local'
2025-11-30 21:45:43,357 - app.core.tenant.middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-30 21:45:43,357 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:45:43,357 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/1006/
2025-11-30 21:45:43,359 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo log de autenticación ID 1006, cliente_id: 1
2025-11-30 21:45:43,359 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Cliente_id proporcionado (1), consultando log 1006 directamente en BD del tenant
2025-11-30 21:45:43,362 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1006 encontrado en BD del cliente 1
2025-11-30 21:45:43,363 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/1006/ 200 9.1ms
2025-11-30 21:55:09,987 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:09,987 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/ 200 0.4ms
2025-11-30 21:55:09,987 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:09,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:09,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:09,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:09,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:09,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:09,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:09,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:09,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:09,987 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:09,993 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:09,993 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:09,993 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-30 21:55:09,993 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 401 2.8ms
2025-11-30 21:55:10,004 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 21:55:10,004 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.5ms
2025-11-30 21:55:10,004 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:10,004 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-30 21:55:10,054 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-11-30 21:55:10,054 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-11-30 21:55:10,064 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 21:55:10,070 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:55:10,070 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14446, Rotación: True
2025-11-30 21:55:10,073 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 21:55:10,073 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 21:55:10,073 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-11-30 21:55:10,073 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14446
2025-11-30 21:55:10,073 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-11-30 21:55:10,088 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:55:10,088 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-11-30 21:55:10,088 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 82.3ms
2025-11-30 21:55:10,088 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:10,093 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:10,093 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:55:10,093 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:55:10,093 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:10,113 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:10,119 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 18, Página: 1
2025-11-30 21:55:10,119 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 27.5ms
2025-11-30 21:55:14,993 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:14,993 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/ 200 0.5ms
2025-11-30 21:55:14,993 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:14,993 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:15,003 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:55:15,003 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:55:15,003 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:15,005 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:15,007 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 18, Página: 1
2025-11-30 21:55:15,008 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 9.4ms
2025-11-30 21:55:16,997 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:16,997 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:16,997 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:55:16,997 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:55:17,004 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:17,004 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:17,004 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 18, Página: 1
2025-11-30 21:55:17,004 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 7.3ms
2025-11-30 21:55:20,990 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:20,990 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:20,990 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:20,990 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:20,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:20,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:20,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:20,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:20,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:20,994 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:20,995 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:20,995 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:20,998 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:55:20,998 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:55:21,001 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:21,001 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:21,004 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 18, Página: 1
2025-11-30 21:55:21,004 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 12.5ms
2025-11-30 21:55:31,994 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:31,994 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:31,994 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:31,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:31,995 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:31,995 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:31,995 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:31,995 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:31,995 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:31,995 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:31,995 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:31,996 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:55:31,998 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:55:31,998 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:55:31,999 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:31,999 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:32,002 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 18, Página: 1
2025-11-30 21:55:32,004 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 9.8ms
2025-11-30 21:55:41,060 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-30 21:55:41,060 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.6ms
2025-11-30 21:55:41,062 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-30 21:55:41,062 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.5ms
2025-11-30 21:55:41,065 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 21:55:41,065 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:41,065 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:41,065 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:41,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:41,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:41,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:41,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:41,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:41,067 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:41,067 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:41,067 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 21:55:41,069 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 21:55:41,069 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 21:55:41,074 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 21:55:41,075 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.8ms
2025-11-30 21:55:41,077 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 21:55:41,077 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:41,077 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:41,077 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:41,078 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:41,078 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:41,078 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:41,078 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:41,078 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:41,078 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:41,078 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:41,078 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 21:55:41,081 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 21:55:41,081 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 21:55:41,083 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 21:55:41,084 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 6.8ms
2025-11-30 21:55:43,711 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 21:55:43,712 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:43,712 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:43,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,714 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,714 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:43,714 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:43,714 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-30 21:55:43,717 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-11-30 21:55:43,719 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-11-30 21:55:43,721 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 21:55:43,724 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:55:43,725 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14447, Rotación: True
2025-11-30 21:55:43,726 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 21:55:43,727 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 21:55:43,727 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-11-30 21:55:43,727 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14447
2025-11-30 21:55:43,727 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-11-30 21:55:43,731 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:55:43,731 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-11-30 21:55:43,732 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 20.0ms
2025-11-30 21:55:43,738 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-30 21:55:43,738 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.5ms
2025-11-30 21:55:43,739 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-30 21:55:43,741 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:43,741 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:43,741 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,741 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,741 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,741 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,741 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,742 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:43,742 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:43,742 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-30 21:55:43,745 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-30 21:55:43,745 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-11-30 21:55:43,746 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-30 21:55:43,760 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-30 21:55:43,761 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-11-30 21:55:43,761 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 20.3ms
2025-11-30 21:55:43,765 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-11-30 21:55:43,765 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.5ms
2025-11-30 21:55:43,767 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-11-30 21:55:43,768 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:43,768 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:43,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,770 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,770 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:43,770 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:43,770 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-11-30 21:55:43,772 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-11-30 21:55:43,773 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-11-30 21:55:43,774 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-11-30 21:55:43,775 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 7.7ms
2025-11-30 21:55:43,789 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-30 21:55:43,789 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.0ms
2025-11-30 21:55:43,791 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-30 21:55:43,791 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 21:55:43,792 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.6ms
2025-11-30 21:55:43,793 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:43,793 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:43,793 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,793 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,793 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,794 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,794 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,794 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,794 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:43,794 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:43,794 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 21:55:43,797 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 21:55:43,797 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 21:55:43,799 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 21:55:43,802 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 21:55:43,802 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 11.3ms
2025-11-30 21:55:43,804 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:43,804 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:43,804 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,804 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,804 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,804 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,809 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,810 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,810 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:43,811 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:43,812 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 21:55:43,822 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 21:55:43,824 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 21:55:43,874 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 21:55:43,876 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 74.3ms
2025-11-30 21:55:43,876 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 21:55:43,877 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:43,877 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:43,877 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,877 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,878 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:43,878 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:43,878 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 21:55:43,881 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 21:55:43,881 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 21:55:43,883 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 21:55:43,884 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 21:55:43,885 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:43,885 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:43,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:43,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:43,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:43,887 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:43,887 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:43,888 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 21:55:43,889 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 21:55:43,889 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 21:55:43,891 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 21:55:43,892 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 15.1ms
2025-11-30 21:55:43,893 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.0ms
2025-11-30 21:55:52,056 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 21:55:52,057 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:52,058 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:52,058 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,059 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:52,059 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:52,060 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-30 21:55:52,084 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-11-30 21:55:52,097 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-11-30 21:55:52,110 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 21:55:52,120 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:55:52,120 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14448, Rotación: True
2025-11-30 21:55:52,125 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 21:55:52,126 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 21:55:52,127 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-11-30 21:55:52,127 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14448
2025-11-30 21:55:52,127 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-11-30 21:55:52,138 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:55:52,138 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-11-30 21:55:52,139 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 82.1ms
2025-11-30 21:55:52,150 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-30 21:55:52,150 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:52,150 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:52,150 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,150 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,151 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,151 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,151 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,151 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,151 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:52,151 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:52,151 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-30 21:55:52,154 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-30 21:55:52,154 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-11-30 21:55:52,154 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-30 21:55:52,168 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-30 21:55:52,170 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-11-30 21:55:52,170 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 20.3ms
2025-11-30 21:55:52,178 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-11-30 21:55:52,179 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:52,179 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:52,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,180 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,180 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,180 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,180 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,180 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,180 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:52,180 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:52,180 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-11-30 21:55:52,184 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-11-30 21:55:52,184 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-11-30 21:55:52,185 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-11-30 21:55:52,186 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 7.3ms
2025-11-30 21:55:52,193 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 21:55:52,194 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:52,194 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:52,194 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,194 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,194 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,194 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,195 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,195 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,195 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:52,195 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:52,195 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 21:55:52,199 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 21:55:52,199 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 21:55:52,256 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 21:55:52,257 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 21:55:52,258 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:52,258 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:52,258 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,258 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,259 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,259 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,259 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,259 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,259 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:52,259 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:52,259 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 21:55:52,261 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 67.3ms
2025-11-30 21:55:52,265 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 21:55:52,266 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 21:55:52,275 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 21:55:52,277 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 19.7ms
2025-11-30 21:55:52,279 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 21:55:52,281 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:52,281 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:52,281 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,281 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,281 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,282 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,282 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,282 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,282 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:52,282 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:52,282 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 21:55:52,286 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 21:55:52,286 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 21:55:52,288 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 21:55:52,289 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 21:55:52,289 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:52,289 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:52,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:52,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:52,292 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:52,292 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:52,292 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 21:55:52,296 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 21:55:52,296 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 21:55:52,307 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 21:55:52,308 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 28.6ms
2025-11-30 21:55:52,309 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 20.1ms
2025-11-30 21:55:52,322 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 21:55:52,322 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.6ms
2025-11-30 21:55:52,325 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 21:55:52,326 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:52,326 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': global.app.local:5173
2025-11-30 21:55:52,326 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'global.app.local'
2025-11-30 21:55:52,326 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,327 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-11-30 21:55:52,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'global.app.local'
2025-11-30 21:55:52,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-11-30 21:55:52,336 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='global', Código='GLOBAL004', ID=5
2025-11-30 21:55:52,336 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_sistema, servidor=localhost
2025-11-30 21:55:52,337 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=5, db_type=single, bd=bd_sistema, path=/api/v1/auth/refresh/
2025-11-30 21:55:52,338 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 21:55:52,339 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 1.0ms
2025-11-30 21:55:52,340 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 21:55:52,341 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 1.1ms
2025-11-30 21:55:52,347 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 5
2025-11-30 21:55:52,347 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-11-30 21:55:52,364 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:55:52,365 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-11-30 21:55:52,366 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 21:55:52,366 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:52,366 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': techcorp.app.local:5173
2025-11-30 21:55:52,366 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.app.local'
2025-11-30 21:55:52,366 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,367 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-30 21:55:52,369 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.app.local'
2025-11-30 21:55:52,369 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,369 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-30 21:55:52,369 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-30 21:55:52,369 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_sistema, servidor=localhost
2025-11-30 21:55:52,370 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_sistema, path=/api/v1/auth/refresh/
2025-11-30 21:55:52,370 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 45.5ms
2025-11-30 21:55:52,372 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 21:55:52,372 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:52,373 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 21:55:52,373 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 21:55:52,373 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,373 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 21:55:52,374 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 21:55:52,374 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:52,374 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 21:55:52,375 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 21:55:52,375 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 21:55:52,375 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/refresh/
2025-11-30 21:55:52,382 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 4
2025-11-30 21:55:52,382 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-11-30 21:55:52,384 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:55:52,384 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-11-30 21:55:52,385 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:52,394 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 2
2025-11-30 21:55:52,394 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-11-30 21:55:52,394 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:52,398 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 21:55:52,399 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-11-30 21:55:52,399 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 33.3ms
2025-11-30 21:55:52,401 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 29.0ms
2025-11-30 21:55:54,078 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-11-30 21:55:54,079 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 1.0ms
2025-11-30 21:55:54,079 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-11-30 21:55:54,081 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 1.6ms
2025-11-30 21:55:54,082 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-11-30 21:55:54,082 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-11-30 21:55:54,084 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 21:55:54,084 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 2.2ms
2025-11-30 21:55:54,084 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 1.9ms
2025-11-30 21:55:54,085 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 21:55:54,085 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:54,085 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:54,085 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:54,086 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:54,086 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:54,086 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:54,086 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:54,086 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:54,086 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:54,086 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:54,087 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 21:55:54,098 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 21:55:54,103 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:54,103 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:54,103 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:54,103 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:54,103 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:54,104 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:54,104 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:54,104 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:54,104 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:54,104 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:54,104 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 21:55:54,106 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 21:55:54,106 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 21:55:54,122 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 21:55:54,124 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 39.9ms
2025-11-30 21:55:54,124 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 39.1ms
2025-11-30 21:55:54,126 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 21:55:54,127 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:54,127 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:54,127 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:54,127 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:54,127 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:54,127 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:54,127 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:54,128 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:54,128 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:54,128 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:54,128 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 21:55:54,131 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 21:55:54,132 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 21:55:54,134 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:54,134 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:54,134 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:54,134 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:54,134 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:54,135 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:54,135 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:54,135 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:54,135 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:54,135 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:54,135 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 21:55:54,137 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 21:55:54,138 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 21:55:54,139 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 21:55:54,141 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 14.8ms
2025-11-30 21:55:54,142 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 8.4ms
2025-11-30 21:55:55,532 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-11-30 21:55:55,532 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-11-30 21:55:55,533 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.9ms
2025-11-30 21:55:55,533 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.6ms
2025-11-30 21:55:55,535 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 21:55:55,535 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:55,535 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:55,535 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:55,536 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:55,536 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:55,536 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:55,536 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:55,536 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:55,536 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:55,536 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:55,537 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 21:55:55,538 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 21:55:55,538 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 21:55:55,542 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 21:55:55,544 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 9.2ms
2025-11-30 21:55:55,546 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 21:55:55,546 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:55,546 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:55,546 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:55,546 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:55,546 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:55,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:55,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:55,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:55,547 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:55,547 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:55,547 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 21:55:55,549 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 21:55:55,550 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 21:55:55,550 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 21:55:55,552 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.0ms
2025-11-30 21:55:56,850 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2/
2025-11-30 21:55:56,852 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2/ 200 1.7ms
2025-11-30 21:55:56,853 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-30 21:55:56,853 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2/
2025-11-30 21:55:56,853 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-30 21:55:56,854 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.3ms
2025-11-30 21:55:56,854 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2/ 200 1.2ms
2025-11-30 21:55:56,854 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.1ms
2025-11-30 21:55:56,855 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2/
2025-11-30 21:55:56,856 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:56,856 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:56,856 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:56,857 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:56,857 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:56,857 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:56,857 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:56,857 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:56,857 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:56,857 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:56,858 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2/
2025-11-30 21:55:56,859 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-30 21:55:56,859 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-30 21:55:56,863 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-30 21:55:56,863 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 21:55:56,863 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:56,863 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:56,864 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:56,864 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:56,864 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:56,864 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:56,864 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:56,864 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:56,864 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:56,865 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:56,865 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 21:55:56,867 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-11-30 21:55:56,867 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-11-30 21:55:56,869 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 21:55:56,870 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 21:55:56,871 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2/ 200 15.0ms
2025-11-30 21:55:56,872 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 8.5ms
2025-11-30 21:55:56,873 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2/
2025-11-30 21:55:56,873 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:56,873 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:56,874 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:56,874 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:56,874 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:56,874 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:56,874 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:56,874 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:56,874 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:56,875 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:56,875 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2/
2025-11-30 21:55:56,875 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 21:55:56,878 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-30 21:55:56,878 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-30 21:55:56,879 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-30 21:55:56,880 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:56,880 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:56,880 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:56,880 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:56,880 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:56,880 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:56,880 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:56,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:56,881 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:56,881 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:56,881 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 21:55:56,883 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-11-30 21:55:56,883 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-11-30 21:55:56,884 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 21:55:56,885 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 21:55:56,885 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2/ 200 12.7ms
2025-11-30 21:55:56,886 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 10.9ms
2025-11-30 21:55:58,340 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:55:58,340 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:55:58,341 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 0.8ms
2025-11-30 21:55:58,341 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 0.5ms
2025-11-30 21:55:58,342 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:55:58,344 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:58,344 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:58,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:58,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:58,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:58,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:58,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:58,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:58,345 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:58,345 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:58,345 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:55:58,346 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-11-30 21:55:58,346 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-11-30 21:55:58,347 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:58,351 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:58,353 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:58,371 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:58,372 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:58,375 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-11-30 21:55:58,375 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 31.9ms
2025-11-30 21:55:58,377 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:55:58,377 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:55:58,377 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:55:58,378 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:58,378 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:58,378 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:58,378 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:55:58,378 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:55:58,378 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:55:58,378 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:55:58,379 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:55:58,379 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:55:58,380 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-11-30 21:55:58,380 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-11-30 21:55:58,381 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:58,381 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:58,382 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:58,385 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:58,386 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:55:58,388 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-11-30 21:55:58,389 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 12.0ms
2025-11-30 21:56:00,324 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:56:00,324 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:56:00,325 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:56:00,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:00,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:00,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:00,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:00,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:00,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:00,326 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:56:00,326 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:56:00,326 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:56:00,328 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:56:00,328 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:56:00,329 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:00,332 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:00,334 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 18, Página: 1
2025-11-30 21:56:00,335 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 11.3ms
2025-11-30 21:56:00,337 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:56:00,337 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:56:00,337 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:56:00,337 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:00,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:00,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:00,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:00,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:00,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:00,339 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:56:00,339 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:56:00,339 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-11-30 21:56:00,341 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:56:00,341 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-11-30 21:56:00,342 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:00,343 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:00,344 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 18, Página: 1
2025-11-30 21:56:00,345 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 7.6ms
2025-11-30 21:56:05,956 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/1005/
2025-11-30 21:56:05,956 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/1005/ 200 0.6ms
2025-11-30 21:56:05,959 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/1005/
2025-11-30 21:56:05,959 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:56:05,959 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:56:05,959 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:05,959 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:05,959 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:05,959 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:05,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:05,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:05,961 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:56:05,961 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:56:05,961 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/1005/
2025-11-30 21:56:05,963 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo log de autenticación ID 1005, cliente_id: 2
2025-11-30 21:56:05,963 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Cliente_id proporcionado (2), consultando log 1005 directamente en BD del tenant
2025-11-30 21:56:05,963 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:05,967 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1005 encontrado en BD del cliente 2
2025-11-30 21:56:05,969 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/1005/ 200 9.9ms
2025-11-30 21:56:09,359 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/1006/
2025-11-30 21:56:09,361 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/1006/ 200 0.5ms
2025-11-30 21:56:09,362 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/1006/
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:56:09,363 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/1006/
2025-11-30 21:56:09,367 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo log de autenticación ID 1006, cliente_id: 2
2025-11-30 21:56:09,367 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Cliente_id proporcionado (2), consultando log 1006 directamente en BD del tenant
2025-11-30 21:56:09,367 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:09,368 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1006 encontrado en BD del cliente 2
2025-11-30 21:56:09,369 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/1006/ 200 6.6ms
2025-11-30 21:56:24,094 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/1004/
2025-11-30 21:56:24,095 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/1004/ 200 0.6ms
2025-11-30 21:56:24,097 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/1004/
2025-11-30 21:56:24,097 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:56:24,097 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:56:24,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:24,099 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:24,099 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:24,099 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:24,099 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:24,099 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:24,099 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:56:24,099 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:56:24,099 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/1004/
2025-11-30 21:56:24,102 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo log de autenticación ID 1004, cliente_id: 2
2025-11-30 21:56:24,102 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Cliente_id proporcionado (2), consultando log 1004 directamente en BD del tenant
2025-11-30 21:56:24,102 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:24,103 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1004 encontrado en BD del cliente 2
2025-11-30 21:56:24,104 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/1004/ 200 7.1ms
2025-11-30 21:56:28,906 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/1021/
2025-11-30 21:56:28,907 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/1021/ 200 0.5ms
2025-11-30 21:56:28,908 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/1021/
2025-11-30 21:56:28,908 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:56:28,909 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:56:28,909 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:28,909 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:28,909 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:28,909 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:28,909 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:28,909 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:28,909 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:56:28,910 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:56:28,910 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/1021/
2025-11-30 21:56:28,912 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo log de autenticación ID 1021, cliente_id: 2
2025-11-30 21:56:28,912 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Cliente_id proporcionado (2), consultando log 1021 directamente en BD del tenant
2025-11-30 21:56:28,912 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:28,913 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1021 encontrado en BD del cliente 2
2025-11-30 21:56:28,915 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/1021/ 200 6.2ms
2025-11-30 21:56:34,890 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:56:34,891 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:56:34,891 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:56:34,891 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:34,891 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:34,891 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:34,891 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:34,891 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:34,891 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:34,892 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:56:34,892 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:56:34,892 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:56:34,894 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-11-30 21:56:34,894 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-11-30 21:56:34,895 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:34,895 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:34,896 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:34,897 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:34,899 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:34,901 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-11-30 21:56:34,901 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 11.7ms
2025-11-30 21:56:34,903 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:56:34,903 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:56:34,903 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:56:34,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:34,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:34,904 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:34,904 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:56:34,904 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:56:34,904 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:56:34,904 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:56:34,904 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:56:34,904 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:56:34,909 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-11-30 21:56:34,909 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-11-30 21:56:34,911 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:34,922 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:34,925 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:34,930 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:34,933 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:56:34,935 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-11-30 21:56:34,935 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 32.2ms
2025-11-30 21:59:23,991 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:59:23,992 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:59:23,992 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:59:23,992 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:59:23,992 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:59:23,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:59:23,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:59:23,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:59:23,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:59:23,993 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:59:23,993 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:59:23,994 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:59:24,018 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-11-30 21:59:24,018 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-11-30 21:59:24,026 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:24,040 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:24,042 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:24,056 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:24,057 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:24,059 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-11-30 21:59:24,059 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 68.0ms
2025-11-30 21:59:27,979 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:59:27,980 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:59:27,980 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:59:27,980 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:59:27,980 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:59:27,980 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:59:27,981 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:59:27,981 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:59:27,981 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:59:27,981 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:59:27,981 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:59:27,981 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:59:27,983 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-11-30 21:59:27,984 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-11-30 21:59:27,984 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:27,985 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:27,985 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:27,988 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:27,990 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:27,991 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-11-30 21:59:27,992 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 12.6ms
2025-11-30 21:59:31,995 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:59:31,995 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:59:31,997 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:59:31,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:59:31,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:59:31,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:59:31,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:59:31,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:59:31,997 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:59:31,997 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:59:31,998 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:59:31,998 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:59:32,001 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-11-30 21:59:32,001 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-11-30 21:59:32,002 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:32,003 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:32,004 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:32,006 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:32,007 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:32,009 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-11-30 21:59:32,010 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 14.7ms
2025-11-30 21:59:33,982 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:59:33,983 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:59:33,983 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:59:33,983 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:59:33,983 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:59:33,983 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:59:33,983 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:59:33,984 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:59:33,984 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:59:33,984 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:59:33,984 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:59:33,984 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:59:33,986 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-11-30 21:59:33,986 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-11-30 21:59:33,986 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:33,987 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:33,988 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:33,989 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:33,992 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:33,993 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-11-30 21:59:33,995 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 12.8ms
2025-11-30 21:59:55,986 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:59:55,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 21:59:55,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 21:59:55,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:59:55,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:59:55,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:59:55,988 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 21:59:55,988 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 21:59:55,988 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 21:59:55,988 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 21:59:55,988 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 21:59:55,988 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-11-30 21:59:55,990 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-11-30 21:59:55,990 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-11-30 21:59:55,991 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:55,992 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:55,993 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:55,995 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:55,997 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 21:59:55,999 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-11-30 21:59:55,999 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 12.1ms
2025-11-30 23:08:05,696 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-30 23:08:05,696 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.8ms
2025-11-30 23:08:05,697 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-30 23:08:05,697 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.9ms
2025-11-30 23:08:05,699 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:08:05,700 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:05,700 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:08:05,700 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:05,700 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:05,700 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:05,700 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:05,702 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:05,702 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:05,703 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:08:05,703 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:08:05,703 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:08:05,704 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-30 23:08:05,704 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 401 4.4ms
2025-11-30 23:08:05,705 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:08:05,707 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:05,707 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:08:05,707 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:05,707 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:05,707 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:05,708 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:05,708 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:05,708 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:05,708 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:08:05,708 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:08:05,708 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:08:05,709 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-30 23:08:05,710 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 23:08:05,710 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.4ms
2025-11-30 23:08:05,710 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 401 4.0ms
2025-11-30 23:08:05,713 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:08:05,713 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:05,714 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:08:05,714 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:05,714 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:05,714 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:05,714 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:05,714 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:05,714 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:05,714 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:08:05,714 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:08:05,715 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-30 23:08:05,738 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-11-30 23:08:05,775 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-11-30 23:08:05,782 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 23:08:05,791 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:08:05,792 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14449, Rotación: True
2025-11-30 23:08:05,799 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:08:05,799 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 23:08:05,799 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-11-30 23:08:05,800 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14449
2025-11-30 23:08:05,800 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-11-30 23:08:05,813 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:08:05,814 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-11-30 23:08:05,814 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 101.7ms
2025-11-30 23:08:05,818 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:08:05,819 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:08:05,823 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:08:05,823 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:08:05,827 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:08:05,828 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.0ms
2025-11-30 23:08:05,830 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:08:05,830 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:05,831 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:08:05,831 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:05,831 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:05,831 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:05,831 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:05,831 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:05,831 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:05,831 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:08:05,831 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:08:05,832 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:08:05,834 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:08:05,834 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:08:05,836 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:08:05,836 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 6.6ms
2025-11-30 23:08:13,993 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:08:13,993 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:13,993 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:08:13,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:13,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:13,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:13,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:13,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:13,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:13,994 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:08:13,994 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:08:13,994 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:08:13,997 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:08:13,997 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:08:13,999 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:08:14,002 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.2ms
2025-11-30 23:08:14,003 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:08:14,004 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:14,004 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:08:14,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:14,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:14,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:14,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:14,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:14,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:14,005 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:08:14,005 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:08:14,006 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:08:14,008 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:08:14,008 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:08:14,010 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:08:14,011 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.0ms
2025-11-30 23:08:19,736 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-30 23:08:19,737 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.0ms
2025-11-30 23:08:19,738 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-30 23:08:19,738 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.1ms
2025-11-30 23:08:19,741 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 23:08:19,741 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:19,742 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:08:19,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:19,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:19,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:19,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:19,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:19,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:19,743 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:08:19,743 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:08:19,743 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 23:08:19,760 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-30 23:08:19,760 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-30 23:08:19,766 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 23:08:19,767 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 23:08:19,769 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 27.9ms
2025-11-30 23:08:19,770 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 23:08:19,771 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:19,771 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:08:19,771 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:19,771 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:19,771 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:19,771 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:19,772 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:19,772 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:19,772 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:08:19,772 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:08:19,772 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 23:08:19,774 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-30 23:08:19,774 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-30 23:08:19,775 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 23:08:19,776 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 23:08:19,777 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 6.8ms
2025-11-30 23:08:21,257 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-30 23:08:21,257 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.5ms
2025-11-30 23:08:21,258 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-30 23:08:21,259 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:21,259 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:08:21,259 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:21,259 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:21,259 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:21,259 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:08:21,261 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:21,261 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:08:21,261 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:08:21,261 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:08:21,261 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-30 23:08:21,275 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:08:21,276 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 23:08:21,276 - app.modules.auth.presentation.endpoints - INFO - [LOGOUT-WEB] Token no encontrado en BD (ya expirado/revocado) - Cliente: 1, Usuario: 1 (superadmin)
2025-11-30 23:08:21,289 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:08:21,289 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=logout, cliente_id=1, usuario_id=1, exito=True
2025-11-30 23:08:21,289 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 32.1ms
2025-11-30 23:08:25,105 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 23:08:25,106 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.5ms
2025-11-30 23:08:25,107 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:08:25,107 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:25,108 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:25,108 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:25,108 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:25,108 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:25,124 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:25,124 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:25,124 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:25,124 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:25,126 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:25,126 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/refresh/
2025-11-30 23:08:25,127 - app.core.auth - WARNING - [REFRESH] No se proporcionó refresh token. Cliente: web
2025-11-30 23:08:25,127 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 20.0ms
2025-11-30 23:08:39,588 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-30 23:08:39,588 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.5ms
2025-11-30 23:08:39,589 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-30 23:08:39,589 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:39,591 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:39,591 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:39,591 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:39,591 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:39,592 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:39,592 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:39,592 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:39,592 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:39,592 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:39,593 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/login/
2025-11-30 23:08:39,597 - app.modules.auth.presentation.endpoints - INFO - Cliente 2 resuelto y validado para login.
2025-11-30 23:08:39,597 - app.core.auth - INFO - [AUTH] Intento de login: username='admin_acme', cliente_id_destino=2
2025-11-30 23:08:39,597 - app.core.auth - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=2
2025-11-30 23:08:39,598 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,823 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,827 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,835 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=4, super_admin=False, type=tenant_admin
2025-11-30 23:08:39,835 - app.core.auth - INFO - [AUTH] Login exitoso: username='admin_acme', usuario_id=1, cliente_origen=2, cliente_destino=N/A, access_level=4, user_type=tenant_admin
2025-11-30 23:08:39,835 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,838 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,839 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=4, super_admin=False, type=tenant_admin
2025-11-30 23:08:39,839 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,846 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:08:39,846 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 2, Usuario 1, Tipo: web, Token ID: 2045, Rotación: False
2025-11-30 23:08:39,846 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: 2045
2025-11-30 23:08:39,846 - app.modules.auth.presentation.endpoints - INFO - Usuario admin_acme autenticado exitosamente (WEB) para cliente 2
2025-11-30 23:08:39,847 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,856 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:08:39,856 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=2, usuario_id=1, exito=True
2025-11-30 23:08:39,857 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 266.7ms
2025-11-30 23:08:39,865 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-11-30 23:08:39,866 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.7ms
2025-11-30 23:08:39,868 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-11-30 23:08:39,868 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:39,869 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:39,869 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:39,869 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:39,869 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:39,870 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:39,870 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:39,870 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:39,871 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:39,871 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:39,871 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/clientes/tenant/branding
2025-11-30 23:08:39,872 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,873 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:39,873 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=2 por usuario: admin_acme
2025-11-30 23:08:39,873 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=2
2025-11-30 23:08:39,876 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=2
2025-11-30 23:08:39,876 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 8.9ms
2025-11-30 23:08:39,886 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-30 23:08:39,887 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.8ms
2025-11-30 23:08:39,888 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/sessions/admin/
2025-11-30 23:08:39,889 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-30 23:08:39,890 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/sessions/admin/ 200 1.6ms
2025-11-30 23:08:39,890 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.6ms
2025-11-30 23:08:39,890 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:08:39,891 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/sessions/admin/
2025-11-30 23:08:39,892 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:39,892 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:39,892 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:39,892 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:39,892 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:39,893 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:39,893 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:39,893 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:39,894 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:39,894 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:39,894 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/menus/getmenu/
2025-11-30 23:08:39,896 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,897 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:39,897 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 2
2025-11-30 23:08:39,898 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:08:39,898 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,969 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 5 items raíz.
2025-11-30 23:08:39,969 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 1 con 5 items raíz.
2025-11-30 23:08:39,970 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/sessions/admin/ 200 78.9ms
2025-11-30 23:08:39,971 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/sessions/admin/
2025-11-30 23:08:39,971 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 80.9ms
2025-11-30 23:08:39,972 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:39,972 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:39,972 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:39,972 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:39,972 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:39,973 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:39,973 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:39,973 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:39,974 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:39,974 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:39,974 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/sessions/admin/
2025-11-30 23:08:39,975 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,976 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:39,976 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,982 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,986 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,987 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Solicitud /sessions/admin/ por usuario: admin_acme
2025-11-30 23:08:39,987 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,991 - app.modules.auth.application.services.refresh_token_service - INFO - [ADMIN-SESSIONS] 8 sesiones activas recuperadas - Cliente 2
2025-11-30 23:08:39,991 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Recuperadas 8 sesiones activas totales.
2025-11-30 23:08:39,992 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/sessions/admin/ 200 21.6ms
2025-11-30 23:08:39,993 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:08:39,993 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:39,993 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:39,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:39,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:39,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:39,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:39,994 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:39,996 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:39,996 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:39,996 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:39,997 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/menus/getmenu/
2025-11-30 23:08:39,997 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:39,998 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:39,999 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 2
2025-11-30 23:08:39,999 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:08:39,999 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:40,000 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 5 items raíz.
2025-11-30 23:08:40,000 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 1 con 5 items raíz.
2025-11-30 23:08:40,002 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/sessions/admin/
2025-11-30 23:08:40,002 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:40,002 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:40,003 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:40,003 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:40,003 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:40,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:40,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:40,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:40,005 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:40,005 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:40,005 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/sessions/admin/
2025-11-30 23:08:40,007 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:40,008 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:40,008 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:40,009 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:40,010 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:40,010 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Solicitud /sessions/admin/ por usuario: admin_acme
2025-11-30 23:08:40,011 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:40,011 - app.modules.auth.application.services.refresh_token_service - INFO - [ADMIN-SESSIONS] 8 sesiones activas recuperadas - Cliente 2
2025-11-30 23:08:40,012 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Recuperadas 8 sesiones activas totales.
2025-11-30 23:08:40,012 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 19.4ms
2025-11-30 23:08:40,013 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/sessions/admin/ 200 11.4ms
2025-11-30 23:08:42,296 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-30 23:08:42,297 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-30 23:08:42,297 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.9ms
2025-11-30 23:08:42,297 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-30 23:08:42,298 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-30 23:08:42,298 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 2.3ms
2025-11-30 23:08:42,298 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.7ms
2025-11-30 23:08:42,300 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.4ms
2025-11-30 23:08:42,302 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-30 23:08:42,303 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:42,303 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:42,303 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:42,303 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:42,304 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:42,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:42,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:42,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:42,306 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:42,306 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:42,306 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/usuarios/
2025-11-30 23:08:42,308 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-30 23:08:42,311 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,315 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:42,316 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,317 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,318 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 2 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-30 23:08:42,321 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente 2: page=1, limit=10, search='None'
2025-11-30 23:08:42,322 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,328 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,338 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 1 tiene codigo_rol='ADMIN' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:42,338 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 2 tiene codigo_rol='SUPERVISOR' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:42,339 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 3 tiene codigo_rol='USER' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:42,339 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-11-30 23:08:42,340 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-30 23:08:42,340 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente 2 - Total: 3, Página: 1
2025-11-30 23:08:42,340 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:42,340 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:42,341 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:42,341 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:42,341 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:42,342 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:42,342 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:42,342 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:42,343 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:42,343 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:42,343 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/roles/all-active/
2025-11-30 23:08:42,344 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,344 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:42,344 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,346 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,347 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 2 para lista simple
2025-11-30 23:08:42,347 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,349 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente 2
2025-11-30 23:08:42,349 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente 2 - Total: 3
2025-11-30 23:08:42,349 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 47.7ms
2025-11-30 23:08:42,350 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 42.8ms
2025-11-30 23:08:42,352 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-30 23:08:42,353 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:42,353 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:42,353 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:42,353 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:42,354 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:42,354 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:42,354 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:42,355 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:42,355 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:42,356 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:42,356 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/usuarios/
2025-11-30 23:08:42,356 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-30 23:08:42,358 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,359 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:42,359 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,359 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,360 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 2 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-30 23:08:42,360 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente 2: page=1, limit=10, search='None'
2025-11-30 23:08:42,360 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,362 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,364 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 1 tiene codigo_rol='ADMIN' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:42,364 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 2 tiene codigo_rol='SUPERVISOR' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:42,364 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 3 tiene codigo_rol='USER' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:42,364 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-11-30 23:08:42,364 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-30 23:08:42,364 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente 2 - Total: 3, Página: 1
2025-11-30 23:08:42,366 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:42,366 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:42,366 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:42,366 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:42,366 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:42,367 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:42,367 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:42,367 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:42,368 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:42,368 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:42,368 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/roles/all-active/
2025-11-30 23:08:42,369 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,370 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:42,371 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,371 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,372 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 2 para lista simple
2025-11-30 23:08:42,372 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:42,373 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente 2
2025-11-30 23:08:42,373 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente 2 - Total: 3
2025-11-30 23:08:42,374 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 22.0ms
2025-11-30 23:08:42,375 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 17.9ms
2025-11-30 23:08:44,307 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-11-30 23:08:44,308 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 0.8ms
2025-11-30 23:08:44,308 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-11-30 23:08:44,309 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 0.9ms
2025-11-30 23:08:44,310 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-11-30 23:08:44,310 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:44,310 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:44,311 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:44,311 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:44,311 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:44,312 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:44,312 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:44,312 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:44,312 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:44,314 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:44,314 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/roles/
2025-11-30 23:08:44,314 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:44,316 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:44,316 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:44,316 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:44,318 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 2 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-30 23:08:44,318 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente 2: page=1, limit=10, search='None'
2025-11-30 23:08:44,318 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=2, page=1, limit=10, search='None'
2025-11-30 23:08:44,318 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:44,323 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente 2: 3
2025-11-30 23:08:44,323 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:44,325 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Obtenidos 3 roles para la página 1 de 3 totales
2025-11-30 23:08:44,326 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 1 tiene codigo_rol='ADMIN' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:44,326 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 2 tiene codigo_rol='SUPERVISOR' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:44,326 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 3 tiene codigo_rol='USER' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:44,326 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: 2, Total: 3, Página: 1/1, Resultados: 3
2025-11-30 23:08:44,326 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: 2, Total roles: 3
2025-11-30 23:08:44,327 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 17.9ms
2025-11-30 23:08:44,329 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-11-30 23:08:44,329 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:44,329 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:44,329 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:44,329 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:44,329 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:44,331 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:44,331 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:44,331 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:44,332 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:44,332 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:44,332 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/roles/
2025-11-30 23:08:44,333 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:44,334 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:44,334 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:44,334 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:44,336 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 2 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-30 23:08:44,336 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente 2: page=1, limit=10, search='None'
2025-11-30 23:08:44,336 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=2, page=1, limit=10, search='None'
2025-11-30 23:08:44,336 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:44,338 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente 2: 3
2025-11-30 23:08:44,338 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:44,341 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Obtenidos 3 roles para la página 1 de 3 totales
2025-11-30 23:08:44,341 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 1 tiene codigo_rol='ADMIN' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:44,341 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 2 tiene codigo_rol='SUPERVISOR' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:44,341 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 3 tiene codigo_rol='USER' pero cliente_id=2. Normalizando codigo_rol a None.
2025-11-30 23:08:44,341 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: 2, Total: 3, Página: 1/1, Resultados: 3
2025-11-30 23:08:44,341 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: 2, Total roles: 3
2025-11-30 23:08:44,342 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 12.7ms
2025-11-30 23:08:45,341 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-11-30 23:08:45,341 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-11-30 23:08:45,342 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 0.9ms
2025-11-30 23:08:45,342 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 0.6ms
2025-11-30 23:08:45,344 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-11-30 23:08:45,344 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:45,344 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:45,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:45,345 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:45,345 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:45,346 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:45,346 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:45,346 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:45,346 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:45,347 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:45,347 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/areas/
2025-11-30 23:08:45,347 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:45,349 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:45,349 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:45,349 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:45,351 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 1 del cliente 2 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-11-30 23:08:45,351 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente 2: skip=0, limit=10, search='None'
2025-11-30 23:08:45,351 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:45,354 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:45,357 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente 2: 2 áreas de 2 totales
2025-11-30 23:08:45,358 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente 2 - Total: 2, Página: 1
2025-11-30 23:08:45,359 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 15.4ms
2025-11-30 23:08:45,360 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-11-30 23:08:45,360 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:45,360 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:45,361 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:45,361 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:45,361 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:45,362 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:45,362 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:45,362 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:45,362 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:45,362 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:45,363 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/areas/
2025-11-30 23:08:45,363 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:45,364 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:45,364 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:45,364 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:45,366 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 1 del cliente 2 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-11-30 23:08:45,366 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente 2: skip=0, limit=10, search='None'
2025-11-30 23:08:45,366 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:45,367 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:45,369 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente 2: 2 áreas de 2 totales
2025-11-30 23:08:45,369 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente 2 - Total: 2, Página: 1
2025-11-30 23:08:45,369 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 8.8ms
2025-11-30 23:08:46,723 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/list/
2025-11-30 23:08:46,724 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/list/ 200 0.7ms
2025-11-30 23:08:46,724 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/list/
2025-11-30 23:08:46,726 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/list/ 200 1.0ms
2025-11-30 23:08:46,727 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-11-30 23:08:46,727 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:46,727 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:46,727 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:46,727 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:46,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:46,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:46,729 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:46,729 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:46,730 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:46,730 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:46,730 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/areas/list/
2025-11-30 23:08:46,731 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:46,733 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:46,733 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:46,734 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:46,734 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/list/ recibida por usuario 1 del cliente 2 para lista simple
2025-11-30 23:08:46,734 - app.modules.menus.application.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente 2
2025-11-30 23:08:46,734 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:46,738 - app.modules.menus.application.services.area_service - INFO - Lista simple obtenida para cliente 2: 2 áreas activas
2025-11-30 23:08:46,738 - app.modules.menus.presentation.endpoints_areas - INFO - Lista simple de áreas recuperada para cliente 2 - Total: 2 áreas activas
2025-11-30 23:08:46,739 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 11.7ms
2025-11-30 23:08:46,741 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-11-30 23:08:46,741 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:46,742 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:46,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:46,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:46,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:46,743 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:46,743 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:46,743 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:46,744 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:46,744 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:46,744 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/areas/list/
2025-11-30 23:08:46,745 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:46,746 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-11-30 23:08:46,747 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:46,747 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:46,748 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/list/ recibida por usuario 1 del cliente 2 para lista simple
2025-11-30 23:08:46,748 - app.modules.menus.application.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente 2
2025-11-30 23:08:46,749 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:46,749 - app.modules.menus.application.services.area_service - INFO - Lista simple obtenida para cliente 2: 2 áreas activas
2025-11-30 23:08:46,750 - app.modules.menus.presentation.endpoints_areas - INFO - Lista simple de áreas recuperada para cliente 2 - Total: 2 áreas activas
2025-11-30 23:08:46,750 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 9.7ms
2025-11-30 23:08:51,163 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-30 23:08:51,164 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.4ms
2025-11-30 23:08:51,164 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-30 23:08:51,166 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:08:51,166 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:08:51,166 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:51,166 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:51,166 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:51,167 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:08:51,167 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:08:51,167 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:08:51,168 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:08:51,168 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:08:51,168 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/logout/
2025-11-30 23:08:51,169 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:51,170 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:51,176 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:08:51,176 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 2, Usuario 1
2025-11-30 23:08:51,176 - app.modules.auth.presentation.endpoints - INFO - [LOGOUT-WEB] Token no encontrado en BD (ya expirado/revocado) - Cliente: 2, Usuario: 1 (admin_acme)
2025-11-30 23:08:51,177 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:08:51,179 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:08:51,179 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=logout, cliente_id=2, usuario_id=1, exito=True
2025-11-30 23:08:51,179 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 15.5ms
2025-11-30 23:09:04,276 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-30 23:09:04,277 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.4ms
2025-11-30 23:09:04,278 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-30 23:09:04,279 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:09:04,279 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:09:04,279 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:04,279 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:04,279 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:04,279 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:04,279 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:04,279 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:04,280 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:09:04,280 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:09:04,280 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-30 23:09:04,282 - app.modules.auth.presentation.endpoints - INFO - Cliente 1 resuelto y validado para login.
2025-11-30 23:09:04,283 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-30 23:09:04,283 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-30 23:09:04,504 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 23:09:04,504 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-30 23:09:04,504 - app.modules.auth.presentation.endpoints - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-30 23:09:04,505 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 23:09:04,509 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:09:04,509 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14450, Rotación: False
2025-11-30 23:09:04,509 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: 14450
2025-11-30 23:09:04,511 - app.modules.auth.presentation.endpoints - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-30 23:09:04,515 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:09:04,515 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=1, usuario_id=1, exito=True
2025-11-30 23:09:04,516 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 238.4ms
2025-11-30 23:09:04,524 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-11-30 23:09:04,524 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.6ms
2025-11-30 23:09:04,526 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-11-30 23:09:04,526 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:09:04,526 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:09:04,526 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:04,526 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:04,526 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:04,527 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:04,527 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:04,527 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:04,527 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:09:04,527 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:09:04,527 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-11-30 23:09:04,529 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-11-30 23:09:04,529 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-11-30 23:09:04,532 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-11-30 23:09:04,533 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 6.9ms
2025-11-30 23:09:04,537 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-30 23:09:04,538 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.8ms
2025-11-30 23:09:04,539 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-30 23:09:04,539 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.7ms
2025-11-30 23:09:04,541 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:09:04,542 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:09:04,542 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:09:04,542 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:04,542 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:04,542 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:04,544 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:04,544 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:04,544 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:04,544 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:09:04,544 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:09:04,544 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:09:04,546 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:09:04,547 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:09:04,586 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:09:04,586 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 45.0ms
2025-11-30 23:09:04,587 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:09:04,588 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:09:04,588 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:09:04,588 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:04,588 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:04,588 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:04,588 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:04,589 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:04,589 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:04,589 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:09:04,589 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:09:04,589 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:09:04,592 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:09:04,592 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:09:04,593 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:09:04,594 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 5.7ms
2025-11-30 23:09:06,293 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:09:06,294 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:09:06,294 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:09:06,294 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:06,294 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:06,294 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:06,295 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:06,295 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:06,295 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:06,295 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:09:06,295 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:09:06,295 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:09:06,297 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:09:06,297 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:09:06,303 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:09:06,304 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 11.3ms
2025-11-30 23:09:06,306 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:09:06,306 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:09:06,307 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:09:06,307 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:06,307 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:06,307 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:06,307 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:09:06,307 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:09:06,307 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:09:06,308 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:09:06,308 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:09:06,308 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:09:06,310 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:09:06,311 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:09:06,314 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:09:06,314 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.5ms
2025-11-30 23:10:04,709 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-11-30 23:10:04,710 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 0.5ms
2025-11-30 23:10:04,711 - app.main - INFO - [SYSTEM] 127.0.0.1 -> PUT /api/v1/clientes/2/
2025-11-30 23:10:04,711 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:10:04,712 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:10:04,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:04,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:04,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:04,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:04,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:04,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:04,712 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:10:04,712 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:10:04,713 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:10:04,760 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud PUT /clientes/2 recibida para actualizar por usuario: superadmin
2025-11-30 23:10:04,760 - app.modules.tenant.application.services.cliente_service - INFO - Actualizando cliente ID: 2
2025-11-30 23:10:04,783 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:10:04,783 - app.modules.tenant.application.services.cliente_service - INFO - Cliente ID 2 actualizado exitosamente.
2025-11-30 23:10:04,784 - app.modules.tenant.presentation.endpoints_clientes - INFO - Cliente 2 actualizado exitosamente
2025-11-30 23:10:04,784 - app.main - INFO - [SYSTEM] 127.0.0.1 <- PUT /api/v1/clientes/2/ 200 72.9ms
2025-11-30 23:10:04,788 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:10:04,789 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:10:04,789 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:10:04,789 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:04,789 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:04,789 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:04,790 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:04,790 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:04,790 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:04,790 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:10:04,790 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:10:04,790 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:10:04,792 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:10:04,792 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:10:04,797 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:10:04,798 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.4ms
2025-11-30 23:10:13,270 - app.main - INFO - [SYSTEM] 127.0.0.1 -> PUT /api/v1/clientes/2/
2025-11-30 23:10:13,270 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:10:13,270 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:10:13,270 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:13,270 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:13,270 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:13,270 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:13,271 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:13,271 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:13,271 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:10:13,271 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:10:13,271 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:10:13,274 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud PUT /clientes/2 recibida para actualizar por usuario: superadmin
2025-11-30 23:10:13,274 - app.modules.tenant.application.services.cliente_service - INFO - Actualizando cliente ID: 2
2025-11-30 23:10:13,282 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:10:13,282 - app.modules.tenant.application.services.cliente_service - INFO - Cliente ID 2 actualizado exitosamente.
2025-11-30 23:10:13,282 - app.modules.tenant.presentation.endpoints_clientes - INFO - Cliente 2 actualizado exitosamente
2025-11-30 23:10:13,283 - app.main - INFO - [SYSTEM] 127.0.0.1 <- PUT /api/v1/clientes/2/ 200 13.7ms
2025-11-30 23:10:13,285 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:10:13,285 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:10:13,287 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:10:13,287 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:13,287 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:13,287 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:13,287 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:13,287 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:13,287 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:13,288 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:10:13,288 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:10:13,288 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:10:13,290 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:10:13,290 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:10:13,292 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:10:13,292 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 6.3ms
2025-11-30 23:10:17,725 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:10:17,725 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:10:17,727 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:10:17,727 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:17,727 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:17,727 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:17,727 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:17,727 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:17,727 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:17,728 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:10:17,728 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:10:17,728 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:10:17,730 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:10:17,732 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-11-30 23:10:17,732 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-11-30 23:10:17,732 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 7.2ms
2025-11-30 23:10:17,735 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 2.6ms
2025-11-30 23:10:17,735 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 2.4ms
2025-11-30 23:10:17,737 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:10:17,738 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:10:17,738 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:10:17,739 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:17,739 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:17,739 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:17,739 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:17,739 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:17,739 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:17,741 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:10:17,741 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:10:17,741 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:10:17,741 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:10:17,743 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:10:17,744 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:10:17,744 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:10:17,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:17,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:17,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:17,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:17,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:17,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:17,746 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:10:17,746 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:10:17,746 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:10:17,747 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:10:17,747 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:10:17,758 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:10:17,758 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 21.1ms
2025-11-30 23:10:17,759 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 18.9ms
2025-11-30 23:10:17,762 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:10:17,762 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:10:17,762 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:10:17,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:17,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:17,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:17,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:17,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:17,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:17,763 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:10:17,763 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:10:17,764 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:10:17,765 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:10:17,765 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:10:17,767 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:10:17,769 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 7.3ms
2025-11-30 23:10:20,437 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:10:20,437 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:10:20,437 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.9ms
2025-11-30 23:10:20,437 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.6ms
2025-11-30 23:10:20,439 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:10:20,439 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:10:20,439 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:10:20,439 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:20,439 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:20,441 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:20,441 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:20,441 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:20,441 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:20,441 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:10:20,441 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:10:20,441 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:10:20,443 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:10:20,443 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:10:20,447 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:10:20,448 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 8.9ms
2025-11-30 23:10:20,449 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:10:20,449 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:10:20,449 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:10:20,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:20,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:20,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:20,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:10:20,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:10:20,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:10:20,451 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:10:20,451 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:10:20,452 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:10:20,454 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:10:20,454 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:10:20,455 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:10:20,455 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.2ms
2025-11-30 23:11:21,721 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/3/activar/
2025-11-30 23:11:21,722 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/3/activar/ 200 0.5ms
2025-11-30 23:11:21,723 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/3/activar/
2025-11-30 23:11:21,724 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:11:21,724 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:11:21,724 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:11:21,724 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:11:21,724 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:11:21,724 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:11:21,724 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:11:21,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:11:21,725 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:11:21,725 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:11:21,725 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/3/activar/
2025-11-30 23:11:21,728 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/3/activar/ recibida
2025-11-30 23:11:21,742 - app.modules.tenant.application.services.modulo_activo_service - INFO - Activando módulo 3 para cliente 2
2025-11-30 23:11:21,756 - app.infrastructure.database.queries - ERROR - Error en execute_insert: ('23000', "[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Violation of UNIQUE KEY constraint 'UQ_cliente_modulo'. Cannot insert duplicate key in object 'dbo.cliente_modulo_activo'. The duplicate key value is (2, 3). (2627) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-11-30 23:11:21,756 - app.infrastructure.database.connection - ERROR - Error general en la gestión de conexión: El módulo ya está activado para este cliente.
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries.py", line 193, in execute_insert
    cursor.execute(query, params)
pyodbc.IntegrityError: ('23000', "[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Violation of UNIQUE KEY constraint 'UQ_cliente_modulo'. Cannot insert duplicate key in object 'dbo.cliente_modulo_activo'. The duplicate key value is (2, 3). (2627) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\connection.py", line 142, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries.py", line 235, in execute_insert
    raise ConflictError(
app.core.exceptions.ConflictError: El módulo ya está activado para este cliente.
2025-11-30 23:11:21,790 - app.core.exceptions - ERROR - CustomException: UNIQUE_CONSTRAINT_VIOLATION - El módulo ya está activado para este cliente. | Path: /api/v1/modulos/clientes/2/modulos/3/activar/ | Method: POST
2025-11-30 23:11:21,791 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/3/activar/ 409 67.6ms
2025-11-30 23:16:27,736 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:16:27,736 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:16:27,736 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:16:27,736 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:27,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:27,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:27,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:27,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:27,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:27,738 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:16:27,739 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:16:27,739 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:16:27,759 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:16:27,759 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:16:27,768 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:16:27,769 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 32.5ms
2025-11-30 23:16:27,771 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:16:27,772 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:16:27,776 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:16:27,776 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:16:27,779 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:16:27,779 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.9ms
2025-11-30 23:16:33,915 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/5/
2025-11-30 23:16:33,915 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/5/ 200 0.8ms
2025-11-30 23:16:33,917 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/5/estadisticas/
2025-11-30 23:16:33,918 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/5/estadisticas/
2025-11-30 23:16:33,918 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/5/
2025-11-30 23:16:33,918 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/5/estadisticas/ 200 2.1ms
2025-11-30 23:16:33,919 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/5/estadisticas/ 200 2.1ms
2025-11-30 23:16:33,920 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/5/ 200 2.0ms
2025-11-30 23:16:33,922 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/5/
2025-11-30 23:16:33,923 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:16:33,923 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:16:33,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:33,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:33,924 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:33,924 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:33,924 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:33,924 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:33,924 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:16:33,924 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:16:33,924 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/5/
2025-11-30 23:16:33,928 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/5 recibida por usuario: superadmin
2025-11-30 23:16:33,929 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/5/estadisticas/
2025-11-30 23:16:33,930 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:16:33,930 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:16:33,930 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:33,930 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:33,930 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:33,930 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:33,931 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:33,931 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:33,931 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:16:33,931 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:16:33,931 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/5/estadisticas/
2025-11-30 23:16:33,933 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/5/estadisticas recibida por usuario: superadmin
2025-11-30 23:16:33,933 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 5
2025-11-30 23:16:33,942 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 5
2025-11-30 23:16:33,943 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/5/ 200 20.6ms
2025-11-30 23:16:33,944 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/5/estadisticas/ 200 14.7ms
2025-11-30 23:16:33,945 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/5/
2025-11-30 23:16:33,946 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:16:33,946 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:16:33,946 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:33,946 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:33,947 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:33,947 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:33,947 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:33,947 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:33,947 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:16:33,947 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:16:33,947 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/5/
2025-11-30 23:16:33,949 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/5 recibida por usuario: superadmin
2025-11-30 23:16:33,951 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/5/estadisticas/
2025-11-30 23:16:33,953 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:16:33,953 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:16:33,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:33,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:33,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:33,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:33,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:33,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:33,954 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:16:33,954 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:16:33,954 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/5/estadisticas/
2025-11-30 23:16:33,956 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/5/estadisticas recibida por usuario: superadmin
2025-11-30 23:16:33,956 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 5
2025-11-30 23:16:33,959 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 5
2025-11-30 23:16:33,959 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/5/ 200 13.0ms
2025-11-30 23:16:33,960 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/5/estadisticas/ 200 8.1ms
2025-11-30 23:16:35,353 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/5/modulos/
2025-11-30 23:16:35,353 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/5/modulos/
2025-11-30 23:16:35,354 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/5/modulos/ 200 0.9ms
2025-11-30 23:16:35,354 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/5/modulos/ 200 0.6ms
2025-11-30 23:16:35,355 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/5/modulos/
2025-11-30 23:16:35,357 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:16:35,357 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:16:35,357 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:35,357 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:35,357 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:35,357 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:35,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:35,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:35,358 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:16:35,358 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:16:35,358 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/5/modulos/
2025-11-30 23:16:35,359 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/5/modulos/ recibida
2025-11-30 23:16:35,360 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 5
2025-11-30 23:16:35,363 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 5 recuperados: 5 módulos
2025-11-30 23:16:35,364 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/5/modulos/ 200 8.7ms
2025-11-30 23:16:35,367 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/5/modulos/
2025-11-30 23:16:35,367 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:16:35,367 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:16:35,367 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:35,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:35,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:35,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:16:35,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:16:35,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:16:35,368 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:16:35,368 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:16:35,368 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/5/modulos/
2025-11-30 23:16:35,371 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/5/modulos/ recibida
2025-11-30 23:16:35,371 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 5
2025-11-30 23:16:35,372 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 5 recuperados: 5 módulos
2025-11-30 23:16:35,372 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/5/modulos/ 200 6.3ms
2025-11-30 23:23:32,949 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/5/modulos/1/desactivar/
2025-11-30 23:23:32,949 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/5/modulos/1/desactivar/ 200 0.5ms
2025-11-30 23:23:32,951 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/5/modulos/1/desactivar/
2025-11-30 23:23:32,951 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:23:32,951 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:23:32,951 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:23:32,952 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:23:32,952 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:23:32,952 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:23:32,952 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:23:32,952 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:23:32,952 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:23:32,952 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:23:32,952 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/5/modulos/1/desactivar/
2025-11-30 23:23:32,953 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/5/modulos/1/desactivar/ recibida
2025-11-30 23:23:32,965 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 10
2025-11-30 23:23:32,967 - app.core.exceptions - ERROR - CustomException: CANNOT_DEACTIVATE_CORE_MODULE - No se puede desactivar un módulo core. | Path: /api/v1/modulos/clientes/5/modulos/1/desactivar/ | Method: POST
2025-11-30 23:23:32,968 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/5/modulos/1/desactivar/ 400 18.0ms
2025-11-30 23:28:41,983 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-11-30 23:28:41,983 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-11-30 23:28:41,983 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-11-30 23:28:41,983 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-11-30 23:28:41,984 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-11-30 23:28:41,984 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-11-30 23:28:43,284 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-11-30 23:28:43,286 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-11-30 23:28:43,286 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-11-30 23:28:43,287 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-11-30 23:28:43,287 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-11-30 23:28:43,288 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-11-30 23:28:43,618 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-11-30 23:28:43,619 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-11-30 23:28:43,688 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-11-30 23:28:43,688 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-11-30 23:28:43,688 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-11-30 23:28:43,867 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-11-30 23:28:43,868 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-11-30 23:28:43,978 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'assets', 'static', 'backend', 'cdn', 'www', 'api', 'admin'}
2025-11-30 23:28:50,137 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-11-30 23:28:50,137 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-11-30 23:28:50,137 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-11-30 23:28:50,137 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-11-30 23:28:50,138 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-11-30 23:28:50,138 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-11-30 23:28:52,090 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-11-30 23:28:52,091 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-11-30 23:28:52,091 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-11-30 23:28:52,092 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-11-30 23:28:52,092 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-11-30 23:28:52,092 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-11-30 23:28:52,375 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-11-30 23:28:52,376 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-11-30 23:28:52,444 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-11-30 23:28:52,444 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-11-30 23:28:52,444 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-11-30 23:28:52,639 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-11-30 23:28:52,639 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-11-30 23:28:52,743 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'www', 'api', 'admin', 'assets', 'static', 'backend', 'cdn'}
2025-11-30 23:29:39,749 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-30 23:29:39,750 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.1ms
2025-11-30 23:29:39,751 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-30 23:29:39,752 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.6ms
2025-11-30 23:29:39,753 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:29:39,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:39,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:39,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:39,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:39,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:39,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:39,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:39,755 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:39,755 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:39,755 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:39,755 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:29:39,759 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-30 23:29:39,760 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 401 7.4ms
2025-11-30 23:29:39,762 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:29:39,762 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:39,762 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:39,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:39,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:39,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:39,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:39,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:39,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:39,763 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:39,763 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:39,764 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:29:39,764 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-30 23:29:39,766 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 23:29:39,766 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.7ms
2025-11-30 23:29:39,767 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 401 4.3ms
2025-11-30 23:29:39,769 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:29:39,769 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:39,769 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:39,770 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:39,770 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:39,770 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:39,770 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:39,770 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:39,770 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:39,770 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:39,770 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:39,770 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-30 23:29:39,849 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-11-30 23:29:39,852 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-11-30 23:29:39,860 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 23:29:39,866 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:29:39,867 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14451, Rotación: True
2025-11-30 23:29:39,871 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:29:39,872 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 23:29:39,872 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-11-30 23:29:39,872 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14451
2025-11-30 23:29:39,872 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-11-30 23:29:39,882 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:29:39,882 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-11-30 23:29:39,882 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 113.8ms
2025-11-30 23:29:39,886 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:29:39,887 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:39,887 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:39,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:39,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:39,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:39,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:39,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:39,888 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:39,888 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:39,888 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:39,888 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:29:39,890 - app.infrastructure.database.queries - INFO - [SQL_VERSION] Detectada versión: SQL Server 2022 (internal: 16)
2025-11-30 23:29:39,894 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:29:39,894 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:29:39,899 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:29:39,899 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 13.8ms
2025-11-30 23:29:39,902 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:29:39,902 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:39,902 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:39,902 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:39,902 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:39,902 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:39,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:39,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:39,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:39,903 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:39,903 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:39,903 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:29:39,906 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:29:39,906 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:29:39,908 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:29:39,909 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.3ms
2025-11-30 23:29:41,764 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:29:41,764 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:41,765 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:41,765 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:41,765 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:41,765 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:41,765 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:41,765 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:41,766 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:41,766 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:41,766 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:41,766 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:29:41,769 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:29:41,770 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:29:41,771 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:29:41,772 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.3ms
2025-11-30 23:29:41,773 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:29:41,773 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:41,773 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:41,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:41,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:41,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:41,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:41,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:41,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:41,776 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:41,776 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:41,776 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:29:41,778 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:29:41,778 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:29:41,780 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:29:41,780 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 6.9ms
2025-11-30 23:29:42,812 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:29:42,812 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:42,812 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:42,812 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,812 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,813 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,813 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,813 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,813 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,813 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:42,813 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:42,813 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-30 23:29:42,816 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-11-30 23:29:42,817 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-11-30 23:29:42,818 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 23:29:42,821 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:29:42,821 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14452, Rotación: True
2025-11-30 23:29:42,822 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:29:42,822 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 23:29:42,822 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-11-30 23:29:42,823 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14452
2025-11-30 23:29:42,823 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-11-30 23:29:42,825 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:29:42,826 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-11-30 23:29:42,827 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 14.4ms
2025-11-30 23:29:42,832 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-30 23:29:42,832 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.5ms
2025-11-30 23:29:42,834 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-30 23:29:42,834 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:42,834 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:42,834 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,835 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:42,835 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:42,836 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-30 23:29:42,838 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-30 23:29:42,838 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-11-30 23:29:42,838 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-30 23:29:42,852 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-30 23:29:42,852 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-11-30 23:29:42,852 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 18.4ms
2025-11-30 23:29:42,855 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-11-30 23:29:42,856 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.5ms
2025-11-30 23:29:42,857 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-11-30 23:29:42,858 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:42,858 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:42,858 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,858 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,858 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,859 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,859 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,859 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,859 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:42,859 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:42,859 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-11-30 23:29:42,862 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-11-30 23:29:42,862 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-11-30 23:29:42,865 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-11-30 23:29:42,865 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 7.2ms
2025-11-30 23:29:42,884 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-30 23:29:42,885 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.4ms
2025-11-30 23:29:42,885 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:29:42,886 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-30 23:29:42,886 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:42,887 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:42,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,888 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:42,888 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:42,888 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:29:42,889 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:29:42,891 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:29:42,892 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:29:42,893 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 6.9ms
2025-11-30 23:29:42,894 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:29:42,895 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:42,895 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:42,895 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,895 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,895 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,897 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,897 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,897 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,897 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:42,897 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:42,897 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:29:42,899 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:29:42,899 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:29:42,937 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:29:42,938 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 52.7ms
2025-11-30 23:29:42,939 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 44.7ms
2025-11-30 23:29:42,941 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:29:42,941 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:42,942 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:42,942 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,942 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,942 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,942 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,942 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,942 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,942 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:42,942 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:42,942 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:29:42,946 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:29:42,946 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:29:42,947 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:29:42,948 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:29:42,949 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:42,949 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:42,949 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,949 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,949 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,949 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:42,949 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:42,950 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:42,950 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:42,950 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:42,950 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:29:42,952 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:29:42,952 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:29:42,952 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:29:42,952 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 11.9ms
2025-11-30 23:29:42,953 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 5.8ms
2025-11-30 23:29:44,727 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-11-30 23:29:44,728 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 0.6ms
2025-11-30 23:29:44,729 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-11-30 23:29:44,730 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 0.9ms
2025-11-30 23:29:44,731 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-11-30 23:29:44,731 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-11-30 23:29:44,732 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:29:44,732 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 1.5ms
2025-11-30 23:29:44,732 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 1.5ms
2025-11-30 23:29:44,733 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:44,733 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:44,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:44,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:44,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:44,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:44,734 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:44,734 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:44,734 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:44,734 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:44,734 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:29:44,734 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:29:44,738 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:44,742 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:29:44,746 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:29:44,746 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:29:44,754 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:29:44,755 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 23.5ms
2025-11-30 23:29:44,756 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 21.2ms
2025-11-30 23:29:44,757 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:29:44,758 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:44,758 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:44,758 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:44,758 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:44,759 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:44,759 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:44,759 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:44,759 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:44,759 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:44,759 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:44,759 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:29:44,761 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:29:44,762 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:29:44,763 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:44,763 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:44,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:44,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:44,764 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:44,764 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:44,764 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:44,764 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:44,764 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:44,764 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:44,764 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:29:44,766 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:29:44,766 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:29:44,770 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:29:44,770 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 13.1ms
2025-11-30 23:29:44,771 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 8.3ms
2025-11-30 23:29:48,070 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:29:48,071 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:29:48,071 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.9ms
2025-11-30 23:29:48,071 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.6ms
2025-11-30 23:29:48,074 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:29:48,074 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:48,074 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:48,075 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:48,075 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:48,075 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:48,075 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:48,075 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:48,075 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:48,075 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:48,076 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:48,076 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:29:48,077 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:29:48,078 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:29:48,082 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:29:48,083 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 9.1ms
2025-11-30 23:29:48,085 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:29:48,085 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:48,085 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:48,085 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:48,085 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:48,085 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:48,086 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:48,086 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:48,086 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:48,086 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:48,086 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:48,086 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:29:48,088 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:29:48,088 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:29:48,089 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:29:48,089 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.0ms
2025-11-30 23:29:54,262 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:29:54,263 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/2/desactivar/ 200 0.5ms
2025-11-30 23:29:54,264 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:29:54,264 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:29:54,265 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:29:54,265 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:54,265 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:54,265 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:54,265 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:29:54,265 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:29:54,265 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:29:54,266 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:29:54,266 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:29:54,266 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:29:54,267 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/2/desactivar/ recibida
2025-11-30 23:29:54,272 - app.infrastructure.database.repositories.base_service - ERROR - ERROR INESPERADO en obtener_modulo_activo_por_cliente_y_modulo: 1 validation error for ModuloActivoRead
fecha_vencimiento
  Value error, La fecha de vencimiento debe ser futura. [type=value_error, input_value=datetime.datetime(2025, 11, 27, 0, 0), input_type=datetime]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\repositories\base_service.py", line 43, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\tenant\application\services\modulo_activo_service.py", line 158, in obtener_modulo_activo_por_cliente_y_modulo
    return ModuloActivoRead(**modulo_deserializado)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for ModuloActivoRead
fecha_vencimiento
  Value error, La fecha de vencimiento debe ser futura. [type=value_error, input_value=datetime.datetime(2025, 11, 27, 0, 0), input_type=datetime]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error
2025-11-30 23:29:54,291 - app.core.exceptions - ERROR - CustomException: INTERNAL_SERVICE_ERROR - Error interno del servidor en obtener_modulo_activo_por_cliente_y_modulo | Path: /api/v1/modulos/clientes/2/modulos/2/desactivar/ | Method: POST
2025-11-30 23:29:54,292 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/2/desactivar/ 500 27.0ms
2025-11-30 23:30:14,461 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/4/activar/
2025-11-30 23:30:14,463 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/4/activar/ 200 0.5ms
2025-11-30 23:30:14,464 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/4/activar/
2025-11-30 23:30:14,464 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:30:14,464 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:30:14,465 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:14,465 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:14,465 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:14,465 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:14,465 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:14,465 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:14,465 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:30:14,466 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:30:14,466 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/4/activar/
2025-11-30 23:30:14,469 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/4/activar/ recibida
2025-11-30 23:30:14,472 - app.modules.tenant.application.services.modulo_activo_service - INFO - Activando módulo 4 para cliente 2
2025-11-30 23:30:14,477 - app.modules.tenant.application.services.modulo_activo_service - INFO - [ACTIVAR] Registro existente encontrado (ID: 1003), actualizando a activo
2025-11-30 23:30:14,480 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: 1
2025-11-30 23:30:14,480 - app.modules.tenant.application.services.modulo_activo_service - INFO - [ACTIVAR] Módulo reactivado exitosamente (ID: 1003)
2025-11-30 23:30:14,482 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulo 4 activado para cliente 2
2025-11-30 23:30:14,482 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/4/activar/ 201 18.8ms
2025-11-30 23:30:14,486 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:30:14,487 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:30:14,487 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:30:14,487 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:14,487 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:14,487 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:14,487 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:14,488 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:14,488 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:14,488 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:30:14,488 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:30:14,488 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:30:14,490 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:30:14,490 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:30:14,491 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:30:14,492 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.2ms
2025-11-30 23:30:35,647 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/3/activar/
2025-11-30 23:30:35,647 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/3/activar/ 200 0.5ms
2025-11-30 23:30:35,649 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/3/activar/
2025-11-30 23:30:35,649 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:30:35,649 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:30:35,649 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:35,651 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:35,651 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:35,651 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:35,651 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:35,651 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:35,651 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:30:35,651 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:30:35,651 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/3/activar/
2025-11-30 23:30:35,653 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/3/activar/ recibida
2025-11-30 23:30:35,667 - app.modules.tenant.application.services.modulo_activo_service - INFO - Activando módulo 3 para cliente 2
2025-11-30 23:30:35,675 - app.modules.tenant.application.services.modulo_activo_service - INFO - [ACTIVAR] Registro existente encontrado (ID: 6), actualizando a activo
2025-11-30 23:30:35,683 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: 1
2025-11-30 23:30:35,683 - app.modules.tenant.application.services.modulo_activo_service - INFO - [ACTIVAR] Módulo reactivado exitosamente (ID: 6)
2025-11-30 23:30:35,685 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulo 3 activado para cliente 2
2025-11-30 23:30:35,686 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/3/activar/ 201 36.5ms
2025-11-30 23:30:35,688 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:30:35,690 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:30:35,690 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:30:35,690 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:35,690 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:35,690 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:35,691 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:35,691 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:35,691 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:35,691 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:30:35,691 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:30:35,691 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:30:35,696 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:30:35,696 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:30:35,701 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:30:35,701 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 11.9ms
2025-11-30 23:30:39,883 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/4/desactivar/
2025-11-30 23:30:39,884 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/4/desactivar/ 200 0.5ms
2025-11-30 23:30:39,885 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/4/desactivar/
2025-11-30 23:30:39,885 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:30:39,886 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:30:39,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:39,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:39,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:39,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:39,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:39,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:39,886 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:30:39,887 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:30:39,887 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/4/desactivar/
2025-11-30 23:30:39,888 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/4/desactivar/ recibida
2025-11-30 23:30:39,892 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 1003
2025-11-30 23:30:39,895 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: 1
2025-11-30 23:30:39,895 - app.modules.tenant.application.services.modulo_activo_service - INFO - Módulo activo ID 1003 desactivado exitosamente.
2025-11-30 23:30:39,896 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulo 4 desactivado para cliente 2
2025-11-30 23:30:39,896 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/4/desactivar/ 200 10.2ms
2025-11-30 23:30:39,899 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:30:39,899 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:30:39,899 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:30:39,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:39,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:39,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:39,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:39,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:39,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:39,900 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:30:39,901 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:30:39,901 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:30:39,903 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:30:39,903 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:30:39,904 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:30:39,905 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.5ms
2025-11-30 23:30:49,621 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/3/desactivar/
2025-11-30 23:30:49,622 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/3/desactivar/ 200 0.5ms
2025-11-30 23:30:49,623 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/3/desactivar/
2025-11-30 23:30:49,623 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:30:49,623 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:30:49,624 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:49,624 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:49,624 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:49,624 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:49,624 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:49,624 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:49,624 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:30:49,624 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:30:49,625 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/3/desactivar/
2025-11-30 23:30:49,625 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/3/desactivar/ recibida
2025-11-30 23:30:49,626 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 6
2025-11-30 23:30:49,628 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: 1
2025-11-30 23:30:49,629 - app.modules.tenant.application.services.modulo_activo_service - INFO - Módulo activo ID 6 desactivado exitosamente.
2025-11-30 23:30:49,629 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulo 3 desactivado para cliente 2
2025-11-30 23:30:49,629 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/3/desactivar/ 200 6.5ms
2025-11-30 23:30:49,633 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:30:49,633 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:30:49,633 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:30:49,633 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:49,633 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:49,633 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:49,633 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:49,633 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:49,634 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:49,634 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:30:49,634 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:30:49,634 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:30:49,637 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:30:49,637 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:30:49,638 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:30:49,639 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.9ms
2025-11-30 23:30:55,611 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:30:55,611 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:30:55,611 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:30:55,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:55,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:55,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:55,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:30:55,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:30:55,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:30:55,612 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:30:55,612 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:30:55,613 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:30:55,613 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/2/desactivar/ recibida
2025-11-30 23:30:55,614 - app.infrastructure.database.repositories.base_service - ERROR - ERROR INESPERADO en obtener_modulo_activo_por_cliente_y_modulo: 1 validation error for ModuloActivoRead
fecha_vencimiento
  Value error, La fecha de vencimiento debe ser futura. [type=value_error, input_value=datetime.datetime(2025, 11, 27, 0, 0), input_type=datetime]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\repositories\base_service.py", line 43, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\tenant\application\services\modulo_activo_service.py", line 158, in obtener_modulo_activo_por_cliente_y_modulo
    return ModuloActivoRead(**modulo_deserializado)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for ModuloActivoRead
fecha_vencimiento
  Value error, La fecha de vencimiento debe ser futura. [type=value_error, input_value=datetime.datetime(2025, 11, 27, 0, 0), input_type=datetime]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error
2025-11-30 23:30:55,614 - app.core.exceptions - ERROR - CustomException: INTERNAL_SERVICE_ERROR - Error interno del servidor en obtener_modulo_activo_por_cliente_y_modulo | Path: /api/v1/modulos/clientes/2/modulos/2/desactivar/ | Method: POST
2025-11-30 23:30:55,614 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/2/desactivar/ 500 4.3ms
2025-11-30 23:31:39,458 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/1002/desactivar/
2025-11-30 23:31:39,459 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/1002/desactivar/ 200 0.5ms
2025-11-30 23:31:39,461 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1002/desactivar/
2025-11-30 23:31:39,461 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:31:39,461 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:31:39,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:31:39,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:31:39,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:31:39,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:31:39,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:31:39,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:31:39,462 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:31:39,462 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:31:39,462 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1002/desactivar/
2025-11-30 23:31:39,463 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1002/desactivar/ recibida
2025-11-30 23:31:39,479 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 1004
2025-11-30 23:31:39,485 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: 1
2025-11-30 23:31:39,485 - app.modules.tenant.application.services.modulo_activo_service - INFO - Módulo activo ID 1004 desactivado exitosamente.
2025-11-30 23:31:39,485 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulo 1002 desactivado para cliente 2
2025-11-30 23:31:39,485 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1002/desactivar/ 200 25.3ms
2025-11-30 23:31:39,488 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:31:39,488 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:31:39,488 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:31:39,488 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:31:39,488 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:31:39,489 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:31:39,489 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:31:39,489 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:31:39,489 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:31:39,489 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:31:39,489 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:31:39,489 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:31:39,497 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:31:39,497 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:31:39,502 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:31:39,502 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 14.2ms
2025-11-30 23:31:46,381 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:31:46,381 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/1/desactivar/ 200 0.5ms
2025-11-30 23:31:46,384 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:31:46,384 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:31:46,384 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:31:46,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:31:46,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:31:46,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:31:46,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:31:46,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:31:46,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:31:46,385 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:31:46,385 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:31:46,385 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:31:46,385 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1/desactivar/ recibida
2025-11-30 23:31:46,386 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 5
2025-11-30 23:31:46,387 - app.core.exceptions - ERROR - CustomException: CANNOT_DEACTIVATE_CORE_MODULE - No se puede desactivar un módulo core. | Path: /api/v1/modulos/clientes/2/modulos/1/desactivar/ | Method: POST
2025-11-30 23:31:46,388 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1/desactivar/ 400 4.7ms
2025-11-30 23:32:14,924 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:32:14,924 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:32:14,924 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:32:14,924 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:32:14,924 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:32:14,924 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:32:14,925 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:32:14,925 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:32:14,925 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:32:14,925 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:32:14,925 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:32:14,925 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:32:14,926 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/2/desactivar/ recibida
2025-11-30 23:32:14,927 - app.infrastructure.database.repositories.base_service - ERROR - ERROR INESPERADO en obtener_modulo_activo_por_cliente_y_modulo: 1 validation error for ModuloActivoRead
fecha_vencimiento
  Value error, La fecha de vencimiento debe ser futura. [type=value_error, input_value=datetime.datetime(2025, 11, 27, 0, 0), input_type=datetime]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\repositories\base_service.py", line 43, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\tenant\application\services\modulo_activo_service.py", line 158, in obtener_modulo_activo_por_cliente_y_modulo
    return ModuloActivoRead(**modulo_deserializado)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for ModuloActivoRead
fecha_vencimiento
  Value error, La fecha de vencimiento debe ser futura. [type=value_error, input_value=datetime.datetime(2025, 11, 27, 0, 0), input_type=datetime]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error
2025-11-30 23:32:14,927 - app.core.exceptions - ERROR - CustomException: INTERNAL_SERVICE_ERROR - Error interno del servidor en obtener_modulo_activo_por_cliente_y_modulo | Path: /api/v1/modulos/clientes/2/modulos/2/desactivar/ | Method: POST
2025-11-30 23:32:14,928 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/2/desactivar/ 500 4.6ms
2025-11-30 23:33:18,509 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:33:18,511 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:33:18,511 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:33:18,511 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:33:18,511 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:33:18,511 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:33:18,512 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:33:18,512 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:33:18,512 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:33:18,512 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:33:18,512 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:33:18,512 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:33:18,513 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/2/desactivar/ recibida
2025-11-30 23:33:18,531 - app.infrastructure.database.repositories.base_service - ERROR - ERROR INESPERADO en obtener_modulo_activo_por_cliente_y_modulo: 1 validation error for ModuloActivoRead
fecha_vencimiento
  Value error, La fecha de vencimiento debe ser futura. [type=value_error, input_value=datetime.datetime(2025, 11, 27, 0, 0), input_type=datetime]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\repositories\base_service.py", line 43, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\tenant\application\services\modulo_activo_service.py", line 158, in obtener_modulo_activo_por_cliente_y_modulo
    return ModuloActivoRead(**modulo_deserializado)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for ModuloActivoRead
fecha_vencimiento
  Value error, La fecha de vencimiento debe ser futura. [type=value_error, input_value=datetime.datetime(2025, 11, 27, 0, 0), input_type=datetime]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error
2025-11-30 23:33:18,531 - app.core.exceptions - ERROR - CustomException: INTERNAL_SERVICE_ERROR - Error interno del servidor en obtener_modulo_activo_por_cliente_y_modulo | Path: /api/v1/modulos/clientes/2/modulos/2/desactivar/ | Method: POST
2025-11-30 23:33:18,532 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/2/desactivar/ 500 21.1ms
2025-11-30 23:37:40,908 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:37:40,909 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:40,910 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:40,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:40,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:40,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:40,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:40,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:40,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:40,911 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:40,911 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:40,911 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-30 23:37:40,977 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-11-30 23:37:40,982 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-11-30 23:37:40,992 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 23:37:40,999 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:37:41,000 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14453, Rotación: True
2025-11-30 23:37:41,006 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:37:41,007 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 23:37:41,007 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-11-30 23:37:41,007 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14453
2025-11-30 23:37:41,007 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-11-30 23:37:41,021 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:37:41,021 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-11-30 23:37:41,022 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 113.7ms
2025-11-30 23:37:41,281 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-11-30 23:37:41,281 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-11-30 23:37:41,281 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-11-30 23:37:41,282 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-11-30 23:37:41,282 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-11-30 23:37:41,282 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-11-30 23:37:42,218 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-11-30 23:37:42,220 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-11-30 23:37:42,220 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-11-30 23:37:42,220 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-11-30 23:37:42,220 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-11-30 23:37:42,221 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-11-30 23:37:42,585 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-11-30 23:37:42,586 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-11-30 23:37:42,682 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-11-30 23:37:42,683 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-11-30 23:37:42,683 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-11-30 23:37:42,934 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-11-30 23:37:42,934 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-11-30 23:37:43,068 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'cdn', 'www', 'api', 'assets', 'static', 'backend', 'admin'}
2025-11-30 23:37:43,116 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-30 23:37:43,116 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:43,116 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:43,116 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,117 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,117 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,117 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,117 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,117 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,117 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:43,117 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:43,118 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-30 23:37:43,174 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-30 23:37:43,174 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-11-30 23:37:43,175 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-30 23:37:43,185 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-30 23:37:43,186 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-11-30 23:37:43,187 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 71.0ms
2025-11-30 23:37:43,191 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-11-30 23:37:43,191 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:43,191 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:43,191 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,191 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,192 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,192 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,192 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,192 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,192 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:43,192 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:43,193 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-11-30 23:37:43,194 - app.infrastructure.database.queries - INFO - [SQL_VERSION] Detectada versión: SQL Server 2022 (internal: 16)
2025-11-30 23:37:43,195 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-11-30 23:37:43,195 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-11-30 23:37:43,197 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-11-30 23:37:43,197 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 6.9ms
2025-11-30 23:37:43,211 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:37:43,212 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:43,212 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:43,213 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,213 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,213 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,214 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,214 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,214 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,214 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:43,214 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:43,214 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:37:43,215 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:37:43,216 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:37:43,254 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:37:43,255 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:37:43,255 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:37:43,255 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:43,255 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:43,256 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,256 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,256 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,256 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,256 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,256 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,256 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:43,256 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:43,257 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:37:43,257 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:43,257 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:43,257 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,257 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,257 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,257 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,258 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,258 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,258 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:43,258 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:43,258 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:37:43,260 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:37:43,261 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:37:43,273 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:37:43,275 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:37:43,275 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 64.4ms
2025-11-30 23:37:43,276 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 21.7ms
2025-11-30 23:37:43,277 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 21.6ms
2025-11-30 23:37:43,278 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:37:43,280 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:43,280 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:43,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,280 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:43,280 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:43,281 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:37:43,282 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:37:43,283 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:37:43,284 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:37:43,284 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:37:43,285 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:37:43,285 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:43,285 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:43,285 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,286 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,286 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,286 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,286 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,286 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,286 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:43,286 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:43,288 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:37:43,288 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:43,288 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:43,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:43,289 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:43,289 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:43,289 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:43,289 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:43,289 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:37:43,290 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:37:43,293 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:37:43,293 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:37:43,295 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:37:43,295 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 16.4ms
2025-11-30 23:37:43,296 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 11.3ms
2025-11-30 23:37:43,296 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 11.1ms
2025-11-30 23:37:45,986 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:37:45,986 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:45,986 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:45,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:45,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:45,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:45,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:45,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:45,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:45,987 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:45,987 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:45,987 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:37:45,990 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:37:45,990 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:37:45,995 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:37:45,996 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 10.4ms
2025-11-30 23:37:45,998 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:37:45,998 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:45,998 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:45,998 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:45,998 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:45,998 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:45,998 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:46,000 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:46,000 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:46,000 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:46,000 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:46,000 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:37:46,002 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:37:46,002 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:37:46,003 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:37:46,004 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.1ms
2025-11-30 23:37:54,077 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:37:54,079 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:54,079 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:54,079 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:54,079 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:54,079 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:54,079 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:54,079 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:54,079 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:54,079 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:54,080 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:54,080 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/2/desactivar/
2025-11-30 23:37:54,081 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/2/desactivar/ recibida
2025-11-30 23:37:54,086 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 1002
2025-11-30 23:37:54,091 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: 1
2025-11-30 23:37:54,092 - app.modules.tenant.application.services.modulo_activo_service - INFO - Módulo activo ID 1002 desactivado exitosamente.
2025-11-30 23:37:54,092 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulo 2 desactivado para cliente 2
2025-11-30 23:37:54,092 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/2/desactivar/ 200 14.1ms
2025-11-30 23:37:54,096 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:37:54,096 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:54,096 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:54,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:54,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:54,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:54,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:54,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:54,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:54,098 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:54,098 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:54,098 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:37:54,100 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:37:54,100 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:37:54,101 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:37:54,102 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.1ms
2025-11-30 23:37:56,743 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:37:56,743 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:37:56,743 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:37:56,743 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:56,743 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:56,744 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:56,744 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:37:56,744 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:37:56,744 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:37:56,744 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:37:56,744 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:37:56,744 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:37:56,745 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1/desactivar/ recibida
2025-11-30 23:37:56,746 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 5
2025-11-30 23:37:56,747 - app.core.exceptions - ERROR - CustomException: CANNOT_DEACTIVATE_CORE_MODULE - No se puede desactivar un módulo core. | Path: /api/v1/modulos/clientes/2/modulos/1/desactivar/ | Method: POST
2025-11-30 23:37:56,748 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1/desactivar/ 400 5.4ms
2025-11-30 23:38:15,404 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:38:15,404 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:15,404 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:15,404 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,404 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,405 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:15,406 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:15,406 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-30 23:38:15,417 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-11-30 23:38:15,428 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-11-30 23:38:15,440 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 23:38:15,453 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:38:15,453 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14454, Rotación: True
2025-11-30 23:38:15,457 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:38:15,457 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 23:38:15,457 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-11-30 23:38:15,457 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14454
2025-11-30 23:38:15,457 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-11-30 23:38:15,465 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:38:15,465 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-11-30 23:38:15,466 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 63.0ms
2025-11-30 23:38:15,471 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-30 23:38:15,471 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:15,471 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:15,471 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,471 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,472 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,472 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,472 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,472 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,472 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:15,472 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:15,472 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-30 23:38:15,475 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-30 23:38:15,475 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-11-30 23:38:15,476 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-30 23:38:15,486 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-30 23:38:15,487 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-11-30 23:38:15,487 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 16.5ms
2025-11-30 23:38:15,491 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-11-30 23:38:15,492 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:15,492 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:15,492 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,492 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,492 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,492 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,492 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,493 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,493 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:15,493 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:15,493 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-11-30 23:38:15,495 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-11-30 23:38:15,495 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-11-30 23:38:15,496 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-11-30 23:38:15,497 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 5.7ms
2025-11-30 23:38:15,501 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:38:15,502 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:15,502 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:15,502 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,503 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:15,504 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:15,504 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:38:15,504 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:38:15,506 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:38:15,507 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:38:15,553 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:38:15,553 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:15,554 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:15,554 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,554 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,554 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,554 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,554 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,555 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,555 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:15,555 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:15,555 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:38:15,555 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:38:15,558 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:38:15,560 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:15,560 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:15,560 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,560 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,560 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,561 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,561 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,561 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,561 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:15,561 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:15,561 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:38:15,563 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:38:15,563 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:38:15,574 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:38:15,575 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 73.7ms
2025-11-30 23:38:15,575 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 71.6ms
2025-11-30 23:38:15,576 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 20.3ms
2025-11-30 23:38:15,578 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:38:15,578 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:38:15,579 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:15,579 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:15,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,580 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,580 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:15,580 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:15,580 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:38:15,580 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:38:15,581 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:15,581 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:15,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,582 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:15,582 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:15,582 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:38:15,585 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:38:15,588 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:38:15,588 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:38:15,589 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:38:15,589 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:15,589 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:15,589 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,590 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,590 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,590 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:15,590 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:15,590 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:15,590 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:15,590 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:15,590 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:38:15,593 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:38:15,593 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:38:15,595 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:38:15,596 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 18.2ms
2025-11-30 23:38:15,596 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 17.9ms
2025-11-30 23:38:15,597 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 16.1ms
2025-11-30 23:38:17,729 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:38:17,730 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:17,730 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:17,730 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:17,730 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:17,730 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:17,731 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:17,731 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:17,731 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:17,731 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:17,731 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:17,731 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:38:17,733 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:38:17,734 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:38:17,740 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:38:17,740 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.9ms
2025-11-30 23:38:17,741 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:38:17,743 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:17,743 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:17,743 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:17,743 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:17,743 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:17,744 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:17,744 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:17,744 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:17,744 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:17,744 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:17,744 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:38:17,746 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:38:17,746 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:38:17,748 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:38:17,749 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 6.6ms
2025-11-30 23:38:19,204 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:38:19,204 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:19,205 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:19,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:19,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:19,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:19,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:19,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:19,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:19,206 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:19,206 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:19,206 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:38:19,207 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:38:19,209 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:38:19,209 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:19,209 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:19,209 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:19,209 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:19,211 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:19,211 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:19,211 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:19,211 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:19,211 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:19,211 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:19,211 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:38:19,214 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:38:19,214 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:38:19,216 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:38:19,216 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 12.4ms
2025-11-30 23:38:19,217 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 8.7ms
2025-11-30 23:38:19,219 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:38:19,219 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:19,219 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:19,219 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:19,219 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:19,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:19,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:19,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:19,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:19,220 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:19,220 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:19,220 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:38:19,222 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:38:19,224 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:38:19,225 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:19,225 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:19,225 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:19,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:19,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:19,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:19,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:19,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:19,226 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:19,226 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:19,227 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:38:19,228 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:38:19,229 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:38:19,231 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:38:19,231 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 12.7ms
2025-11-30 23:38:19,232 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 10.7ms
2025-11-30 23:38:24,935 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:38:24,936 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:24,936 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:24,936 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:24,936 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:24,936 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:24,936 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:24,936 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:24,937 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:24,937 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:24,937 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:24,937 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:38:24,939 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:38:24,939 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:38:24,942 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:38:24,943 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 7.4ms
2025-11-30 23:38:24,945 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:38:24,945 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:24,945 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:24,945 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:24,946 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:24,946 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:24,946 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:24,946 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:24,946 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:24,946 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:24,947 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:24,947 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:38:24,949 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:38:24,949 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:38:24,949 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:38:24,951 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.0ms
2025-11-30 23:38:26,434 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2/
2025-11-30 23:38:26,435 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2/ 200 0.8ms
2025-11-30 23:38:26,435 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-30 23:38:26,436 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-30 23:38:26,437 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2/
2025-11-30 23:38:26,437 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.7ms
2025-11-30 23:38:26,438 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.4ms
2025-11-30 23:38:26,438 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2/ 200 1.4ms
2025-11-30 23:38:26,438 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2/
2025-11-30 23:38:26,439 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:26,439 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:26,439 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:26,439 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:26,440 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:26,440 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:26,440 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:26,440 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:26,440 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:26,440 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:26,440 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2/
2025-11-30 23:38:26,441 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-30 23:38:26,443 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-30 23:38:26,448 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-30 23:38:26,449 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 23:38:26,450 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2/ 200 12.1ms
2025-11-30 23:38:26,450 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:26,450 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:26,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:26,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:26,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:26,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:26,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:26,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:26,451 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:26,451 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:26,451 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 23:38:26,453 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-11-30 23:38:26,453 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-11-30 23:38:26,456 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 23:38:26,457 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 23:38:26,458 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 8.2ms
2025-11-30 23:38:26,459 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2/
2025-11-30 23:38:26,460 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:26,460 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:26,460 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:26,460 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:26,460 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:26,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:26,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:26,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:26,461 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:26,461 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:26,461 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2/
2025-11-30 23:38:26,463 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-30 23:38:26,464 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-30 23:38:26,465 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-30 23:38:26,465 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 23:38:26,466 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:26,466 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:26,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:26,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:26,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:26,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:26,467 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:26,467 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:26,467 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:26,467 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:26,467 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 23:38:26,467 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2/ 200 8.6ms
2025-11-30 23:38:26,469 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-11-30 23:38:26,469 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-11-30 23:38:26,471 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 23:38:26,471 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 23:38:26,472 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 6.9ms
2025-11-30 23:38:27,682 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:38:27,682 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:27,682 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:27,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:27,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:27,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:27,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:27,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:27,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:27,683 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:27,683 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:27,684 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:38:27,685 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:38:27,685 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:38:27,686 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:38:27,686 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 4.5ms
2025-11-30 23:38:27,687 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:38:27,688 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:27,688 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:27,688 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:27,688 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:27,688 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:27,689 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:27,689 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:27,689 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:27,689 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:27,689 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:27,689 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:38:27,691 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:38:27,692 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:38:27,693 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:38:27,693 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.5ms
2025-11-30 23:38:31,750 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:38:31,750 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:38:31,750 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:38:31,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:31,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:31,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:31,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:38:31,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:38:31,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:38:31,751 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:38:31,751 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:38:31,752 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:38:31,752 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1/desactivar/ recibida
2025-11-30 23:38:31,755 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 5
2025-11-30 23:38:31,758 - app.core.exceptions - ERROR - CustomException: CANNOT_DEACTIVATE_CORE_MODULE - No se puede desactivar un módulo core. | Path: /api/v1/modulos/clientes/2/modulos/1/desactivar/ | Method: POST
2025-11-30 23:38:31,758 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1/desactivar/ 400 8.8ms
2025-11-30 23:39:10,460 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:39:10,461 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:10,461 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:10,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:10,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:10,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:10,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:10,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:10,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:10,462 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:10,462 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:10,462 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:39:10,480 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:39:10,480 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:39:10,491 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:39:10,492 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 32.1ms
2025-11-30 23:39:10,494 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:39:10,495 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:10,495 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:10,495 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:10,495 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:10,495 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:10,495 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:10,496 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:10,496 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:10,496 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:10,496 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:10,496 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:39:10,498 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:39:10,499 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:39:10,502 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:39:10,502 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.6ms
2025-11-30 23:39:12,196 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:39:12,197 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:12,197 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:12,197 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:12,197 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:12,197 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:12,197 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:12,197 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:12,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:12,198 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:12,198 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:12,198 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:39:12,199 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:39:12,203 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:39:12,203 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 7.1ms
2025-11-30 23:39:12,204 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:12,204 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:12,204 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:12,204 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:12,204 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:12,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:12,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:12,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:12,205 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:12,205 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:12,205 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:39:12,208 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:39:12,208 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:39:12,218 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:39:12,220 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 16.2ms
2025-11-30 23:39:12,220 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:39:12,220 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:12,220 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:12,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:12,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:12,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:12,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:12,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:12,222 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:12,222 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:12,222 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:12,222 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:39:12,223 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:39:12,225 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:39:12,225 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:12,226 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:12,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:12,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:12,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:12,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:12,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:12,227 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:12,227 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:12,227 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:12,227 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:39:12,229 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:39:12,229 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:39:12,231 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:39:12,231 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 12.0ms
2025-11-30 23:39:12,233 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 8.3ms
2025-11-30 23:39:13,962 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:39:13,962 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:13,962 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:13,962 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:13,963 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:13,963 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:13,963 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:13,963 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:13,963 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:13,963 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:13,963 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:13,964 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:39:13,965 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:39:13,965 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:39:13,971 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:39:13,971 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 9.0ms
2025-11-30 23:39:13,972 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:39:13,973 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:13,973 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:13,973 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:13,973 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:13,973 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:13,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:13,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:13,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:13,974 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:13,974 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:13,974 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:39:13,976 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:39:13,976 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:39:13,979 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:39:13,979 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.3ms
2025-11-30 23:39:25,745 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-30 23:39:25,745 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 0.8ms
2025-11-30 23:39:25,746 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-30 23:39:25,747 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 0.6ms
2025-11-30 23:39:25,748 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 23:39:25,749 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:25,749 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:25,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:25,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:25,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:25,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:25,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:25,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:25,749 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:25,749 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:25,750 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 23:39:25,752 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-30 23:39:25,752 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-30 23:39:25,755 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 23:39:25,757 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 23:39:25,757 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 9.0ms
2025-11-30 23:39:25,759 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 23:39:25,759 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:25,759 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:25,759 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:25,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:25,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:25,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:25,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:25,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:25,760 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:25,760 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:25,760 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 23:39:25,762 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-30 23:39:25,762 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-30 23:39:25,765 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 23:39:25,765 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 23:39:25,766 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 7.0ms
2025-11-30 23:39:39,284 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/1/
2025-11-30 23:39:39,284 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/1/ 200 0.5ms
2025-11-30 23:39:39,286 - app.main - INFO - [SYSTEM] 127.0.0.1 -> PUT /api/v1/modulos/1/
2025-11-30 23:39:39,287 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:39,287 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:39,287 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:39,287 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:39,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:39,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:39,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:39,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:39,288 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:39,288 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:39,288 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/1/
2025-11-30 23:39:39,295 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud PUT /modulos/1/ recibida
2025-11-30 23:39:39,296 - app.modules.tenant.application.services.modulo_service - INFO - Actualizando módulo ID: 1
2025-11-30 23:39:39,299 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:39:39,300 - app.modules.tenant.application.services.modulo_service - INFO - Módulo ID 1 actualizado exitosamente.
2025-11-30 23:39:39,300 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulo 1 actualizado exitosamente
2025-11-30 23:39:39,300 - app.main - INFO - [SYSTEM] 127.0.0.1 <- PUT /api/v1/modulos/1/ 200 13.8ms
2025-11-30 23:39:39,303 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 23:39:39,303 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:39,303 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:39,303 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:39,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:39,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:39,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:39,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:39,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:39,305 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:39,305 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:39,305 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 23:39:39,307 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-30 23:39:39,307 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-30 23:39:39,308 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 23:39:39,309 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 23:39:39,309 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 5.7ms
2025-11-30 23:39:43,263 - app.main - INFO - [SYSTEM] 127.0.0.1 -> PUT /api/v1/modulos/1/
2025-11-30 23:39:43,263 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:43,263 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:43,263 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:43,264 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:43,264 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:43,264 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:43,264 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:43,264 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:43,264 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:43,264 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:43,265 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/1/
2025-11-30 23:39:43,266 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud PUT /modulos/1/ recibida
2025-11-30 23:39:43,266 - app.modules.tenant.application.services.modulo_service - INFO - Actualizando módulo ID: 1
2025-11-30 23:39:43,267 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:39:43,268 - app.modules.tenant.application.services.modulo_service - INFO - Módulo ID 1 actualizado exitosamente.
2025-11-30 23:39:43,268 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulo 1 actualizado exitosamente
2025-11-30 23:39:43,268 - app.main - INFO - [SYSTEM] 127.0.0.1 <- PUT /api/v1/modulos/1/ 200 5.6ms
2025-11-30 23:39:43,276 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 23:39:43,276 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:43,277 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:43,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:43,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:43,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:43,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:43,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:43,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:43,277 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:43,278 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:43,278 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 23:39:43,279 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-30 23:39:43,279 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-30 23:39:43,279 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 23:39:43,282 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 23:39:43,282 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 6.1ms
2025-11-30 23:39:59,796 - app.main - INFO - [SYSTEM] 127.0.0.1 -> PUT /api/v1/modulos/1/
2025-11-30 23:39:59,797 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:59,797 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:59,797 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:59,797 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:59,797 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:59,797 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:59,798 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:59,798 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:59,798 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:59,798 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:59,798 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/1/
2025-11-30 23:39:59,799 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud PUT /modulos/1/ recibida
2025-11-30 23:39:59,799 - app.modules.tenant.application.services.modulo_service - INFO - Actualizando módulo ID: 1
2025-11-30 23:39:59,801 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:39:59,801 - app.modules.tenant.application.services.modulo_service - INFO - Módulo ID 1 actualizado exitosamente.
2025-11-30 23:39:59,801 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulo 1 actualizado exitosamente
2025-11-30 23:39:59,802 - app.main - INFO - [SYSTEM] 127.0.0.1 <- PUT /api/v1/modulos/1/ 200 5.6ms
2025-11-30 23:39:59,805 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-30 23:39:59,805 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:39:59,805 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:39:59,805 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:59,805 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:59,806 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:59,806 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:39:59,806 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:39:59,806 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:39:59,806 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:39:59,806 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:39:59,806 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-30 23:39:59,808 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-30 23:39:59,808 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-30 23:39:59,810 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-11-30 23:39:59,811 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-11-30 23:39:59,811 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 5.9ms
2025-11-30 23:40:09,452 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-30 23:40:09,452 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-30 23:40:09,452 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.1ms
2025-11-30 23:40:09,453 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.9ms
2025-11-30 23:40:09,457 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:40:09,457 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:40:09,458 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:40:09,458 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:09,458 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:09,458 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:09,458 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:09,458 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:09,458 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:09,459 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:40:09,459 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:40:09,459 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:40:09,462 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:40:09,462 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:40:09,464 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:40:09,465 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.4ms
2025-11-30 23:40:09,467 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:40:09,468 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:40:09,468 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:40:09,469 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:09,469 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:09,469 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:09,469 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:09,469 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:09,469 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:09,469 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:40:09,469 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:40:09,469 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:40:09,473 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:40:09,473 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:40:09,476 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:40:09,477 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.6ms
2025-11-30 23:40:12,022 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-11-30 23:40:12,023 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 0.5ms
2025-11-30 23:40:12,024 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:40:12,025 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:40:12,025 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:40:12,025 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:12,025 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:12,025 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:12,025 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:12,025 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:12,026 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:12,026 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:40:12,026 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:40:12,026 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:40:12,034 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:40:12,041 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-11-30 23:40:12,041 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-11-30 23:40:12,042 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 17.3ms
2025-11-30 23:40:12,042 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 1.1ms
2025-11-30 23:40:12,042 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 1.0ms
2025-11-30 23:40:12,045 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:40:12,045 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:40:12,046 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:40:12,046 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:40:12,046 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:12,046 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:12,046 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:12,046 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:12,046 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:12,046 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:12,047 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:40:12,047 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:40:12,047 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:40:12,049 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:40:12,050 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:40:12,054 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:40:12,054 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:40:12,062 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:40:12,063 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 17.9ms
2025-11-30 23:40:12,063 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 17.8ms
2025-11-30 23:40:12,066 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:40:12,066 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:40:12,066 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:40:12,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:12,067 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:12,067 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:12,067 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:12,067 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:12,067 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:12,067 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:40:12,067 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:40:12,068 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:40:12,069 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:40:12,071 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:40:12,073 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:40:12,074 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 8.1ms
2025-11-30 23:40:13,444 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:40:13,445 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:40:13,445 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.9ms
2025-11-30 23:40:13,445 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.6ms
2025-11-30 23:40:13,447 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:40:13,447 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:40:13,447 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:40:13,447 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:13,447 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:13,447 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:13,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:13,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:13,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:13,448 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:40:13,448 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:40:13,448 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:40:13,456 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:40:13,456 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:40:13,463 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:40:13,464 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 17.5ms
2025-11-30 23:40:13,465 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:40:13,466 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:40:13,466 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:40:13,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:13,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:13,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:13,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:13,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:13,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:13,467 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:40:13,467 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:40:13,467 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:40:13,470 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:40:13,470 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:40:13,471 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:40:13,471 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.8ms
2025-11-30 23:40:16,968 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:40:16,968 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:40:16,968 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:40:16,969 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:16,969 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:16,969 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:16,969 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:40:16,969 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:40:16,969 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:40:16,969 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:40:16,969 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:40:16,970 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:40:16,970 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1/desactivar/ recibida
2025-11-30 23:40:16,991 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 5
2025-11-30 23:40:16,994 - app.core.exceptions - ERROR - CustomException: CANNOT_DEACTIVATE_CORE_MODULE - No se puede desactivar un módulo core. | Path: /api/v1/modulos/clientes/2/modulos/1/desactivar/ | Method: POST
2025-11-30 23:40:16,995 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1/desactivar/ 400 26.9ms
2025-11-30 23:43:27,495 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:43:27,496 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/1/desactivar/ 200 0.5ms
2025-11-30 23:43:27,497 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:43:27,498 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:43:27,498 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:43:27,498 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:43:27,498 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:43:27,498 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:43:27,498 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:43:27,498 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:43:27,498 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:43:27,499 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:43:27,499 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:43:27,499 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:43:27,500 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1/desactivar/ recibida
2025-11-30 23:43:27,522 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 5
2025-11-30 23:43:27,526 - app.core.exceptions - ERROR - CustomException: CANNOT_DEACTIVATE_CORE_MODULE - No se puede desactivar un módulo core. | Path: /api/v1/modulos/clientes/2/modulos/1/desactivar/ | Method: POST
2025-11-30 23:43:27,527 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1/desactivar/ 400 29.7ms
2025-11-30 23:46:36,643 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 23:46:36,644 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 1.0ms
2025-11-30 23:46:36,646 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:46:36,647 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:36,647 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:36,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:36,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:36,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:36,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:36,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:36,649 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:36,649 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:36,649 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:36,649 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-30 23:46:36,678 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-11-30 23:46:36,684 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-11-30 23:46:36,692 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 23:46:36,698 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:46:36,699 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14455, Rotación: True
2025-11-30 23:46:36,703 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:46:36,703 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 23:46:36,704 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-11-30 23:46:36,704 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14455
2025-11-30 23:46:36,704 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-11-30 23:46:36,714 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:46:36,715 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-11-30 23:46:36,715 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 69.4ms
2025-11-30 23:46:36,719 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-30 23:46:36,719 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.4ms
2025-11-30 23:46:36,721 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-30 23:46:36,722 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:36,722 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:36,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:36,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:36,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:36,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:36,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:36,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:36,723 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:36,723 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:36,723 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-30 23:46:36,725 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-30 23:46:36,725 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-11-30 23:46:36,725 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-30 23:46:36,739 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-30 23:46:36,739 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-11-30 23:46:36,740 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 18.4ms
2025-11-30 23:46:36,984 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-11-30 23:46:36,984 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-11-30 23:46:36,984 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-11-30 23:46:36,985 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-11-30 23:46:36,985 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-11-30 23:46:36,985 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-11-30 23:46:38,078 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-11-30 23:46:38,080 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-11-30 23:46:38,080 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-11-30 23:46:38,081 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-11-30 23:46:38,081 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-11-30 23:46:38,081 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-11-30 23:46:38,485 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-11-30 23:46:38,485 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-11-30 23:46:38,589 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-11-30 23:46:38,589 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-11-30 23:46:38,589 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-11-30 23:46:38,896 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-11-30 23:46:38,896 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-11-30 23:46:39,066 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'cdn', 'admin', 'assets', 'static', 'www', 'api', 'backend'}
2025-11-30 23:46:39,111 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-30 23:46:39,112 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:46:39,112 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-11-30 23:46:39,112 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:46:39,112 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-30 23:46:39,113 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:39,113 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:39,113 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,113 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,113 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,113 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,114 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,114 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,114 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:39,114 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:39,114 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:46:39,114 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:39,114 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:39,115 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,115 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,115 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,115 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,115 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,115 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,116 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:39,116 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:39,116 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:46:39,116 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 5.5ms
2025-11-30 23:46:39,163 - app.infrastructure.database.queries - INFO - [SQL_VERSION] Detectada versión: SQL Server 2022 (internal: 16)
2025-11-30 23:46:39,166 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:46:39,169 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 57.2ms
2025-11-30 23:46:39,170 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:46:39,171 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:46:39,177 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:46:39,179 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 66.2ms
2025-11-30 23:46:39,180 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 68.9ms
2025-11-30 23:46:39,180 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 68.5ms
2025-11-30 23:46:39,184 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-11-30 23:46:39,184 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:46:39,185 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:39,185 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:39,185 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,185 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,186 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,186 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,186 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,186 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,186 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:39,186 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:39,187 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-11-30 23:46:39,187 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:39,187 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:39,187 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,187 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,187 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,187 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,188 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,188 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,188 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:39,188 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:39,188 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:46:39,188 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:46:39,189 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-11-30 23:46:39,189 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-11-30 23:46:39,192 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-11-30 23:46:39,193 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:46:39,193 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:46:39,234 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:46:39,234 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:39,235 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:39,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,235 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:39,236 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:39,236 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:46:39,236 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:46:39,238 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:46:39,238 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:39,238 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:39,238 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,239 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,239 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,239 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,239 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,239 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,239 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:39,239 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:39,239 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:46:39,241 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:46:39,241 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:46:39,243 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:46:39,244 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 60.2ms
2025-11-30 23:46:39,244 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 60.0ms
2025-11-30 23:46:39,245 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 56.8ms
2025-11-30 23:46:39,246 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 10.0ms
2025-11-30 23:46:39,246 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:46:39,247 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:39,247 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:39,247 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,247 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,248 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,248 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:39,248 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:39,248 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:39,248 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:39,248 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:39,249 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:46:39,251 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:46:39,251 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:46:39,252 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:46:39,254 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.2ms
2025-11-30 23:46:40,860 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:46:40,860 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:40,860 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:40,860 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:40,860 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:40,860 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:40,860 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:40,860 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:40,862 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:40,862 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:40,862 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:40,862 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:46:40,864 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:46:40,864 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:46:40,868 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:46:40,869 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 9.3ms
2025-11-30 23:46:40,870 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:46:40,870 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:40,871 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:40,871 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:40,871 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:40,871 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:40,871 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:40,871 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:40,871 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:40,871 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:40,872 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:40,872 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:46:40,875 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:46:40,875 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:46:40,876 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:46:40,876 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.5ms
2025-11-30 23:46:43,146 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:46:43,147 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:46:43,147 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:46:43,147 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:43,147 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:43,147 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:43,147 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:46:43,148 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:46:43,148 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:46:43,148 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:46:43,148 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:46:43,148 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:46:43,149 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1/desactivar/ recibida
2025-11-30 23:46:43,154 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 5
2025-11-30 23:46:43,158 - app.modules.tenant.presentation.endpoints_modulos - WARNING - Error de negocio al desactivar módulo 1 para cliente 2: No se puede desactivar un módulo core.
2025-11-30 23:46:43,159 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1/desactivar/ 400 12.4ms
2025-11-30 23:52:51,811 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-11-30 23:52:51,811 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-11-30 23:52:51,811 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-11-30 23:52:51,812 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-11-30 23:52:51,812 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-11-30 23:52:51,812 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-11-30 23:52:53,720 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-11-30 23:52:53,721 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-11-30 23:52:53,721 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-11-30 23:52:53,723 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-11-30 23:52:53,723 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-11-30 23:52:53,723 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-11-30 23:52:53,998 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-11-30 23:52:53,998 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-11-30 23:52:54,070 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-11-30 23:52:54,072 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-11-30 23:52:54,072 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-11-30 23:52:54,258 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-11-30 23:52:54,259 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-11-30 23:52:54,361 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'admin', 'api', 'www', 'static', 'assets', 'cdn', 'backend'}
2025-11-30 23:53:02,548 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:53:02,550 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:02,550 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:02,550 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,550 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,550 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,550 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,551 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,551 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,551 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:02,551 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:02,551 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-30 23:53:02,636 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-11-30 23:53:02,639 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-11-30 23:53:02,648 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-30 23:53:02,655 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:53:02,655 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14456, Rotación: True
2025-11-30 23:53:02,662 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-30 23:53:02,662 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-11-30 23:53:02,662 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-11-30 23:53:02,663 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14456
2025-11-30 23:53:02,663 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-11-30 23:53:02,671 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:53:02,671 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-11-30 23:53:02,673 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 124.0ms
2025-11-30 23:53:02,681 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-30 23:53:02,683 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:02,683 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:02,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,684 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:02,684 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:02,684 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-30 23:53:02,686 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-30 23:53:02,687 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-11-30 23:53:02,687 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-30 23:53:02,703 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-30 23:53:02,703 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-11-30 23:53:02,704 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 21.3ms
2025-11-30 23:53:02,707 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-11-30 23:53:02,707 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:02,708 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:02,708 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,709 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,709 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,709 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,711 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,712 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:02,712 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:02,712 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-11-30 23:53:02,714 - app.infrastructure.database.queries - INFO - [SQL_VERSION] Detectada versión: SQL Server 2022 (internal: 16)
2025-11-30 23:53:02,716 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-11-30 23:53:02,717 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-11-30 23:53:02,718 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-11-30 23:53:02,719 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 12.5ms
2025-11-30 23:53:02,723 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-11-30 23:53:02,723 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:53:02,724 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 1.5ms
2025-11-30 23:53:02,724 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:02,724 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:02,724 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,726 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,726 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:02,726 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:02,726 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:53:02,729 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:53:02,729 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:53:02,785 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:53:02,787 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-11-30 23:53:02,788 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-11-30 23:53:02,788 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-11-30 23:53:02,788 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 2.5ms
2025-11-30 23:53:02,790 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 66.7ms
2025-11-30 23:53:02,791 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 2.6ms
2025-11-30 23:53:02,791 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 2.2ms
2025-11-30 23:53:02,796 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:53:02,797 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:02,798 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:02,798 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,798 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,798 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,798 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,798 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,799 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,799 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:02,799 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:02,799 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:53:02,802 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:53:02,806 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:53:02,807 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:02,807 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:02,809 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,809 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,809 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,809 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,809 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,809 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,809 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:02,809 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:02,809 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:53:02,810 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-30 23:53:02,813 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:53:02,813 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:53:02,825 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:53:02,826 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 30.4ms
2025-11-30 23:53:02,826 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:02,826 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:02,826 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,826 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,826 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,827 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,827 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,827 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,827 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:02,827 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:02,828 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-30 23:53:02,831 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-30 23:53:02,831 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-30 23:53:02,833 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-30 23:53:02,834 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 23:53:02,834 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 23:53:02,836 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-30 23:53:02,837 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 29.9ms
2025-11-30 23:53:02,837 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 2.5ms
2025-11-30 23:53:02,837 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 2.2ms
2025-11-30 23:53:02,838 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:53:02,838 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 2.3ms
2025-11-30 23:53:02,839 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 28.6ms
2025-11-30 23:53:02,840 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:02,840 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:02,840 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,840 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,840 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,841 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,841 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,841 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,841 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:02,841 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:02,841 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:53:02,846 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:53:02,849 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:53:02,850 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:02,850 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:02,851 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,851 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,851 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,851 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:02,851 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,851 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:02,851 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:02,851 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:02,851 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:53:02,856 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:53:02,856 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:53:02,860 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:53:02,860 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:53:02,861 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:53:02,862 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 24.7ms
2025-11-30 23:53:02,864 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-30 23:53:02,865 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:02,865 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-11-30 23:53:02,865 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:53:02,865 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,866 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:53:02,868 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-11-30 23:53:02,868 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:02,868 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-30 23:53:02,869 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-30 23:53:06,996 - app.infrastructure.cache.redis_cache - WARNING - [REDIS_CACHE] Error conectando a Redis: Error 10061 connecting to localhost:6379. No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión.. Cache desactivado automáticamente (usando fallback en memoria).
2025-11-30 23:53:06,996 - app.infrastructure.cache.redis_cache - INFO - ℹ️ Módulo de Redis cache cargado pero desactivado (usando fallback en memoria)
2025-11-30 23:53:07,003 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 2: multi - bd_cliente_acme
2025-11-30 23:53:07,003 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-11-30 23:53:07,003 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/refresh/
2025-11-30 23:53:07,004 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:07,004 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': techcorp.app.local:5173
2025-11-30 23:53:07,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.app.local'
2025-11-30 23:53:07,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:07,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-30 23:53:07,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.app.local'
2025-11-30 23:53:07,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:07,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-30 23:53:07,007 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-30 23:53:07,007 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 4: single - bd_sistema
2025-11-30 23:53:07,007 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_sistema, servidor=localhost
2025-11-30 23:53:07,008 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_sistema, path=/api/v1/auth/refresh/
2025-11-30 23:53:07,009 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:07,009 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': global.app.local:5173
2025-11-30 23:53:07,009 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'global.app.local'
2025-11-30 23:53:07,009 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:07,009 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-11-30 23:53:07,012 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'global.app.local'
2025-11-30 23:53:07,012 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:07,012 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-11-30 23:53:07,013 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='global', Código='GLOBAL004', ID=5
2025-11-30 23:53:07,014 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 5: single - bd_sistema
2025-11-30 23:53:07,014 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_sistema, servidor=localhost
2025-11-30 23:53:07,014 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=5, db_type=single, bd=bd_sistema, path=/api/v1/auth/refresh/
2025-11-30 23:53:07,016 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-30 23:53:07,016 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-30 23:53:07,017 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 4167.8ms
2025-11-30 23:53:07,018 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 2.0ms
2025-11-30 23:53:07,018 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.7ms
2025-11-30 23:53:07,021 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:53:07,048 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 2
2025-11-30 23:53:07,048 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-11-30 23:53:07,048 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-11-30 23:53:07,054 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:53:07,055 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-11-30 23:53:07,056 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 4
2025-11-30 23:53:07,056 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-11-30 23:53:07,059 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:53:07,059 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-11-30 23:53:07,061 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 5
2025-11-30 23:53:07,062 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-11-30 23:53:07,063 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-30 23:53:07,064 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-11-30 23:53:07,064 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:53:07,065 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:07,065 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:07,065 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:07,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:07,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:07,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:07,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:07,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:07,067 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:07,067 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:07,067 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:53:07,069 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:53:07,069 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:53:07,074 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:53:07,074 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 4213.5ms
2025-11-30 23:53:07,074 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 4213.2ms
2025-11-30 23:53:07,075 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 4211.1ms
2025-11-30 23:53:07,076 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 12.2ms
2025-11-30 23:53:07,078 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-30 23:53:07,079 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:07,080 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:07,080 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:07,080 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:07,080 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:07,080 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:07,080 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:07,080 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:07,081 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:07,081 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:07,081 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-30 23:53:07,084 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-11-30 23:53:07,084 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-11-30 23:53:07,085 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-11-30 23:53:07,086 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.4ms
2025-11-30 23:53:08,583 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:53:08,584 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:08,584 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:08,585 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:08,585 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:08,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:08,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:08,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:08,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:08,587 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:08,587 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:08,587 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:53:08,589 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:53:08,591 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:53:08,591 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:08,591 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:08,592 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:08,592 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:08,592 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:08,592 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:08,592 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:08,592 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:08,592 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:08,593 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:08,593 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:53:08,595 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:53:08,596 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:53:08,598 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:53:08,598 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 15.4ms
2025-11-30 23:53:08,599 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 8.8ms
2025-11-30 23:53:08,601 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-11-30 23:53:08,601 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:08,601 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:08,601 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:08,601 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:08,603 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:08,603 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:08,603 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:08,603 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:08,604 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:08,604 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:08,604 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-11-30 23:53:08,604 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-11-30 23:53:08,606 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-11-30 23:53:08,607 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:08,607 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:08,608 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:08,608 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:08,608 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:08,608 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:08,608 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:08,608 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:08,608 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:08,609 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:08,609 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-11-30 23:53:08,610 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-11-30 23:53:08,610 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-11-30 23:53:08,613 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-11-30 23:53:08,613 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 12.4ms
2025-11-30 23:53:08,614 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 9.9ms
2025-11-30 23:53:09,950 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:53:09,951 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:53:09,951 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 1.0ms
2025-11-30 23:53:09,952 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.9ms
2025-11-30 23:53:09,953 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:53:09,953 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:09,953 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:09,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:09,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:09,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:09,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:09,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:09,954 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:09,954 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:09,954 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:09,954 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:53:09,955 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:53:09,956 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:53:09,960 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:53:09,961 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 8.4ms
2025-11-30 23:53:09,963 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:53:09,963 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:09,963 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:09,963 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:09,963 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:09,963 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:09,964 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:09,964 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:09,964 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:09,964 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:09,964 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:09,964 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:53:09,966 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:53:09,966 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:53:09,967 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:53:09,968 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.8ms
2025-11-30 23:53:12,176 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:53:12,177 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:12,177 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:12,177 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:12,177 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:12,177 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:12,177 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:12,177 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:12,178 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:12,178 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:12,178 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:12,178 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:53:12,179 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1/desactivar/ recibida
2025-11-30 23:53:12,184 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 5
2025-11-30 23:53:12,187 - app.modules.tenant.presentation.endpoints_modulos - WARNING - Error de negocio al desactivar módulo 1 para cliente 2: No se puede desactivar un módulo core.
2025-11-30 23:53:12,188 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1/desactivar/ 400 11.9ms
2025-11-30 23:53:18,815 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:53:18,815 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:53:18,815 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:53:18,815 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:18,815 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:18,816 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:18,816 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:53:18,816 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:53:18,816 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:53:18,816 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:53:18,816 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:53:18,816 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:53:18,817 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1/desactivar/ recibida
2025-11-30 23:53:18,818 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 5
2025-11-30 23:53:18,819 - app.modules.tenant.presentation.endpoints_modulos - WARNING - Error de negocio al desactivar módulo 1 para cliente 2: No se puede desactivar un módulo core.
2025-11-30 23:53:18,819 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1/desactivar/ 400 4.9ms
2025-11-30 23:57:01,879 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:57:01,879 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/1/desactivar/ 200 0.5ms
2025-11-30 23:57:01,880 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:57:01,881 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:57:01,881 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:57:01,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:57:01,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:57:01,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:57:01,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:57:01,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:57:01,882 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:57:01,882 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:57:01,882 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:57:01,882 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-11-30 23:57:01,883 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1/desactivar/ recibida
2025-11-30 23:57:01,907 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 5
2025-11-30 23:57:01,910 - app.modules.tenant.presentation.endpoints_modulos - WARNING - Error de negocio al desactivar módulo 1 para cliente 2: No se puede desactivar un módulo core.
2025-11-30 23:57:01,911 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1/desactivar/ 400 30.1ms
2025-11-30 23:57:53,998 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:57:53,998 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:57:53,998 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:57:53,999 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:57:53,999 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:57:53,999 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:57:53,999 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:57:53,999 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:57:53,999 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:57:53,999 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:57:53,999 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:57:53,999 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:57:54,018 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:57:54,018 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:57:54,025 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:57:54,027 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 28.5ms
2025-11-30 23:58:24,988 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:58:24,988 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:58:24,988 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:58:24,989 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:58:24,989 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:58:24,989 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:58:24,989 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:58:24,989 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:58:24,989 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:58:24,989 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:58:24,989 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:58:24,989 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:58:24,991 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:58:24,991 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:58:24,993 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:58:24,994 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.1ms
2025-11-30 23:59:47,004 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:47,005 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:47,005 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:47,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:47,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:47,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:47,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:47,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:47,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:47,006 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:47,006 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:47,006 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:47,036 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:59:47,036 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:59:47,044 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:59:47,045 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 40.4ms
2025-11-30 23:59:47,753 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:47,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:47,754 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:47,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:47,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:47,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:47,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:47,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:47,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:47,755 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:47,755 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:47,755 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:47,758 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:59:47,758 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:59:47,759 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:59:47,759 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.6ms
2025-11-30 23:59:48,768 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:48,768 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:48,768 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:48,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:48,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:48,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:48,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:48,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:48,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:48,769 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:48,769 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:48,769 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:48,772 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:59:48,772 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:59:48,773 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:59:48,773 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.3ms
2025-11-30 23:59:50,005 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:50,005 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:50,006 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:50,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:50,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:50,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:50,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:50,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:50,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:50,006 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:50,007 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:50,007 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:50,009 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:59:50,009 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:59:50,012 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:59:50,012 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 7.0ms
2025-11-30 23:59:51,297 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:51,297 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:51,297 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:51,297 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:51,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:51,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:51,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:51,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:51,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:51,298 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:51,299 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:51,299 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:51,302 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:59:51,302 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:59:51,303 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:59:51,304 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 7.1ms
2025-11-30 23:59:52,415 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:52,416 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:52,416 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:52,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:52,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:52,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:52,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:52,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:52,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:52,418 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:52,418 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:52,418 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:52,419 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:59:52,421 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:59:52,422 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:59:52,423 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 7.4ms
2025-11-30 23:59:53,909 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:53,909 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:53,909 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:53,909 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:53,909 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:53,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:53,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:53,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:53,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:53,910 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:53,910 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:53,910 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:53,913 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:59:53,914 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:59:53,915 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:59:53,916 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.9ms
2025-11-30 23:59:54,904 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:54,905 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:54,905 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:54,905 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:54,905 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:54,906 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:54,906 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:54,906 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:54,906 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:54,906 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:54,906 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:54,906 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:54,909 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:59:54,909 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:59:54,911 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:59:54,912 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 7.6ms
2025-11-30 23:59:56,218 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:56,219 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:56,219 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:56,219 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:56,219 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:56,219 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:56,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:56,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:56,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:56,220 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:56,220 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:56,220 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:56,230 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:59:56,230 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:59:56,239 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:59:56,239 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 22.7ms
2025-11-30 23:59:57,979 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:57,979 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:57,979 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:57,979 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:57,979 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:57,981 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:57,981 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:57,981 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:57,981 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:57,981 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:57,981 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:57,981 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:57,991 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-11-30 23:59:57,991 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-11-30 23:59:58,000 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-11-30 23:59:58,001 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 21.8ms
2025-11-30 23:59:59,994 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-11-30 23:59:59,995 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-11-30 23:59:59,995 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-11-30 23:59:59,995 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:59,995 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:59,995 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:59,995 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-11-30 23:59:59,995 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-11-30 23:59:59,996 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-11-30 23:59:59,996 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-11-30 23:59:59,996 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-30 23:59:59,996 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:00:00,014 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:00:00,014 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:00:00,022 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:00:00,023 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 28.3ms
2025-12-01 00:00:00,985 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:00:00,986 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:00:00,986 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:00:00,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:00:00,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:00:00,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:00:00,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:00:00,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:00:00,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:00:00,987 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:00:00,987 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:00:00,987 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:00:01,001 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:00:01,001 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:00:01,008 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:00:01,010 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 24.6ms
2025-12-01 00:00:07,989 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:00:07,989 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:00:07,989 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:00:07,989 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:00:07,989 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:00:07,990 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:00:07,990 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:00:07,990 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:00:07,990 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:00:07,990 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:00:07,990 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:00:07,990 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:00:07,992 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:00:07,992 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:00:07,993 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:00:07,994 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 6.2ms
2025-12-01 00:00:35,988 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:00:35,989 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:00:35,989 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:00:35,989 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:00:35,990 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:00:35,990 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:00:35,990 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:00:35,990 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:00:35,990 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:00:35,990 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:00:35,990 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:00:35,991 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:00:35,992 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:00:35,993 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:00:35,994 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:00:35,994 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.5ms
2025-12-01 00:01:12,748 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-01 00:01:12,748 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-01 00:01:12,748 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-01 00:01:12,748 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-01 00:01:12,748 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-01 00:01:12,750 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-01 00:01:14,248 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-01 00:01:14,250 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-01 00:01:14,251 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-01 00:01:14,251 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-01 00:01:14,251 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-01 00:01:14,251 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-12-01 00:01:14,522 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-01 00:01:14,522 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-01 00:01:14,593 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-01 00:01:14,593 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-01 00:01:14,593 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-01 00:01:14,788 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-01 00:01:14,789 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-01 00:01:14,900 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'api', 'static', 'admin', 'assets', 'www', 'cdn', 'backend'}
2025-12-01 00:01:21,329 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-01 00:01:21,330 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.8ms
2025-12-01 00:01:21,332 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 00:01:21,332 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:21,332 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:21,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:21,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:21,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:21,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:21,334 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:21,334 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:21,334 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:21,334 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:21,334 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-12-01 00:01:21,424 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-12-01 00:01:21,427 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-12-01 00:01:21,433 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-12-01 00:01:21,441 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:01:21,442 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14457, Rotación: True
2025-12-01 00:01:21,470 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-12-01 00:01:21,471 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-12-01 00:01:21,471 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-01 00:01:21,471 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14457
2025-12-01 00:01:21,472 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-01 00:01:21,480 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:01:21,480 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-12-01 00:01:21,482 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 150.0ms
2025-12-01 00:01:21,482 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 00:01:21,482 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 00:01:21,483 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:21,483 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': global.app.local:5173
2025-12-01 00:01:21,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'global.app.local'
2025-12-01 00:01:21,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:21,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-12-01 00:01:21,488 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'global.app.local'
2025-12-01 00:01:21,488 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:21,488 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-12-01 00:01:21,490 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='global', Código='GLOBAL004', ID=5
2025-12-01 00:01:25,622 - app.infrastructure.cache.redis_cache - WARNING - [REDIS_CACHE] Error conectando a Redis: Error 10061 connecting to localhost:6379. No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión.. Cache desactivado automáticamente (usando fallback en memoria).
2025-12-01 00:01:25,622 - app.infrastructure.cache.redis_cache - INFO - ℹ️ Módulo de Redis cache cargado pero desactivado (usando fallback en memoria)
2025-12-01 00:01:25,627 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 5: single - bd_sistema
2025-12-01 00:01:25,628 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_sistema, servidor=localhost
2025-12-01 00:01:25,628 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=5, db_type=single, bd=bd_sistema, path=/api/v1/auth/refresh/
2025-12-01 00:01:25,628 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:25,628 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': techcorp.app.local:5173
2025-12-01 00:01:25,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.app.local'
2025-12-01 00:01:25,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-12-01 00:01:25,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.app.local'
2025-12-01 00:01:25,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-12-01 00:01:25,632 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-12-01 00:01:25,633 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 4: single - bd_sistema
2025-12-01 00:01:25,633 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_sistema, servidor=localhost
2025-12-01 00:01:25,633 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_sistema, path=/api/v1/auth/refresh/
2025-12-01 00:01:25,636 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 00:01:25,637 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:25,637 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 00:01:25,637 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 00:01:25,637 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,637 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 00:01:25,638 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 00:01:25,640 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,640 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 00:01:25,641 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 00:01:25,642 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 2: multi - bd_cliente_acme
2025-12-01 00:01:25,642 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 00:01:25,643 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/refresh/
2025-12-01 00:01:25,643 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-12-01 00:01:25,645 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 5
2025-12-01 00:01:25,645 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-01 00:01:25,648 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:01:25,648 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-12-01 00:01:25,650 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 4
2025-12-01 00:01:25,651 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-01 00:01:25,652 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:01:25,652 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-12-01 00:01:25,652 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 8.7ms
2025-12-01 00:01:25,654 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 4171.6ms
2025-12-01 00:01:25,654 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 4171.5ms
2025-12-01 00:01:25,655 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:01:25,688 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 2
2025-12-01 00:01:25,688 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-01 00:01:25,688 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:01:25,693 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:01:25,694 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-12-01 00:01:25,694 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-01 00:01:25,695 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:25,695 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:25,695 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,696 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,696 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,696 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,696 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,696 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,696 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:25,696 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:25,697 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-12-01 00:01:25,699 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-01 00:01:25,699 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-01 00:01:25,699 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-12-01 00:01:25,710 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-12-01 00:01:25,710 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-01 00:01:25,711 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 75.4ms
2025-12-01 00:01:25,713 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 19.2ms
2025-12-01 00:01:25,722 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-12-01 00:01:25,722 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.8ms
2025-12-01 00:01:25,737 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-01 00:01:25,738 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:25,738 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:25,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,739 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,739 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,739 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,739 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:25,739 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:25,739 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-12-01 00:01:25,741 - app.infrastructure.database.queries - INFO - [SQL_VERSION] Detectada versión: SQL Server 2022 (internal: 16)
2025-12-01 00:01:25,743 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-12-01 00:01:25,744 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-12-01 00:01:25,746 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-12-01 00:01:25,748 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-01 00:01:25,750 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 00:01:25,751 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 00:01:25,751 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 2.2ms
2025-12-01 00:01:25,752 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:25,752 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:25,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,753 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:25,753 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:25,753 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 00:01:25,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:25,754 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:25,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,755 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:25,755 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:25,755 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 00:01:25,755 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-01 00:01:25,756 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 18.5ms
2025-12-01 00:01:25,758 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 00:01:25,762 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 00:01:25,762 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 00:01:25,768 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 00:01:25,771 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 15.4ms
2025-12-01 00:01:25,772 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 22.1ms
2025-12-01 00:01:25,772 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 21.9ms
2025-12-01 00:01:25,773 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 00:01:25,774 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:25,774 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:25,774 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,774 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,774 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,775 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:25,775 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:25,775 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 00:01:25,778 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 00:01:25,778 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 00:01:25,818 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 00:01:25,820 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 00:01:25,821 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:25,821 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:25,822 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,822 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,822 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,822 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,822 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,822 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,822 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:25,823 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:25,823 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 00:01:25,825 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 00:01:25,827 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 00:01:25,827 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 54.6ms
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:25,828 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 00:01:25,831 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 00:01:25,831 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 00:01:25,834 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 00:01:25,835 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 14.4ms
2025-12-01 00:01:25,835 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 00:01:25,836 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:25,836 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:25,836 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,836 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,837 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,837 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:25,837 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:25,837 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:25,837 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:25,837 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:25,838 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 00:01:25,838 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 11.2ms
2025-12-01 00:01:25,840 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 00:01:25,840 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 00:01:25,841 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 00:01:25,843 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.9ms
2025-12-01 00:01:27,415 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:01:27,417 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:27,417 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:27,417 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:27,417 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:27,417 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:27,418 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:27,418 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:27,418 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:27,418 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:27,418 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:27,418 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:01:27,423 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:01:27,423 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:01:27,433 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:01:27,434 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 18.4ms
2025-12-01 00:01:27,436 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:01:27,437 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:27,437 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:27,437 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:27,437 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:27,437 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:27,438 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:27,438 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:27,438 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:27,438 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:27,438 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:27,438 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:01:27,443 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:01:27,443 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:01:27,451 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:01:27,452 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 15.6ms
2025-12-01 00:01:28,910 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 00:01:28,911 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:28,911 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:28,911 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:28,911 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:28,912 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:28,912 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:28,912 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:28,912 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:28,912 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:28,912 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:28,912 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 00:01:28,917 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 00:01:28,921 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 00:01:28,922 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:28,922 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:28,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:28,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:28,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:28,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:28,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:28,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:28,923 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:28,923 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:28,924 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 00:01:28,924 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 13.4ms
2025-12-01 00:01:28,926 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 00:01:28,926 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 00:01:28,934 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 00:01:28,935 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 14.0ms
2025-12-01 00:01:28,937 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 00:01:28,937 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:28,939 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:28,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:28,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:28,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:28,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:28,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:28,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:28,939 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:28,939 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:28,939 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 00:01:28,940 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 00:01:28,941 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 00:01:28,943 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:28,943 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:28,943 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:28,943 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:28,943 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:28,943 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:28,943 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:28,945 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:28,945 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:28,945 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:28,945 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 00:01:28,947 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 00:01:28,947 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 00:01:28,949 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 00:01:28,950 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 12.7ms
2025-12-01 00:01:28,950 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 11.0ms
2025-12-01 00:01:30,810 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:01:30,811 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:30,811 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:30,811 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:30,811 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:30,811 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:30,812 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:30,812 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:30,812 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:30,812 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:30,812 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:30,812 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:01:30,815 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:01:30,815 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:01:30,821 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:01:30,822 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 11.3ms
2025-12-01 00:01:30,823 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:01:30,823 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:30,824 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:30,824 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:30,824 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:30,824 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:30,824 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:30,824 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:30,824 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:30,825 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:30,825 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:30,825 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:01:30,826 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:01:30,826 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:01:30,827 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:01:30,828 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.1ms
2025-12-01 00:01:34,842 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-12-01 00:01:34,842 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:34,842 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:34,842 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:34,843 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:34,843 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:34,843 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:34,843 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:34,843 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:34,843 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:34,843 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:34,843 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/1/desactivar/
2025-12-01 00:01:34,844 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/1/desactivar/ recibida
2025-12-01 00:01:34,854 - app.modules.tenant.application.services.modulo_activo_service - INFO - Desactivando módulo activo ID: 5
2025-12-01 00:01:34,857 - app.modules.tenant.presentation.endpoints_modulos - WARNING - Error de negocio al desactivar módulo 1 para cliente 2: No se puede desactivar un módulo core.
2025-12-01 00:01:34,857 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/1/desactivar/ 400 15.7ms
2025-12-01 00:01:57,547 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/2/activar/
2025-12-01 00:01:57,547 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/2/activar/ 200 0.5ms
2025-12-01 00:01:57,549 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/modulos/clientes/2/modulos/2/activar/
2025-12-01 00:01:57,549 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:57,550 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:57,550 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:57,550 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:57,550 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:57,550 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:57,550 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:57,550 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:57,551 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:57,551 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:57,551 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/2/activar/
2025-12-01 00:01:57,556 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud POST /clientes/2/modulos/2/activar/ recibida
2025-12-01 00:01:57,557 - app.modules.tenant.application.services.modulo_activo_service - INFO - Activando módulo 2 para cliente 2
2025-12-01 00:01:57,564 - app.modules.tenant.application.services.modulo_activo_service - INFO - [ACTIVAR] Registro existente encontrado (ID: 1002), actualizando a activo
2025-12-01 00:01:57,570 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: 1
2025-12-01 00:01:57,570 - app.modules.tenant.application.services.modulo_activo_service - INFO - [ACTIVAR] Módulo reactivado exitosamente (ID: 1002)
2025-12-01 00:01:57,571 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulo 2 activado para cliente 2
2025-12-01 00:01:57,571 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/modulos/clientes/2/modulos/2/activar/ 201 22.6ms
2025-12-01 00:01:57,575 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:01:57,577 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:01:57,577 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:01:57,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:57,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:57,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:57,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:01:57,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:01:57,578 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:01:57,578 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:01:57,578 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:01:57,578 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:01:57,580 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:01:57,580 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:01:57,583 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:01:57,584 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 8.7ms
2025-12-01 00:03:01,536 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-01 00:03:01,536 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-01 00:03:01,536 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-01 00:03:01,536 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-01 00:03:01,538 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-01 00:03:01,538 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-01 00:39:20,845 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-01 00:39:20,859 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-01 00:39:20,859 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-01 00:39:20,860 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-01 00:39:20,860 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-01 00:39:20,860 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-12-01 00:39:21,745 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-01 00:39:21,745 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-01 00:39:21,838 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-01 00:39:21,838 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-01 00:39:21,839 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-01 00:39:22,039 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-01 00:39:22,039 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-01 00:39:22,141 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'static', 'www', 'api', 'admin', 'assets', 'cdn', 'backend'}
2025-12-01 00:39:37,407 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-01 00:39:37,408 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 1.1ms
2025-12-01 00:39:37,410 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 00:39:37,410 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:37,410 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:37,410 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,410 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,412 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,412 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,412 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,412 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,412 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:37,412 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:37,412 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-12-01 00:39:37,503 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-12-01 00:39:37,507 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-12-01 00:39:37,514 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-12-01 00:39:37,519 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:39:37,520 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14458, Rotación: True
2025-12-01 00:39:37,524 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-12-01 00:39:37,525 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-12-01 00:39:37,525 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-01 00:39:37,525 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14458
2025-12-01 00:39:37,525 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-01 00:39:37,531 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:39:37,532 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-12-01 00:39:37,532 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 122.2ms
2025-12-01 00:39:37,537 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-12-01 00:39:37,537 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.5ms
2025-12-01 00:39:37,539 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-01 00:39:37,540 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:37,540 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:37,540 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,540 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,540 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,540 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,540 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,540 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,540 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:37,541 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:37,541 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-12-01 00:39:37,543 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-01 00:39:37,543 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-01 00:39:37,543 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-12-01 00:39:37,554 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-12-01 00:39:37,556 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-01 00:39:37,556 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 16.7ms
2025-12-01 00:39:37,560 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-12-01 00:39:37,560 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.4ms
2025-12-01 00:39:37,561 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-01 00:39:37,561 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:37,562 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:37,562 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,562 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,562 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,562 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,562 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,562 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,562 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:37,563 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:37,563 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-12-01 00:39:37,564 - app.infrastructure.database.queries - INFO - [SQL_VERSION] Detectada versión: SQL Server 2022 (internal: 16)
2025-12-01 00:39:37,566 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-12-01 00:39:37,566 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-12-01 00:39:37,569 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-12-01 00:39:37,569 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 7.8ms
2025-12-01 00:39:37,579 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-01 00:39:37,581 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.4ms
2025-12-01 00:39:37,582 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-12-01 00:39:37,583 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-12-01 00:39:37,584 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-01 00:39:37,585 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 2.3ms
2025-12-01 00:39:37,585 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 1.9ms
2025-12-01 00:39:37,585 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 00:39:37,586 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-12-01 00:39:37,586 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-12-01 00:39:37,587 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 3.0ms
2025-12-01 00:39:37,587 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:37,588 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:37,588 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,588 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,588 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,588 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,588 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,588 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,588 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:37,588 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:37,588 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 00:39:37,591 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 00:39:37,591 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 00:39:37,632 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 00:39:37,633 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 48.3ms
2025-12-01 00:39:37,634 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 48.3ms
2025-12-01 00:39:37,636 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 00:39:37,636 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 00:39:37,637 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 52.3ms
2025-12-01 00:39:37,637 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:37,637 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:37,639 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,639 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,639 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,639 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,639 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,639 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,639 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:37,640 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:37,640 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 00:39:37,640 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:37,640 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:37,640 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,640 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,640 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,640 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,640 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,641 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,641 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:37,641 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:37,641 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 00:39:37,643 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 00:39:37,647 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 00:39:37,647 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 00:39:37,655 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 00:39:37,657 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 20.5ms
2025-12-01 00:39:37,657 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 20.5ms
2025-12-01 00:39:37,657 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 00:39:37,658 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:37,658 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:37,658 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,659 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:37,659 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:37,661 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 00:39:37,662 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 00:39:37,662 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 00:39:37,663 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 00:39:37,664 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 00:39:37,665 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:37,665 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:37,665 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,665 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,665 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,666 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:37,666 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:37,666 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 00:39:37,668 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 00:39:37,669 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 00:39:37,669 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 12.3ms
2025-12-01 00:39:37,671 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:37,671 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:37,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:37,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:37,672 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:37,672 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:37,672 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:37,672 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 00:39:37,674 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 00:39:37,674 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 00:39:37,677 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 00:39:37,678 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 13.3ms
2025-12-01 00:39:37,679 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 9.4ms
2025-12-01 00:39:41,605 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-12-01 00:39:41,606 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-12-01 00:39:41,606 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.0ms
2025-12-01 00:39:41,607 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.1ms
2025-12-01 00:39:41,608 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:39:41,609 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:41,609 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:41,609 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:41,609 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:41,609 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:41,609 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:41,609 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:41,609 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:41,609 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:41,609 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:41,611 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:39:41,613 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:39:41,613 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:39:41,619 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:39:41,620 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 11.1ms
2025-12-01 00:39:41,621 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:39:41,622 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:41,622 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:41,622 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:41,622 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:41,622 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:41,622 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:41,622 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:41,622 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:41,623 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:41,623 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:41,623 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:39:41,625 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:39:41,626 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:39:41,628 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:39:41,628 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.5ms
2025-12-01 00:39:43,039 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-01 00:39:43,040 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.0ms
2025-12-01 00:39:43,040 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-01 00:39:43,041 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 0.9ms
2025-12-01 00:39:43,042 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 00:39:43,043 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:43,043 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:43,043 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:43,043 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:43,043 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:43,043 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:43,044 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:43,044 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:43,044 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:43,044 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:43,044 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 00:39:43,046 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-12-01 00:39:43,048 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-12-01 00:39:43,052 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 00:39:43,053 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 00:39:43,054 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 11.5ms
2025-12-01 00:39:43,055 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 00:39:43,056 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:43,056 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:43,056 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:43,056 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:43,056 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:43,057 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:43,057 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:43,057 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:43,057 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:43,057 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:43,057 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 00:39:43,059 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-12-01 00:39:43,059 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-12-01 00:39:43,061 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 00:39:43,062 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 00:39:43,063 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 7.1ms
2025-12-01 00:39:45,273 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 00:39:45,274 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:45,274 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:45,274 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:45,274 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:45,274 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:45,275 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:45,275 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:45,275 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:45,275 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:45,275 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:45,275 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 00:39:45,277 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-12-01 00:39:45,277 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-12-01 00:39:45,278 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 00:39:45,278 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 00:39:45,279 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 5.8ms
2025-12-01 00:39:45,280 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 00:39:45,282 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:45,282 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:45,282 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:45,282 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:45,282 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:45,282 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:45,284 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:45,284 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:45,284 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:45,284 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:45,284 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 00:39:45,286 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-12-01 00:39:45,287 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-12-01 00:39:45,288 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 00:39:45,289 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 00:39:45,290 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 8.3ms
2025-12-01 00:39:45,704 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:39:45,704 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:45,704 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:45,704 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:45,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:45,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:45,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:45,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:45,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:45,705 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:45,706 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:45,706 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:39:45,708 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:39:45,708 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:39:45,710 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:39:45,711 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.6ms
2025-12-01 00:39:45,714 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:39:45,714 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:45,714 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:45,714 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:45,715 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:45,715 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:45,715 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:45,715 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:45,715 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:45,715 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:45,715 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:45,717 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:39:45,719 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:39:45,719 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:39:45,720 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:39:45,721 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.4ms
2025-12-01 00:39:55,584 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 00:39:55,586 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:55,586 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:55,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,587 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:55,588 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:55,588 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-12-01 00:39:55,592 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente 1, Usuario 1, Tipo: web
2025-12-01 00:39:55,593 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 5, Type: super_admin)
2025-12-01 00:39:55,594 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-12-01 00:39:55,603 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:39:55,603 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14459, Rotación: True
2025-12-01 00:39:55,607 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-12-01 00:39:55,609 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-12-01 00:39:55,610 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-01 00:39:55,610 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 14459
2025-12-01 00:39:55,611 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-01 00:39:55,613 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:39:55,614 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=1, usuario_id=1, exito=True
2025-12-01 00:39:55,615 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 30.7ms
2025-12-01 00:39:55,626 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-01 00:39:55,627 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:55,627 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:55,627 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,628 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:55,629 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:55,629 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-12-01 00:39:55,631 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-01 00:39:55,632 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-01 00:39:55,632 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-12-01 00:39:55,634 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-12-01 00:39:55,635 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-01 00:39:55,635 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 8.5ms
2025-12-01 00:39:55,646 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-01 00:39:55,647 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:55,647 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:55,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,648 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:55,648 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:55,648 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-12-01 00:39:55,651 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-12-01 00:39:55,652 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-12-01 00:39:55,652 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-12-01 00:39:55,654 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 7.4ms
2025-12-01 00:39:55,662 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 00:39:55,663 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:55,663 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:55,663 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,664 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,664 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,664 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,664 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,664 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,664 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:55,664 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:55,665 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 00:39:55,666 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 00:39:55,666 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 00:39:55,667 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 00:39:55,668 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:39:55,669 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 6.9ms
2025-12-01 00:39:55,669 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:55,669 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:55,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,671 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,672 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:55,672 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:55,672 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:39:55,676 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:39:55,676 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:39:55,677 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:39:55,680 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.9ms
2025-12-01 00:39:55,680 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 00:39:55,681 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:55,682 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:55,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,684 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,684 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,684 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,684 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,684 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:55,684 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:55,684 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 00:39:55,686 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 00:39:55,686 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 00:39:55,687 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 00:39:55,688 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:39:55,690 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:55,690 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:39:55,690 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,690 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,690 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,691 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:39:55,691 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,691 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:39:55,691 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:39:55,692 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:39:55,692 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:39:55,693 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 12.9ms
2025-12-01 00:39:55,696 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:39:55,696 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:39:55,698 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:39:55,699 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 11.2ms
2025-12-01 00:39:55,854 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-01 00:39:55,854 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.5ms
2025-12-01 00:39:55,856 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 00:39:55,857 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:39:55,857 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 00:39:55,857 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 00:39:55,857 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,857 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 00:39:55,902 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 00:39:55,902 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:39:55,902 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 00:39:55,903 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 00:40:00,489 - app.infrastructure.cache.redis_cache - WARNING - [REDIS_CACHE] Error conectando a Redis: Error 10061 connecting to localhost:6379. No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión.. Cache desactivado automáticamente (usando fallback en memoria).
2025-12-01 00:40:00,489 - app.infrastructure.cache.redis_cache - INFO - ℹ️ Módulo de Redis cache cargado pero desactivado (usando fallback en memoria)
2025-12-01 00:40:00,507 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 2: multi - bd_cliente_acme
2025-12-01 00:40:00,507 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 00:40:00,507 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/refresh/
2025-12-01 00:40:00,508 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-01 00:40:00,509 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 1.3ms
2025-12-01 00:40:00,510 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-12-01 00:40:00,510 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-01 00:40:00,512 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 2.1ms
2025-12-01 00:40:00,512 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 2.0ms
2025-12-01 00:40:00,513 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:00,569 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 2
2025-12-01 00:40:00,569 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-01 00:40:00,571 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:00,576 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:40:00,576 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-12-01 00:40:00,578 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 00:40:00,579 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:00,579 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': global.app.local:5173
2025-12-01 00:40:00,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'global.app.local'
2025-12-01 00:40:00,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:00,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-12-01 00:40:00,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'global.app.local'
2025-12-01 00:40:00,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:00,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-12-01 00:40:00,582 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='global', Código='GLOBAL004', ID=5
2025-12-01 00:40:00,583 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 5: single - bd_sistema
2025-12-01 00:40:00,583 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_sistema, servidor=localhost
2025-12-01 00:40:00,583 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=5, db_type=single, bd=bd_sistema, path=/api/v1/auth/refresh/
2025-12-01 00:40:00,583 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-12-01 00:40:00,584 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 4727.4ms
2025-12-01 00:40:00,585 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:00,585 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:00,585 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:00,585 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:00,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:00,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:00,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:00,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:00,586 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:00,586 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:00,586 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-12-01 00:40:00,591 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-12-01 00:40:00,592 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-12-01 00:40:00,592 - app.modules.auth.presentation.endpoints - INFO - [LOGOUT-WEB] Token no encontrado en BD (ya expirado/revocado) - Cliente: 1, Usuario: 1 (superadmin)
2025-12-01 00:40:00,599 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:40:00,600 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=logout, cliente_id=1, usuario_id=1, exito=True
2025-12-01 00:40:00,601 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 00:40:00,601 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:00,602 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': techcorp.app.local:5173
2025-12-01 00:40:00,602 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.app.local'
2025-12-01 00:40:00,602 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:00,602 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-12-01 00:40:00,604 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.app.local'
2025-12-01 00:40:00,605 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:00,605 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-12-01 00:40:00,605 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-12-01 00:40:00,606 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 4: single - bd_sistema
2025-12-01 00:40:00,606 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_sistema, servidor=localhost
2025-12-01 00:40:00,607 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_sistema, path=/api/v1/auth/refresh/
2025-12-01 00:40:00,607 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 23.8ms
2025-12-01 00:40:00,612 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 5
2025-12-01 00:40:00,613 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-01 00:40:00,616 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:40:00,616 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-12-01 00:40:00,618 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 39.4ms
2025-12-01 00:40:00,622 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente 4
2025-12-01 00:40:00,622 - app.core.auth - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-01 00:40:00,623 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:40:00,623 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=1, usuario_id=None, exito=False
2025-12-01 00:40:00,625 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 23.9ms
2025-12-01 00:40:19,201 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-12-01 00:40:19,202 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.5ms
2025-12-01 00:40:19,203 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-12-01 00:40:19,203 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:19,203 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:19,203 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:19,204 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:19,204 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:19,204 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:19,204 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:19,204 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:19,204 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:19,204 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:19,204 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-12-01 00:40:19,209 - app.modules.auth.presentation.endpoints - INFO - Cliente 1 resuelto y validado para login.
2025-12-01 00:40:19,209 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-12-01 00:40:19,209 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-12-01 00:40:19,432 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-12-01 00:40:19,432 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-12-01 00:40:19,432 - app.modules.auth.presentation.endpoints - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-12-01 00:40:19,432 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-12-01 00:40:19,433 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:40:19,433 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14460, Rotación: False
2025-12-01 00:40:19,433 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: 14460
2025-12-01 00:40:19,434 - app.modules.auth.presentation.endpoints - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-12-01 00:40:19,437 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:40:19,437 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=1, usuario_id=1, exito=True
2025-12-01 00:40:19,438 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 235.5ms
2025-12-01 00:40:19,447 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-01 00:40:19,447 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:19,447 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:19,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:19,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:19,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:19,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:19,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:19,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:19,448 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:19,449 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:19,449 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-12-01 00:40:19,450 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-12-01 00:40:19,451 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-12-01 00:40:19,451 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-12-01 00:40:19,453 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 5.9ms
2025-12-01 00:40:19,461 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 00:40:19,462 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:19,462 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:19,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:19,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:19,463 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:19,463 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:19,463 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:19,463 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:19,463 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:19,463 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:19,463 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 00:40:19,467 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 00:40:19,467 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 00:40:19,468 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 00:40:19,469 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.2ms
2025-12-01 00:40:19,471 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 00:40:19,471 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:19,471 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:19,471 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:19,471 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:19,471 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:19,471 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:19,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:19,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:19,473 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:19,473 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:19,473 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 00:40:19,475 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 00:40:19,475 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 00:40:19,476 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 00:40:19,477 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 5.8ms
2025-12-01 00:40:22,025 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:40:22,025 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:22,026 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:22,026 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:22,026 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:22,026 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:22,026 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:22,026 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:22,026 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:22,027 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:22,027 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:22,027 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:40:22,029 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:40:22,029 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:40:22,031 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:40:22,031 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.0ms
2025-12-01 00:40:22,034 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:40:22,035 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:22,035 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:22,035 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:22,035 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:22,036 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:22,036 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:22,036 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:22,036 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:22,036 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:22,036 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:22,036 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:40:22,038 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:40:22,038 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:40:22,040 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:40:22,040 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 6.8ms
2025-12-01 00:40:23,082 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 00:40:23,083 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:23,083 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:23,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:23,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:23,084 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:23,084 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:23,084 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:23,084 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:23,084 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:23,084 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:23,085 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 00:40:23,087 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-12-01 00:40:23,087 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-12-01 00:40:23,089 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 00:40:23,090 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 00:40:23,090 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 7.9ms
2025-12-01 00:40:23,093 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 00:40:23,093 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:23,093 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:23,093 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:23,093 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:23,093 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:23,094 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:23,094 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:23,094 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:23,094 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:23,094 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:23,094 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 00:40:23,096 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-12-01 00:40:23,097 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-12-01 00:40:23,098 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 00:40:23,098 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 00:40:23,099 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 7.2ms
2025-12-01 00:40:26,922 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:40:26,922 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:26,923 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:26,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:26,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:26,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:26,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:26,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:26,923 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:26,923 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:26,923 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:26,924 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:40:26,925 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:40:26,925 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:40:26,927 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:40:26,928 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 6.9ms
2025-12-01 00:40:26,929 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 00:40:26,931 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:26,931 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:26,931 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:26,931 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:26,931 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:26,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:26,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:26,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:26,932 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:26,932 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:26,932 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 00:40:26,935 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 00:40:26,935 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 00:40:26,938 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 00:40:26,938 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.2ms
2025-12-01 00:40:27,953 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 00:40:27,953 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:27,953 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:27,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:27,954 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:27,954 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:27,954 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:27,954 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:27,954 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:27,954 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:27,954 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:27,955 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 00:40:27,957 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 00:40:27,960 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 00:40:27,960 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 6.9ms
2025-12-01 00:40:27,961 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:27,961 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:27,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:27,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:27,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:27,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:27,962 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:27,962 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:27,962 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:27,962 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:27,962 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 00:40:27,964 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 00:40:27,964 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 00:40:27,967 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 00:40:27,968 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 9.0ms
2025-12-01 00:40:27,968 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 00:40:27,969 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:27,969 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:27,969 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:27,969 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:27,970 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:27,970 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:27,970 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:27,970 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:27,970 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:27,970 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:27,970 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 00:40:27,973 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 00:40:27,975 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 00:40:27,975 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:27,976 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:27,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:27,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:27,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:27,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:27,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:27,977 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:27,977 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:27,977 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:27,977 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 00:40:27,979 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 00:40:27,979 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 00:40:27,981 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 00:40:27,981 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 12.9ms
2025-12-01 00:40:27,983 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 7.7ms
2025-12-01 00:40:29,273 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:40:29,273 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.8ms
2025-12-01 00:40:29,274 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:40:29,275 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 1.0ms
2025-12-01 00:40:29,276 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:40:29,276 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:29,276 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:29,276 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:29,276 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:29,276 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:29,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:29,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:29,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:29,277 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:29,277 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:29,277 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:40:29,279 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:40:29,279 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:40:29,285 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:40:29,286 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 10.6ms
2025-12-01 00:40:29,288 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:40:29,288 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:29,288 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:29,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:29,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:29,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:29,289 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:29,289 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:29,289 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:29,289 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:29,289 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:29,289 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:40:29,291 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:40:29,291 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:40:29,293 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:40:29,294 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.8ms
2025-12-01 00:40:30,175 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2/
2025-12-01 00:40:30,176 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2/ 200 1.0ms
2025-12-01 00:40:30,177 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-01 00:40:30,178 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2/
2025-12-01 00:40:30,178 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-01 00:40:30,178 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.6ms
2025-12-01 00:40:30,179 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2/ 200 1.4ms
2025-12-01 00:40:30,179 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.4ms
2025-12-01 00:40:30,179 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2/
2025-12-01 00:40:30,181 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:30,182 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:30,182 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:30,182 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:30,182 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:30,182 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:30,182 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:30,182 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:30,182 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:30,183 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:30,183 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2/
2025-12-01 00:40:30,183 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 00:40:30,184 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-12-01 00:40:30,185 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-12-01 00:40:30,187 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-12-01 00:40:30,188 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:30,188 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:30,188 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:30,188 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:30,188 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:30,188 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:30,189 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:30,189 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:30,189 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:30,189 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:30,189 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 00:40:30,191 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-01 00:40:30,191 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-01 00:40:30,193 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 00:40:30,194 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 00:40:30,195 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2/ 200 14.4ms
2025-12-01 00:40:30,195 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 12.4ms
2025-12-01 00:40:30,196 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2/
2025-12-01 00:40:30,197 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:30,198 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:30,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:30,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:30,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:30,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:30,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:30,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:30,198 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:30,199 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:30,199 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2/
2025-12-01 00:40:30,199 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 00:40:30,200 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-12-01 00:40:30,201 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-12-01 00:40:30,201 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-12-01 00:40:30,203 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:30,203 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:30,203 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:30,203 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:30,203 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:30,203 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:30,204 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:30,204 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:30,204 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:30,204 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:30,204 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 00:40:30,206 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-01 00:40:30,206 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-01 00:40:30,207 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 00:40:30,208 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 00:40:30,208 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2/ 200 11.9ms
2025-12-01 00:40:30,209 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 10.0ms
2025-12-01 00:40:31,616 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 00:40:31,616 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 00:40:31,617 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 0.9ms
2025-12-01 00:40:31,617 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 0.6ms
2025-12-01 00:40:31,618 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 00:40:31,619 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:31,619 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:31,619 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:31,619 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:31,619 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:31,619 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:31,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:31,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:31,620 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:31,620 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:31,620 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 00:40:31,621 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-12-01 00:40:31,623 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-12-01 00:40:31,623 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:31,627 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:31,633 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:31,641 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:31,643 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:31,645 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-12-01 00:40:31,647 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 28.0ms
2025-12-01 00:40:31,648 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 00:40:31,649 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:31,649 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:31,649 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:31,649 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:31,649 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:31,649 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:31,650 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:31,650 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:31,650 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:31,650 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:31,650 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 00:40:31,651 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-12-01 00:40:31,651 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-12-01 00:40:31,652 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:31,654 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:31,655 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:31,656 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:31,658 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:31,663 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-12-01 00:40:31,664 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 15.4ms
2025-12-01 00:40:33,745 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/1/actividad/
2025-12-01 00:40:33,745 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/1/sesiones/
2025-12-01 00:40:33,746 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/1/actividad/ 200 1.0ms
2025-12-01 00:40:33,747 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/1/sesiones/ 200 1.1ms
2025-12-01 00:40:33,748 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/1/actividad/
2025-12-01 00:40:33,749 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:33,749 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:33,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:33,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:33,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:33,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:33,749 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:33,750 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:33,750 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:33,750 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:33,750 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/1/actividad/
2025-12-01 00:40:33,752 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo actividad para usuario 1, cliente_id: 2
2025-12-01 00:40:33,754 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [ACTIVIDAD] Usando cliente_id proporcionado: 2
2025-12-01 00:40:33,754 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:33,756 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:33,758 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:33,759 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/1/sesiones/
2025-12-01 00:40:33,761 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:33,761 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:33,761 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:33,761 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:33,761 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:33,761 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:33,761 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:33,762 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:33,762 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:33,762 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:33,763 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/1/sesiones/
2025-12-01 00:40:33,765 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo sesiones para usuario 1, cliente_id: 2
2025-12-01 00:40:33,765 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [SESIONES] Usando cliente_id proporcionado: 2
2025-12-01 00:40:33,765 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:33,766 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:33,769 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/1/actividad/ 200 21.7ms
2025-12-01 00:40:33,770 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/1/sesiones/ 200 10.1ms
2025-12-01 00:40:37,754 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/
2025-12-01 00:40:37,754 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/
2025-12-01 00:40:37,755 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/ 200 0.9ms
2025-12-01 00:40:37,755 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/ 200 0.6ms
2025-12-01 00:40:37,757 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-01 00:40:37,757 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:37,757 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:37,757 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:37,757 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:37,758 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:37,758 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:37,758 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:37,758 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:37,758 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:37,758 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:37,758 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-01 00:40:37,760 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-12-01 00:40:37,761 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-12-01 00:40:37,761 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:37,763 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:37,764 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 20, Página: 1
2025-12-01 00:40:37,766 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 9.6ms
2025-12-01 00:40:37,767 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-01 00:40:37,768 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:37,768 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:37,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:37,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:37,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:37,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:37,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:37,768 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:37,769 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:37,769 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:37,769 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-01 00:40:37,772 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-12-01 00:40:37,772 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-12-01 00:40:37,773 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:37,773 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:37,774 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 20, Página: 1
2025-12-01 00:40:37,775 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 7.8ms
2025-12-01 00:40:39,428 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/1025/
2025-12-01 00:40:39,429 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/1025/ 200 0.4ms
2025-12-01 00:40:39,430 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/1025/
2025-12-01 00:40:39,430 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:39,430 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:39,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:39,431 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:39,431 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:39,431 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:39,431 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:39,431 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:39,431 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:39,431 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:39,431 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/1025/
2025-12-01 00:40:39,436 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo log de autenticación ID 1025, cliente_id: 2
2025-12-01 00:40:39,436 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Cliente_id proporcionado (2), consultando log 1025 directamente en BD del tenant
2025-12-01 00:40:39,436 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:39,440 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 1025 encontrado en BD del cliente 2
2025-12-01 00:40:39,449 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/1025/ 200 19.1ms
2025-12-01 00:40:45,307 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 00:40:45,309 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:45,309 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:45,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:45,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:45,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:45,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:45,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:45,310 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:45,310 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:45,310 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:45,310 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 00:40:45,312 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-12-01 00:40:45,312 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-12-01 00:40:45,315 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:45,316 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:45,317 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:45,329 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:45,331 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:45,333 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-12-01 00:40:45,333 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 25.2ms
2025-12-01 00:40:45,335 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 00:40:45,335 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:45,335 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:45,335 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:45,336 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:45,336 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:45,336 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:45,336 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:45,336 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:45,336 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:45,336 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:45,337 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 00:40:45,338 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-12-01 00:40:45,338 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-12-01 00:40:45,340 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:45,340 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:45,341 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:45,343 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:45,345 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:45,346 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-12-01 00:40:45,347 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 12.3ms
2025-12-01 00:40:46,446 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/2/actividad/
2025-12-01 00:40:46,447 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/2/actividad/ 200 0.8ms
2025-12-01 00:40:46,447 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/2/sesiones/
2025-12-01 00:40:46,448 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/2/sesiones/ 200 0.8ms
2025-12-01 00:40:46,449 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/2/actividad/
2025-12-01 00:40:46,449 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:46,449 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:46,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:46,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:46,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:46,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:46,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:46,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:46,451 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:46,451 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:46,451 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/2/actividad/
2025-12-01 00:40:46,454 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo actividad para usuario 2, cliente_id: 2
2025-12-01 00:40:46,454 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [ACTIVIDAD] Usando cliente_id proporcionado: 2
2025-12-01 00:40:46,454 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:46,456 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:46,459 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:46,461 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/2/sesiones/
2025-12-01 00:40:46,461 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:46,461 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:46,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:46,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:46,461 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:46,463 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:46,463 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:46,463 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:46,463 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:46,463 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:46,463 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/2/sesiones/
2025-12-01 00:40:46,463 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/2/actividad/ 200 14.2ms
2025-12-01 00:40:46,465 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo sesiones para usuario 2, cliente_id: 2
2025-12-01 00:40:46,465 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [SESIONES] Usando cliente_id proporcionado: 2
2025-12-01 00:40:46,465 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:46,467 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 00:40:46,470 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/2/sesiones/ 200 8.3ms
2025-12-01 00:40:49,902 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:40:49,903 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:49,903 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:49,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:49,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:49,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:49,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:49,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:49,903 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:49,903 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:49,903 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:49,904 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:40:49,905 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:40:49,905 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:40:49,911 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:40:49,913 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 10.8ms
2025-12-01 00:40:49,914 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 00:40:49,915 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:49,915 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:49,915 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:49,915 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:49,915 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:49,915 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:49,915 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:49,916 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:49,916 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:49,916 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:49,916 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 00:40:49,918 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 00:40:49,918 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 00:40:49,919 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 00:40:49,920 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.5ms
2025-12-01 00:40:54,756 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-12-01 00:40:54,756 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 00:40:54,756 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 00:40:54,757 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:54,757 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:54,757 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:54,757 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 00:40:54,757 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 00:40:54,757 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 00:40:54,757 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 00:40:54,758 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 00:40:54,758 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-12-01 00:40:54,767 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-12-01 00:40:54,767 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-12-01 00:40:54,767 - app.modules.auth.presentation.endpoints - INFO - [LOGOUT-WEB] Token no encontrado en BD (ya expirado/revocado) - Cliente: 1, Usuario: 1 (superadmin)
2025-12-01 00:40:54,782 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 00:40:54,783 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=logout, cliente_id=1, usuario_id=1, exito=True
2025-12-01 00:40:54,783 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 27.4ms
2025-12-01 00:55:20,679 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-01 00:55:20,679 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-01 00:55:20,679 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-01 00:55:20,679 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-01 00:55:20,679 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-01 00:55:20,679 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-01 00:55:21,539 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-01 00:55:21,541 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-01 00:55:21,541 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-01 00:55:21,541 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-01 00:55:21,542 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-01 00:55:21,542 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-12-01 00:55:21,847 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-01 00:55:21,848 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-01 00:55:21,915 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-01 00:55:21,915 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-01 00:55:21,916 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-01 00:55:22,118 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-01 00:55:22,118 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-01 00:55:22,217 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'api', 'assets', 'admin', 'backend', 'cdn', 'static', 'www'}
2025-12-01 01:25:21,235 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-01 01:25:21,235 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-01 01:25:21,236 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-01 01:25:21,236 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-01 01:25:21,236 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-01 01:25:21,236 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-01 01:25:22,044 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-01 01:25:22,046 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-01 01:25:22,046 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-01 01:25:22,047 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-01 01:25:22,047 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-01 01:25:22,047 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-12-01 01:25:22,385 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-01 01:25:22,385 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-01 01:25:22,457 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-01 01:25:22,457 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-01 01:25:22,457 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-01 01:25:22,654 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-01 01:25:22,654 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-01 01:25:22,757 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'www', 'assets', 'admin', 'cdn', 'backend', 'static', 'api'}
2025-12-01 01:25:43,387 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-01 01:25:43,388 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-01 01:25:43,388 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-01 01:25:43,388 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-01 01:25:43,388 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-01 01:25:43,388 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-01 01:25:45,688 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-01 01:25:45,689 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-01 01:25:45,689 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-01 01:25:45,691 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-01 01:25:45,691 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-01 01:25:45,691 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-12-01 01:25:45,989 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-01 01:25:45,989 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-01 01:25:46,061 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-01 01:25:46,061 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-01 01:25:46,061 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-01 01:25:46,254 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-01 01:25:46,254 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-01 01:25:46,377 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'cdn', 'assets', 'backend', 'api', 'static', 'www', 'admin'}
2025-12-01 01:25:53,729 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-01 01:25:53,730 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.9ms
2025-12-01 01:25:53,732 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 01:25:53,732 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:25:53,732 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:25:53,732 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:25:53,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:25:53,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:25:53,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:25:53,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:25:53,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:25:53,733 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:25:53,733 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:25:53,734 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-12-01 01:25:53,736 - app.core.auth - WARNING - [REFRESH] No se proporcionó refresh token. Cliente: web
2025-12-01 01:25:53,736 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 5.2ms
2025-12-01 01:26:05,922 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-12-01 01:26:05,922 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.5ms
2025-12-01 01:26:05,924 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-12-01 01:26:05,924 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:26:05,924 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:26:05,924 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:05,925 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:05,925 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:05,925 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:05,925 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:05,925 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:05,925 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:26:05,925 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:26:05,926 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-12-01 01:26:05,994 - app.modules.auth.presentation.endpoints - INFO - Cliente 1 resuelto y validado para login.
2025-12-01 01:26:05,996 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-12-01 01:26:05,996 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-12-01 01:26:06,225 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-12-01 01:26:06,226 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-12-01 01:26:06,226 - app.modules.auth.presentation.endpoints - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-12-01 01:26:06,226 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-12-01 01:26:06,235 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 01:26:06,235 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14461, Rotación: False
2025-12-01 01:26:06,235 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: 14461
2025-12-01 01:26:06,235 - app.modules.auth.presentation.endpoints - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-12-01 01:26:06,242 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 01:26:06,242 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=1, usuario_id=1, exito=True
2025-12-01 01:26:06,244 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 320.2ms
2025-12-01 01:26:06,253 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-12-01 01:26:06,253 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.5ms
2025-12-01 01:26:06,255 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-01 01:26:06,255 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:26:06,255 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:26:06,255 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:06,255 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:06,256 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:06,256 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:06,256 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:06,256 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:06,256 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:26:06,256 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:26:06,256 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-12-01 01:26:06,258 - app.infrastructure.database.queries - INFO - [SQL_VERSION] Detectada versión: SQL Server 2022 (internal: 16)
2025-12-01 01:26:06,262 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-12-01 01:26:06,262 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-12-01 01:26:06,264 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-12-01 01:26:06,265 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 10.3ms
2025-12-01 01:26:06,273 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-01 01:26:06,274 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.8ms
2025-12-01 01:26:06,275 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-01 01:26:06,276 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.8ms
2025-12-01 01:26:06,277 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 01:26:06,278 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:26:06,278 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:26:06,278 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:06,278 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:06,278 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:06,278 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:06,278 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:06,279 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:06,279 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:26:06,279 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:26:06,279 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 01:26:06,281 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 01:26:06,282 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 01:26:06,321 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 01:26:06,322 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 44.6ms
2025-12-01 01:26:06,323 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 01:26:06,323 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:26:06,323 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:26:06,324 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:06,324 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:06,324 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:06,324 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:06,324 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:06,324 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:06,325 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:26:06,325 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:26:06,325 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 01:26:06,327 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 01:26:06,327 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 01:26:06,329 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 01:26:06,329 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 6.4ms
2025-12-01 01:26:08,409 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-12-01 01:26:08,411 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.8ms
2025-12-01 01:26:08,411 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-12-01 01:26:08,411 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.8ms
2025-12-01 01:26:08,413 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 01:26:08,413 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:26:08,413 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:26:08,413 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:08,413 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:08,414 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:08,414 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:08,414 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:08,414 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:08,414 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:26:08,414 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:26:08,415 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 01:26:08,417 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 01:26:08,417 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 01:26:08,422 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 01:26:08,423 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 11.2ms
2025-12-01 01:26:08,425 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 01:26:08,425 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:26:08,425 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:26:08,425 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:08,426 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:08,426 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:08,426 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:26:08,426 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:26:08,426 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:26:08,426 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:26:08,428 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:26:08,428 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 01:26:08,430 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 01:26:08,430 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 01:26:08,432 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 01:26:08,433 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.4ms
2025-12-01 01:27:40,344 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-12-01 01:27:40,344 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 0.6ms
2025-12-01 01:27:40,346 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-12-01 01:27:40,347 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 1.4ms
2025-12-01 01:27:40,347 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-12-01 01:27:40,347 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-12-01 01:27:40,350 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 01:27:40,350 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 2.3ms
2025-12-01 01:27:40,351 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 2.3ms
2025-12-01 01:27:40,351 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:40,351 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:40,351 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:40,351 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:40,351 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:40,351 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:40,351 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:40,352 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:40,352 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:40,352 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:40,352 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 01:27:40,382 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 01:27:40,388 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 01:27:40,389 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 39.3ms
2025-12-01 01:27:40,390 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:40,390 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:40,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:40,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:40,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:40,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:40,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:40,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:40,390 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:40,391 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:40,391 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 01:27:40,393 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 01:27:40,393 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 01:27:40,401 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 01:27:40,402 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 13.9ms
2025-12-01 01:27:40,403 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 01:27:40,404 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:40,404 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:40,404 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:40,404 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:40,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:40,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:40,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:40,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:40,405 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:40,405 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:40,405 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 01:27:40,408 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 01:27:40,410 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 01:27:40,410 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 7.5ms
2025-12-01 01:27:40,410 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:40,410 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:40,410 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:40,410 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:40,412 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:40,412 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:40,412 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:40,412 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:40,412 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:40,412 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:40,412 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 01:27:40,414 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 01:27:40,414 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 01:27:40,416 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 01:27:40,417 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 7.2ms
2025-12-01 01:27:41,292 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-12-01 01:27:41,292 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-12-01 01:27:41,293 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 1.0ms
2025-12-01 01:27:41,293 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.7ms
2025-12-01 01:27:41,295 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 01:27:41,295 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:41,295 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:41,295 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:41,296 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:41,296 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:41,296 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:41,296 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:41,296 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:41,296 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:41,296 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:41,296 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 01:27:41,298 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 01:27:41,298 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 01:27:41,304 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 01:27:41,305 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 9.8ms
2025-12-01 01:27:41,307 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
2025-12-01 01:27:41,307 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:41,307 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:41,308 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:41,308 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:41,308 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:41,308 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:41,308 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:41,308 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:41,308 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:41,308 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:41,308 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/clientes/2/modulos/
2025-12-01 01:27:41,310 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/2/modulos/ recibida
2025-12-01 01:27:41,310 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: 2
2025-12-01 01:27:41,311 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente 2 recuperados: 5 módulos
2025-12-01 01:27:41,312 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/2/modulos/ 200 5.7ms
2025-12-01 01:27:42,440 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2/
2025-12-01 01:27:42,442 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-01 01:27:42,442 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2/ 200 1.4ms
2025-12-01 01:27:42,442 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-01 01:27:42,442 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2/
2025-12-01 01:27:42,443 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.7ms
2025-12-01 01:27:42,443 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.2ms
2025-12-01 01:27:42,444 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2/ 200 1.1ms
2025-12-01 01:27:42,445 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2/
2025-12-01 01:27:42,446 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:42,446 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:42,446 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:42,446 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:42,446 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:42,447 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:42,447 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:42,447 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:42,447 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:42,447 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:42,447 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2/
2025-12-01 01:27:42,448 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 01:27:42,449 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-12-01 01:27:42,449 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-12-01 01:27:42,453 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-12-01 01:27:42,453 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:42,453 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:42,454 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:42,454 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:42,454 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:42,454 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:42,454 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:42,454 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:42,454 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:42,454 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:42,455 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 01:27:42,455 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-01 01:27:42,456 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-01 01:27:42,459 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 01:27:42,461 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 01:27:42,461 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2/ 200 15.8ms
2025-12-01 01:27:42,461 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 13.8ms
2025-12-01 01:27:42,463 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2/
2025-12-01 01:27:42,464 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:42,464 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:42,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:42,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:42,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:42,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:42,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:42,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:42,465 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:42,465 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:42,465 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2/
2025-12-01 01:27:42,465 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 01:27:42,468 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-12-01 01:27:42,468 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-12-01 01:27:42,469 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-12-01 01:27:42,469 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:42,469 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:42,469 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:42,470 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:42,470 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:42,470 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:42,470 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:42,470 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:42,470 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:42,470 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:42,470 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 01:27:42,472 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-01 01:27:42,472 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-01 01:27:42,473 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 01:27:42,473 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 01:27:42,474 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2/ 200 11.5ms
2025-12-01 01:27:42,476 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 9.9ms
2025-12-01 01:27:43,825 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 01:27:43,826 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 01:27:43,826 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 1.4ms
2025-12-01 01:27:43,827 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 0.9ms
2025-12-01 01:27:43,828 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 01:27:43,829 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:43,829 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:43,829 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:43,829 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:43,829 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:43,830 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:43,830 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:43,830 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:43,830 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:43,830 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:43,830 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 01:27:43,832 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-12-01 01:27:43,832 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-12-01 01:27:47,979 - app.infrastructure.cache.redis_cache - WARNING - [REDIS_CACHE] Error conectando a Redis: Error 10061 connecting to localhost:6379. No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión.. Cache desactivado automáticamente (usando fallback en memoria).
2025-12-01 01:27:47,979 - app.infrastructure.cache.redis_cache - INFO - ℹ️ Módulo de Redis cache cargado pero desactivado (usando fallback en memoria)
2025-12-01 01:27:47,983 - app.core.tenant.routing - INFO - [METADATA] Metadata cargada para cliente 2: multi - bd_cliente_acme
2025-12-01 01:27:47,983 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:48,029 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:48,031 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:48,040 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:48,043 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:48,044 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-12-01 01:27:48,045 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 4216.6ms
2025-12-01 01:27:48,048 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 01:27:48,048 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:48,048 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:48,049 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:48,049 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:48,049 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:48,049 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:48,049 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:48,049 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:48,049 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:48,050 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:48,050 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 01:27:48,052 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-12-01 01:27:48,052 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-12-01 01:27:48,053 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:48,054 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:48,055 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:48,057 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:48,058 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:48,060 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-12-01 01:27:48,060 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 12.9ms
2025-12-01 01:27:50,712 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/
2025-12-01 01:27:50,712 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/ 200 0.7ms
2025-12-01 01:27:50,713 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/
2025-12-01 01:27:50,714 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/ 200 1.2ms
2025-12-01 01:27:50,715 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-01 01:27:50,715 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:50,715 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:50,715 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:50,715 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:50,716 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:50,716 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:50,716 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:50,716 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:50,716 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:50,716 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:50,716 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-01 01:27:50,718 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-12-01 01:27:50,718 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-12-01 01:27:50,720 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:50,722 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:50,724 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 20, Página: 1
2025-12-01 01:27:50,725 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 10.3ms
2025-12-01 01:27:50,726 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-01 01:27:50,726 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:50,726 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:50,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:50,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:50,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:50,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:50,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:50,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:50,728 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:50,728 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:50,729 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-01 01:27:50,730 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 1 solicitando logs de autenticación - cliente_id: 2, page: 1
2025-12-01 01:27:50,730 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: 2, page: 1
2025-12-01 01:27:50,730 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:50,732 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:50,733 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 20, Página: 1
2025-12-01 01:27:50,736 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 8.6ms
2025-12-01 01:27:54,403 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 01:27:54,404 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:54,404 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:54,404 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:54,404 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:54,404 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:54,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:54,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:54,405 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:54,405 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:54,405 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:54,405 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 01:27:54,413 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-12-01 01:27:54,413 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-12-01 01:27:54,423 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:54,427 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:54,428 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:54,444 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:54,451 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:54,452 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-12-01 01:27:54,453 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 49.9ms
2025-12-01 01:27:54,456 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 01:27:54,456 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:54,456 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:54,456 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:54,457 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:54,457 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:54,457 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:54,457 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:54,457 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:54,457 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:54,457 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:54,458 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/clientes/2/usuarios/
2025-12-01 01:27:54,464 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 1 solicitando usuarios del cliente 2 - page: 1, limit: 10
2025-12-01 01:27:54,464 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: 2, page: 1, limit: 10
2025-12-01 01:27:54,471 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:54,476 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:54,477 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:54,482 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:54,483 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:54,485 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente 2 recuperados - Total: 3, Página: 1
2025-12-01 01:27:54,487 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/2/usuarios/ 200 31.0ms
2025-12-01 01:27:57,787 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/1/actividad/
2025-12-01 01:27:57,788 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/1/actividad/ 200 0.7ms
2025-12-01 01:27:57,788 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/1/sesiones/
2025-12-01 01:27:57,789 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/1/sesiones/ 200 0.9ms
2025-12-01 01:27:57,790 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/1/actividad/
2025-12-01 01:27:57,790 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:57,790 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:57,790 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:57,790 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:57,790 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:57,790 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:57,791 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:57,791 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:57,791 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:57,791 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:57,791 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/1/actividad/
2025-12-01 01:27:57,809 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo actividad para usuario 1, cliente_id: 2
2025-12-01 01:27:57,809 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [ACTIVIDAD] Usando cliente_id proporcionado: 2
2025-12-01 01:27:57,809 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:57,828 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:57,830 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:57,832 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/1/sesiones/
2025-12-01 01:27:57,832 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/1/actividad/ 200 42.7ms
2025-12-01 01:27:57,832 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:27:57,832 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:27:57,832 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:57,833 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:57,833 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:57,833 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:27:57,833 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:27:57,833 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:27:57,833 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:27:57,833 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:27:57,834 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/1/sesiones/
2025-12-01 01:27:57,835 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo sesiones para usuario 1, cliente_id: 2
2025-12-01 01:27:57,835 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [SESIONES] Usando cliente_id proporcionado: 2
2025-12-01 01:27:57,836 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:57,837 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:27:57,841 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/1/sesiones/ 200 9.6ms
2025-12-01 01:28:02,032 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/2/actividad/
2025-12-01 01:28:02,033 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/2/sesiones/
2025-12-01 01:28:02,033 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/2/actividad/ 200 0.9ms
2025-12-01 01:28:02,033 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/2/sesiones/ 200 0.6ms
2025-12-01 01:28:02,036 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/2/actividad/
2025-12-01 01:28:02,036 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/2/sesiones/
2025-12-01 01:28:02,036 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:02,036 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:28:02,038 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:02,038 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:02,038 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:02,038 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:02,038 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:02,038 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:02,038 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:28:02,039 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:28:02,039 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/2/actividad/
2025-12-01 01:28:02,041 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo actividad para usuario 2, cliente_id: 2
2025-12-01 01:28:02,041 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [ACTIVIDAD] Usando cliente_id proporcionado: 2
2025-12-01 01:28:02,041 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:02,042 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:02,042 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:02,043 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:02,044 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:28:02,044 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:02,044 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:02,044 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:02,044 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:02,044 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:02,044 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:02,046 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:28:02,046 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:28:02,046 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/2/sesiones/
2025-12-01 01:28:02,048 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo sesiones para usuario 2, cliente_id: 2
2025-12-01 01:28:02,049 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [SESIONES] Usando cliente_id proporcionado: 2
2025-12-01 01:28:02,049 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:02,049 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:02,050 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/2/actividad/ 200 14.5ms
2025-12-01 01:28:02,051 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/2/sesiones/ 200 14.2ms
2025-12-01 01:28:24,770 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/3/actividad/
2025-12-01 01:28:24,770 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/3/actividad/ 200 0.7ms
2025-12-01 01:28:24,771 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/3/sesiones/
2025-12-01 01:28:24,771 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/3/sesiones/ 200 0.9ms
2025-12-01 01:28:24,774 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/3/actividad/
2025-12-01 01:28:24,775 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:24,775 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:28:24,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:24,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:24,776 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:24,776 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:24,776 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:24,776 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:24,776 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:28:24,776 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:28:24,777 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/3/actividad/
2025-12-01 01:28:24,777 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/3/sesiones/
2025-12-01 01:28:24,779 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo actividad para usuario 3, cliente_id: 2
2025-12-01 01:28:24,779 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [ACTIVIDAD] Usando cliente_id proporcionado: 2
2025-12-01 01:28:24,779 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:24,780 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:24,781 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:24,781 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:24,781 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:28:24,783 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:24,783 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:24,783 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:24,783 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:24,783 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:24,783 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:24,783 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:28:24,784 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:28:24,784 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/3/sesiones/
2025-12-01 01:28:24,786 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo sesiones para usuario 3, cliente_id: 2
2025-12-01 01:28:24,786 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [SESIONES] Usando cliente_id proporcionado: 2
2025-12-01 01:28:24,786 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:24,787 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:24,788 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/3/actividad/ 200 13.9ms
2025-12-01 01:28:24,789 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/3/sesiones/ 200 11.8ms
2025-12-01 01:28:28,564 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/1/actividad/
2025-12-01 01:28:28,564 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/1/sesiones/
2025-12-01 01:28:28,565 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:28,565 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:28:28,565 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:28,565 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:28,565 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:28,566 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:28,566 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:28,566 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:28,566 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:28:28,566 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:28:28,566 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/1/actividad/
2025-12-01 01:28:28,568 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo actividad para usuario 1, cliente_id: 2
2025-12-01 01:28:28,569 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [ACTIVIDAD] Usando cliente_id proporcionado: 2
2025-12-01 01:28:28,569 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:28,570 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:28,570 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:28,572 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:28,572 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:28:28,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:28,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:28,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:28,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:28,573 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:28,573 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:28,573 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:28:28,573 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:28:28,573 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/superadmin/usuarios/1/sesiones/
2025-12-01 01:28:28,575 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo sesiones para usuario 1, cliente_id: 2
2025-12-01 01:28:28,575 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [SESIONES] Usando cliente_id proporcionado: 2
2025-12-01 01:28:28,575 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:28,576 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:28,577 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/1/actividad/ 200 13.9ms
2025-12-01 01:28:28,577 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/1/sesiones/ 200 13.7ms
2025-12-01 01:28:38,383 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-12-01 01:28:38,383 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.5ms
2025-12-01 01:28:38,385 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-12-01 01:28:38,385 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:38,385 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:28:38,385 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:38,386 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:38,386 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:38,386 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:28:38,386 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:38,386 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:28:38,386 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:28:38,386 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:28:38,386 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-12-01 01:28:38,401 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-12-01 01:28:38,403 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 1, Usuario 1
2025-12-01 01:28:38,403 - app.modules.auth.presentation.endpoints - INFO - [LOGOUT-WEB] Token no encontrado en BD (ya expirado/revocado) - Cliente: 1, Usuario: 1 (superadmin)
2025-12-01 01:28:38,414 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 01:28:38,415 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=logout, cliente_id=1, usuario_id=1, exito=True
2025-12-01 01:28:38,415 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 30.2ms
2025-12-01 01:28:50,108 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-12-01 01:28:50,109 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.6ms
2025-12-01 01:28:50,111 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-12-01 01:28:50,111 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:50,112 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:50,112 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,112 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,112 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,115 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,115 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,115 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,116 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:50,116 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:50,116 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/login/
2025-12-01 01:28:50,123 - app.modules.auth.presentation.endpoints - INFO - Cliente 2 resuelto y validado para login.
2025-12-01 01:28:50,124 - app.core.auth - INFO - [AUTH] Intento de login: username='admin_acme', cliente_id_destino=2
2025-12-01 01:28:50,124 - app.core.auth - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=2
2025-12-01 01:28:50,124 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,337 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,340 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,346 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=4, super_admin=False, type=tenant_admin
2025-12-01 01:28:50,346 - app.core.auth - INFO - [AUTH] Login exitoso: username='admin_acme', usuario_id=1, cliente_origen=2, cliente_destino=N/A, access_level=4, user_type=tenant_admin
2025-12-01 01:28:50,346 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,349 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,350 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=4, super_admin=False, type=tenant_admin
2025-12-01 01:28:50,350 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,353 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 01:28:50,354 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 2, Usuario 1, Tipo: web, Token ID: 2046, Rotación: False
2025-12-01 01:28:50,354 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: 2046
2025-12-01 01:28:50,354 - app.modules.auth.presentation.endpoints - INFO - Usuario admin_acme autenticado exitosamente (WEB) para cliente 2
2025-12-01 01:28:50,354 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,357 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 01:28:50,358 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=2, usuario_id=1, exito=True
2025-12-01 01:28:50,358 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 246.6ms
2025-12-01 01:28:50,367 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-12-01 01:28:50,367 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.5ms
2025-12-01 01:28:50,369 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-01 01:28:50,369 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:50,369 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:50,369 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,370 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,370 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,372 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,372 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,372 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,372 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:50,373 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:50,373 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/clientes/tenant/branding
2025-12-01 01:28:50,374 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,375 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:50,375 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=2 por usuario: admin_acme
2025-12-01 01:28:50,376 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=2
2025-12-01 01:28:50,379 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=2
2025-12-01 01:28:50,379 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 10.0ms
2025-12-01 01:28:50,384 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-01 01:28:50,385 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.9ms
2025-12-01 01:28:50,387 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/list/
2025-12-01 01:28:50,387 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-01 01:28:50,388 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/list/
2025-12-01 01:28:50,389 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/list/ 200 2.5ms
2025-12-01 01:28:50,389 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 2.3ms
2025-12-01 01:28:50,389 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 01:28:50,391 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/list/ 200 2.3ms
2025-12-01 01:28:50,392 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:50,392 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:50,392 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,392 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,392 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,396 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:50,396 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:50,396 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/menus/getmenu/
2025-12-01 01:28:50,397 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,398 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:50,399 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 2
2025-12-01 01:28:50,399 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 01:28:50,399 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,462 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 5 items raíz.
2025-12-01 01:28:50,462 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 1 con 5 items raíz.
2025-12-01 01:28:50,463 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-12-01 01:28:50,463 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 73.9ms
2025-12-01 01:28:50,464 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:50,464 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:50,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,465 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,465 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,465 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,466 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:50,466 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:50,466 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/areas/list/
2025-12-01 01:28:50,467 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,468 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:50,468 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,473 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,477 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/list/ recibida por usuario 1 del cliente 2 para lista simple
2025-12-01 01:28:50,477 - app.modules.menus.application.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente 2
2025-12-01 01:28:50,478 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,479 - app.modules.menus.application.services.area_service - INFO - Lista simple obtenida para cliente 2: 2 áreas activas
2025-12-01 01:28:50,480 - app.modules.menus.presentation.endpoints_areas - INFO - Lista simple de áreas recuperada para cliente 2 - Total: 2 áreas activas
2025-12-01 01:28:50,481 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 17.3ms
2025-12-01 01:28:50,481 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 01:28:50,482 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:50,482 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:50,482 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,482 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,483 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,485 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:50,485 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:50,485 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/menus/getmenu/
2025-12-01 01:28:50,486 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,487 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:50,487 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 2
2025-12-01 01:28:50,487 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 01:28:50,487 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,488 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 5 items raíz.
2025-12-01 01:28:50,489 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 1 con 5 items raíz.
2025-12-01 01:28:50,490 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-12-01 01:28:50,490 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:50,490 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:50,490 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,490 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,491 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,491 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:50,492 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:50,492 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:50,492 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:50,492 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:50,493 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/areas/list/
2025-12-01 01:28:50,493 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,495 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:50,495 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,496 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,497 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/list/ recibida por usuario 1 del cliente 2 para lista simple
2025-12-01 01:28:50,497 - app.modules.menus.application.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente 2
2025-12-01 01:28:50,497 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:50,498 - app.modules.menus.application.services.area_service - INFO - Lista simple obtenida para cliente 2: 2 áreas activas
2025-12-01 01:28:50,498 - app.modules.menus.presentation.endpoints_areas - INFO - Lista simple de áreas recuperada para cliente 2 - Total: 2 áreas activas
2025-12-01 01:28:50,499 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 17.6ms
2025-12-01 01:28:50,500 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 10.5ms
2025-12-01 01:28:53,607 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-12-01 01:28:53,608 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-12-01 01:28:53,608 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.5ms
2025-12-01 01:28:53,609 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-12-01 01:28:53,609 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-12-01 01:28:53,610 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 2.2ms
2025-12-01 01:28:53,610 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.7ms
2025-12-01 01:28:53,610 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.5ms
2025-12-01 01:28:53,612 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-01 01:28:53,615 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:53,615 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:53,615 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:53,615 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:53,615 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:53,616 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:53,617 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:53,617 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:53,618 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:53,618 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:53,618 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/usuarios/
2025-12-01 01:28:53,619 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,619 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:53,619 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,622 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,622 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 2 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-01 01:28:53,622 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente 2: page=1, limit=10, search='None'
2025-12-01 01:28:53,622 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,626 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,633 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 1 tiene codigo_rol='ADMIN' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:53,633 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 2 tiene codigo_rol='SUPERVISOR' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:53,633 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 3 tiene codigo_rol='USER' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:53,633 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-01 01:28:53,634 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-01 01:28:53,634 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente 2 - Total: 3, Página: 1
2025-12-01 01:28:53,635 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-01 01:28:53,635 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:53,635 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:53,635 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:53,635 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:53,636 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:53,636 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:53,636 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:53,637 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:53,637 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:53,637 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:53,637 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/roles/all-active/
2025-12-01 01:28:53,638 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,639 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:53,639 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,639 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,641 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 2 para lista simple
2025-12-01 01:28:53,641 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,642 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente 2
2025-12-01 01:28:53,642 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente 2 - Total: 3
2025-12-01 01:28:53,642 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 30.1ms
2025-12-01 01:28:53,643 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 8.8ms
2025-12-01 01:28:53,645 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-01 01:28:53,645 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-01 01:28:53,646 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:53,646 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:53,646 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:53,646 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:53,646 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:53,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:53,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:53,648 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:53,648 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:53,648 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:53,648 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/usuarios/
2025-12-01 01:28:53,650 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,650 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:53,652 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,652 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,653 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 2 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-01 01:28:53,653 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente 2: page=1, limit=10, search='None'
2025-12-01 01:28:53,653 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,654 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,656 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 1 tiene codigo_rol='ADMIN' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:53,656 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 2 tiene codigo_rol='SUPERVISOR' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:53,656 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 3 tiene codigo_rol='USER' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:53,657 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-01 01:28:53,657 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-01 01:28:53,657 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente 2 - Total: 3, Página: 1
2025-12-01 01:28:53,657 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:53,658 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:53,658 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:53,658 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:53,658 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:53,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:53,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:53,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:53,659 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:53,659 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:53,660 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/roles/all-active/
2025-12-01 01:28:53,660 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,661 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:53,661 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,661 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,663 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 2 para lista simple
2025-12-01 01:28:53,663 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:53,664 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente 2
2025-12-01 01:28:53,664 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente 2 - Total: 3
2025-12-01 01:28:53,665 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 20.6ms
2025-12-01 01:28:53,665 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 20.3ms
2025-12-01 01:28:56,482 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-12-01 01:28:56,482 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 0.6ms
2025-12-01 01:28:56,483 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-12-01 01:28:56,485 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 0.5ms
2025-12-01 01:28:56,485 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-01 01:28:56,486 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:56,486 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:56,486 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:56,486 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:56,486 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:56,487 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:56,487 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:56,487 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:56,488 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:56,488 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:56,488 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/roles/
2025-12-01 01:28:56,489 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:56,491 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:56,491 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:56,492 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:56,493 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 2 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-01 01:28:56,493 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente 2: page=1, limit=10, search='None'
2025-12-01 01:28:56,494 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=2, page=1, limit=10, search='None'
2025-12-01 01:28:56,494 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:56,496 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente 2: 3
2025-12-01 01:28:56,497 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:56,501 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Obtenidos 3 roles para la página 1 de 3 totales
2025-12-01 01:28:56,501 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 1 tiene codigo_rol='ADMIN' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:56,502 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 2 tiene codigo_rol='SUPERVISOR' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:56,502 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 3 tiene codigo_rol='USER' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:56,502 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: 2, Total: 3, Página: 1/1, Resultados: 3
2025-12-01 01:28:56,502 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: 2, Total roles: 3
2025-12-01 01:28:56,502 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 17.5ms
2025-12-01 01:28:56,503 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-01 01:28:56,504 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:56,504 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:56,504 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:56,504 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:56,504 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:56,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:56,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:56,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:56,507 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:56,507 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:56,507 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/roles/
2025-12-01 01:28:56,508 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:56,509 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:56,509 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:56,510 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:56,510 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 2 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-01 01:28:56,510 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente 2: page=1, limit=10, search='None'
2025-12-01 01:28:56,510 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=2, page=1, limit=10, search='None'
2025-12-01 01:28:56,510 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:56,512 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente 2: 3
2025-12-01 01:28:56,512 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:56,513 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Obtenidos 3 roles para la página 1 de 3 totales
2025-12-01 01:28:56,513 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 1 tiene codigo_rol='ADMIN' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:56,513 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 2 tiene codigo_rol='SUPERVISOR' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:56,513 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 3 tiene codigo_rol='USER' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:28:56,514 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: 2, Total: 3, Página: 1/1, Resultados: 3
2025-12-01 01:28:56,514 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: 2, Total roles: 3
2025-12-01 01:28:56,514 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 10.6ms
2025-12-01 01:28:58,631 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-12-01 01:28:58,632 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-12-01 01:28:58,632 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 1.4ms
2025-12-01 01:28:58,633 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 1.4ms
2025-12-01 01:28:58,636 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-12-01 01:28:58,637 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:58,637 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:58,637 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:58,637 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:58,637 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:58,638 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:58,638 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:58,640 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:58,640 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:58,640 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:58,641 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/areas/
2025-12-01 01:28:58,642 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:58,643 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:58,643 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:58,644 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:58,645 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 1 del cliente 2 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-12-01 01:28:58,645 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente 2: skip=0, limit=10, search='None'
2025-12-01 01:28:58,646 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:58,649 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:58,655 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente 2: 2 áreas de 2 totales
2025-12-01 01:28:58,655 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente 2 - Total: 2, Página: 1
2025-12-01 01:28:58,656 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 20.0ms
2025-12-01 01:28:58,658 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-12-01 01:28:58,658 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:28:58,658 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:28:58,658 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:58,658 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:58,658 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:58,660 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:28:58,660 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:28:58,660 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:28:58,661 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:28:58,661 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:28:58,661 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/areas/
2025-12-01 01:28:58,662 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:58,664 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:28:58,664 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:58,665 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:58,667 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 1 del cliente 2 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-12-01 01:28:58,667 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente 2: skip=0, limit=10, search='None'
2025-12-01 01:28:58,667 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:58,671 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:28:58,675 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente 2: 2 áreas de 2 totales
2025-12-01 01:28:58,675 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente 2 - Total: 2, Página: 1
2025-12-01 01:28:58,676 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 18.3ms
2025-12-01 01:29:00,160 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-12-01 01:29:00,160 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:29:00,160 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:29:00,160 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:00,160 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:00,160 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:00,165 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:00,165 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:00,165 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:00,168 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:29:00,168 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:29:00,168 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/areas/list/
2025-12-01 01:29:00,169 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:00,173 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:29:00,174 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:00,177 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:00,182 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/list/ recibida por usuario 1 del cliente 2 para lista simple
2025-12-01 01:29:00,182 - app.modules.menus.application.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente 2
2025-12-01 01:29:00,182 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:00,184 - app.modules.menus.application.services.area_service - INFO - Lista simple obtenida para cliente 2: 2 áreas activas
2025-12-01 01:29:00,184 - app.modules.menus.presentation.endpoints_areas - INFO - Lista simple de áreas recuperada para cliente 2 - Total: 2 áreas activas
2025-12-01 01:29:00,184 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 25.5ms
2025-12-01 01:29:00,186 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-12-01 01:29:00,187 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:29:00,187 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:29:00,187 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:00,187 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:00,187 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:00,189 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:00,189 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:00,189 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:00,189 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:29:00,189 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:29:00,189 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/areas/list/
2025-12-01 01:29:00,191 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:00,192 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:29:00,193 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:00,194 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:00,194 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/list/ recibida por usuario 1 del cliente 2 para lista simple
2025-12-01 01:29:00,195 - app.modules.menus.application.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente 2
2025-12-01 01:29:00,195 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:00,195 - app.modules.menus.application.services.area_service - INFO - Lista simple obtenida para cliente 2: 2 áreas activas
2025-12-01 01:29:00,196 - app.modules.menus.presentation.endpoints_areas - INFO - Lista simple de áreas recuperada para cliente 2 - Total: 2 áreas activas
2025-12-01 01:29:00,196 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 9.7ms
2025-12-01 01:29:01,115 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/sessions/admin/
2025-12-01 01:29:01,116 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/sessions/admin/ 200 1.1ms
2025-12-01 01:29:01,116 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/sessions/admin/
2025-12-01 01:29:01,117 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/sessions/admin/ 200 1.1ms
2025-12-01 01:29:01,119 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/sessions/admin/
2025-12-01 01:29:01,119 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:29:01,119 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:29:01,119 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:01,119 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:01,119 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:01,125 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:01,125 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:01,126 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:01,126 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:29:01,127 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:29:01,127 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/sessions/admin/
2025-12-01 01:29:01,128 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:01,130 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:29:01,131 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:01,134 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:01,143 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:01,147 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Solicitud /sessions/admin/ por usuario: admin_acme
2025-12-01 01:29:01,147 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:01,153 - app.modules.auth.application.services.refresh_token_service - INFO - [ADMIN-SESSIONS] 8 sesiones activas recuperadas - Cliente 2
2025-12-01 01:29:01,154 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Recuperadas 8 sesiones activas totales.
2025-12-01 01:29:01,155 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/sessions/admin/ 200 34.9ms
2025-12-01 01:29:01,157 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/sessions/admin/
2025-12-01 01:29:01,157 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:29:01,157 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:29:01,157 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:01,157 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:01,158 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:01,163 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:01,163 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:01,163 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:01,164 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:29:01,164 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:29:01,164 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/sessions/admin/
2025-12-01 01:29:01,166 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:01,167 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:29:01,168 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:01,172 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:01,176 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:01,180 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Solicitud /sessions/admin/ por usuario: admin_acme
2025-12-01 01:29:01,180 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:01,183 - app.modules.auth.application.services.refresh_token_service - INFO - [ADMIN-SESSIONS] 8 sesiones activas recuperadas - Cliente 2
2025-12-01 01:29:01,183 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Recuperadas 8 sesiones activas totales.
2025-12-01 01:29:01,184 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/sessions/admin/ 200 28.0ms
2025-12-01 01:29:02,333 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-01 01:29:02,335 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:29:02,335 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:29:02,335 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:02,335 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:02,335 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:02,338 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:02,338 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:02,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:02,340 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:29:02,340 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:29:02,341 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/usuarios/
2025-12-01 01:29:02,342 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,344 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:29:02,344 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,347 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,376 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 2 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-01 01:29:02,376 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente 2: page=1, limit=10, search='None'
2025-12-01 01:29:02,376 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,383 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,389 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 1 tiene codigo_rol='ADMIN' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:29:02,389 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 2 tiene codigo_rol='SUPERVISOR' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:29:02,389 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 3 tiene codigo_rol='USER' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:29:02,389 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-01 01:29:02,390 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-01 01:29:02,390 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente 2 - Total: 3, Página: 1
2025-12-01 01:29:02,391 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-01 01:29:02,391 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 58.1ms
2025-12-01 01:29:02,391 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:29:02,391 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:29:02,393 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:02,393 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:02,393 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:02,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:02,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:02,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:02,394 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:29:02,395 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:29:02,395 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/roles/all-active/
2025-12-01 01:29:02,396 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,397 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:29:02,397 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,398 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,398 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 2 para lista simple
2025-12-01 01:29:02,399 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,400 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente 2
2025-12-01 01:29:02,400 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente 2 - Total: 3
2025-12-01 01:29:02,402 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 10.5ms
2025-12-01 01:29:02,402 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-01 01:29:02,403 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:29:02,403 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:29:02,403 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:02,403 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:02,404 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:02,406 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:02,406 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:02,406 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:02,407 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:29:02,407 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:29:02,407 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/usuarios/
2025-12-01 01:29:02,408 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,409 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:29:02,409 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,410 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,411 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 2 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-01 01:29:02,411 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente 2: page=1, limit=10, search='None'
2025-12-01 01:29:02,411 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,412 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,414 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 1 tiene codigo_rol='ADMIN' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:29:02,414 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 2 tiene codigo_rol='SUPERVISOR' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:29:02,414 - app.modules.rbac.application.services.rol_service - WARNING - [NORMALIZAR-ROL] Rol 3 tiene codigo_rol='USER' pero cliente_id=2. Normalizando codigo_rol a None.
2025-12-01 01:29:02,415 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-01 01:29:02,415 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-01 01:29:02,415 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente 2 - Total: 3, Página: 1
2025-12-01 01:29:02,416 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-01 01:29:02,417 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:29:02,417 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:29:02,417 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:02,417 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:02,417 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:02,419 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:02,419 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:02,419 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:02,420 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:29:02,420 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:29:02,420 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/roles/all-active/
2025-12-01 01:29:02,421 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,422 - app.api.deps - WARNING - [VALIDATION] Rol con codigo_rol='ADMIN' encontrado en cliente_id=2 (rol_id=1). Los roles de sistema solo pueden pertenecer al cliente SUPER ADMIN (cliente_id=1). Filtrando este rol inválido.
2025-12-01 01:29:02,422 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,422 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,423 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 2 para lista simple
2025-12-01 01:29:02,423 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:02,425 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente 2
2025-12-01 01:29:02,425 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente 2 - Total: 3
2025-12-01 01:29:02,426 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 22.9ms
2025-12-01 01:29:02,427 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 9.8ms
2025-12-01 01:29:04,869 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-12-01 01:29:04,870 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.5ms
2025-12-01 01:29:04,870 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-12-01 01:29:04,871 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:29:04,871 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-01 01:29:04,871 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:04,871 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:04,871 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:04,874 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-01 01:29:04,874 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:29:04,874 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-01 01:29:04,875 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-12-01 01:29:04,875 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=multi, bd=bd_cliente_acme, servidor=localhost
2025-12-01 01:29:04,875 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=multi, bd=bd_cliente_acme, path=/api/v1/auth/logout/
2025-12-01 01:29:04,876 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:04,878 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:04,890 - app.infrastructure.database.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-12-01 01:29:04,890 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente 2, Usuario 1
2025-12-01 01:29:04,890 - app.modules.auth.presentation.endpoints - INFO - [LOGOUT-WEB] Token no encontrado en BD (ya expirado/revocado) - Cliente: 2, Usuario: 1 (admin_acme)
2025-12-01 01:29:04,892 - app.core.tenant.routing - INFO - [ROUTING] Cliente 2 -> Multi-DB (bd_cliente_acme)
2025-12-01 01:29:04,895 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 01:29:04,896 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=logout, cliente_id=2, usuario_id=1, exito=True
2025-12-01 01:29:04,896 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 26.2ms
2025-12-01 01:42:23,448 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-01 01:42:23,448 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-01 01:42:23,448 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-01 01:42:23,449 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-01 01:42:23,449 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-01 01:42:23,449 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-01 01:42:24,369 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-01 01:42:24,371 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-01 01:42:24,371 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-01 01:42:24,371 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-01 01:42:24,371 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-01 01:42:24,372 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-12-01 01:42:24,703 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-01 01:42:24,703 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-01 01:42:24,775 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-01 01:42:24,775 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-01 01:42:24,775 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-01 01:42:25,045 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-01 01:42:25,045 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-01 01:42:25,159 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'admin', 'www', 'cdn', 'api', 'backend', 'static', 'assets'}
2025-12-01 01:45:22,072 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-01 01:45:22,072 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-01 01:45:22,072 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-01 01:45:22,072 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-01 01:45:22,073 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-01 01:45:22,073 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-01 01:45:23,022 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-01 01:45:23,024 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-01 01:45:23,024 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-01 01:45:23,025 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-01 01:45:23,025 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-01 01:45:23,025 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=1, DEFAULT_TYPE=single
2025-12-01 01:45:23,357 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-01 01:45:23,357 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-01 01:45:23,428 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-01 01:45:23,428 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-01 01:45:23,428 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-01 01:45:23,692 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-01 01:45:23,693 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-01 01:45:23,801 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=1, EXCLUDED_SUBDOMAINS={'static', 'admin', 'backend', 'www', 'cdn', 'assets', 'api'}
2025-12-01 01:45:34,685 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-01 01:45:34,687 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.9ms
2025-12-01 01:45:34,690 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-01 01:45:34,690 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:34,690 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:34,692 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:34,693 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:34,693 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-12-01 01:45:34,695 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] No se proporcionó refresh token. Cliente: web
2025-12-01 01:45:34,696 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 5.4ms
2025-12-01 01:45:44,418 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-12-01 01:45:44,418 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.5ms
2025-12-01 01:45:44,420 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-12-01 01:45:44,420 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:44,420 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:44,420 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:44,420 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:44,420 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:44,420 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:44,421 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:44,421 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:44,421 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:44,421 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:44,421 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-12-01 01:45:44,492 - app.modules.auth.presentation.endpoints - INFO - Cliente 1 resuelto y validado para login.
2025-12-01 01:45:44,492 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-12-01 01:45:44,493 - app.modules.auth.application.services.auth_service - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-12-01 01:45:44,726 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-12-01 01:45:44,726 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-12-01 01:45:44,726 - app.modules.auth.presentation.endpoints - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-12-01 01:45:44,727 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-12-01 01:45:44,739 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 01:45:44,740 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente 1, Usuario 1, Tipo: web, Token ID: 14462, Rotación: False
2025-12-01 01:45:44,740 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: 14462
2025-12-01 01:45:44,740 - app.modules.auth.presentation.endpoints - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-12-01 01:45:44,747 - app.infrastructure.database.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-12-01 01:45:44,748 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=1, usuario_id=1, exito=True
2025-12-01 01:45:44,749 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 329.5ms
2025-12-01 01:45:44,758 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-12-01 01:45:44,758 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.6ms
2025-12-01 01:45:44,760 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-01 01:45:44,760 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:44,760 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:44,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:44,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:44,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:44,761 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:44,761 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:44,761 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:44,761 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:44,761 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:44,761 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/tenant/branding
2025-12-01 01:45:44,763 - app.infrastructure.database.queries - INFO - [SQL_VERSION] Detectada versión: SQL Server 2022 (internal: 16)
2025-12-01 01:45:44,767 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=1 por usuario: superadmin
2025-12-01 01:45:44,767 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=1
2025-12-01 01:45:44,769 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=1
2025-12-01 01:45:44,770 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 10.0ms
2025-12-01 01:45:44,780 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-01 01:45:44,781 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-01 01:45:44,782 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.7ms
2025-12-01 01:45:44,783 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.5ms
2025-12-01 01:45:44,786 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 01:45:44,786 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:44,786 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:44,787 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:44,787 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:44,787 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:44,787 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:44,787 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:44,787 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:44,788 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:44,788 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:44,788 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 01:45:44,790 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 01:45:44,790 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 01:45:44,829 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 01:45:44,830 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 44.8ms
2025-12-01 01:45:44,833 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-01 01:45:44,834 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:44,834 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:44,834 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:44,834 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:44,834 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:44,834 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:44,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:44,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:44,835 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:44,835 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:44,835 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-12-01 01:45:44,837 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-12-01 01:45:44,837 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-12-01 01:45:44,837 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-12-01 01:45:44,838 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 5.7ms
2025-12-01 01:45:47,566 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-12-01 01:45:47,568 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-12-01 01:45:47,568 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.6ms
2025-12-01 01:45:47,569 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.4ms
2025-12-01 01:45:47,570 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 01:45:47,570 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:47,571 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:47,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:47,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:47,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:47,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:47,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:47,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:47,572 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:47,572 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:47,572 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 01:45:47,574 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 01:45:47,576 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 01:45:47,580 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 01:45:47,581 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 11.2ms
2025-12-01 01:45:47,584 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 01:45:47,585 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:47,585 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:47,585 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:47,585 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:47,585 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:47,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:47,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:47,586 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:47,586 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:47,586 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:47,587 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 01:45:47,589 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 01:45:47,589 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 01:45:47,592 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 01:45:47,592 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.7ms
2025-12-01 01:45:48,684 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-01 01:45:48,686 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.0ms
2025-12-01 01:45:48,686 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-01 01:45:48,686 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 0.8ms
2025-12-01 01:45:48,687 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 01:45:48,688 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:48,688 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:48,688 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:48,688 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:48,689 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:48,689 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:48,689 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:48,689 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:48,689 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:48,689 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:48,689 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 01:45:48,693 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-12-01 01:45:48,693 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-12-01 01:45:48,699 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 01:45:48,701 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 01:45:48,702 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 13.7ms
2025-12-01 01:45:48,704 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-01 01:45:48,704 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:48,704 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:48,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:48,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:48,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:48,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:48,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:48,705 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:48,706 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:48,706 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:48,706 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-12-01 01:45:48,708 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-12-01 01:45:48,709 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-12-01 01:45:48,709 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-01 01:45:48,710 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 5 módulos de 5 totales
2025-12-01 01:45:48,711 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 7.2ms
2025-12-01 01:45:49,270 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 01:45:49,270 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:49,270 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:49,270 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:49,270 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:49,270 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:49,271 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:49,271 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:49,271 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:49,271 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:49,271 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:49,271 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 01:45:49,273 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 01:45:49,275 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 01:45:49,276 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 01:45:49,277 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.6ms
2025-12-01 01:45:49,278 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-01 01:45:49,279 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:49,279 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:49,279 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:49,279 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:49,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:49,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:49,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:49,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:49,280 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:49,280 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:49,280 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-12-01 01:45:49,282 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-01 01:45:49,283 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-01 01:45:49,284 - app.modules.tenant.application.services.cliente_service - INFO - Listados 6 clientes de 6 totales
2025-12-01 01:45:49,285 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.1ms
2025-12-01 01:45:53,298 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-12-01 01:45:53,298 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 0.7ms
2025-12-01 01:45:53,299 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-12-01 01:45:53,300 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 1.5ms
2025-12-01 01:45:53,301 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/
2025-12-01 01:45:53,302 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/estadisticas/
2025-12-01 01:45:53,302 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 01:45:53,303 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/ 200 1.6ms
2025-12-01 01:45:53,303 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/estadisticas/ 200 1.5ms
2025-12-01 01:45:53,303 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:53,303 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:53,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:53,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:53,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:53,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:53,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:53,305 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:53,305 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:53,306 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:53,306 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 01:45:53,310 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 01:45:53,313 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 01:45:53,314 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:53,314 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:53,315 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:53,315 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:53,315 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:53,315 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:53,315 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:53,315 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:53,316 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:53,316 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:53,316 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 01:45:53,316 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 13.6ms
2025-12-01 01:45:53,319 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 01:45:53,319 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 01:45:53,329 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 01:45:53,330 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 16.7ms
2025-12-01 01:45:53,331 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/
2025-12-01 01:45:53,332 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:53,332 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:53,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:53,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:53,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:53,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:53,334 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:53,334 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:53,334 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:53,334 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:53,334 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/
2025-12-01 01:45:53,336 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2 recibida por usuario: superadmin
2025-12-01 01:45:53,337 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/estadisticas/
2025-12-01 01:45:53,338 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-01 01:45:53,338 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-01 01:45:53,338 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:53,338 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:53,338 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:53,338 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-01 01:45:53,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-01 01:45:53,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-01 01:45:53,339 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: 1
2025-12-01 01:45:53,339 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-01 01:45:53,339 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/estadisticas/
2025-12-01 01:45:53,342 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/2/estadisticas recibida por usuario: superadmin
2025-12-01 01:45:53,342 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: 2
2025-12-01 01:45:53,345 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente 2
2025-12-01 01:45:53,345 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/ 200 13.8ms
2025-12-01 01:45:53,346 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/estadisticas/ 200 9.2ms
2025-12-01 01:45:54,816 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-12-01 01:45:54,817 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/2/modulos/
2025-12-01 01:45:54,818 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.9ms
2025-12-01 01:45:54,818 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/2/modulos/ 200 0.6ms
2025-12-01 01:45:54,820 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/2/modulos/
