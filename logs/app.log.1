2025-12-04 08:56:39,309 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:56:39,310 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:56:39,310 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:56:39,310 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:56:39,310 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 4181.3ms
2025-12-04 08:56:39,310 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:39,310 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:56:39,310 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:39,310 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 4185.1ms
2025-12-04 08:56:39,310 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:56:39,310 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:39,310 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:39,310 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:39,310 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:39,310 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:39,310 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:39,310 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:39,310 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:39,326 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:56:39,326 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:56:39,326 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:56:39,326 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 4198.5ms
2025-12-04 08:56:39,326 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:39,326 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:39,326 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:56:39,330 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:56:39,330 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:39,330 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:39,330 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:39,330 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:39,330 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:39,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:39,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:39,339 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:39,343 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:39,343 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:39,343 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:56:39,343 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:39,360 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:56:39,362 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:39,367 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:39,367 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:39,367 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:56:39,369 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 50.4ms
2025-12-04 08:56:39,372 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:39,372 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:39,372 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:39,376 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:39,381 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:56:39,381 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:56:39,381 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:56:39,382 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 50.3ms
2025-12-04 08:56:42,117 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-12-04 08:56:42,117 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 0.8ms
2025-12-04 08:56:42,118 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-12-04 08:56:42,119 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 0.5ms
2025-12-04 08:56:42,119 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-12-04 08:56:42,120 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:42,120 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:42,120 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:42,120 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:42,120 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:42,126 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:42,127 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:42,127 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:42,131 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:42,131 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:42,131 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/areas/
2025-12-04 08:56:42,146 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:42,146 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-12-04 08:56:42,146 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: skip=0, limit=10, search='None'
2025-12-04 08:56:42,146 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:42,146 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0 áreas de 0 totales
2025-12-04 08:56:42,146 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 0, Página: 1
2025-12-04 08:56:42,146 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 35.1ms
2025-12-04 08:56:42,146 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-12-04 08:56:42,146 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:42,146 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:42,146 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:42,146 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:42,146 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:42,162 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:42,162 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:42,162 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:42,163 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:42,163 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:42,163 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/areas/
2025-12-04 08:56:42,179 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:42,182 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-12-04 08:56:42,182 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: skip=0, limit=10, search='None'
2025-12-04 08:56:42,182 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:42,185 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0 áreas de 0 totales
2025-12-04 08:56:42,185 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 0, Página: 1
2025-12-04 08:56:42,186 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 30.0ms
2025-12-04 08:56:43,319 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:56:43,319 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:43,320 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:43,320 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:43,320 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:43,320 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:43,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:43,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:43,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:43,329 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:43,329 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:43,329 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:56:43,345 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:43,346 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:43,346 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:43,346 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:56:43,346 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:43,346 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:56:43,346 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:56:43,346 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:56:43,346 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:56:43,346 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 35.1ms
2025-12-04 08:56:43,346 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:56:43,346 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:43,346 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:43,346 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:43,346 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:43,346 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:43,346 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:43,346 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:43,346 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:43,365 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:43,365 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:43,365 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:56:43,377 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:43,379 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:43,379 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:43,379 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:56:43,379 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:43,379 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:56:43,379 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:56:43,379 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:56:43,379 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:56:43,379 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 31.2ms
2025-12-04 08:56:45,696 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:56:45,697 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:45,697 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:45,697 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:45,697 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:45,697 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:45,700 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:56:45,701 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:45,701 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:45,701 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:45,701 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:45,701 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:45,704 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:45,704 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:45,704 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:45,704 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:45,704 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:45,704 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:45,714 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:45,714 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:45,714 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:56:45,716 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:45,716 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:45,716 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:56:45,733 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:45,733 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:45,733 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:56:45,733 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:45,733 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:45,733 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:45,733 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:45,733 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:45,733 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:56:45,747 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 47.4ms
2025-12-04 08:56:45,750 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:56:45,750 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:45,751 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:45,751 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:45,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:45,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:45,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:45,756 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:45,756 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:45,756 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:45,759 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:56:45,759 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:56:45,759 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:56:45,760 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 63.4ms
2025-12-04 08:56:45,762 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:56:45,762 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:45,762 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:45,762 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:45,762 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:45,763 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:45,764 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:45,764 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:45,765 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:56:45,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:45,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:45,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:45,777 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:45,777 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:45,777 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:56:45,783 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:45,783 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:56:45,783 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:45,798 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:45,799 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:56:45,799 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:45,800 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 50.4ms
2025-12-04 08:56:45,800 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:45,800 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:45,800 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:45,800 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:45,809 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:56:45,809 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:56:45,809 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:56:45,809 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 50.6ms
2025-12-04 08:56:50,691 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:56:50,692 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:50,693 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:50,693 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:50,694 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:50,694 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:50,700 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:50,700 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:50,700 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:50,705 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:50,705 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:50,706 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:56:50,721 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:50,722 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:50,722 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:50,722 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:56:50,722 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:50,728 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:56:50,728 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:56:50,728 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:56:50,728 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:56:50,729 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 37.7ms
2025-12-04 08:56:50,729 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:56:50,729 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:50,729 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:50,729 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:50,729 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:50,729 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:50,729 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:50,729 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:50,729 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:50,740 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:50,741 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:50,741 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:56:50,754 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:50,758 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:50,758 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:50,759 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:56:50,759 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:50,759 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:56:50,759 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:56:50,759 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:56:50,759 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:56:50,759 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 32.6ms
2025-12-04 08:56:51,700 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-12-04 08:56:51,701 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:51,701 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:51,701 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:51,701 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:51,701 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:51,708 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:51,708 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:51,708 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:51,709 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:51,709 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:51,709 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/areas/
2025-12-04 08:56:51,729 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:51,729 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-12-04 08:56:51,729 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: skip=0, limit=10, search='None'
2025-12-04 08:56:51,729 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:51,737 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0 áreas de 0 totales
2025-12-04 08:56:51,737 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 0, Página: 1
2025-12-04 08:56:51,738 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 37.4ms
2025-12-04 08:56:51,739 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-12-04 08:56:51,741 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:51,741 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:51,741 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:51,741 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:51,741 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:51,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:51,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:51,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:51,748 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:51,748 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:51,748 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/areas/
2025-12-04 08:56:51,764 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:51,767 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-12-04 08:56:51,767 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: skip=0, limit=10, search='None'
2025-12-04 08:56:51,767 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:51,770 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0 áreas de 0 totales
2025-12-04 08:56:51,772 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 0, Página: 1
2025-12-04 08:56:51,772 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 31.9ms
2025-12-04 08:56:53,023 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:56:53,024 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:53,024 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:53,024 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:53,024 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:53,024 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:53,028 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:53,028 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:53,029 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:53,033 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:53,033 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:53,033 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:56:53,049 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:53,049 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:53,049 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:53,049 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:56:53,049 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:53,058 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:56:53,058 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:56:53,058 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:56:53,058 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:56:53,059 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 36.5ms
2025-12-04 08:56:53,059 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:56:53,059 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:53,059 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:53,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:53,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:53,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:53,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:53,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:53,059 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:53,068 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:53,068 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:53,068 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:56:53,084 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:53,086 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:53,086 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:53,087 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:56:53,087 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:53,091 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:56:53,091 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:56:53,091 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:56:53,091 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:56:53,091 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 30.8ms
2025-12-04 08:56:55,062 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-04 08:56:55,062 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.4ms
2025-12-04 08:56:55,069 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 08:56:55,069 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:55,069 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:55,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,074 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,074 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,074 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,074 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,074 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:55,074 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 08:56:55,074 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente EE7BFC14-995F-4209-B4B9-99C307534A43, Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558, Tipo: web
2025-12-04 08:56:55,091 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: admin_acme (Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Level: 4, Type: tenant_admin)
2025-12-04 08:56:55,093 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558: level=4, super_admin=False, type=tenant_admin
2025-12-04 08:56:55,093 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43, Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558, Tipo: web, Token ID: A7FDF2D5-0344-47A9-95D7-6403AF957671, Rotación: True
2025-12-04 08:56:55,103 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43, Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558
2025-12-04 08:56:55,103 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-04 08:56:55,103 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: A7FDF2D5-0344-47A9-95D7-6403AF957671
2025-12-04 08:56:55,103 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: admin_acme
2025-12-04 08:56:55,109 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, usuario_id=2458D1EA-816B-4C3C-8D13-B90271F59558, exito=True
2025-12-04 08:56:55,109 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 42.3ms
2025-12-04 08:56:55,109 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-12-04 08:56:55,109 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.4ms
2025-12-04 08:56:55,109 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 08:56:55,109 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:55,109 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:55,109 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,109 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,109 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,109 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,109 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,109 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,127 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,128 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:55,128 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/me/
2025-12-04 08:56:55,133 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: admin_acme
2025-12-04 08:56:55,133 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 4, Super Admin: False, Type: tenant_admin
2025-12-04 08:56:55,133 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 2458D1EA-816B-4C3C-8D13-B90271F59558 para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,134 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:55,150 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 2458D1EA-816B-4C3C-8D13-B90271F59558 con 1 roles activos
2025-12-04 08:56:55,150 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: admin_acme, Type: tenant_admin, Level: 4, Super Admin: False, Roles: 1
2025-12-04 08:56:55,150 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 33.4ms
2025-12-04 08:56:55,150 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-12-04 08:56:55,150 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.6ms
2025-12-04 08:56:55,157 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 08:56:55,158 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:55,158 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:55,158 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,158 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,159 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,159 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,159 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,159 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,159 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,159 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:55,159 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/clientes/tenant/branding
2025-12-04 08:56:55,175 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-04 08:56:55,176 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.9ms
2025-12-04 08:56:55,177 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-04 08:56:55,179 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.3ms
2025-12-04 08:56:55,179 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:56:55,179 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:55,179 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:55,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,184 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 08:56:55,184 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:55,184 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:55,184 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,184 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,184 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,190 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,190 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,190 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,192 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,192 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,192 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,202 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,202 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:55,202 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:56:55,204 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,204 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:55,204 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/menus/getmenu/
2025-12-04 08:56:55,207 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43 por usuario: admin_acme
2025-12-04 08:56:55,207 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,214 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,216 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 59.8ms
2025-12-04 08:56:55,232 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:55,237 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,237 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 2458d1ea-816b-4c3c-8d13-b90271f59558
2025-12-04 08:56:55,237 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:55,237 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:55,237 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:56:55,237 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:55,242 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 5 items raíz.
2025-12-04 08:56:55,242 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 con 5 items raíz.
2025-12-04 08:56:55,243 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 60.2ms
2025-12-04 08:56:55,243 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:56:55,245 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:56:55,245 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:56:55,245 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:56:55,245 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 08:56:55,245 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:55,245 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:55,245 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,247 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,247 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,248 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 69.4ms
2025-12-04 08:56:55,249 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:56:55,249 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:55,249 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:55,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,260 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:55,260 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:55,260 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:55,261 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,261 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:55,261 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/menus/getmenu/
2025-12-04 08:56:55,261 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,261 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:55,261 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:56:55,287 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:55,288 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 2458d1ea-816b-4c3c-8d13-b90271f59558
2025-12-04 08:56:55,292 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:55,294 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 5 items raíz.
2025-12-04 08:56:55,295 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 con 5 items raíz.
2025-12-04 08:56:55,295 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 49.2ms
2025-12-04 08:56:55,297 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:55,297 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:55,297 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:56:55,297 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:55,301 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:56:55,301 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:56:55,301 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:56:55,302 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:56:55,302 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 51.5ms
2025-12-04 08:56:56,707 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:56:56,707 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:56,708 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:56,708 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:56,708 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:56,708 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:56,711 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:56:56,712 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:56,712 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:56,712 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:56,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:56,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:56,720 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:56,720 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:56,721 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:56,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:56,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:56,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:56,730 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:56,730 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:56,730 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:56:56,732 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:56,732 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:56,732 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:56:56,745 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:56,745 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:56,760 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:56,760 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:56,760 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:56,761 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:56:56,761 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:56,766 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:56,766 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:56:56,767 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 56.1ms
2025-12-04 08:56:56,768 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:56,769 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:56:56,769 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:56,769 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:56,770 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:56,770 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:56,770 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:56,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:56,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:56,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:56,779 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:56:56,779 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:56:56,779 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:56:56,779 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 73.3ms
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:56:56,779 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:56:56,779 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:56:56,796 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:56,796 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:56:56,796 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:56:56,796 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:56,811 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:56:56,811 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:56,811 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:56,811 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:56:56,811 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:56:56,811 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 51.0ms
2025-12-04 08:56:56,811 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:56:56,811 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:56:56,811 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:56,828 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:56:56,829 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:56:56,829 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:56:56,829 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:56:56,829 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 50.2ms
2025-12-04 08:57:10,260 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:57:10,260 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:10,261 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:10,261 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:10,261 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:10,261 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:10,265 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:10,265 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:10,265 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:10,265 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:10,265 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:10,265 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:57:10,276 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:10,291 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:57:10,291 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:57:10,291 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:57:10,291 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:10,291 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:57:10,291 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:57:10,291 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:57:10,291 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:57:10,291 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 36.0ms
2025-12-04 08:57:10,291 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:10,291 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:57:10,320 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:10,324 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:57:10,324 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:57:10,324 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:57:10,324 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:10,324 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:57:10,328 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:57:10,328 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:57:10,328 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:57:10,328 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 31.2ms
2025-12-04 08:57:20,379 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:57:20,379 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:20,379 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:20,379 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,380 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,380 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,381 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:57:20,382 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:20,382 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:20,382 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,382 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,383 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,387 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:20,390 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:57:20,437 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,438 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,441 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:57:20,441 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,442 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:57:20,442 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:57:20,442 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,445 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:20,445 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:57:20,446 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 64.5ms
2025-12-04 08:57:20,448 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:57:20,448 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,448 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:20,448 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:20,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,452 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:57:20,452 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:57:20,452 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:57:20,452 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 81.3ms
2025-12-04 08:57:20,452 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,452 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,469 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,469 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,469 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,473 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:20,473 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:20,473 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:57:20,503 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,503 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:57:20,503 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,503 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,503 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:20,516 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:57:20,516 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 69.1ms
2025-12-04 08:57:20,519 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:57:20,519 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:57:20,519 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,519 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,519 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:57:20,519 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:57:20,519 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:57:20,519 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 68.9ms
2025-12-04 08:57:20,919 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:57:20,919 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:20,921 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:20,921 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,921 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,921 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,925 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,926 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,926 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,926 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:20,926 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:20,926 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:57:20,941 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,949 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:57:20,949 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:57:20,949 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:57:20,949 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,952 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:57:20,952 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:57:20,952 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:57:20,952 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:57:20,952 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 35.7ms
2025-12-04 08:57:20,952 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:57:20,952 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:20,952 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:20,952 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,952 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,952 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,960 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:20,960 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:20,960 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:20,965 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:20,965 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:20,965 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:57:20,978 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,981 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:57:20,981 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:57:20,982 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:57:20,982 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:20,986 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:57:20,986 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:57:20,986 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:57:20,986 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:57:20,986 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 30.2ms
2025-12-04 08:57:34,006 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-12-04 08:57:34,006 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:34,007 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:34,007 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:34,007 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:34,007 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:34,011 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:34,012 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:34,012 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:34,016 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:34,016 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:34,017 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/areas/
2025-12-04 08:57:34,031 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:34,031 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-12-04 08:57:34,031 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: skip=0, limit=10, search='None'
2025-12-04 08:57:34,031 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:34,038 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0 áreas de 0 totales
2025-12-04 08:57:34,038 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 0, Página: 1
2025-12-04 08:57:34,040 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 33.5ms
2025-12-04 08:57:34,040 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-12-04 08:57:34,040 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:34,040 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:34,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:34,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:34,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:34,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:34,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:34,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:34,050 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:34,050 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:34,050 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/areas/
2025-12-04 08:57:34,064 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:34,067 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-12-04 08:57:34,067 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: skip=0, limit=10, search='None'
2025-12-04 08:57:34,067 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:34,071 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0 áreas de 0 totales
2025-12-04 08:57:34,071 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 0, Página: 1
2025-12-04 08:57:34,071 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 30.1ms
2025-12-04 08:57:37,462 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-12-04 08:57:37,462 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:37,462 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:37,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:37,462 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:37,463 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:37,467 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:37,467 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:37,467 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:37,472 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:37,472 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:37,472 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/areas/list/
2025-12-04 08:57:37,487 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:37,490 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/list/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:57:37,490 - app.modules.menus.application.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:37,490 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:37,490 - app.modules.menus.application.services.area_service - INFO - No se encontraron áreas activas para el cliente ee7bfc14-995f-4209-b4b9-99c307534a43 en la lista simple
2025-12-04 08:57:37,490 - app.modules.menus.presentation.endpoints_areas - INFO - Lista simple de áreas recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 0 áreas activas
2025-12-04 08:57:37,490 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 32.4ms
2025-12-04 08:57:37,490 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-12-04 08:57:37,490 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:37,490 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:37,490 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:37,490 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:37,490 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:37,490 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:37,490 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:37,490 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:37,504 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:37,504 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:37,504 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/areas/list/
2025-12-04 08:57:37,516 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:37,520 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/list/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:57:37,520 - app.modules.menus.application.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:37,520 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:37,520 - app.modules.menus.application.services.area_service - INFO - No se encontraron áreas activas para el cliente ee7bfc14-995f-4209-b4b9-99c307534a43 en la lista simple
2025-12-04 08:57:37,520 - app.modules.menus.presentation.endpoints_areas - INFO - Lista simple de áreas recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 0 áreas activas
2025-12-04 08:57:37,520 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 28.5ms
2025-12-04 08:57:38,061 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/sessions/admin/
2025-12-04 08:57:38,062 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/sessions/admin/ 200 0.5ms
2025-12-04 08:57:38,063 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/sessions/admin/
2025-12-04 08:57:38,063 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:38,064 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:38,064 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:38,064 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:38,064 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:38,070 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:38,070 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:38,070 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:38,070 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:38,070 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:38,070 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/sessions/admin/
2025-12-04 08:57:38,091 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:38,091 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Solicitud /sessions/admin/ por usuario: admin_acme
2025-12-04 08:57:38,104 - app.modules.auth.application.services.refresh_token_service - INFO - [ADMIN-SESSIONS] 8 sesiones activas recuperadas - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:38,104 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Recuperadas 8 sesiones activas totales.
2025-12-04 08:57:38,105 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/sessions/admin/ 200 41.9ms
2025-12-04 08:57:38,106 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/sessions/admin/
2025-12-04 08:57:38,107 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:38,107 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:38,107 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:38,107 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:38,107 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:38,111 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:38,112 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:38,112 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:38,115 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:38,115 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:38,115 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/sessions/admin/
2025-12-04 08:57:38,120 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:38,136 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Solicitud /sessions/admin/ por usuario: admin_acme
2025-12-04 08:57:38,136 - app.modules.auth.application.services.refresh_token_service - INFO - [ADMIN-SESSIONS] 8 sesiones activas recuperadas - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:38,136 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Recuperadas 8 sesiones activas totales.
2025-12-04 08:57:38,136 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/sessions/admin/ 200 32.7ms
2025-12-04 08:57:53,802 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-12-04 08:57:53,803 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.2ms
2025-12-04 08:57:53,803 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-12-04 08:57:53,805 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-12-04 08:57:53,805 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-12-04 08:57:53,805 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 2.4ms
2025-12-04 08:57:53,807 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.6ms
2025-12-04 08:57:53,807 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.5ms
2025-12-04 08:57:53,808 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:57:53,810 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:53,810 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:53,810 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:53,810 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:53,810 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:53,810 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:57:53,810 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:53,810 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:53,810 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:53,810 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:53,810 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:53,819 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:53,819 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:53,819 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:53,820 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:53,820 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:53,820 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:53,825 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:53,825 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:53,825 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:57:53,830 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:53,830 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:53,830 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:57:53,869 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:53,870 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:53,870 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:57:53,870 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:57:53,870 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:53,877 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:57:53,877 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:53,878 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:53,880 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:53,880 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:57:53,880 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 69.1ms
2025-12-04 08:57:53,880 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:57:53,884 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:53,884 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:53,884 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:53,884 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:53,884 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:53,886 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:57:53,886 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:57:53,886 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:57:53,886 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 80.1ms
2025-12-04 08:57:53,890 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:57:53,890 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:53,890 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:53,890 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:53,890 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:53,890 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:53,890 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:53,890 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:53,890 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:53,895 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:53,895 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:53,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:53,902 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:53,903 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:53,903 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:57:53,903 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:53,903 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:53,903 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:57:53,928 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:53,930 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:53,933 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:57:53,933 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:53,936 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:57:53,936 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:57:53,936 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:53,940 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:53,940 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:57:53,940 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 57.7ms
2025-12-04 08:57:53,945 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:57:53,945 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:57:53,945 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:57:53,945 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:57:53,951 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 59.7ms
2025-12-04 08:57:57,249 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-12-04 08:57:57,249 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:57:57,249 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:57:57,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:57,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:57,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:57,253 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:57:57,253 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:57:57,253 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:57:57,257 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:57:57,257 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:57:57,257 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/logout/
2025-12-04 08:57:57,264 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43, Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558
2025-12-04 08:57:57,264 - app.modules.auth.presentation.endpoints - INFO - [LOGOUT-WEB] Token no encontrado en BD (ya expirado/revocado) - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Usuario: 2458D1EA-816B-4C3C-8D13-B90271F59558 (admin_acme)
2025-12-04 08:57:57,267 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=logout, cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, usuario_id=2458D1EA-816B-4C3C-8D13-B90271F59558, exito=True
2025-12-04 08:57:57,267 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 19.3ms
2025-12-04 08:58:03,821 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-12-04 08:58:03,821 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.5ms
2025-12-04 08:58:03,821 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-12-04 08:58:03,821 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:58:03,821 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:58:03,821 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:03,821 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:03,821 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:03,827 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:03,827 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:03,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:03,831 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:03,831 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:58:03,831 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/login/
2025-12-04 08:58:03,831 - app.modules.auth.presentation.endpoints - INFO - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43 resuelto y validado para login.
2025-12-04 08:58:03,831 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Intento de login: username='admin_acme', cliente_id_destino=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:03,831 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,062 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558: level=4, super_admin=False, type=tenant_admin
2025-12-04 08:58:04,062 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Login exitoso: username='admin_acme', usuario_id=2458D1EA-816B-4C3C-8D13-B90271F59558, cliente_origen=ee7bfc14-995f-4209-b4b9-99c307534a43, cliente_destino=N/A, access_level=4, user_type=tenant_admin
2025-12-04 08:58:04,062 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,070 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558: level=4, super_admin=False, type=tenant_admin
2025-12-04 08:58:04,070 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43, Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558, Tipo: web, Token ID: 707FE553-F36B-4E0B-A1FD-F81475F7007C, Rotación: False
2025-12-04 08:58:04,070 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: 707FE553-F36B-4E0B-A1FD-F81475F7007C
2025-12-04 08:58:04,070 - app.modules.auth.presentation.endpoints - INFO - Usuario admin_acme autenticado exitosamente (WEB) para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,079 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, usuario_id=2458D1EA-816B-4C3C-8D13-B90271F59558, exito=True
2025-12-04 08:58:04,079 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 256.9ms
2025-12-04 08:58:04,087 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 08:58:04,088 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:58:04,088 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:58:04,088 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,088 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,088 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,092 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,094 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,094 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,101 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 08:58:04,101 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/clientes/tenant/branding
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,101 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,101 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,114 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,114 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,114 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,114 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,114 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,120 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,120 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,120 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,120 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,130 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,130 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:58:04,131 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/menus/getmenu/
2025-12-04 08:58:04,132 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,132 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:58:04,132 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:58:04,132 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,132 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:58:04,132 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:58:04,159 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43 por usuario: admin_acme
2025-12-04 08:58:04,159 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,163 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,163 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 80.7ms
2025-12-04 08:58:04,178 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,178 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 2458d1ea-816b-4c3c-8d13-b90271f59558
2025-12-04 08:58:04,181 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,181 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,181 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 5 items raíz.
2025-12-04 08:58:04,181 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 con 5 items raíz.
2025-12-04 08:58:04,181 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 86.5ms
2025-12-04 08:58:04,181 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:58:04,181 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:58:04,181 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,181 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 08:58:04,181 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:58:04,181 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:58:04,181 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,181 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,181 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,196 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:58:04,196 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,199 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,199 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,201 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,201 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:58:04,201 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 97.3ms
2025-12-04 08:58:04,201 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:58:04,201 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:58:04,201 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:58:04,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,201 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,201 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:58:04,201 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/menus/getmenu/
2025-12-04 08:58:04,212 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:58:04,213 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:58:04,213 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:58:04,213 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 112.8ms
2025-12-04 08:58:04,213 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:58:04,213 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:58:04,213 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:58:04,213 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,213 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,213 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,220 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,220 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:58:04,220 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:58:04,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:04,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:04,229 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:04,234 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,235 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:58:04,235 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:58:04,248 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,248 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 2458d1ea-816b-4c3c-8d13-b90271f59558
2025-12-04 08:58:04,250 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 5 items raíz.
2025-12-04 08:58:04,250 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 con 5 items raíz.
2025-12-04 08:58:04,258 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 67.4ms
2025-12-04 08:58:04,262 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,264 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,264 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:58:04,264 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,270 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:58:04,270 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:58:04,270 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,270 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:04,270 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:58:04,270 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 68.0ms
2025-12-04 08:58:04,279 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:04,287 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:58:04,287 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:58:04,287 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:58:04,287 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 71.1ms
2025-12-04 08:58:05,466 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-12-04 08:58:05,467 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 0.6ms
2025-12-04 08:58:05,468 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-12-04 08:58:05,468 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 0.6ms
2025-12-04 08:58:05,468 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:58:05,470 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:58:05,470 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:58:05,470 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:05,470 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:05,470 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:05,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:05,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:05,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:05,483 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:05,483 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:58:05,483 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:58:05,501 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:05,506 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:58:05,506 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:58:05,506 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:58:05,506 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:05,509 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:58:05,510 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:58:05,510 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:58:05,510 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:58:05,510 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 41.7ms
2025-12-04 08:58:05,512 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 08:58:05,514 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:58:05,514 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:58:05,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:05,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:05,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:05,519 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:58:05,519 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:58:05,519 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:58:05,523 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:58:05,523 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:58:05,523 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 08:58:05,542 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:05,545 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:58:05,545 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:58:05,546 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 08:58:05,546 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:58:05,551 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 0
2025-12-04 08:58:05,551 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] No hay roles para mostrar (total=0, limit=10)
2025-12-04 08:58:05,551 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 0, Página: 1/0, Resultados: 0
2025-12-04 08:58:05,551 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 0
2025-12-04 08:58:05,552 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 39.1ms
2025-12-04 08:59:31,902 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-04 08:59:31,902 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-04 08:59:31,902 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-04 08:59:31,902 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-04 08:59:31,902 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-04 08:59:31,902 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-04 08:59:31,999 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x00000277403D2990>
2025-12-04 08:59:32,000 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x00000277403D3BC0>
2025-12-04 08:59:32,000 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x00000277403D1A00>
2025-12-04 08:59:32,000 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x0000027740D34C50>
2025-12-04 08:59:32,001 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x0000027740DD9F10>
2025-12-04 08:59:32,001 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x0000027740D346E0>
2025-12-04 08:59:32,001 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x0000027740D0FF80>
2025-12-04 08:59:32,802 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-04 08:59:33,031 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] SQLAlchemy async disponible
2025-12-04 08:59:33,034 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] aioodbc disponible
2025-12-04 08:59:33,042 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-04 08:59:33,042 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-04 08:59:33,042 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-04 08:59:33,042 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-04 08:59:33,042 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, DEFAULT_TYPE=single
2025-12-04 08:59:33,419 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-04 08:59:33,419 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-04 08:59:33,511 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-04 08:59:33,511 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-04 08:59:33,511 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-04 08:59:33,712 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-04 08:59:33,717 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-04 08:59:33,867 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, EXCLUDED_SUBDOMAINS={'api', 'assets', 'static', 'backend', 'admin', 'www', 'cdn'}
2025-12-04 08:59:53,377 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:59:53,377 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:59:53,378 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:59:53,378 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:59:53,378 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:59:53,378 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:59:53,379 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:59:53,382 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] AsyncEngine creado para admin
2025-12-04 08:59:53,384 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:59:53,385 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:59:53,385 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:59:53,385 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:59:53,385 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:59:53,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:59:53,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:59:53,451 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:59:53,452 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:59:53,453 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:59:53,453 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:59:53,459 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:59:57,577 - app.infrastructure.cache.redis_cache - WARNING - [REDIS_CACHE] Error conectando a Redis: Error 10061 connecting to localhost:6379. No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión.. Cache desactivado automáticamente (usando fallback en memoria).
2025-12-04 08:59:57,577 - app.infrastructure.cache.redis_cache - INFO - ℹ️ Módulo de Redis cache cargado pero desactivado (usando fallback en memoria)
2025-12-04 08:59:57,577 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:59:57,582 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:59:57,582 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:59:57,582 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:59:57,582 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:59:57,582 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] AsyncEngine creado para tenant_ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:59:57,622 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:59:57,622 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:59:57,630 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:59:57,630 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:59:57,630 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:59:57,630 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:59:57,632 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:59:57,635 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:59:57,635 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:59:57,636 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 4258.4ms
2025-12-04 08:59:57,637 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:59:57,639 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 08:59:57,639 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:59:57,639 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:59:57,639 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:59:57,640 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:59:57,640 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:59:57,645 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:59:57,645 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:59:57,645 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:59:57,649 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:59:57,649 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:59:57,649 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:59:57,649 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 4273.4ms
2025-12-04 08:59:57,652 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 08:59:57,652 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 08:59:57,663 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:59:57,663 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 08:59:57,663 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 08:59:57,677 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:59:57,682 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 08:59:57,682 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:59:57,687 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 08:59:57,687 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 08:59:57,689 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:59:57,689 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 49.9ms
2025-12-04 08:59:57,692 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 08:59:57,692 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 08:59:57,692 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:59:57,696 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 08:59:57,701 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 08:59:57,701 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 08:59:57,701 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 08:59:57,702 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 50.0ms
2025-12-04 09:00:01,457 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 09:00:01,457 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:01,457 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:01,457 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:01,457 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:01,457 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:01,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:01,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:01,464 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:01,470 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:01,470 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:01,470 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 09:00:01,489 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:01,492 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:01,492 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 09:00:01,492 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 09:00:01,492 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:01,496 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 3
2025-12-04 09:00:01,497 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:01,503 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Obtenidos 3 roles para la página 1 de 3 totales
2025-12-04 09:00:01,503 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 3, Página: 1/1, Resultados: 3
2025-12-04 09:00:01,504 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 3
2025-12-04 09:00:01,504 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 47.3ms
2025-12-04 09:00:01,506 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 09:00:01,506 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:01,506 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:01,506 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:01,507 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:01,507 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:01,510 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:01,510 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:01,510 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:01,515 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:01,515 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:01,515 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 09:00:01,529 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:01,532 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:01,532 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 09:00:01,532 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 09:00:01,533 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:01,536 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 3
2025-12-04 09:00:01,536 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:01,540 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Obtenidos 3 roles para la página 1 de 3 totales
2025-12-04 09:00:01,540 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 3, Página: 1/1, Resultados: 3
2025-12-04 09:00:01,541 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 3
2025-12-04 09:00:01,541 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 35.1ms
2025-12-04 09:00:05,651 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 09:00:05,651 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:05,652 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:05,652 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:05,652 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:05,652 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:05,655 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 09:00:05,655 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:05,656 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:05,656 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:05,656 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:05,656 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:05,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:05,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:05,659 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:05,662 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:05,662 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:05,662 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:05,669 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:05,669 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:05,669 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 09:00:05,671 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:05,671 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:05,672 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 09:00:05,692 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:05,692 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:05,692 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:05,692 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 09:00:05,692 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:05,692 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 09:00:05,699 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:05,699 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:05,699 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 09:00:05,702 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 47.3ms
2025-12-04 09:00:05,703 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:05,705 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 09:00:05,706 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:05,706 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:05,706 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:05,706 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:05,706 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:05,710 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:05,710 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:05,710 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:05,714 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 09:00:05,714 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 09:00:05,714 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 09:00:05,715 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 63.9ms
2025-12-04 09:00:05,717 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 09:00:05,717 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:05,717 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:05,718 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 09:00:05,718 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:05,718 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:05,718 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:05,718 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:05,718 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:05,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:05,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:05,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:05,728 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:05,728 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:05,728 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 09:00:05,742 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:05,742 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 09:00:05,742 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:05,755 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:05,756 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:05,756 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 09:00:05,757 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 51.0ms
2025-12-04 09:00:05,760 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:05,760 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 09:00:05,760 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:05,763 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:05,767 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 09:00:05,767 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 09:00:05,767 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 09:00:05,769 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 51.4ms
2025-12-04 09:00:07,327 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 09:00:07,327 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:07,329 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:07,329 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:07,329 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:07,329 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:07,333 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:07,333 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:07,333 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:07,338 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:07,338 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:07,338 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 09:00:07,356 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:07,356 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:07,356 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 09:00:07,356 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 09:00:07,356 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:07,362 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 3
2025-12-04 09:00:07,362 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:07,362 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Obtenidos 3 roles para la página 1 de 3 totales
2025-12-04 09:00:07,362 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 3, Página: 1/1, Resultados: 3
2025-12-04 09:00:07,362 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 3
2025-12-04 09:00:07,362 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 40.1ms
2025-12-04 09:00:07,362 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 09:00:07,362 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:07,362 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:07,371 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:07,371 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:07,371 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:07,376 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:07,376 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:07,376 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:07,380 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:07,380 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:07,380 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 09:00:07,396 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:07,399 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:07,399 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 09:00:07,399 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, page=1, limit=10, search='None'
2025-12-04 09:00:07,400 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:07,402 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 3
2025-12-04 09:00:07,402 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:07,408 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Obtenidos 3 roles para la página 1 de 3 totales
2025-12-04 09:00:07,408 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total: 3, Página: 1/1, Resultados: 3
2025-12-04 09:00:07,408 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Total roles: 3
2025-12-04 09:00:07,409 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 38.7ms
2025-12-04 09:00:08,927 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 09:00:08,928 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:08,928 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:08,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:08,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:08,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:08,931 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 09:00:08,932 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:08,932 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:08,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:08,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:08,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:08,938 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:08,938 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:08,938 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:08,940 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:08,940 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:08,940 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:08,942 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:08,942 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:08,942 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 09:00:08,942 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:08,942 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:08,942 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 09:00:08,972 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:08,974 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:08,978 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:08,978 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 09:00:08,978 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:08,979 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 09:00:08,980 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:08,982 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:08,984 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 09:00:08,984 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:08,984 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 53.4ms
2025-12-04 09:00:08,987 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 09:00:08,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:08,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:08,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:08,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:08,988 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:08,992 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 09:00:08,992 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 09:00:08,992 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 09:00:08,992 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:08,992 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:08,992 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:08,992 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 68.7ms
2025-12-04 09:00:08,992 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 09:00:08,992 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:08,992 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:08,992 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:08,992 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:08,992 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:09,002 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:09,002 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:09,002 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 09:00:09,002 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:09,002 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:09,006 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:09,013 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:09,014 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:09,014 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 09:00:09,030 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:09,036 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 09:00:09,036 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:09,037 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:09,042 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:09,042 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 09:00:09,042 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:09,043 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:09,043 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 09:00:09,044 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 57.6ms
2025-12-04 09:00:09,047 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:09,053 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 09:00:09,053 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 09:00:09,053 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 09:00:09,054 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 55.9ms
2025-12-04 09:00:10,065 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-12-04 09:00:10,065 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:10,065 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:00:10,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:10,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:10,066 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:10,070 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:00:10,070 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:10,070 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:00:10,074 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:00:10,074 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:00:10,074 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/logout/
2025-12-04 09:00:10,081 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43, Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558
2025-12-04 09:00:10,081 - app.modules.auth.presentation.endpoints - INFO - [LOGOUT-WEB] Token no encontrado en BD (ya expirado/revocado) - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Usuario: 2458D1EA-816B-4C3C-8D13-B90271F59558 (admin_acme)
2025-12-04 09:00:10,084 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=logout, cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, usuario_id=2458D1EA-816B-4C3C-8D13-B90271F59558, exito=True
2025-12-04 09:00:10,085 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 20.2ms
2025-12-04 09:00:18,270 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-12-04 09:00:18,270 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.5ms
2025-12-04 09:00:18,272 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-12-04 09:00:18,272 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:18,273 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:18,273 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,273 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,273 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,276 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,276 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,279 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,284 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:18,284 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/login/
2025-12-04 09:00:18,289 - app.modules.auth.presentation.endpoints - INFO - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 resuelto y validado para login.
2025-12-04 09:00:18,289 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Intento de login: username='admin_innova', cliente_id_destino=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,289 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,289 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] AsyncEngine creado para tenant_a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,532 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 726D3AED-DFF3-4EE0-8084-4E2E4FECDEDF: level=4, super_admin=False, type=tenant_admin
2025-12-04 09:00:18,532 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Login exitoso: username='admin_innova', usuario_id=726D3AED-DFF3-4EE0-8084-4E2E4FECDEDF, cliente_origen=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, cliente_destino=N/A, access_level=4, user_type=tenant_admin
2025-12-04 09:00:18,532 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,534 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 726D3AED-DFF3-4EE0-8084-4E2E4FECDEDF: level=4, super_admin=False, type=tenant_admin
2025-12-04 09:00:18,539 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, Usuario 726D3AED-DFF3-4EE0-8084-4E2E4FECDEDF, Tipo: web, Token ID: 7AEAF4D5-5E17-408A-9325-5529C13727F3, Rotación: False
2025-12-04 09:00:18,542 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: 7AEAF4D5-5E17-408A-9325-5529C13727F3
2025-12-04 09:00:18,542 - app.modules.auth.presentation.endpoints - INFO - Usuario admin_innova autenticado exitosamente (WEB) para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,542 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, usuario_id=726D3AED-DFF3-4EE0-8084-4E2E4FECDEDF, exito=True
2025-12-04 09:00:18,542 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 274.5ms
2025-12-04 09:00:18,556 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-12-04 09:00:18,556 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.6ms
2025-12-04 09:00:18,558 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:00:18,558 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:18,558 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:18,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,562 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-04 09:00:18,566 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.7ms
2025-12-04 09:00:18,566 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,567 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,567 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,570 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-12-04 09:00:18,570 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-04 09:00:18,570 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-12-04 09:00:18,572 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 2.8ms
2025-12-04 09:00:18,572 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 2.3ms
2025-12-04 09:00:18,572 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.8ms
2025-12-04 09:00:18,572 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-12-04 09:00:18,572 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-12-04 09:00:18,572 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:00:18,572 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 3.3ms
2025-12-04 09:00:18,572 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 3.3ms
2025-12-04 09:00:18,572 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:18,572 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:18,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,582 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 09:00:18,582 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 09:00:18,583 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:18,584 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:18,584 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,584 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,584 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,587 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:18,587 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:18,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,592 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,592 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:18,592 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/clientes/tenant/branding
2025-12-04 09:00:18,596 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,596 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,597 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,599 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,599 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,599 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,601 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,601 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,601 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,610 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,610 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:18,611 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 09:00:18,611 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,612 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:18,612 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/menus/getmenu/
2025-12-04 09:00:18,613 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,613 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:18,613 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 09:00:18,634 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 por usuario: admin_innova
2025-12-04 09:00:18,634 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,652 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,652 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 98.2ms
2025-12-04 09:00:18,652 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,659 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,659 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 726d3aed-dff3-4ee0-8084-4e2e4fecdedf
2025-12-04 09:00:18,659 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,667 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:18,667 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: page=1, limit=10, search='None'
2025-12-04 09:00:18,667 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,668 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 3 items raíz.
2025-12-04 09:00:18,668 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf con 3 items raíz.
2025-12-04 09:00:18,668 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 93.7ms
2025-12-04 09:00:18,668 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 para lista simple
2025-12-04 09:00:18,668 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,672 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:00:18,672 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:18,672 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:18,672 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,672 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,672 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,672 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,672 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,672 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,672 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,682 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,682 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 3
2025-12-04 09:00:18,683 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 101.2ms
2025-12-04 09:00:18,684 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 09:00:18,687 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:18,687 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:18,687 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,687 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,687 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,687 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,687 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:18,687 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/menus/getmenu/
2025-12-04 09:00:18,692 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 09:00:18,692 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 09:00:18,692 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 3, Página: 1
2025-12-04 09:00:18,692 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 113.9ms
2025-12-04 09:00:18,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,700 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 09:00:18,701 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:18,701 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:18,701 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,701 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,701 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,711 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,711 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:18,711 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 09:00:18,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:18,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:18,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:18,726 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,726 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:18,726 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 09:00:18,735 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,735 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 726d3aed-dff3-4ee0-8084-4e2e4fecdedf
2025-12-04 09:00:18,747 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 3 items raíz.
2025-12-04 09:00:18,747 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf con 3 items raíz.
2025-12-04 09:00:18,747 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 75.4ms
2025-12-04 09:00:18,751 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,753 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 para lista simple
2025-12-04 09:00:18,753 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,753 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,763 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:18,763 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 3
2025-12-04 09:00:18,763 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 77.2ms
2025-12-04 09:00:18,766 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:18,766 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: page=1, limit=10, search='None'
2025-12-04 09:00:18,766 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,771 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:18,775 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 09:00:18,776 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 09:00:18,776 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 3, Página: 1
2025-12-04 09:00:18,777 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 77.1ms
2025-12-04 09:00:23,536 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-12-04 09:00:23,538 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-12-04 09:00:23,539 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 1.5ms
2025-12-04 09:00:23,539 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 1.2ms
2025-12-04 09:00:23,541 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 09:00:23,541 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:23,541 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:23,541 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:23,541 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:23,541 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:23,546 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:23,546 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:23,546 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:23,551 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:23,551 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:23,551 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 09:00:23,567 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:23,569 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:23,569 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: page=1, limit=10, search='None'
2025-12-04 09:00:23,570 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, page=1, limit=10, search='None'
2025-12-04 09:00:23,570 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:23,576 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: 3
2025-12-04 09:00:23,576 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:23,581 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Obtenidos 3 roles para la página 1 de 3 totales
2025-12-04 09:00:23,581 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, Total: 3, Página: 1/1, Resultados: 3
2025-12-04 09:00:23,581 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, Total roles: 3
2025-12-04 09:00:23,581 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 41.2ms
2025-12-04 09:00:23,583 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-12-04 09:00:23,583 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:23,584 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:23,584 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:23,584 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:23,584 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:23,589 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:23,589 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:23,589 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:23,592 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:23,593 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:23,593 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/roles/
2025-12-04 09:00:23,609 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:23,613 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:23,613 - app.modules.rbac.application.services.rol_service - INFO - Obteniendo roles paginados para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: page=1, limit=10, search='None'
2025-12-04 09:00:23,613 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Iniciando consulta para cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, page=1, limit=10, search='None'
2025-12-04 09:00:23,613 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:23,616 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Total de roles encontrados para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: 3
2025-12-04 09:00:23,617 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:23,620 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Obtenidos 3 roles para la página 1 de 3 totales
2025-12-04 09:00:23,620 - app.modules.rbac.application.services.rol_service - INFO - [ROLES-PAGINADOS] Consulta completada exitosamente - Cliente: a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, Total: 3, Página: 1/1, Resultados: 3
2025-12-04 09:00:23,620 - app.modules.rbac.presentation.endpoints - INFO - Respuesta exitosa para GET /roles/ - Cliente: a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, Total roles: 3
2025-12-04 09:00:23,621 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 37.9ms
2025-12-04 09:00:27,204 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-12-04 09:00:27,205 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 0.5ms
2025-12-04 09:00:27,205 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-12-04 09:00:27,206 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 0.8ms
2025-12-04 09:00:27,207 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-12-04 09:00:27,207 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:27,207 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:27,209 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:27,209 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:27,209 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:27,213 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:27,213 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:27,213 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:27,218 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:27,218 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:27,218 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/areas/
2025-12-04 09:00:27,232 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:27,232 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-12-04 09:00:27,232 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: skip=0, limit=10, search='None'
2025-12-04 09:00:27,232 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:27,245 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: 0 áreas de 0 totales
2025-12-04 09:00:27,246 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 0, Página: 1
2025-12-04 09:00:27,246 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 39.3ms
2025-12-04 09:00:27,247 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-12-04 09:00:27,249 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:27,249 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:27,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:27,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:27,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:27,253 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:27,253 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:27,253 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:27,256 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:27,256 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:27,256 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/areas/
2025-12-04 09:00:27,270 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:27,274 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-12-04 09:00:27,274 - app.modules.menus.application.services.area_service - INFO - Obteniendo áreas paginadas para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: skip=0, limit=10, search='None'
2025-12-04 09:00:27,274 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:27,277 - app.modules.menus.application.services.area_service - INFO - Paginación completada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: 0 áreas de 0 totales
2025-12-04 09:00:27,277 - app.modules.menus.presentation.endpoints_areas - INFO - Lista paginada de áreas recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 0, Página: 1
2025-12-04 09:00:27,277 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 30.4ms
2025-12-04 09:00:28,290 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/list/
2025-12-04 09:00:28,290 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/list/ 200 0.5ms
2025-12-04 09:00:28,292 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-12-04 09:00:28,292 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:28,292 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:28,293 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:28,293 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:28,293 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:28,297 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:28,297 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:28,297 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:28,302 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:28,302 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:28,302 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/areas/list/
2025-12-04 09:00:28,313 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:28,319 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/list/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 para lista simple
2025-12-04 09:00:28,319 - app.modules.menus.application.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:28,319 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:28,323 - app.modules.menus.application.services.area_service - INFO - No se encontraron áreas activas para el cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 en la lista simple
2025-12-04 09:00:28,323 - app.modules.menus.presentation.endpoints_areas - INFO - Lista simple de áreas recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 0 áreas activas
2025-12-04 09:00:28,326 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 34.0ms
2025-12-04 09:00:28,328 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-12-04 09:00:28,329 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:28,329 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:28,329 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:28,329 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:28,329 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:28,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:28,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:28,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:28,332 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:28,332 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:28,332 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/areas/list/
2025-12-04 09:00:28,354 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:28,356 - app.modules.menus.presentation.endpoints_areas - INFO - Solicitud GET /areas/list/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 para lista simple
2025-12-04 09:00:28,356 - app.modules.menus.application.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:28,356 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:28,359 - app.modules.menus.application.services.area_service - INFO - No se encontraron áreas activas para el cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 en la lista simple
2025-12-04 09:00:28,359 - app.modules.menus.presentation.endpoints_areas - INFO - Lista simple de áreas recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 0 áreas activas
2025-12-04 09:00:28,360 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 32.7ms
2025-12-04 09:00:29,437 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/sessions/admin/
2025-12-04 09:00:29,438 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/sessions/admin/ 200 0.6ms
2025-12-04 09:00:29,440 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/sessions/admin/
2025-12-04 09:00:29,441 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/sessions/admin/ 200 0.7ms
2025-12-04 09:00:29,441 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/sessions/admin/
2025-12-04 09:00:29,441 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:29,441 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:29,441 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:29,441 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:29,442 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:29,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:29,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:29,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:29,455 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:29,455 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:29,455 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/sessions/admin/
2025-12-04 09:00:29,473 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:29,479 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Solicitud /sessions/admin/ por usuario: admin_innova
2025-12-04 09:00:29,482 - app.modules.auth.application.services.refresh_token_service - INFO - [ADMIN-SESSIONS] 1 sesiones activas recuperadas - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:29,482 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Recuperadas 1 sesiones activas totales.
2025-12-04 09:00:29,482 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/sessions/admin/ 200 45.4ms
2025-12-04 09:00:29,482 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/sessions/admin/
2025-12-04 09:00:29,482 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:29,482 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:29,482 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:29,482 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:29,482 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:29,482 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:29,492 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:29,492 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:29,497 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:29,497 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:29,498 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/sessions/admin/
2025-12-04 09:00:29,512 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:29,519 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Solicitud /sessions/admin/ por usuario: admin_innova
2025-12-04 09:00:29,519 - app.modules.auth.application.services.refresh_token_service - INFO - [ADMIN-SESSIONS] 1 sesiones activas recuperadas - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:29,519 - app.modules.auth.presentation.endpoints - INFO - [ADMIN] Recuperadas 1 sesiones activas totales.
2025-12-04 09:00:29,519 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/sessions/admin/ 200 33.7ms
2025-12-04 09:00:32,507 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 09:00:32,509 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:32,509 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:32,510 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:32,510 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:32,510 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:32,514 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 09:00:32,514 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:32,514 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:32,515 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:32,515 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:32,515 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:32,516 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:32,516 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:32,516 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:32,523 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:32,523 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:32,523 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:32,523 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:32,523 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:32,523 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 09:00:32,523 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:32,523 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:32,523 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 09:00:32,552 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:32,553 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:32,557 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:32,557 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: page=1, limit=10, search='None'
2025-12-04 09:00:32,557 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:32,558 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 para lista simple
2025-12-04 09:00:32,558 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:32,562 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:32,562 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 3
2025-12-04 09:00:32,562 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:32,565 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 50.9ms
2025-12-04 09:00:32,568 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 09:00:32,569 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:32,569 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:32,569 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:32,569 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:32,569 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:32,573 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 09:00:32,573 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 09:00:32,574 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 3, Página: 1
2025-12-04 09:00:32,574 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 66.1ms
2025-12-04 09:00:32,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:32,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:32,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:32,579 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 09:00:32,580 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:00:32,580 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:00:32,580 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:32,580 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:32,580 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:32,584 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:32,584 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:32,585 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 09:00:32,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:00:32,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:00:32,587 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:00:32,594 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:32,595 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:00:32,595 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 09:00:32,609 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:32,615 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 para lista simple
2025-12-04 09:00:32,615 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:32,616 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:32,616 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:00:32,616 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 3
2025-12-04 09:00:32,616 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 53.1ms
2025-12-04 09:00:32,622 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 726d3aed-dff3-4ee0-8084-4e2e4fecdedf del cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:00:32,622 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60: page=1, limit=10, search='None'
2025-12-04 09:00:32,622 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:32,622 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:00:32,632 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 09:00:32,633 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 09:00:32,633 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60 - Total: 3, Página: 1
2025-12-04 09:00:32,633 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 54.5ms
2025-12-04 09:04:17,630 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-12-04 09:04:17,630 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:04:17,630 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:04:17,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,634 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,634 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,634 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,638 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,638 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:04:17,639 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/login/
2025-12-04 09:04:17,644 - app.modules.auth.presentation.endpoints - INFO - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43 resuelto y validado para login.
2025-12-04 09:04:17,645 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Intento de login: username='admin_acme', cliente_id_destino=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,645 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,856 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558: level=4, super_admin=False, type=tenant_admin
2025-12-04 09:04:17,859 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Login exitoso: username='admin_acme', usuario_id=2458D1EA-816B-4C3C-8D13-B90271F59558, cliente_origen=ee7bfc14-995f-4209-b4b9-99c307534a43, cliente_destino=N/A, access_level=4, user_type=tenant_admin
2025-12-04 09:04:17,859 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:17,861 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558: level=4, super_admin=False, type=tenant_admin
2025-12-04 09:04:17,867 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43, Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558, Tipo: web, Token ID: A7BBC941-E5F9-4AC0-BBEE-4E4F3753D6FF, Rotación: False
2025-12-04 09:04:17,867 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: A7BBC941-E5F9-4AC0-BBEE-4E4F3753D6FF
2025-12-04 09:04:17,867 - app.modules.auth.presentation.endpoints - INFO - Usuario admin_acme autenticado exitosamente (WEB) para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,871 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, usuario_id=2458D1EA-816B-4C3C-8D13-B90271F59558, exito=True
2025-12-04 09:04:17,871 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 241.6ms
2025-12-04 09:04:17,881 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:04:17,881 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:04:17,882 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:04:17,882 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,882 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,882 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,886 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,887 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,889 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:04:17,889 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:04:17,893 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:04:17,893 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,893 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,893 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,897 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 09:04:17,897 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 09:04:17,899 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:04:17,899 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:04:17,899 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,901 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:04:17,901 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:04:17,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,902 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,903 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,904 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:04:17,904 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/clientes/tenant/branding
2025-12-04 09:04:17,906 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,906 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,906 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,913 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,913 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,914 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,914 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,915 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,915 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,918 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,918 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:04:17,918 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/menus/getmenu/
2025-12-04 09:04:17,926 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,926 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:04:17,926 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 09:04:17,927 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,928 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:04:17,928 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 09:04:17,951 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43 por usuario: admin_acme
2025-12-04 09:04:17,951 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,962 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,963 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 83.2ms
2025-12-04 09:04:17,971 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:17,972 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,972 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 2458d1ea-816b-4c3c-8d13-b90271f59558
2025-12-04 09:04:17,973 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:17,980 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 09:04:17,980 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:17,981 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 5 items raíz.
2025-12-04 09:04:17,982 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 con 5 items raíz.
2025-12-04 09:04:17,983 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 90.8ms
2025-12-04 09:04:17,984 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:04:17,984 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 09:04:17,984 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:17,986 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:04:17,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:04:17,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:04:17,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,991 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:17,991 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 09:04:17,993 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 95.5ms
2025-12-04 09:04:17,996 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:17,996 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:17,996 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:17,999 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-12-04 09:04:17,999 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:04:18,000 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:04:18,000 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:18,000 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:18,000 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:18,001 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:18,006 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:18,006 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:04:18,006 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/menus/getmenu/
2025-12-04 09:04:18,007 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:18,007 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:18,007 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:18,011 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 09:04:18,011 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 09:04:18,011 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 09:04:18,013 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 114.2ms
2025-12-04 09:04:18,014 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-12-04 09:04:18,016 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:04:18,016 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:04:18,016 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:18,016 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:18,017 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:18,019 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:18,019 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:04:18,019 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/roles/all-active/
2025-12-04 09:04:18,025 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:04:18,025 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:04:18,025 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:04:18,031 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:18,031 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:04:18,031 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/usuarios/
2025-12-04 09:04:18,040 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:18,040 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 2458d1ea-816b-4c3c-8d13-b90271f59558
2025-12-04 09:04:18,049 - app.modules.menus.application.services.menu_helper - INFO - Árbol de menú construido con 5 items raíz.
2025-12-04 09:04:18,049 - app.modules.menus.application.services.menu_service - INFO - Árbol de menú construido para usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 con 5 items raíz.
2025-12-04 09:04:18,049 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:18,054 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 67.5ms
2025-12-04 09:04:18,058 - app.modules.rbac.presentation.endpoints - INFO - Solicitud GET /roles/all-active/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 para lista simple
2025-12-04 09:04:18,058 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:18,065 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:18,066 - app.modules.rbac.application.services.rol_service - INFO - Se encontraron 3 roles activos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:04:18,066 - app.modules.rbac.presentation.endpoints - INFO - Lista simple de roles activos recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3
2025-12-04 09:04:18,066 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 67.4ms
2025-12-04 09:04:18,069 - app.modules.users.presentation.endpoints - INFO - Solicitud GET /usuarios/ recibida por usuario 2458d1ea-816b-4c3c-8d13-b90271f59558 del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-12-04 09:04:18,069 - app.modules.users.application.services.user_service - INFO - Obteniendo usuarios paginados para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: page=1, limit=10, search='None'
2025-12-04 09:04:18,069 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:18,071 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:04:18,077 - app.modules.users.application.services.user_service - INFO - [USUARIOS-PAGINADOS] Procesados 3 usuarios únicos de 3 filas crudas
2025-12-04 09:04:18,077 - app.modules.users.application.services.user_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-12-04 09:04:18,077 - app.modules.users.presentation.endpoints - INFO - Lista paginada de usuarios recuperada para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - Total: 3, Página: 1
2025-12-04 09:04:18,079 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 63.7ms
2025-12-04 09:06:03,680 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-12-04 09:06:03,681 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.5ms
2025-12-04 09:06:03,682 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-12-04 09:06:03,682 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:03,682 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:06:03,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:06:03,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:03,683 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:06:03,686 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:06:03,686 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:03,686 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:06:03,690 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:06:03,690 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:06:03,690 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/logout/
2025-12-04 09:06:03,697 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43, Usuario 2458D1EA-816B-4C3C-8D13-B90271F59558
2025-12-04 09:06:03,697 - app.modules.auth.presentation.endpoints - INFO - [LOGOUT-WEB] Token no encontrado en BD (ya expirado/revocado) - Cliente: ee7bfc14-995f-4209-b4b9-99c307534a43, Usuario: 2458D1EA-816B-4C3C-8D13-B90271F59558 (admin_acme)
2025-12-04 09:06:03,701 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=logout, cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, usuario_id=2458D1EA-816B-4C3C-8D13-B90271F59558, exito=True
2025-12-04 09:06:03,701 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 19.5ms
2025-12-04 09:06:25,504 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-12-04 09:06:25,504 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.4ms
2025-12-04 09:06:25,505 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:06:25,506 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/login/
2025-12-04 09:06:25,512 - app.modules.auth.presentation.endpoints - INFO - Cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 resuelto y validado para login.
2025-12-04 09:06:25,512 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,513 - app.modules.auth.application.services.auth_service - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7), accediendo a cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,728 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:06:25,728 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, cliente_origen=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, cliente_destino=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, access_level=5, user_type=super_admin
2025-12-04 09:06:25,728 - app.modules.auth.presentation.endpoints - INFO - [LOGIN] Superadmin accediendo a cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,728 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:06:25,738 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web, Token ID: 401D80E9-16AF-484F-969A-25DF7F6307EE, Rotación: False
2025-12-04 09:06:25,738 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: 401D80E9-16AF-484F-969A-25DF7F6307EE
2025-12-04 09:06:25,738 - app.modules.auth.presentation.endpoints - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,743 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:06:25,744 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 237.9ms
2025-12-04 09:06:25,748 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-12-04 09:06:25,748 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.5ms
2025-12-04 09:06:25,753 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:06:25,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:25,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:06:25,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:25,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:25,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:25,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:25,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:25,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:25,754 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,754 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:06:25,754 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:06:25,768 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-04 09:06:25,768 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.8ms
2025-12-04 09:06:25,771 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-04 09:06:25,772 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.9ms
2025-12-04 09:06:25,773 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:06:25,775 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:25,775 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:06:25,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:25,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:25,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:25,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:25,775 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:25,776 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:25,776 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,776 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:06:25,776 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:06:25,788 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:06:25,788 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,796 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,796 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 43.4ms
2025-12-04 09:06:25,803 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,803 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:06:25,806 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:06:25,808 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 34.0ms
2025-12-04 09:06:25,809 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:06:25,810 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:25,810 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:06:25,810 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:25,810 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:25,810 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:25,811 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:25,811 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:25,811 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:25,811 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,812 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:06:25,812 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:06:25,829 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:25,829 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:06:25,832 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:06:25,833 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 23.1ms
2025-12-04 09:06:27,566 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-12-04 09:06:27,568 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-12-04 09:06:27,568 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.3ms
2025-12-04 09:06:27,569 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.2ms
2025-12-04 09:06:27,570 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:06:27,571 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:27,571 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:06:27,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:27,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:27,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:27,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:27,571 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:27,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:27,572 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:27,572 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:06:27,572 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:06:27,589 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:06:27,590 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:06:27,599 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:06:27,599 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 29.1ms
2025-12-04 09:06:27,601 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:06:27,601 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:27,601 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:06:27,601 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:27,601 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:27,601 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:27,602 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:27,602 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:27,602 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:27,602 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:27,602 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:06:27,602 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:06:27,621 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:06:27,621 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:06:27,626 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:06:27,628 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 26.9ms
2025-12-04 09:06:35,595 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:06:35,596 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 0.5ms
2025-12-04 09:06:35,597 - app.main - INFO - [SYSTEM] 127.0.0.1 -> PUT /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:06:35,597 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:35,597 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:06:35,598 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:35,598 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:35,598 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:35,598 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:35,598 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:35,598 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:35,598 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:35,599 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:06:35,599 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:06:35,720 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud PUT /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida para actualizar por usuario: superadmin
2025-12-04 09:06:35,720 - app.modules.tenant.application.services.cliente_service - INFO - Actualizando cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:06:35,742 - app.modules.tenant.application.services.cliente_service - INFO - Cliente ID ee7bfc14-995f-4209-b4b9-99c307534a43 actualizado exitosamente.
2025-12-04 09:06:35,742 - app.modules.tenant.presentation.endpoints_clientes - INFO - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43 actualizado exitosamente
2025-12-04 09:06:35,742 - app.main - INFO - [SYSTEM] 127.0.0.1 <- PUT /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 149.8ms
2025-12-04 09:06:35,751 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:06:35,751 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:35,751 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:06:35,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:35,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:35,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:35,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:35,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:35,752 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:35,752 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:35,753 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:06:35,753 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:06:35,771 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:06:35,771 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:06:35,771 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:06:35,771 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 26.3ms
2025-12-04 09:06:44,919 - app.main - INFO - [SYSTEM] 127.0.0.1 -> PUT /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:06:44,919 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:44,919 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:06:44,919 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:44,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:44,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:44,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:44,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:44,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:44,920 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:44,920 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:06:44,921 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:06:44,938 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud PUT /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida para actualizar por usuario: superadmin
2025-12-04 09:06:44,938 - app.modules.tenant.application.services.cliente_service - INFO - Actualizando cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:06:44,948 - app.modules.tenant.application.services.cliente_service - INFO - Cliente ID ee7bfc14-995f-4209-b4b9-99c307534a43 actualizado exitosamente.
2025-12-04 09:06:44,948 - app.modules.tenant.presentation.endpoints_clientes - INFO - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43 actualizado exitosamente
2025-12-04 09:06:44,948 - app.main - INFO - [SYSTEM] 127.0.0.1 <- PUT /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 38.4ms
2025-12-04 09:06:44,960 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:06:44,960 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:06:44,960 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:06:44,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:44,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:44,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:44,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:06:44,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:06:44,961 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:06:44,962 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:06:44,962 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:06:44,962 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:06:44,980 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:06:44,981 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:06:44,986 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:06:44,986 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 27.0ms
2025-12-04 09:07:06,421 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/NaN/
2025-12-04 09:07:06,422 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/NaN/ 200 1.0ms
2025-12-04 09:07:06,423 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:07:06,423 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/NaN/
2025-12-04 09:07:06,425 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:07:06,425 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/NaN/estadisticas/ 200 1.5ms
2025-12-04 09:07:06,425 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/NaN/ 200 1.4ms
2025-12-04 09:07:06,426 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/NaN/estadisticas/ 200 1.0ms
2025-12-04 09:07:06,427 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:07:06,428 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:07:06,429 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:07:06,429 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:07:06,429 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:07:06,429 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:07:06,429 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:07:06,429 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:07:06,429 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:07:06,429 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:07:06,430 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:07:06,431 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:07:06,433 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:07:06,434 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:07:06,434 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:07:06,434 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:07:06,434 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:07:06,434 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:07:06,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:07:06,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:07:06,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:07:06,435 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:07:06,435 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:07:06,435 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:07:06,467 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:07:06,468 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:07:06,468 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 35.4ms
2025-12-04 09:07:06,468 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 42.2ms
2025-12-04 09:07:06,468 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:07:06,468 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:07:06,473 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:07:06,473 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:07:06,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:07:06,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:07:06,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:07:06,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:07:06,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:07:06,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:07:06,474 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:07:06,474 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:07:06,474 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:07:06,475 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:07:06,476 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:07:06,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:07:06,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:07:06,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:07:06,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:07:06,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:07:06,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:07:06,477 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:07:06,477 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:07:06,477 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:07:06,502 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:07:06,503 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:07:06,503 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 31.3ms
2025-12-04 09:07:06,504 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 30.9ms
2025-12-04 09:12:31,463 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-04 09:12:31,464 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.5ms
2025-12-04 09:12:31,465 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:31,466 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,466 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,466 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,467 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,467 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,467 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,467 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,467 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,468 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,468 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:12:31,475 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:12:31,478 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:12:31,481 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:12:31,490 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web, Token ID: B0210153-06B2-4E38-928D-69ABBD089C3C, Rotación: True
2025-12-04 09:12:31,493 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E
2025-12-04 09:12:31,493 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-04 09:12:31,493 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: B0210153-06B2-4E38-928D-69ABBD089C3C
2025-12-04 09:12:31,494 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:12:31,497 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:12:31,498 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 32.2ms
2025-12-04 09:12:31,503 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-12-04 09:12:31,503 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.6ms
2025-12-04 09:12:31,503 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,503 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:12:31,511 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:12:31,511 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:12:31,511 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:12:31,511 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:12:31,522 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:12:31,522 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:12:31,523 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 18.5ms
2025-12-04 09:12:31,529 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:12:31,529 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,529 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,530 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,530 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,530 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,530 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,530 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,530 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,530 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,531 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,531 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:12:31,554 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:12:31,554 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,557 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,559 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:31,559 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:31,561 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,563 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,563 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,563 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,563 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,563 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,563 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,563 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,563 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,563 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,563 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:31,568 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:12:31,568 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,576 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,582 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 52.8ms
2025-12-04 09:12:31,617 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,617 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:12:31,618 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:31,619 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 62.5ms
2025-12-04 09:12:31,621 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:31,622 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,622 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,622 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,622 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,622 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,623 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,623 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,623 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,623 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,623 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,623 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:31,624 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:31,626 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 64.9ms
2025-12-04 09:12:31,629 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:31,630 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,630 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,632 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,632 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,632 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:31,634 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:12:31,635 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 79.6ms
2025-12-04 09:12:31,639 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:12:31,639 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,641 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,641 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,641 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,641 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,641 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,641 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,641 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,641 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,641 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,641 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:12:31,685 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:31,686 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:31,687 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 66.2ms
2025-12-04 09:12:31,687 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 59.1ms
2025-12-04 09:12:31,691 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,691 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:12:31,693 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:12:31,693 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 57.0ms
2025-12-04 09:12:31,917 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:31,917 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,918 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,919 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,919 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,919 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,919 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,920 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,920 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,920 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:12:31,926 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:12:31,929 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:12:31,936 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:12:31,936 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN-ROTATION] Token ya existe en BD (doble refresh detectado) - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Token ID: B0210153-06B2-4E38-928D-69ABBD089C3C
2025-12-04 09:12:31,936 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: B0210153-06B2-4E38-928D-69ABBD089C3C
2025-12-04 09:12:31,936 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:12:31,943 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:12:31,943 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 28.7ms
2025-12-04 09:12:31,950 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:12:31,950 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,951 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,951 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,951 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,952 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,953 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,953 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,953 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,953 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:12:31,958 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:12:31,959 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:12:31,959 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:12:31,959 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:12:31,971 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:12:31,971 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:12:31,974 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 23.5ms
2025-12-04 09:12:31,974 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:31,974 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:12:32,000 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:12:32,004 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:32,004 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:32,004 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,005 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,005 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:32,005 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:32,005 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:12:32,008 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:32,008 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:32,009 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:32,009 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:32,009 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,010 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,010 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,010 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,010 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,010 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,010 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:32,010 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:32,011 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:32,011 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:32,011 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:32,011 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,011 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,012 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,012 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,012 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,012 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,012 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:32,012 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:32,012 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:32,021 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:12:32,022 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:32,043 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:32,043 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 67.0ms
2025-12-04 09:12:32,073 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:32,073 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:12:32,073 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:32,073 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:32,073 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 70.3ms
2025-12-04 09:12:32,073 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 70.9ms
2025-12-04 09:12:32,073 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:32,082 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:32,082 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:32,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,084 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,084 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,084 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,084 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:32,084 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:32,085 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:32,087 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:32,088 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:32,088 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:32,088 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,090 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,090 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,090 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,090 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,090 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,091 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:32,091 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:32,091 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:32,093 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:12:32,095 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 94.9ms
2025-12-04 09:12:32,095 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:12:32,099 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:32,100 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:32,100 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,100 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,100 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,100 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:32,100 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,102 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:32,102 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:32,102 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:32,102 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:12:32,147 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:32,149 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 67.7ms
2025-12-04 09:12:32,154 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:32,155 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 67.6ms
2025-12-04 09:12:32,159 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:32,159 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:12:32,163 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:12:32,163 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 65.5ms
2025-12-04 09:12:32,373 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-04 09:12:32,373 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.6ms
2025-12-04 09:12:32,373 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:32,379 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:32,379 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:12:32,379 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:12:32,379 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,379 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:12:32,385 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:12:32,385 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,385 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:12:32,388 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-12-04 09:12:32,389 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 1.2ms
2025-12-04 09:12:32,390 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:32,390 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:32,390 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:12:32,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:12:32,390 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,393 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:12:32,393 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:12:32,393 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:12:32,393 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:12:32,401 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:12:32,401 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:32,402 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:12:32,406 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:12:32,407 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:12:32,407 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:12:32,407 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:12:32,407 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:12:32,413 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:12:32,413 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:12:32,413 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:12:32,417 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 38.5ms
2025-12-04 09:12:32,421 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:12:32,421 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 29.9ms
2025-12-04 09:12:34,505 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:34,506 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:34,506 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:34,506 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,507 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,507 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,508 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,508 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,508 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,508 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,508 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:34,508 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:12:34,513 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:12:34,517 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:12:34,521 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:12:34,528 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web, Token ID: AC5CBB5F-2EEA-469C-A28B-29CECCFBEC95, Rotación: True
2025-12-04 09:12:34,531 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E
2025-12-04 09:12:34,531 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-04 09:12:34,531 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: AC5CBB5F-2EEA-469C-A28B-29CECCFBEC95
2025-12-04 09:12:34,531 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:12:34,534 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:12:34,536 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 30.5ms
2025-12-04 09:12:34,539 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:34,539 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:12:34,543 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:12:34,543 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:12:34,543 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:12:34,543 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:12:34,554 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:12:34,554 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:12:34,555 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 14.7ms
2025-12-04 09:12:34,559 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:12:34,559 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:34,560 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:34,560 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,560 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,560 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,560 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,560 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,561 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,561 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,561 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:34,561 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:12:34,572 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:12:34,572 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:34,572 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:34,574 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:34,574 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:34,574 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,574 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,574 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,574 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,575 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,575 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:34,575 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:12:34,576 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:34,577 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:34,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,578 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,578 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:34,578 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:34,578 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:34,578 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:34,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,579 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,579 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:34,580 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:34,604 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:12:34,605 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,613 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,613 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 56.8ms
2025-12-04 09:12:34,621 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:34,623 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 51.2ms
2025-12-04 09:12:34,624 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:34,625 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 52.5ms
2025-12-04 09:12:34,626 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:34,628 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:34,628 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:34,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,628 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,629 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:34,629 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:34,629 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:34,630 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:34,630 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:34,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,631 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,631 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,632 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:34,632 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:34,634 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,634 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:12:34,643 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:12:34,643 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 73.4ms
2025-12-04 09:12:34,643 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:34,643 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:12:34,676 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:34,676 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:34,676 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 49.9ms
2025-12-04 09:12:34,676 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 47.5ms
2025-12-04 09:12:34,683 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:34,683 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:12:34,689 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:12:34,689 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 45.6ms
2025-12-04 09:12:35,081 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:35,083 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,083 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,083 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,083 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,083 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,085 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:12:35,092 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:12:35,099 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:12:35,103 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:12:35,113 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web, Token ID: B9241238-7ACA-4D5C-823E-E60E7065B3B2, Rotación: True
2025-12-04 09:12:35,115 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E
2025-12-04 09:12:35,115 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-04 09:12:35,115 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: B9241238-7ACA-4D5C-823E-E60E7065B3B2
2025-12-04 09:12:35,120 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:12:35,126 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:12:35,127 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 44.7ms
2025-12-04 09:12:35,138 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:12:35,138 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,139 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,139 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,139 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,139 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,140 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,140 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,140 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,140 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,140 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,140 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:12:35,147 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:12:35,147 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:12:35,147 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:12:35,147 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:12:35,164 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:12:35,164 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:12:35,165 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 26.7ms
2025-12-04 09:12:35,177 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:12:35,177 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,177 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,177 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,178 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,178 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,178 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,178 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,178 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,178 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,178 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,178 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:12:35,187 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:12:35,193 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:35,193 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:35,193 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,193 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,193 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,193 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,193 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,193 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,195 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,195 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,195 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,195 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,195 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:12:35,195 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,198 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,198 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,198 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,198 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,198 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,201 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:35,239 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:12:35,239 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,249 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,259 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 82.9ms
2025-12-04 09:12:35,263 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,263 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:12:35,265 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:35,265 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 74.9ms
2025-12-04 09:12:35,275 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:35,276 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,276 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,276 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,276 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,276 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,277 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,277 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,277 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,278 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:35,280 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:35,283 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 90.6ms
2025-12-04 09:12:35,283 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:35,283 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,283 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:12:35,283 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:12:35,288 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,291 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:12:35,295 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:12:35,295 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:35,297 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,297 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:12:35,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:12:35,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,298 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:12:35,300 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:35,302 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,302 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,302 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,302 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,302 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,302 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,302 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,302 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,302 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,303 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,303 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:35,304 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 116.2ms
2025-12-04 09:12:35,306 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,306 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:12:35,316 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:12:35,316 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,316 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:12:35,330 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:12:35,330 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,330 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:12:35,343 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:12:35,343 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:12:35,343 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:12:35,343 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:12:35,343 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:12:35,343 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:12:35,362 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:12:35,362 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:12:35,366 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:12:35,366 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:12:35,375 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:35,378 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 104.4ms
2025-12-04 09:12:35,380 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:12:35,383 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 98.2ms
2025-12-04 09:12:35,386 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,386 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:12:35,386 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:12:35,390 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 94.8ms
2025-12-04 09:12:35,393 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:35,394 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 93.3ms
2025-12-04 09:12:35,395 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:12:35,397 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 87.7ms
2025-12-04 09:12:35,666 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,666 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:12:35,674 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:12:35,677 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:12:35,683 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:12:35,688 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN-ROTATION] Token ya existe en BD (doble refresh detectado) - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Token ID: B9241238-7ACA-4D5C-823E-E60E7065B3B2
2025-12-04 09:12:35,688 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: B9241238-7ACA-4D5C-823E-E60E7065B3B2
2025-12-04 09:12:35,688 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:12:35,694 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:12:35,694 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 29.9ms
2025-12-04 09:12:35,694 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,694 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:12:35,706 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:12:35,706 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:12:35,706 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:12:35,706 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:12:35,713 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:12:35,713 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:12:35,713 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 17.1ms
2025-12-04 09:12:35,721 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:12:35,722 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,722 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,722 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,723 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,723 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,723 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,723 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,723 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,723 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:12:35,734 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:35,734 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:12:35,735 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:35,735 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,736 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,736 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,736 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,736 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,736 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,736 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,736 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,737 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,737 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,737 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:35,737 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,738 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,738 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,740 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,740 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,740 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,742 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:12:35,744 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,744 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,744 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,744 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,745 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,745 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,745 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:35,778 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:12:35,779 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,793 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,793 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 75.8ms
2025-12-04 09:12:35,793 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:35,793 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,793 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:12:35,793 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 68.6ms
2025-12-04 09:12:35,806 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:35,807 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,808 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,808 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,808 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,808 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,808 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,808 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,808 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,808 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,809 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,809 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:35,811 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:35,811 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 76.7ms
2025-12-04 09:12:35,814 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:12:35,815 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:35,815 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,815 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,815 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,815 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,817 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,817 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,817 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,817 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,817 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,817 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,817 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:35,818 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 84.7ms
2025-12-04 09:12:35,825 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:12:35,826 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:35,826 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:35,826 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,826 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:35,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:35,828 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:35,828 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,828 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:35,829 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:12:35,857 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:35,863 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 59.4ms
2025-12-04 09:12:35,863 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:35,863 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 53.9ms
2025-12-04 09:12:35,871 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:35,871 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:12:35,876 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:12:35,877 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 51.3ms
2025-12-04 09:12:36,229 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:36,229 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:36,229 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:12:36,229 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:12:36,229 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:36,229 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:12:36,235 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:12:36,235 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:36,235 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:12:36,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:12:36,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:36,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:12:36,248 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:12:36,248 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:36,248 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:12:36,250 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:12:36,251 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:36,251 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:12:36,260 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:12:36,260 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:12:36,261 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:12:36,263 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:12:36,263 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:12:36,264 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:12:36,271 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:12:36,271 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:12:36,275 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:12:36,275 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:12:36,276 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:36,278 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:36,280 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:36,280 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:36,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:36,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:36,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:36,280 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:36,281 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:36,281 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:36,281 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:36,281 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:36,281 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:36,282 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:36,283 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:36,283 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:36,283 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:36,283 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:36,283 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:36,283 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:36,283 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:36,283 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:36,283 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:36,283 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:36,288 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:12:36,291 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 61.1ms
2025-12-04 09:12:36,296 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:12:36,296 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 64.6ms
2025-12-04 09:12:36,324 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:36,325 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 48.0ms
2025-12-04 09:12:36,327 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:36,327 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 49.0ms
2025-12-04 09:12:40,121 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:40,121 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:40,121 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:40,121 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:40,121 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:40,123 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:40,123 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:40,123 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:40,123 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:40,123 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:40,123 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:40,123 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:40,123 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:40,125 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:40,125 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:40,125 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:40,125 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:40,125 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:40,125 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:40,126 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:40,126 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:40,127 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:40,127 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:40,127 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:40,153 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:40,153 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:40,153 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 32.9ms
2025-12-04 09:12:40,153 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 32.6ms
2025-12-04 09:12:40,873 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:40,873 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:40,873 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:40,873 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:40,873 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:40,873 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:40,873 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:40,873 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:40,873 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:40,873 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:40,876 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:40,876 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:40,876 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:40,877 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:40,877 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:40,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:40,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:40,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:40,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:40,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:40,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:40,878 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:40,878 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:40,879 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:40,896 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:40,896 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 28.6ms
2025-12-04 09:12:40,903 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:40,903 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 30.0ms
2025-12-04 09:12:41,551 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:41,551 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:41,551 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:41,551 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:41,551 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:41,553 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:41,581 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:41,582 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:41,582 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 31.1ms
2025-12-04 09:12:41,582 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 30.8ms
2025-12-04 09:12:42,341 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:42,343 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:42,343 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:42,343 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:42,343 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:42,343 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:42,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:42,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:42,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:42,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:42,344 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:42,344 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:42,344 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:42,346 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:42,346 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:42,347 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:42,347 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:42,347 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:42,347 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:42,347 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:42,347 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:42,347 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:42,348 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:42,348 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:42,366 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:42,366 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:42,373 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 30.0ms
2025-12-04 09:12:42,373 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 30.7ms
2025-12-04 09:12:43,095 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:43,096 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:43,096 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:43,096 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:43,096 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:43,096 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:43,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:43,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:43,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:43,097 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:43,097 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:43,097 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:43,098 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:43,099 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:43,099 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:43,099 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:43,099 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:43,100 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:43,100 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:43,100 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:43,100 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:43,100 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:43,100 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:43,100 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:43,123 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:43,123 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:43,123 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 29.4ms
2025-12-04 09:12:43,123 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 29.0ms
2025-12-04 09:12:43,753 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:12:43,753 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:12:43,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:12:43,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:43,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:43,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:43,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:12:43,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:12:43,760 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:12:43,760 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:12:43,760 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:12:43,760 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:12:43,783 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:43,783 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:12:43,783 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 31.1ms
2025-12-04 09:12:43,783 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 31.8ms
2025-12-04 09:13:10,986 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:10,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:10,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:10,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:10,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:10,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:10,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:10,988 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:10,988 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:10,988 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:10,988 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:10,988 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:13:10,996 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:13:10,999 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:13:11,003 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:13:11,041 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web, Token ID: 6BD1C3E0-F37C-425A-BD82-E4689130C395, Rotación: True
2025-12-04 09:13:11,048 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E
2025-12-04 09:13:11,048 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-04 09:13:11,048 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 6BD1C3E0-F37C-425A-BD82-E4689130C395
2025-12-04 09:13:11,048 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:13:11,061 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:13:11,062 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 76.3ms
2025-12-04 09:13:11,072 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:13:11,072 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,074 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,075 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,075 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,077 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,077 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,078 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,078 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,078 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,078 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,078 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:13:11,084 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:13:11,084 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:13:11,085 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:13:11,085 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:13:11,107 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:13:11,108 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:13:11,108 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 36.7ms
2025-12-04 09:13:11,127 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:13:11,128 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,128 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,129 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,130 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,130 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,130 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,130 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,130 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,130 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,131 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,131 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:13:11,142 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:11,143 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:11,144 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:13:11,145 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,145 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,145 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,145 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,145 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,146 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,146 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,146 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,146 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,146 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,146 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:11,147 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,147 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,147 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,147 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,148 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,148 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,148 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,148 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,148 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,148 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,150 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:11,150 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,151 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,151 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,151 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,152 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,152 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,152 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,153 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,153 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,153 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,153 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:13:11,198 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:13:11,198 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,219 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,219 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 93.4ms
2025-12-04 09:13:11,225 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,225 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:11,226 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:11,228 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 86.3ms
2025-12-04 09:13:11,230 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:11,232 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:11,234 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 90.0ms
2025-12-04 09:13:11,234 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,234 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,234 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,235 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,235 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,235 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,236 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:11,239 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:13:11,240 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,242 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,242 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,243 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,243 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,243 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,244 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,244 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,244 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,244 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,244 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:13:11,248 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:11,250 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 106.8ms
2025-12-04 09:13:11,252 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:11,253 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,254 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,254 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,254 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,254 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,254 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,254 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,254 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,255 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,255 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,255 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:11,295 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:11,296 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:11,299 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 66.7ms
2025-12-04 09:13:11,300 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 61.9ms
2025-12-04 09:13:11,306 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,306 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:11,314 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:11,315 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 63.1ms
2025-12-04 09:13:11,319 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:11,319 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,319 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:13:11,319 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:11,319 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,319 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:11,325 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:11,326 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,326 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:13:11,327 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:11,327 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,327 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:11,331 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:11,334 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,334 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:11,334 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:11,334 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,334 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:11,341 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:11,342 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:13:11,342 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:11,343 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:11,343 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:13:11,344 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:11,350 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:11,350 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:11,351 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:11,352 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:11,357 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:11,357 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:11,358 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 33.9ms
2025-12-04 09:13:11,359 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 38.5ms
2025-12-04 09:13:11,591 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:11,592 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,592 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,592 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,593 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,593 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,593 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,593 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,594 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,594 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,594 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,594 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:13:11,601 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:13:11,606 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:13:11,611 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:13:11,616 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN-ROTATION] Token ya existe en BD (doble refresh detectado) - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Token ID: 6BD1C3E0-F37C-425A-BD82-E4689130C395
2025-12-04 09:13:11,616 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 6BD1C3E0-F37C-425A-BD82-E4689130C395
2025-12-04 09:13:11,616 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:13:11,621 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:13:11,621 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 30.2ms
2025-12-04 09:13:11,627 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:13:11,627 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,627 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,627 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,628 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,628 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,628 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,628 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:13:11,632 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:13:11,633 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:13:11,633 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:13:11,633 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:13:11,642 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:13:11,642 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:13:11,643 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 16.7ms
2025-12-04 09:13:11,647 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:13:11,647 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,647 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,647 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,648 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,648 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,648 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,648 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,648 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,648 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,648 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,648 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:13:11,659 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:11,660 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:13:11,661 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:11,661 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,661 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,661 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,661 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,661 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,662 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,662 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,662 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,662 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,662 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,662 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:11,664 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,664 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,664 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,665 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,665 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,665 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,665 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,665 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,665 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,665 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,665 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:13:11,666 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,666 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,666 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,666 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,666 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,667 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:11,693 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:13:11,694 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,699 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,702 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 56.3ms
2025-12-04 09:13:11,713 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:11,717 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 56.8ms
2025-12-04 09:13:11,717 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,717 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:11,717 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:11,717 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,717 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,717 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,717 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,724 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,724 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,724 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,724 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,724 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,724 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,724 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:11,728 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:11,729 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 69.1ms
2025-12-04 09:13:11,732 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:13:11,733 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,733 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,733 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,734 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,734 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,734 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,734 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,734 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:13:11,735 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:11,739 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 81.4ms
2025-12-04 09:13:11,748 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:11,748 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:11,750 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:11,750 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,750 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,750 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:11,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:11,751 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:11,751 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,751 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:11,751 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:11,793 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:11,793 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 79.3ms
2025-12-04 09:13:11,804 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:11,804 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 74.6ms
2025-12-04 09:13:11,811 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:11,811 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:11,813 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:11,813 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 68.2ms
2025-12-04 09:13:12,225 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:12,226 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,226 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:13:12,226 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:12,227 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,227 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:12,231 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:12,232 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,234 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:13:12,234 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:12,234 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,234 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:12,245 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:12,247 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,250 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:12,257 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:12,257 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,257 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:12,265 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:12,266 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:13:12,266 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:12,274 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:12,274 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:13:12,274 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:12,277 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:12,277 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:12,288 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:12,289 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:12,291 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:12,292 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 67.4ms
2025-12-04 09:13:12,297 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:12,297 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 65.5ms
2025-12-04 09:13:12,538 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:12,538 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,538 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:12,538 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,539 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,539 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,539 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:12,540 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:13:12,546 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:13:12,552 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:13:12,555 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:13:12,563 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web, Token ID: 34CCAA84-C6D2-4FBA-A42A-BD7CB3AA73BD, Rotación: True
2025-12-04 09:13:12,566 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E
2025-12-04 09:13:12,566 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-04 09:13:12,567 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 34CCAA84-C6D2-4FBA-A42A-BD7CB3AA73BD
2025-12-04 09:13:12,567 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:13:12,571 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:13:12,572 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 33.7ms
2025-12-04 09:13:12,575 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:13:12,575 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,576 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:12,576 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,576 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,576 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,576 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,576 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,576 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,577 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,577 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:12,577 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:13:12,581 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:13:12,582 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:13:12,582 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:13:12,582 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:13:12,589 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:13:12,589 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:13:12,590 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 15.0ms
2025-12-04 09:13:12,594 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:13:12,594 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,594 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:12,594 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,595 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,595 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,595 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,595 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,595 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,595 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,595 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:12,597 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:13:12,603 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:13:12,604 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:12,605 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:12,605 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,605 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:12,605 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,606 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,606 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,606 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,606 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,606 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,606 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,606 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:12,607 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:13:12,607 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,607 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:12,607 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,607 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,607 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,608 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,608 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,608 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,608 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,608 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:12,608 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:12,669 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,674 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:12,674 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,674 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,674 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,674 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,674 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,674 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,674 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,674 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:12,675 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:12,700 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:13:12,700 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,714 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,715 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 121.0ms
2025-12-04 09:13:12,717 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:12,718 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,719 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:12,719 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 114.1ms
2025-12-04 09:13:12,721 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:12,722 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:12,722 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 118.6ms
2025-12-04 09:13:12,722 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,723 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:12,723 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,723 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,723 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,723 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,723 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,723 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,723 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,724 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:12,724 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:12,727 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:13:12,727 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,728 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:12,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,728 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,728 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,729 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:12,729 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:13:12,729 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:12,729 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 129.3ms
2025-12-04 09:13:12,734 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:12,734 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:12,764 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:12,765 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 43.6ms
2025-12-04 09:13:12,767 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:12,770 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 44.0ms
2025-12-04 09:13:12,774 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:12,774 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:12,777 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:12,777 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 43.5ms
2025-12-04 09:13:13,325 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:13,326 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,326 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:13:13,326 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:13,326 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,326 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:13,329 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:13,331 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,331 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:13,331 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,332 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,332 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,333 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:13,333 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:13:13,335 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:13,336 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,336 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:13:13,337 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:13,337 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,337 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:13,343 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:13,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,344 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:13,365 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:13,365 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,366 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:13,368 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:13:13,370 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:13,370 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:13:13,371 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:13,374 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:13,374 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:13:13,374 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:13,378 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:13:13,381 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:13,382 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:13,384 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:13,384 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:13,386 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:13:13,388 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:13,388 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 64.0ms
2025-12-04 09:13:13,393 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:13,394 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 58.1ms
2025-12-04 09:13:13,399 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web, Token ID: 220C7449-F61B-47D8-8ACA-5C8EA0F64890, Rotación: True
2025-12-04 09:13:13,402 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E
2025-12-04 09:13:13,402 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-04 09:13:13,404 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 220C7449-F61B-47D8-8ACA-5C8EA0F64890
2025-12-04 09:13:13,404 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:13:13,408 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:13:13,408 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 79.0ms
2025-12-04 09:13:13,414 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:13:13,414 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,414 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:13,414 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,414 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,415 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,415 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,415 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,415 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,415 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,415 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:13,416 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:13:13,418 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:13:13,419 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:13:13,419 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:13:13,419 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:13:13,429 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:13:13,429 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:13:13,429 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 16.7ms
2025-12-04 09:13:13,434 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:13:13,434 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,434 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:13,434 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,435 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,435 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:13,435 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:13:13,443 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:13,444 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:13,444 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:13:13,445 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,445 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:13,445 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,446 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,446 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,446 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,446 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,446 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,446 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,446 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:13,447 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:13,447 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,447 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:13,447 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,447 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,447 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,448 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,448 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:13,448 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:13,448 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,448 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:13,448 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,450 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,450 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,450 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:13,450 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:13:13,477 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:13:13,477 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,488 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,489 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 55.7ms
2025-12-04 09:13:13,493 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,493 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:13,494 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:13,496 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 52.0ms
2025-12-04 09:13:13,498 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:13,500 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,500 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:13,500 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,500 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,501 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,501 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,501 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,501 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,501 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,501 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:13,501 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:13,503 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:13,504 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 59.4ms
2025-12-04 09:13:13,506 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:13:13,507 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:13,507 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,507 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:13,507 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,507 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,507 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,508 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,508 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,508 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,508 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,508 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:13,508 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:13:13,509 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 67.0ms
2025-12-04 09:13:13,514 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:13,514 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:13,534 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:13,543 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 43.9ms
2025-12-04 09:13:13,544 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:13,547 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 41.7ms
2025-12-04 09:13:13,549 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:13,549 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:13,554 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:13,554 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 41.4ms
2025-12-04 09:13:14,154 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:14,160 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:14,160 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:13:14,160 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:14,160 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:14,161 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:14,164 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:14,165 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:14,165 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:13:14,165 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:14,165 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:14,166 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:14,167 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:14,167 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:14,174 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:14,175 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:14,177 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:14,177 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:14,182 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:14,183 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:13:14,183 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:14,184 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:14,184 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:13:14,184 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:14,184 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:14,184 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:14,184 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:14,184 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:14,197 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:14,198 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 38.5ms
2025-12-04 09:13:14,198 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:14,199 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 35.3ms
2025-12-04 09:13:21,357 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:21,358 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:21,358 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:21,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,360 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,360 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,360 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,360 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:21,360 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:13:21,366 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:13:21,370 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:13:21,374 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:13:21,374 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web, Token ID: 37AF238A-8655-42B0-A922-8FC327EB77FC, Rotación: True
2025-12-04 09:13:21,385 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E
2025-12-04 09:13:21,385 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-04 09:13:21,385 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 37AF238A-8655-42B0-A922-8FC327EB77FC
2025-12-04 09:13:21,386 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:13:21,386 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:13:21,386 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 33.5ms
2025-12-04 09:13:21,394 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:21,394 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:13:21,401 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:13:21,401 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:13:21,401 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:13:21,401 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:13:21,411 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:13:21,411 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:13:21,412 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 17.0ms
2025-12-04 09:13:21,415 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:13:21,415 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:21,416 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:21,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,416 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,417 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,417 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:21,417 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:13:21,426 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:21,427 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:21,427 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:21,427 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,427 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,428 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,428 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,428 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,428 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,428 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,428 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:21,428 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:21,428 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:21,428 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:13:21,430 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:21,430 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:21,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,431 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,431 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,431 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:21,431 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:21,431 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:21,431 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:21,433 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,433 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,433 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,433 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,433 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,433 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,433 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,434 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:21,434 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:13:21,461 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:13:21,461 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,468 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,472 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 57.3ms
2025-12-04 09:13:21,480 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:21,481 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 51.9ms
2025-12-04 09:13:21,481 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,482 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:21,484 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/
2025-12-04 09:13:21,484 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:21,484 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:21,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,484 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,486 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,486 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,486 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:21,486 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/
2025-12-04 09:13:21,488 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:21,489 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 60.6ms
2025-12-04 09:13:21,491 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:21,491 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:21,491 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:21,491 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,491 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,491 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/NaN/estadisticas/
2025-12-04 09:13:21,494 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:21,494 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 70.5ms
2025-12-04 09:13:21,494 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:21,494 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:21,530 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:21,530 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/ 422 49.6ms
2025-12-04 09:13:21,538 - app.core.exceptions - WARNING - RequestValidationError en /api/v1/clientes/NaN/estadisticas/: ["El parámetro 'path.cliente_id' tiene un valor inválido (NaN). Se espera un UUID válido."]
2025-12-04 09:13:21,539 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/NaN/estadisticas/ 422 47.6ms
2025-12-04 09:13:21,542 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:21,542 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:21,546 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:21,546 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 47.9ms
2025-12-04 09:13:22,164 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:22,164 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:22,164 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:13:22,164 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:22,164 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:22,164 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:22,164 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:22,169 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:22,169 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:13:22,169 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:22,169 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:22,169 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:22,174 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:22,174 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:22,174 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:22,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:22,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:22,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:22,186 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:22,187 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:13:22,187 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:22,189 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:22,189 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:13:22,189 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:22,196 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:22,198 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:22,198 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:22,199 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:22,204 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:22,204 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 40.9ms
2025-12-04 09:13:22,206 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:22,206 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 40.5ms
2025-12-04 09:13:24,045 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:13:24,046 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:13:24,046 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:24,046 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:24,047 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:24,047 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:24,047 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:24,047 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:24,047 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:24,047 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:24,047 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:24,048 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:24,048 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:13:24,050 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 3.7ms
2025-12-04 09:13:24,053 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:13:24,053 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:24,054 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:24,054 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:24,054 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:24,054 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:24,055 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:24,055 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:24,055 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:24,055 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:24,055 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:24,056 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:13:24,082 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:13:24,085 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:13:24,085 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:24,089 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 43.3ms
2025-12-04 09:13:24,109 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:24,110 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 57.7ms
2025-12-04 09:13:39,382 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:39,384 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,384 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:39,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,384 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,384 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,386 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:39,386 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/refresh/
2025-12-04 09:13:39,393 - app.modules.auth.application.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web
2025-12-04 09:13:39,397 - app.modules.auth.application.services.auth_service - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Level: 5, Type: super_admin)
2025-12-04 09:13:39,397 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:13:39,404 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web, Token ID: 608629DE-D259-42C9-BA64-DF3ECAEA2922, Rotación: True
2025-12-04 09:13:39,414 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E
2025-12-04 09:13:39,414 - app.modules.auth.presentation.endpoints - WARNING - [REFRESH] Token antiguo no encontrado para revocar (no crítico)
2025-12-04 09:13:39,414 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token rotado exitosamente - ID: 608629DE-D259-42C9-BA64-DF3ECAEA2922
2025-12-04 09:13:39,414 - app.modules.auth.presentation.endpoints - INFO - [REFRESH-WEB] Token refrescado exitosamente - Usuario: superadmin
2025-12-04 09:13:39,425 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_refresh, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:13:39,425 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 42.1ms
2025-12-04 09:13:39,430 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:39,430 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/me/
2025-12-04 09:13:39,437 - app.modules.auth.presentation.endpoints - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-12-04 09:13:39,437 - app.modules.auth.presentation.endpoints - INFO - [ME] Niveles desde token - Level: 5, Super Admin: True, Type: super_admin
2025-12-04 09:13:39,437 - app.modules.users.application.services.user_service - INFO - Obteniendo usuario completo ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E para cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7
2025-12-04 09:13:39,437 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:13:39,444 - app.modules.users.application.services.user_service - INFO - Usuario completo obtenido exitosamente: ID 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E con 1 roles activos
2025-12-04 09:13:39,444 - app.modules.auth.presentation.endpoints - INFO - [ME] Datos completos enviados - Usuario: superadmin, Type: super_admin, Level: 5, Super Admin: True, Roles: 1
2025-12-04 09:13:39,444 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 19.3ms
2025-12-04 09:13:39,456 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:39,456 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:13:39,470 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:39,472 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:13:39,472 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:13:39,472 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,473 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:39,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,473 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,474 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,474 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:39,474 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:39,475 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,475 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:39,475 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,475 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,475 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,476 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,476 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,476 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:39,476 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:13:39,477 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,477 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:39,477 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,477 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,477 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,477 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,477 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,477 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,478 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,478 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:39,478 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:13:39,505 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:13:39,505 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,505 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:39,505 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,505 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': acme.app.local:5173
2025-12-04 09:13:39,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:39,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:39,514 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-12-04 09:13:39,514 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,514 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': innova.app.local:5173
2025-12-04 09:13:39,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:39,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,514 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:39,524 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,524 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 71.1ms
2025-12-04 09:13:39,524 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.app.local'
2025-12-04 09:13:39,524 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,524 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-12-04 09:13:39,524 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.app.local'
2025-12-04 09:13:39,524 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,524 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-12-04 09:13:39,544 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:39,544 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC
2025-12-04 09:13:39,544 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=ee7bfc14-995f-4209-b4b9-99c307534a43, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_acme, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:39,544 - app.core.tenant.middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:39,544 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC
2025-12-04 09:13:39,544 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=a4fc62c0-6d3b-4fa3-b5ee-6294343daf60, tipo_instalacion=dedicated, db_type=multi, bd=bd_cliente_innova, servidor=CARLOSPC, path=/api/v1/auth/refresh/
2025-12-04 09:13:39,544 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:13:39,553 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,553 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:39,555 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:13:39,555 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:39,555 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:39,555 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:39,555 - app.modules.auth.application.services.refresh_token_service - WARNING - [VALIDATE-TOKEN] Token no encontrado, revocado o expirado - Cliente a4fc62c0-6d3b-4fa3-b5ee-6294343daf60
2025-12-04 09:13:39,555 - app.modules.auth.application.services.auth_service - WARNING - [REFRESH] Token JWT válido, pero inactivo/revocado en BD. Usuario: superadmin
2025-12-04 09:13:39,564 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:39,564 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 94.9ms
2025-12-04 09:13:39,564 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:13:39,564 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 97.1ms
2025-12-04 09:13:39,564 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,570 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:39,570 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,570 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,570 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,570 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,570 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,570 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,570 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,571 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:39,571 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:13:39,574 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:13:39,575 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,575 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:39,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,576 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,576 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,576 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:39,576 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:13:39,578 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:39,578 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=token_invalid_or_revoked, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=None, exito=False
2025-12-04 09:13:39,580 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 71.9ms
2025-12-04 09:13:39,581 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 66.7ms
2025-12-04 09:13:39,597 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:39,597 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 126.2ms
2025-12-04 09:13:39,600 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:13:39,600 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:13:39,600 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:13:39,600 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,600 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,600 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,600 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:13:39,600 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:13:39,600 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:13:39,600 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,602 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:13:39,603 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:13:39,614 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:13:39,614 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:13:39,614 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:13:39,624 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:13:39,624 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 51.4ms
2025-12-04 09:13:39,624 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 57.4ms
2025-12-04 09:13:39,634 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:13:39,634 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:39,646 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:13:39,647 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 47.2ms
2025-12-04 09:14:00,366 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:14:00,367 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:00,367 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:00,367 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:00,367 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:00,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:00,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:00,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:00,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:00,368 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:00,368 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:00,368 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:14:00,385 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:14:00,385 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:14:00,393 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:14:00,395 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 27.7ms
2025-12-04 09:14:00,396 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:14:00,397 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:00,397 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:00,397 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:00,397 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:00,397 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:00,397 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:00,398 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:00,398 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:00,398 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:00,398 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:00,398 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:14:00,414 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:14:00,414 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:14:00,419 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:14:00,420 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 23.7ms
2025-12-04 09:14:01,913 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:01,914 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:01,914 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:01,914 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:01,914 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:01,914 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:01,914 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:01,915 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:01,915 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:01,915 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:01,915 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:01,915 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:01,918 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:14:01,918 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:01,918 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:01,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:01,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:01,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:01,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:01,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:01,920 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:01,920 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:01,921 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:01,921 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:14:01,944 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:14:01,944 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:14:01,944 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:01,950 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 36.2ms
2025-12-04 09:14:01,950 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:01,950 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:01,971 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:01,972 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 54.0ms
2025-12-04 09:14:01,974 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:14:01,975 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:01,975 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:01,975 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:01,975 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:01,975 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:01,975 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:01,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:01,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:01,976 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:01,976 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:01,976 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:14:01,978 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:14:01,984 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 35.6ms
2025-12-04 09:14:01,994 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:14:01,994 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:02,004 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:02,009 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 35.4ms
2025-12-04 09:14:03,036 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:14:03,037 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 0.8ms
2025-12-04 09:14:03,037 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:14:03,038 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 0.9ms
2025-12-04 09:14:03,039 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:14:03,039 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:03,040 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:03,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:03,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:03,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:03,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:03,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:03,040 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:03,040 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:03,041 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:03,041 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:14:03,054 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ recibida
2025-12-04 09:14:03,054 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:03,064 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados: 4 módulos
2025-12-04 09:14:03,064 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 30.2ms
2025-12-04 09:14:03,069 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:03,069 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:14:03,088 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ recibida
2025-12-04 09:14:03,088 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:03,090 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados: 4 módulos
2025-12-04 09:14:03,090 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 21.9ms
2025-12-04 09:14:05,493 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:05,494 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 1.0ms
2025-12-04 09:14:05,494 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-04 09:14:05,495 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-04 09:14:05,496 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:05,496 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.7ms
2025-12-04 09:14:05,497 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.9ms
2025-12-04 09:14:05,497 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 1.7ms
2025-12-04 09:14:05,498 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:05,499 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:05,499 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:05,499 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:05,499 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:05,499 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:05,499 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:05,499 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:05,499 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:05,499 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:05,500 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:05,500 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:05,502 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:14:05,502 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:05,502 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:05,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:05,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:05,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:05,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:05,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:05,503 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:05,503 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:05,503 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:05,503 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:14:05,524 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:14:05,524 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:05,524 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:14:05,524 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:14:05,531 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:14:05,531 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:14:05,531 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 36.0ms
2025-12-04 09:14:05,534 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:05,534 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:05,539 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:14:05,539 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 39.3ms
2025-12-04 09:14:05,539 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:14:05,546 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:05,547 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:05,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:05,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:05,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:05,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:05,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:05,548 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:05,548 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:05,548 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:05,548 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:14:05,563 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:14:05,563 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:05,570 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:14:05,570 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:14:05,570 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:14:05,571 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 35.3ms
2025-12-04 09:14:05,574 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:14:05,576 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:14:05,576 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 32.8ms
2025-12-04 09:14:08,616 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:14:08,616 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:14:08,617 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 0.9ms
2025-12-04 09:14:08,617 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 0.6ms
2025-12-04 09:14:08,619 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:14:08,620 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:08,620 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:08,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:08,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:08,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:08,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:08,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:08,621 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:08,621 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:08,621 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:08,621 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:14:08,635 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:14:08,635 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:14:08,635 - app.core.application.base_service - ERROR - ERROR INESPERADO en get_usuarios_globales: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\core\application\base_service.py", line 52, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\superadmin\application\services\superadmin_usuario_service.py", line 110, in get_usuarios_globales
    cliente_info = ClienteInfo(
                   ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
2025-12-04 09:14:08,657 - app.modules.superadmin.presentation.endpoints_usuarios - WARNING - Error de negocio al listar usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43: Error interno del servidor en get_usuarios_globales
2025-12-04 09:14:08,658 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 500 39.1ms
2025-12-04 09:14:08,659 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:14:08,661 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:08,661 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:08,661 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:08,661 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:08,661 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:08,661 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:08,661 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:08,662 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:08,662 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:08,662 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:08,662 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:14:08,677 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:14:08,677 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:14:08,681 - app.core.application.base_service - ERROR - ERROR INESPERADO en get_usuarios_globales: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\core\application\base_service.py", line 52, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\superadmin\application\services\superadmin_usuario_service.py", line 110, in get_usuarios_globales
    cliente_info = ClienteInfo(
                   ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
2025-12-04 09:14:08,681 - app.modules.superadmin.presentation.endpoints_usuarios - WARNING - Error de negocio al listar usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43: Error interno del servidor en get_usuarios_globales
2025-12-04 09:14:08,682 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 500 21.9ms
2025-12-04 09:14:10,975 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:14:10,976 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:14:10,976 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/ 200 0.9ms
2025-12-04 09:14:10,976 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/ 200 0.6ms
2025-12-04 09:14:10,978 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:14:10,978 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:10,978 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:10,978 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:10,978 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:10,978 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:10,978 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:10,979 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:10,979 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:10,979 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:10,979 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:10,979 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:14:10,996 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:14:10,997 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:14:10,999 - app.core.application.base_service - ERROR - ERROR INESPERADO en get_logs_autenticacion: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\core\application\base_service.py", line 52, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\superadmin\application\services\superadmin_auditoria_service.py", line 112, in get_logs_autenticacion
    cliente_info_cache = ClienteInfo(
                         ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
2025-12-04 09:14:11,000 - app.modules.superadmin.presentation.endpoints_auditoria - WARNING - Error de negocio al listar logs de autenticación: Error interno del servidor en get_logs_autenticacion
2025-12-04 09:14:11,001 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 500 22.8ms
2025-12-04 09:14:11,002 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:14:11,002 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:11,003 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:11,003 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:11,003 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:11,003 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:11,003 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:11,003 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:11,003 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:11,003 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:11,003 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:11,003 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:14:11,015 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:14:11,015 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:14:11,020 - app.core.application.base_service - ERROR - ERROR INESPERADO en get_logs_autenticacion: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\core\application\base_service.py", line 52, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\superadmin\application\services\superadmin_auditoria_service.py", line 112, in get_logs_autenticacion
    cliente_info_cache = ClienteInfo(
                         ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
2025-12-04 09:14:11,020 - app.modules.superadmin.presentation.endpoints_auditoria - WARNING - Error de negocio al listar logs de autenticación: Error interno del servidor en get_logs_autenticacion
2025-12-04 09:14:11,020 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 500 20.7ms
2025-12-04 09:14:26,891 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:14:26,891 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:26,891 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:26,892 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:26,892 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:26,892 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:26,892 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:26,892 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:26,892 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:26,892 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:26,892 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:26,892 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:14:26,912 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:14:26,912 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:14:26,918 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:14:26,919 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 28.3ms
2025-12-04 09:14:26,921 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:14:26,921 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:26,921 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:26,921 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:26,921 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:26,921 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:26,922 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:26,922 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:26,922 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:26,922 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:26,922 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:26,922 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:14:26,938 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:14:26,938 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:14:26,944 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:14:26,945 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 23.6ms
2025-12-04 09:14:30,161 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:30,161 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:30,162 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:30,162 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:30,162 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:30,162 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:30,162 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:30,162 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:30,162 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:30,163 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:30,163 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:30,163 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:30,166 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:14:30,167 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:30,167 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:30,167 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:30,168 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:30,168 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:30,168 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:30,168 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:30,168 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:30,168 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:30,168 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:30,169 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:14:30,219 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:14:30,221 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:14:30,221 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:30,224 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 63.7ms
2025-12-04 09:14:30,226 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:30,227 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:30,227 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:30,227 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:30,227 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:30,228 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:30,228 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:30,228 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:30,228 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:30,228 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:30,228 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:30,228 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:30,243 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:30,245 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 79.3ms
2025-12-04 09:14:30,246 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:14:30,248 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:30,248 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:30,248 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:30,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:30,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:30,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:30,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:30,249 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:30,249 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:30,249 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:30,250 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:14:30,252 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:14:30,260 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 33.7ms
2025-12-04 09:14:30,268 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:14:30,268 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:30,280 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:30,281 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 33.7ms
2025-12-04 09:14:34,182 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:14:34,182 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:34,182 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:34,183 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:34,183 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:34,183 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:34,183 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:34,183 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:34,183 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:34,183 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:34,183 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:34,184 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:14:34,196 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ recibida
2025-12-04 09:14:34,196 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:34,196 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados: 4 módulos
2025-12-04 09:14:34,196 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 20.4ms
2025-12-04 09:14:34,196 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:14:34,196 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:34,196 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:34,196 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:34,196 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:34,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:34,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:34,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:34,205 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:34,205 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:34,205 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:34,205 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:14:34,218 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ recibida
2025-12-04 09:14:34,218 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:34,218 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados: 4 módulos
2025-12-04 09:14:34,225 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 21.2ms
2025-12-04 09:14:39,675 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:39,676 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:14:39,676 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:39,676 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:39,676 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:39,676 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:39,677 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:39,677 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:39,677 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:39,677 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:39,677 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:39,677 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:39,677 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:39,678 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:39,678 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:39,678 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:39,678 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:39,678 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:39,678 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:39,678 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:39,678 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:39,680 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:39,680 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:39,680 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:14:39,705 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:14:39,705 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:39,705 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:14:39,705 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:14:39,709 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:14:39,709 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:14:39,714 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 38.2ms
2025-12-04 09:14:39,715 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:39,717 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:39,717 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:39,717 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:39,717 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:39,717 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:39,718 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:39,718 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:39,718 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:39,718 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:39,718 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:39,718 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:14:39,719 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:14:39,719 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 46.2ms
2025-12-04 09:14:39,723 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:14:39,723 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:39,723 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:39,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:39,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:39,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:39,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:39,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:39,725 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:39,725 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:39,725 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:39,726 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:14:39,739 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:14:39,739 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:14:39,748 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:14:39,748 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:14:39,750 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:14:39,752 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 35.4ms
2025-12-04 09:14:39,756 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:14:39,759 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:14:39,759 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 36.1ms
2025-12-04 09:14:54,975 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:14:54,976 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:54,976 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:54,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:54,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:54,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:54,976 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:54,977 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:54,977 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:54,977 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:54,977 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:54,977 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:14:54,990 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:14:54,990 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:14:54,996 - app.core.application.base_service - ERROR - ERROR INESPERADO en get_usuarios_globales: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\core\application\base_service.py", line 52, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\superadmin\application\services\superadmin_usuario_service.py", line 110, in get_usuarios_globales
    cliente_info = ClienteInfo(
                   ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
2025-12-04 09:14:54,996 - app.modules.superadmin.presentation.endpoints_usuarios - WARNING - Error de negocio al listar usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43: Error interno del servidor en get_usuarios_globales
2025-12-04 09:14:54,997 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 500 21.5ms
2025-12-04 09:14:54,998 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:14:54,998 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:14:55,018 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:14:55,018 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:14:55,023 - app.core.application.base_service - ERROR - ERROR INESPERADO en get_usuarios_globales: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\core\application\base_service.py", line 52, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\superadmin\application\services\superadmin_usuario_service.py", line 110, in get_usuarios_globales
    cliente_info = ClienteInfo(
                   ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for ClienteInfo
cliente_id
  Input should be a valid integer [type=int_type, input_value=UUID('ee7bfc14-995f-4209-b4b9-99c307534a43'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/int_type
2025-12-04 09:14:55,023 - app.modules.superadmin.presentation.endpoints_usuarios - WARNING - Error de negocio al listar usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43: Error interno del servidor en get_usuarios_globales
2025-12-04 09:14:55,024 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 500 24.9ms
2025-12-04 09:18:05,095 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-12-04 09:18:05,096 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-12-04 09:18:05,097 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.8ms
2025-12-04 09:18:05,097 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.8ms
2025-12-04 09:18:05,103 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:05,103 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:18:05,145 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:18:05,145 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:18:05,150 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:18:05,150 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 52.9ms
2025-12-04 09:18:05,259 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-04 09:18:05,259 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-04 09:18:05,259 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-04 09:18:05,259 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-04 09:18:05,259 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-04 09:18:05,259 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-04 09:18:05,388 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD41D35040>
2025-12-04 09:18:05,391 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD41D07530>
2025-12-04 09:18:05,391 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD4266A540>
2025-12-04 09:18:05,391 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD426A43E0>
2025-12-04 09:18:05,391 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD42AB67B0>
2025-12-04 09:18:05,391 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD425F28A0>
2025-12-04 09:18:05,391 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD425C3F20>
2025-12-04 09:18:05,391 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD425DCC50>
2025-12-04 09:18:05,394 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD426C00B0>
2025-12-04 09:18:05,394 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD426A7E30>
2025-12-04 09:18:05,394 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD426A74A0>
2025-12-04 09:18:05,394 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD42658CE0>
2025-12-04 09:18:05,394 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD426A6A80>
2025-12-04 09:18:05,394 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x000001AD42AB56A0>
2025-12-04 09:18:06,298 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-04 09:18:06,518 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] SQLAlchemy async disponible
2025-12-04 09:18:06,528 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] aioodbc disponible
2025-12-04 09:18:06,528 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-04 09:18:06,528 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-04 09:18:06,528 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-04 09:18:06,528 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-04 09:18:06,528 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, DEFAULT_TYPE=single
2025-12-04 09:18:06,918 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-04 09:18:06,918 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-04 09:18:07,030 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-04 09:18:07,030 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-04 09:18:07,030 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-04 09:18:07,215 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-04 09:18:07,215 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-04 09:18:07,359 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, EXCLUDED_SUBDOMAINS={'static', 'admin', 'www', 'backend', 'assets', 'api', 'cdn'}
2025-12-04 09:18:07,368 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:07,368 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:18:07,377 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] AsyncEngine creado para admin
2025-12-04 09:18:07,418 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:18:07,418 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:18:07,429 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:18:07,429 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 61.7ms
2025-12-04 09:18:08,923 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:18:08,924 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 0.5ms
2025-12-04 09:18:08,926 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:18:08,926 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:18:08,928 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 1.2ms
2025-12-04 09:18:08,928 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:08,928 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:08,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:08,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:08,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:08,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:08,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:08,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:08,930 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:08,930 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:08,930 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:18:08,932 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:08,932 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:18:08,958 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:18:08,958 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:18:08,964 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:18:08,971 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 37.5ms
2025-12-04 09:18:08,973 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:18:08,973 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:08,974 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:08,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:08,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:08,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:08,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:08,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:08,974 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:08,975 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:08,975 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:08,975 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:18:08,984 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:18:08,985 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 58.2ms
2025-12-04 09:18:08,987 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:18:08,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:08,987 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:08,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:08,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:08,987 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:08,988 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:08,988 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:08,988 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:08,988 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:08,988 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:08,988 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:18:08,998 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:18:09,008 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 38.7ms
2025-12-04 09:18:09,014 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:18:09,014 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:18:09,023 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:18:09,023 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 38.0ms
2025-12-04 09:18:09,954 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:18:09,954 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:09,954 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:09,954 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:09,955 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:09,955 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:09,955 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:09,955 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:09,955 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:09,955 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:09,956 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:09,956 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:18:09,972 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ recibida
2025-12-04 09:18:09,972 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:18:09,972 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados: 4 módulos
2025-12-04 09:18:09,972 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 22.5ms
2025-12-04 09:18:09,972 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:18:09,972 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:09,978 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:09,978 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:09,978 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:09,978 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:09,978 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:09,978 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:09,978 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:09,978 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:09,978 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:09,978 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:18:09,996 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ recibida
2025-12-04 09:18:09,996 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:18:10,000 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados: 4 módulos
2025-12-04 09:18:10,001 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 23.7ms
2025-12-04 09:18:11,576 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:18:11,577 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:18:11,577 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:11,577 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:11,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:11,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:11,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:11,577 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:11,578 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:11,578 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:11,578 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:11,578 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:11,578 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:18:11,579 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:11,579 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:11,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:11,579 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:11,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:11,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:11,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:11,581 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:11,581 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:11,581 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:11,582 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:18:11,603 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:18:11,603 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:18:11,604 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:18:11,604 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:18:11,608 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:18:11,609 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:18:11,609 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 33.4ms
2025-12-04 09:18:11,611 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:18:11,611 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:11,611 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:11,611 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:11,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:11,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:11,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:11,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:11,612 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:11,612 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:11,612 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:11,612 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:18:11,616 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:18:11,617 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 40.6ms
2025-12-04 09:18:11,618 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:18:11,618 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:11,618 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:11,618 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:11,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:11,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:11,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:11,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:11,620 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:11,620 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:11,620 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:11,620 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:18:11,638 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:18:11,638 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:18:11,642 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:18:11,642 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:18:11,642 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:18:11,642 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 35.0ms
2025-12-04 09:18:11,649 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:18:11,653 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:18:11,653 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 34.0ms
2025-12-04 09:18:19,839 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:18:19,840 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:19,840 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:19,840 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:19,840 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:19,840 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:19,841 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:19,841 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:19,841 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:19,841 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:19,841 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:19,841 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:18:19,852 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:18:19,852 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:18:19,860 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:18:23,948 - app.infrastructure.cache.redis_cache - WARNING - [REDIS_CACHE] Error conectando a Redis: Error 10061 connecting to localhost:6379. No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión.. Cache desactivado automáticamente (usando fallback en memoria).
2025-12-04 09:18:23,948 - app.infrastructure.cache.redis_cache - INFO - ℹ️ Módulo de Redis cache cargado pero desactivado (usando fallback en memoria)
2025-12-04 09:18:23,955 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] AsyncEngine creado para tenant_ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:18:23,967 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:18:23,970 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 0, Página: 1
2025-12-04 09:18:23,970 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 4132.5ms
2025-12-04 09:18:23,974 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:18:23,974 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:18:23,974 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:18:23,975 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:23,975 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:23,975 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:23,975 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:18:23,975 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:18:23,975 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:18:23,975 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:18:23,975 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:18:23,976 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:18:23,992 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:18:23,992 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:18:23,995 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:18:23,998 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:18:24,000 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 0, Página: 1
2025-12-04 09:18:24,001 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 27.2ms
2025-12-04 09:19:13,385 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-12-04 09:19:13,386 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.5ms
2025-12-04 09:19:13,387 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-12-04 09:19:13,387 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:13,387 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:13,387 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:13,389 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:13,389 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:13,389 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:13,389 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:13,389 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:13,389 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:13,390 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:13,390 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/logout/
2025-12-04 09:19:13,396 - app.modules.auth.application.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya revocado - Cliente BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E
2025-12-04 09:19:13,396 - app.modules.auth.presentation.endpoints - INFO - [LOGOUT-WEB] Token no encontrado en BD (ya expirado/revocado) - Cliente: BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, Usuario: 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E (superadmin)
2025-12-04 09:19:13,401 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=logout, cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:19:13,402 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 14.0ms
2025-12-04 09:19:19,936 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-12-04 09:19:19,936 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.4ms
2025-12-04 09:19:19,936 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:19,939 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/login/
2025-12-04 09:19:19,939 - app.modules.auth.presentation.endpoints - INFO - Cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 resuelto y validado para login.
2025-12-04 09:19:19,939 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Intento de login: username='admin_acme', cliente_id_destino=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:19,939 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:19,949 - app.modules.auth.application.services.auth_service - WARNING - [AUTH] Usuario NO ENCONTRADO: username='admin_acme', cliente_id_buscado=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:19,953 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_failed, cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, usuario_id=None, exito=False
2025-12-04 09:19:19,953 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 401 18.6ms
2025-12-04 09:19:31,049 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-12-04 09:19:31,049 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:31,049 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:31,051 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:31,051 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:31,051 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:31,051 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:31,051 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:31,051 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:31,051 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,052 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:31,052 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/auth/login/
2025-12-04 09:19:31,056 - app.modules.auth.presentation.endpoints - INFO - Cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 resuelto y validado para login.
2025-12-04 09:19:31,057 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,057 - app.modules.auth.application.services.auth_service - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7), accediendo a cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,281 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:19:31,281 - app.modules.auth.application.services.auth_service - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, cliente_origen=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, cliente_destino=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, access_level=5, user_type=super_admin
2025-12-04 09:19:31,281 - app.modules.auth.presentation.endpoints - INFO - [LOGIN] Superadmin accediendo a cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,289 - app.modules.auth.application.services.auth_service - INFO - Niveles calculados - Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E: level=5, super_admin=True, type=super_admin
2025-12-04 09:19:31,289 - app.modules.auth.application.services.refresh_token_service - INFO - [STORE-TOKEN] Token insertado exitosamente - Cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, Usuario 154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, Tipo: web, Token ID: BFD5B5B7-42B0-4D3A-963D-5C37C4655FBE, Rotación: False
2025-12-04 09:19:31,289 - app.modules.auth.presentation.endpoints - INFO - [LOGIN-WEB] Token almacenado - ID: BFD5B5B7-42B0-4D3A-963D-5C37C4655FBE
2025-12-04 09:19:31,289 - app.modules.auth.presentation.endpoints - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,297 - app.modules.superadmin.application.services.audit_service - INFO - [AUDIT] auth_audit_log registrado: evento=login_success, cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, usuario_id=154134AD-A5EB-4F45-AEF0-5F9AAA282C8E, exito=True
2025-12-04 09:19:31,299 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 249.8ms
2025-12-04 09:19:31,300 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/tenant/branding
2025-12-04 09:19:31,300 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/tenant/branding 200 0.5ms
2025-12-04 09:19:31,300 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/tenant/branding
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:31,309 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/tenant/branding
2025-12-04 09:19:31,319 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-04 09:19:31,321 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.0ms
2025-12-04 09:19:31,321 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-12-04 09:19:31,321 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.2ms
2025-12-04 09:19:31,325 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:31,325 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:19:31,339 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /tenant/branding recibida para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7 por usuario: superadmin
2025-12-04 09:19:31,339 - app.modules.tenant.application.services.cliente_service - INFO - Solicitando branding para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,348 - app.modules.tenant.application.services.cliente_service - INFO - Branding obtenido exitosamente para cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,349 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/tenant/branding 200 40.6ms
2025-12-04 09:19:31,352 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,352 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:19:31,355 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:19:31,355 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 30.6ms
2025-12-04 09:19:31,357 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-12-04 09:19:31,357 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:31,357 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:31,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:31,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:31,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:31,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:31,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:31,358 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:31,358 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,358 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:31,358 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/menus/getmenu/
2025-12-04 09:19:31,373 - app.modules.menus.presentation.endpoints - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e del cliente bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:31,373 - app.modules.menus.application.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e
2025-12-04 09:19:31,377 - app.modules.menus.application.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 154134ad-a5eb-4f45-aef0-5f9aaa282c8e.
2025-12-04 09:19:31,378 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 20.8ms
2025-12-04 09:19:32,793 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:19:32,793 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:32,793 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:32,793 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:32,793 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:32,793 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:32,794 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:32,794 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:32,794 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:32,794 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:32,794 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:32,794 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:19:32,812 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:19:32,813 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:19:32,820 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:19:32,820 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 28.1ms
2025-12-04 09:19:32,822 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-12-04 09:19:32,822 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:32,822 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:32,822 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:32,823 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:32,823 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:32,823 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:32,823 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:32,823 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:32,823 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:32,823 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:32,824 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/
2025-12-04 09:19:32,841 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True, buscar: None por usuario: superadmin
2025-12-04 09:19:32,842 - app.modules.tenant.application.services.cliente_service - INFO - Listando clientes - skip: 0, limit: 10, solo_activos: True, buscar: None
2025-12-04 09:19:32,847 - app.modules.tenant.application.services.cliente_service - INFO - Listados 5 clientes de 5 totales
2025-12-04 09:19:32,848 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 25.8ms
2025-12-04 09:19:34,691 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:19:34,691 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:34,692 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:34,692 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:34,693 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:34,693 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:34,693 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:19:34,694 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:19:34,695 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:34,695 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:34,695 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:34,695 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:34,695 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:34,695 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:34,695 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:34,696 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:34,696 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:34,696 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:34,696 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:19:34,745 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:19:34,745 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:19:34,746 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:19:34,749 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 59.2ms
2025-12-04 09:19:34,751 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:34,753 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:19:34,759 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:19:34,767 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 73.3ms
2025-12-04 09:19:34,769 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:34,769 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/
2025-12-04 09:19:34,782 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida por usuario: superadmin
2025-12-04 09:19:34,786 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 36.9ms
2025-12-04 09:19:34,798 - app.modules.tenant.presentation.endpoints_clientes - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas recibida por usuario: superadmin
2025-12-04 09:19:34,798 - app.modules.tenant.application.services.cliente_service - INFO - Obteniendo estadísticas para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:19:34,810 - app.modules.tenant.application.services.cliente_service - INFO - Estadísticas obtenidas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:19:34,810 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/estadisticas/ 200 40.7ms
2025-12-04 09:19:36,504 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:19:36,504 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:36,504 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:36,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:36,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:36,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:36,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:36,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:36,505 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:36,505 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:36,505 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:36,506 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:19:36,520 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ recibida
2025-12-04 09:19:36,521 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:19:36,521 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados: 4 módulos
2025-12-04 09:19:36,521 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 20.6ms
2025-12-04 09:19:36,521 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:36,521 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:19:36,540 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ recibida
2025-12-04 09:19:36,540 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:19:36,540 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados: 4 módulos
2025-12-04 09:19:36,540 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 20.9ms
2025-12-04 09:19:37,509 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:19:37,510 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:19:37,510 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:37,510 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:37,510 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:37,510 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:37,510 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:37,511 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:37,511 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:37,511 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:37,511 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:37,511 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:37,511 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:19:37,512 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:37,513 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:37,513 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:37,513 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:37,513 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:37,513 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:37,513 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:37,513 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:37,514 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:37,514 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:37,514 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:19:37,529 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:19:37,536 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:19:37,537 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:19:37,537 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:19:37,554 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:19:37,554 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:19:37,554 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 48.9ms
2025-12-04 09:19:37,559 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:37,559 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:19:37,559 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:19:37,559 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 56.1ms
2025-12-04 09:19:37,568 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:19:37,572 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:37,572 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:37,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:37,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:37,572 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:37,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:37,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:37,575 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:37,575 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:37,575 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:37,575 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:19:37,593 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:19:37,593 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:19:37,600 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:19:37,600 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:19:37,600 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:19:37,601 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 40.6ms
2025-12-04 09:19:37,604 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:19:37,606 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:19:37,607 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 39.3ms
2025-12-04 09:19:38,998 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:19:39,000 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:39,000 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:39,000 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:39,000 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:39,000 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:39,000 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:39,000 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:39,001 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:39,001 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:39,001 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:39,001 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:19:39,011 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:19:39,011 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:19:39,019 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:19:39,023 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:19:39,026 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 0, Página: 1
2025-12-04 09:19:39,026 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 28.2ms
2025-12-04 09:19:39,028 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:19:39,028 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:39,028 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:39,029 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:39,029 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:39,029 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:39,029 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:39,029 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:39,029 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:39,029 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:39,031 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:39,031 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:19:39,047 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:19:39,047 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:19:39,049 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:19:39,049 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:19:39,056 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 0, Página: 1
2025-12-04 09:19:39,056 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 27.6ms
2025-12-04 09:19:49,149 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:19:49,150 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:49,150 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:49,150 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:49,150 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:49,150 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:49,150 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:49,150 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:49,150 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:49,151 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:49,151 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:49,151 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:19:49,161 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:19:49,165 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:19:49,168 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:19:49,169 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:19:49,220 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 52, Página: 1
2025-12-04 09:19:49,220 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 72.7ms
2025-12-04 09:19:49,220 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:19:49,220 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:19:49,240 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:19:49,240 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:19:49,240 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:19:49,240 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:19:49,304 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 52, Página: 1
2025-12-04 09:19:49,305 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 81.1ms
2025-12-04 09:20:00,811 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b/
2025-12-04 09:20:00,812 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b/ 200 0.5ms
2025-12-04 09:20:00,813 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b/
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:20:00,814 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/auditoria/autenticacion/0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b/
2025-12-04 09:20:00,830 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo log de autenticación ID 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b, cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:20:00,830 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Cliente_id proporcionado (ee7bfc14-995f-4209-b4b9-99c307534a43), consultando log 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b directamente en BD del tenant
2025-12-04 09:20:00,840 - app.modules.superadmin.application.services.superadmin_auditoria_service - WARNING - [AUDIT] Log 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b encontrado pero pertenece a cliente EE7BFC14-995F-4209-B4B9-99C307534A43, no a ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:20:00,840 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Contexto de SuperAdmin detectado, identificando tenant del log 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b
2025-12-04 09:20:00,840 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:00,840 - app.infrastructure.database.queries_async - ERROR - Error en execute_query async (string): (sqlalchemy.exc.InvalidRequestError) A value is required for bind parameter 'log_id'
[SQL: 
            SELECT cliente_id
            FROM dbo.auth_audit_log
            WHERE log_id = ?
            ]
[parameters: [{}]]
(Background on this error at: https://sqlalche.me/e/20/cd3x)
2025-12-04 09:20:00,840 - app.infrastructure.database.connection_async - ERROR - [ASYNC_CONNECTION] Error en sesión async: Error en la consulta: (sqlalchemy.exc.InvalidRequestError) A value is required for bind parameter 'log_id'
[SQL: 
            SELECT cliente_id
            FROM dbo.auth_audit_log
            WHERE log_id = ?
            ]
[parameters: [{}]]
(Background on this error at: https://sqlalche.me/e/20/cd3x)
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1815, in _execute_context
    context = constructor(
              ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1414, in _init_compiled
    compiled.construct_params(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1947, in construct_params
    raise exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: A value is required for bind parameter 'log_id' (Background on this error at: https://sqlalche.me/e/20/cd3x)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 185, in execute_query
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2258, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1815, in _execute_context
    context = constructor(
              ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 1414, in _init_compiled
    compiled.construct_params(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1947, in construct_params
    raise exc.InvalidRequestError(
sqlalchemy.exc.StatementError: (sqlalchemy.exc.InvalidRequestError) A value is required for bind parameter 'log_id'
[SQL: 
            SELECT cliente_id
            FROM dbo.auth_audit_log
            WHERE log_id = ?
            ]
[parameters: [{}]]
(Background on this error at: https://sqlalche.me/e/20/cd3x)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\connection_async.py", line 326, in get_db_connection
    yield session
  File "D:\base_multi_tenant_fastapi\app\core\tenant\routing.py", line 849, in get_connection_for_tenant
    yield session
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 192, in execute_query
    raise DatabaseError(
app.core.exceptions.DatabaseError: Error en la consulta: (sqlalchemy.exc.InvalidRequestError) A value is required for bind parameter 'log_id'
[SQL: 
            SELECT cliente_id
            FROM dbo.auth_audit_log
            WHERE log_id = ?
            ]
[parameters: [{}]]
(Background on this error at: https://sqlalche.me/e/20/cd3x)
2025-12-04 09:20:00,870 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Consultando log 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b completo en BD del cliente EE7BFC14-995F-4209-B4B9-99C307534A43 (execute_query determinará BD automáticamente)
2025-12-04 09:20:00,881 - app.modules.superadmin.application.services.superadmin_auditoria_service - WARNING - [AUDIT] Log 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b no encontrado en BD del cliente EE7BFC14-995F-4209-B4B9-99C307534A43 a pesar de tener su cliente_id
2025-12-04 09:20:00,881 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Log 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b no encontrado en contexto del tenant, buscando en todas las BDs de clientes activos
2025-12-04 09:20:00,885 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - [AUDIT] Buscando log 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b en 5 clientes activos: ['58F3CCE8-037B-45DA-91C3-497FD61F31E5', 'BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7', 'A4FC62C0-6D3B-4FA3-B5EE-6294343DAF60', '6C490DF5-1395-44B6-8053-6C2B67B8D4C5', 'EE7BFC14-995F-4209-B4B9-99C307534A43']
2025-12-04 09:20:00,896 - app.modules.superadmin.application.services.superadmin_auditoria_service - WARNING - [AUDIT] Log 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b no encontrado en ninguna BD de cliente activo
2025-12-04 09:20:00,896 - app.modules.superadmin.presentation.endpoints_auditoria - ERROR - Error de negocio obteniendo log 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b: Log de autenticación con ID 0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b no encontrado.
2025-12-04 09:20:00,896 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/0b098ff5-0a9f-4a92-bc5c-3ca3c7e1521b/ 404 83.7ms
2025-12-04 09:20:09,125 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:20:09,126 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:20:09,126 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:20:09,126 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:09,126 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:09,126 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:09,126 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:09,126 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:09,127 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:09,127 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:20:09,127 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:20:09,127 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:20:09,140 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:20:09,140 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:20:09,140 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:09,140 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:09,150 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 0, Página: 1
2025-12-04 09:20:09,150 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 25.1ms
2025-12-04 09:20:09,152 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:20:09,152 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:20:09,152 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:20:09,152 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:09,153 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:09,153 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:09,153 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:09,153 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:09,153 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:09,153 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:20:09,154 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:20:09,154 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:20:09,169 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:20:09,169 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:20:09,170 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:09,170 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:09,170 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 0, Página: 1
2025-12-04 09:20:09,170 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 26.3ms
2025-12-04 09:20:21,824 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:20:21,825 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:20:21,825 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:20:21,825 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:21,825 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:21,825 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:21,825 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:21,827 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:21,827 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:21,827 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:20:21,827 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:20:21,827 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:20:21,840 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:20:21,840 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:20:21,847 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:21,851 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:21,900 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 52, Página: 1
2025-12-04 09:20:21,900 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 82.6ms
2025-12-04 09:20:21,900 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:20:21,910 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:20:21,930 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:20:21,930 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:20:21,935 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:21,937 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:21,990 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 52, Página: 1
2025-12-04 09:20:21,990 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 83.4ms
2025-12-04 09:20:26,564 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:20:26,565 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:20:26,565 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:20:26,565 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:26,565 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:26,565 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:26,566 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:26,566 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:26,566 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:26,566 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:20:26,566 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:20:26,566 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:20:26,582 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:20:26,582 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:20:26,586 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:26,590 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:26,593 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 0, Página: 1
2025-12-04 09:20:26,593 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 28.3ms
2025-12-04 09:20:26,595 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:20:26,595 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:20:26,595 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:20:26,595 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:26,595 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:26,595 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:26,595 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:20:26,596 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:20:26,596 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:20:26,596 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:20:26,596 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:20:26,596 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:20:26,611 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:20:26,611 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:20:26,615 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:26,618 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:20:26,620 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 0, Página: 1
2025-12-04 09:20:26,621 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 26.9ms
2025-12-04 09:23:05,679 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-04 09:23:05,679 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-04 09:23:05,679 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-04 09:23:05,679 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-04 09:23:05,680 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-04 09:23:05,680 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-04 09:23:05,770 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x00000211F438A810>
2025-12-04 09:23:05,773 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x00000211F360C050>
2025-12-04 09:23:05,773 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x00000211F3A687A0>
2025-12-04 09:23:06,547 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-04 09:23:06,772 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] SQLAlchemy async disponible
2025-12-04 09:23:06,777 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] aioodbc disponible
2025-12-04 09:23:06,779 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-04 09:23:06,779 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-04 09:23:06,782 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-04 09:23:06,782 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-04 09:23:06,782 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, DEFAULT_TYPE=single
2025-12-04 09:23:07,163 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-04 09:23:07,167 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-04 09:23:07,262 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-04 09:23:07,263 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-04 09:23:07,263 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-04 09:23:07,482 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-04 09:23:07,482 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-04 09:23:07,634 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, EXCLUDED_SUBDOMAINS={'assets', 'www', 'static', 'backend', 'api', 'admin', 'cdn'}
2025-12-04 09:23:29,433 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:23:29,435 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:23:29,435 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:29,435 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:29,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:29,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:29,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:29,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:29,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:29,435 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:29,437 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:29,437 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:29,437 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:23:29,445 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] AsyncEngine creado para admin
2025-12-04 09:23:29,445 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:29,445 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:29,445 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:29,445 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:29,445 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:29,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:29,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:29,449 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:29,449 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:29,449 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:29,449 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:23:29,533 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:23:29,533 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:23:29,535 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:23:29,535 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:23:29,540 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:23:29,542 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:23:29,544 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 109.6ms
2025-12-04 09:23:29,546 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:23:29,546 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:29,547 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:29,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:29,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:29,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:29,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:29,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:29,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:29,547 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:29,547 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:29,548 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:23:29,551 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:23:29,552 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 117.2ms
2025-12-04 09:23:29,554 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:23:29,555 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:29,555 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:29,555 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:29,555 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:29,555 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:29,556 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:29,556 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:29,556 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:29,556 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:29,556 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:29,556 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:23:29,581 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:23:29,581 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:23:29,588 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:23:29,588 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:23:29,589 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:23:29,590 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 44.2ms
2025-12-04 09:23:29,595 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:23:29,598 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:23:29,598 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 44.2ms
2025-12-04 09:23:30,418 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:23:30,419 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:30,419 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:30,419 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:30,419 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:30,419 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:30,419 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:30,419 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:30,419 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:30,419 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:30,420 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:30,420 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:23:30,435 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:23:30,436 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:23:30,439 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:34,503 - app.infrastructure.cache.redis_cache - WARNING - [REDIS_CACHE] Error conectando a Redis: Error 10061 connecting to localhost:6379. No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión.. Cache desactivado automáticamente (usando fallback en memoria).
2025-12-04 09:23:34,503 - app.infrastructure.cache.redis_cache - INFO - ℹ️ Módulo de Redis cache cargado pero desactivado (usando fallback en memoria)
2025-12-04 09:23:34,508 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] AsyncEngine creado para tenant_ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:23:34,519 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:34,523 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:34,533 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:34,543 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:34,550 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 3, Página: 1
2025-12-04 09:23:34,550 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 4133.7ms
2025-12-04 09:23:34,553 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:34,553 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:23:34,565 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:23:34,565 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:23:34,573 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:34,573 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:34,580 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:34,587 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:34,593 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:34,602 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 3, Página: 1
2025-12-04 09:23:34,602 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 48.7ms
2025-12-04 09:23:38,984 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/
2025-12-04 09:23:38,985 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/ 200 0.7ms
2025-12-04 09:23:38,985 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/
2025-12-04 09:23:38,986 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/ 200 0.9ms
2025-12-04 09:23:38,986 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:38,986 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/
2025-12-04 09:23:38,986 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:38,993 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/
2025-12-04 09:23:39,018 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo actividad para usuario e74ecdbb-16ae-41c0-b536-b602580bc5c2, cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:23:39,018 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [ACTIVIDAD] Usando cliente_id proporcionado: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:23:39,018 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:39,019 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo sesiones para usuario e74ecdbb-16ae-41c0-b536-b602580bc5c2, cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:23:39,019 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [SESIONES] Usando cliente_id proporcionado: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:23:39,019 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:39,023 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:39,023 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:23:39,023 - app.infrastructure.database.queries_async - ERROR - Error en execute_query async (string): (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-12-04 09:23:39,023 - app.infrastructure.database.connection_async - ERROR - [ASYNC_CONNECTION] Error en sesión async: Error en la consulta: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 185, in execute_query
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2258, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\connection_async.py", line 326, in get_db_connection
    yield session
  File "D:\base_multi_tenant_fastapi\app\core\tenant\routing.py", line 869, in get_connection_for_tenant
    yield session
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 192, in execute_query
    raise DatabaseError(
app.core.exceptions.DatabaseError: Error en la consulta: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-12-04 09:23:39,035 - app.core.application.base_service - ERROR - DatabaseError en obtener_actividad_usuario: Error en la consulta: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 185, in execute_query
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2258, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\core\application\base_service.py", line 52, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\superadmin\application\services\superadmin_usuario_service.py", line 599, in obtener_actividad_usuario
    eventos_raw = await execute_query(query, tuple(params), client_id=usuario_cliente_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 192, in execute_query
    raise DatabaseError(
app.core.exceptions.DatabaseError: Error en la consulta: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-12-04 09:23:39,040 - app.modules.superadmin.presentation.endpoints_usuarios - ERROR - Error de negocio obteniendo actividad de usuario e74ecdbb-16ae-41c0-b536-b602580bc5c2: Error en la consulta: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-12-04 09:23:39,040 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/ 500 53.8ms
2025-12-04 09:23:39,043 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/ 200 52.6ms
2025-12-04 09:23:54,708 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:23:54,708 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:23:54,710 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:54,710 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:54,710 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:54,710 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:54,710 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:54,710 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:54,710 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:54,711 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:54,711 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:54,711 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:54,711 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:23:54,712 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:54,713 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:54,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:54,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:54,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:54,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:54,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:54,713 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:54,713 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:54,714 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:54,714 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:23:54,736 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:23:54,737 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:23:54,737 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:23:54,737 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:23:54,741 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:23:54,741 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:23:54,742 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 33.2ms
2025-12-04 09:23:54,744 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:23:54,744 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:54,744 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:54,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:54,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:54,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:54,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:54,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:54,745 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:54,746 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:54,746 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:54,746 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:23:54,748 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:23:54,750 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 40.3ms
2025-12-04 09:23:54,752 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:23:54,752 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:23:54,752 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:23:54,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:54,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:54,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:54,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:23:54,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:23:54,754 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:23:54,754 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:23:54,755 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:23:54,755 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:23:54,775 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:23:54,775 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:23:54,780 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:23:54,780 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:23:54,780 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:23:54,781 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 37.3ms
2025-12-04 09:23:54,786 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:23:54,789 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:23:54,789 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 37.2ms
2025-12-04 09:24:00,178 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:24:00,178 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:24:00,178 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:24:00,178 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:24:00,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:24:00,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:24:00,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:24:00,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:24:00,179 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:24:00,179 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:24:00,179 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:24:00,180 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:24:00,195 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:24:00,196 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:24:00,198 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:24:00,201 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:24:00,203 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:24:00,207 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:24:00,220 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:24:00,224 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 3, Página: 1
2025-12-04 09:24:00,230 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 53.6ms
2025-12-04 09:24:00,232 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:24:00,232 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:24:00,233 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:24:00,233 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:24:00,233 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:24:00,233 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:24:00,233 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:24:00,233 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:24:00,233 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:24:00,233 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:24:00,234 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:24:00,234 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:24:00,254 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:24:00,255 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:24:00,258 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:24:00,261 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:24:00,263 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:24:00,271 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:24:00,280 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:24:00,289 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 3, Página: 1
2025-12-04 09:24:00,289 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 56.8ms
2025-12-04 09:26:02,544 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/
2025-12-04 09:26:02,544 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:26:02,545 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:26:02,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:26:02,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:26:02,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:26:02,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:26:02,547 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:26:02,547 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:26:02,547 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:26:02,547 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/
2025-12-04 09:26:02,571 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo sesiones para usuario e74ecdbb-16ae-41c0-b536-b602580bc5c2, cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:26:02,571 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [SESIONES] Usando cliente_id proporcionado: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:26:02,571 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:26:02,571 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo actividad para usuario e74ecdbb-16ae-41c0-b536-b602580bc5c2, cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:26:02,575 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [ACTIVIDAD] Usando cliente_id proporcionado: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:26:02,575 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:26:02,575 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:26:02,575 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:26:02,583 - app.infrastructure.database.queries_async - ERROR - Error en execute_query async (string): (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-12-04 09:26:02,584 - app.infrastructure.database.connection_async - ERROR - [ASYNC_CONNECTION] Error en sesión async: Error en la consulta: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 185, in execute_query
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2258, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\connection_async.py", line 326, in get_db_connection
    yield session
  File "D:\base_multi_tenant_fastapi\app\core\tenant\routing.py", line 869, in get_connection_for_tenant
    yield session
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 192, in execute_query
    raise DatabaseError(
app.core.exceptions.DatabaseError: Error en la consulta: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-12-04 09:26:02,586 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/ 200 44.5ms
2025-12-04 09:26:02,586 - app.core.application.base_service - ERROR - DatabaseError en obtener_actividad_usuario: Error en la consulta: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 185, in execute_query
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2258, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\core\application\base_service.py", line 52, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\superadmin\application\services\superadmin_usuario_service.py", line 599, in obtener_actividad_usuario
    eventos_raw = await execute_query(query, tuple(params), client_id=usuario_cliente_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 192, in execute_query
    raise DatabaseError(
app.core.exceptions.DatabaseError: Error en la consulta: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-12-04 09:26:02,592 - app.modules.superadmin.presentation.endpoints_usuarios - ERROR - Error de negocio obteniendo actividad de usuario e74ecdbb-16ae-41c0-b536-b602580bc5c2: Error en la consulta: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: uniqueidentifier is incompatible with int (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: 
        SELECT TOP (?)
            a.log_id,
            a.fecha_evento,
            a.evento,
            a.exito,
            a.ip_address,
            a.user_agent,
            a.device_info,
            a.descripcion,
            a.codigo_error,
            a.metadata_json
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ORDER BY a.fecha_evento DESC
        ]
[parameters: (UUID('e74ecdbb-16ae-41c0-b536-b602580bc5c2'), 20)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-12-04 09:26:02,593 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/ 500 49.6ms
2025-12-04 09:27:45,553 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:27:45,554 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:27:45,554 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 1.6ms
2025-12-04 09:27:45,554 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 0.6ms
2025-12-04 09:27:45,558 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:27:45,558 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:45,558 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:45,558 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:45,558 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:45,558 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:45,558 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:45,558 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:45,558 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:45,558 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:45,558 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:45,559 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:27:45,575 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ recibida
2025-12-04 09:27:45,575 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:27:45,579 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados: 4 módulos
2025-12-04 09:27:45,580 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 22.9ms
2025-12-04 09:27:45,582 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:27:45,582 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:45,582 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:45,582 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:45,583 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:45,583 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:45,583 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:45,583 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:45,583 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:45,583 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:45,583 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:45,583 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/
2025-12-04 09:27:45,614 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ recibida
2025-12-04 09:27:45,614 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo módulos para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:27:45,621 - app.modules.tenant.presentation.endpoints_modulos - INFO - Módulos para cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados: 4 módulos
2025-12-04 09:27:45,621 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/modulos/ 200 40.0ms
2025-12-04 09:27:45,713 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Pool ADMIN inicializado. Size=10, MaxOverflow=5
2025-12-04 09:27:45,713 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Configuración de pools de tenants: MaxPools=50, PoolSize=3, MaxOverflow=2, InactivityTimeout=3600s
2025-12-04 09:27:45,714 - app.infrastructure.database.connection_pool - INFO - ✅ Módulo de connection pooling cargado y activo
2025-12-04 09:27:45,714 - app.infrastructure.database.connection_pool - INFO -    Configuración: MaxTenantPools=50, TenantPoolSize=3, InactivityTimeout=3600s
2025-12-04 09:27:45,714 - app.infrastructure.database.connection_pool - INFO - [CONNECTION_POOL] Todos los pools cerrados
2025-12-04 09:27:45,714 - app.main - INFO - ✅ Pools de conexión cerrados correctamente
2025-12-04 09:27:45,909 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x00000216AEF552E0>
2025-12-04 09:27:45,909 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x00000216AEF56A80>
2025-12-04 09:27:45,910 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x00000216AF7EF2F0>
2025-12-04 09:27:45,910 - asyncio - ERROR - Unclosed connection
connection: <aioodbc.connection.Connection object at 0x00000216AF8304D0>
2025-12-04 09:27:47,050 - app.core.tenant.context - INFO - Módulo tenant_context cargado (versión híbrida)
2025-12-04 09:27:47,297 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] SQLAlchemy async disponible
2025-12-04 09:27:47,297 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] aioodbc disponible
2025-12-04 09:27:47,307 - app.core.security.encryption - INFO - EncryptionManager inicializado correctamente
2025-12-04 09:27:47,307 - app.core.security.encryption - INFO - Módulo de encriptación cargado correctamente
2025-12-04 09:27:47,308 - app.core.tenant.cache - INFO - ✅ ConnectionMetadataCache inicializado (TTL: 300s)
2025-12-04 09:27:47,308 - app.core.tenant.cache - INFO - Módulo connection_cache cargado. Cache global: ConnectionMetadataCache(size=0, ttl=300.0s)
2025-12-04 09:27:47,309 - app.core.tenant.routing - INFO - Módulo multi_db cargado. SYSTEM_CLIENT_ID=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, DEFAULT_TYPE=single
2025-12-04 09:27:47,720 - app.core.security.rate_limiting - INFO - [RATE_LIMITING] Activado. Límites: Login=10/minute, API=200/minute
2025-12-04 09:27:47,720 - app.core.security.rate_limiting - INFO - ✅ Módulo de rate limiting cargado y activo
2025-12-04 09:27:47,797 - app.core.authorization.rbac - INFO - 🔐 Inicializando sistema de autorización...
2025-12-04 09:27:47,798 - app.core.authorization.rbac - INFO - ✅ Sistema de autorización inicializado correctamente
2025-12-04 09:27:47,798 - app.core.authorization.rbac - INFO - 📊 Permisos del sistema: 6 módulos configurados
2025-12-04 09:27:47,960 - app.core.tenant.middleware - INFO - Módulo tenant_middleware cargado (versión híbrida con soporte para proxies)
2025-12-04 09:27:47,960 - app.main - INFO - ✅ Rate limiting configurado y activo
2025-12-04 09:27:48,115 - app.core.tenant.middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=app.local, SYSTEM_ID=BBA6FBAD-4090-4AB8-B44A-4E8F5BC0BDB7, EXCLUDED_SUBDOMAINS={'assets', 'cdn', 'www', 'admin', 'backend', 'api', 'static'}
2025-12-04 09:27:48,801 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:27:48,801 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 1.3ms
2025-12-04 09:27:48,802 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-04 09:27:48,802 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-12-04 09:27:48,802 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:27:48,804 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.5ms
2025-12-04 09:27:48,804 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.3ms
2025-12-04 09:27:48,804 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 1.3ms
2025-12-04 09:27:48,806 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:27:48,807 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:48,807 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:48,807 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:48,807 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:48,807 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:48,807 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:48,807 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:48,809 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:48,809 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:48,809 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:48,809 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:27:48,809 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:27:48,813 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] AsyncEngine creado para admin
2025-12-04 09:27:48,816 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:48,816 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:48,816 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:48,816 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:48,816 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:48,816 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:48,816 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:48,816 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:48,817 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:48,817 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:48,817 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:27:48,890 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:27:48,890 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:27:48,892 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:27:48,892 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:27:48,896 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:27:48,898 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:27:48,898 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 91.6ms
2025-12-04 09:27:48,899 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:27:48,901 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:48,901 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:48,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:48,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:48,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:48,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:48,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:48,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:48,901 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:48,903 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:48,903 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:27:48,906 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:27:48,907 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 97.6ms
2025-12-04 09:27:48,909 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:27:48,910 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:48,910 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:48,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:48,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:48,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:48,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:48,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:48,910 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:48,912 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:48,912 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:48,912 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:27:48,936 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:27:48,936 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:27:48,939 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:27:48,940 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:27:48,940 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:27:48,941 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 40.8ms
2025-12-04 09:27:48,944 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:27:48,948 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:27:48,949 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 39.6ms
2025-12-04 09:27:50,132 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:27:50,133 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:27:50,134 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 1.6ms
2025-12-04 09:27:50,134 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 0.9ms
2025-12-04 09:27:50,138 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:27:50,139 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:50,139 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:50,139 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:50,139 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:50,139 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:50,141 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:50,143 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:50,144 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:50,144 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:50,144 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:50,144 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:27:50,169 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:27:50,169 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:27:50,172 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:54,245 - app.infrastructure.cache.redis_cache - WARNING - [REDIS_CACHE] Error conectando a Redis: Error 10061 connecting to localhost:6379. No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión.. Cache desactivado automáticamente (usando fallback en memoria).
2025-12-04 09:27:54,245 - app.infrastructure.cache.redis_cache - INFO - ℹ️ Módulo de Redis cache cargado pero desactivado (usando fallback en memoria)
2025-12-04 09:27:54,247 - app.infrastructure.database.connection_async - INFO - [ASYNC_CONNECTION] AsyncEngine creado para tenant_ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:27:54,263 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:54,266 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:54,270 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:54,281 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:54,286 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 3, Página: 1
2025-12-04 09:27:54,286 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 4152.4ms
2025-12-04 09:27:54,292 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:27:54,293 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:54,293 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:54,293 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:54,293 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:54,293 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:54,293 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:54,294 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:54,294 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:54,294 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:54,294 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:54,294 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:27:54,307 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:27:54,307 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:27:54,315 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:54,318 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:54,321 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:54,331 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:54,339 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:54,347 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 3, Página: 1
2025-12-04 09:27:54,347 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 56.5ms
2025-12-04 09:27:55,884 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:27:55,885 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:27:55,885 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/ 200 1.1ms
2025-12-04 09:27:55,886 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/auditoria/autenticacion/ 200 0.8ms
2025-12-04 09:27:55,889 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:27:55,889 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:55,889 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:55,889 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:55,889 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:55,889 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:55,890 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:55,890 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:55,890 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:55,890 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:55,890 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:55,890 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:27:55,909 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:27:55,909 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:27:55,914 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:55,917 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:55,979 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 52, Página: 1
2025-12-04 09:27:55,980 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 91.7ms
2025-12-04 09:27:55,982 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:27:55,982 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:55,982 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:55,982 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:55,982 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:55,984 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:55,984 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:55,984 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:55,984 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:55,984 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:55,984 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:55,985 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/auditoria/autenticacion/
2025-12-04 09:27:56,005 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:27:56,006 - app.modules.superadmin.application.services.superadmin_auditoria_service - INFO - Obteniendo logs de autenticación - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1
2025-12-04 09:27:56,010 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:56,013 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:56,074 - app.modules.superadmin.presentation.endpoints_auditoria - INFO - Logs de autenticación recuperados - Total: 52, Página: 1
2025-12-04 09:27:56,075 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/auditoria/autenticacion/ 200 93.0ms
2025-12-04 09:27:57,318 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:27:57,318 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:57,318 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:57,319 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:57,319 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:57,319 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:57,319 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:57,319 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:57,319 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:57,319 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:57,320 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:57,320 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:27:57,338 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:27:57,338 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:27:57,342 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:57,345 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:57,348 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:57,357 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:57,364 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:57,373 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 3, Página: 1
2025-12-04 09:27:57,374 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 56.2ms
2025-12-04 09:27:57,375 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:27:57,375 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:57,375 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:57,377 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:57,377 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:57,377 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:57,377 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:57,377 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:57,377 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:57,377 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:57,378 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:57,378 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:27:57,395 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:27:57,397 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:27:57,400 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:57,404 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:57,407 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:57,414 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:57,423 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:57,430 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 3, Página: 1
2025-12-04 09:27:57,431 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 55.2ms
2025-12-04 09:27:58,795 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/
2025-12-04 09:27:58,795 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:58,795 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:58,796 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:58,796 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:58,796 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:58,796 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:58,796 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:58,796 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:58,796 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:58,798 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:58,798 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/
2025-12-04 09:27:58,802 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/
2025-12-04 09:27:58,805 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:27:58,805 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:27:58,805 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:58,805 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:58,805 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:58,806 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:27:58,807 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:27:58,807 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:27:58,807 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:27:58,807 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:27:58,807 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/
2025-12-04 09:27:58,835 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo sesiones para usuario e74ecdbb-16ae-41c0-b536-b602580bc5c2, cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:27:58,835 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [SESIONES] Usando cliente_id proporcionado: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:27:58,835 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:58,835 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo actividad para usuario e74ecdbb-16ae-41c0-b536-b602580bc5c2, cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:27:58,835 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [ACTIVIDAD] Usando cliente_id proporcionado: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:27:58,837 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:58,840 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:58,843 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:58,846 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/sesiones/ 200 44.4ms
2025-12-04 09:27:58,848 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:27:58,848 - app.infrastructure.database.queries_async - WARNING - execute_query recibió params vacío, ejecutando query sin parámetros
2025-12-04 09:27:58,853 - app.infrastructure.database.queries_async - ERROR - Error en execute_query async (string): (pyodbc.Error) ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')
[SQL: 
        SELECT COUNT(*) as total
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-04 09:27:58,853 - app.infrastructure.database.connection_async - ERROR - [ASYNC_CONNECTION] Error en sesión async: Error en la consulta: (pyodbc.Error) ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')
[SQL: 
        SELECT COUNT(*) as total
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.Error: ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 185, in execute_query
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2258, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')
[SQL: 
        SELECT COUNT(*) as total
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ]
(Background on this error at: https://sqlalche.me/e/20/dbapi)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\connection_async.py", line 326, in get_db_connection
    yield session
  File "D:\base_multi_tenant_fastapi\app\core\tenant\routing.py", line 869, in get_connection_for_tenant
    yield session
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 192, in execute_query
    raise DatabaseError(
app.core.exceptions.DatabaseError: Error en la consulta: (pyodbc.Error) ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')
[SQL: 
        SELECT COUNT(*) as total
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-04 09:27:58,863 - app.core.application.base_service - ERROR - DatabaseError en obtener_actividad_usuario: Error en la consulta: (pyodbc.Error) ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')
[SQL: 
        SELECT COUNT(*) as total
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.Error: ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 185, in execute_query
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2258, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 230, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 368, in _handle_exception
    raise error.with_traceback(exc_info[2])
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 228, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 251, in _execute_async
    result = await self._cursor.execute(operation, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')
[SQL: 
        SELECT COUNT(*) as total
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ]
(Background on this error at: https://sqlalche.me/e/20/dbapi)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\core\application\base_service.py", line 52, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\superadmin\application\services\superadmin_usuario_service.py", line 638, in obtener_actividad_usuario
    count_result = await execute_query(count_query, tuple(params[:-1]), client_id=usuario_cliente_id)  # Excluir límite
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\infrastructure\database\queries_async.py", line 192, in execute_query
    raise DatabaseError(
app.core.exceptions.DatabaseError: Error en la consulta: (pyodbc.Error) ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')
[SQL: 
        SELECT COUNT(*) as total
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-04 09:27:58,869 - app.modules.superadmin.presentation.endpoints_usuarios - ERROR - Error de negocio obteniendo actividad de usuario e74ecdbb-16ae-41c0-b536-b602580bc5c2: Error en la consulta: (pyodbc.Error) ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')
[SQL: 
        SELECT COUNT(*) as total
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-04 09:27:58,869 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/e74ecdbb-16ae-41c0-b536-b602580bc5c2/actividad/ 500 74.3ms
2025-12-04 09:28:04,877 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:28:04,878 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:28:04,878 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:28:04,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:04,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:04,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:04,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:04,878 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:04,879 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:04,879 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:28:04,879 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:28:04,879 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:28:04,879 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:28:04,881 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:28:04,881 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:28:04,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:04,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:04,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:04,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:04,881 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:04,882 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:04,882 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:28:04,882 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:28:04,882 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:28:04,908 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:28:04,908 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:28:04,918 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:28:04,918 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:28:04,922 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:28:04,923 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 46.2ms
2025-12-04 09:28:04,924 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:28:04,926 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:28:04,928 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:28:04,928 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:28:04,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:04,928 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:04,929 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:04,929 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:04,929 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:04,929 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:04,929 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:28:04,929 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:28:04,929 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/
2025-12-04 09:28:04,934 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:28:04,935 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 56.7ms
2025-12-04 09:28:04,941 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-12-04 09:28:04,942 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:28:04,942 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:28:04,942 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:04,944 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:04,944 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:04,944 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:04,944 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:04,944 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:04,944 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:28:04,945 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:28:04,945 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/modulos/
2025-12-04 09:28:04,969 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Solicitud GET /conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43 recibida
2025-12-04 09:28:04,969 - app.modules.tenant.application.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:28:04,976 - app.modules.tenant.presentation.endpoints_modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-12-04 09:28:04,976 - app.modules.tenant.application.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-12-04 09:28:04,977 - app.modules.tenant.presentation.endpoints_conexiones - INFO - Conexiones recuperadas para cliente ee7bfc14-995f-4209-b4b9-99c307534a43: 1 conexiones
2025-12-04 09:28:04,977 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/ 200 50.7ms
2025-12-04 09:28:04,979 - app.modules.tenant.application.services.modulo_service - INFO - Contando total de módulos en el sistema
2025-12-04 09:28:04,984 - app.modules.tenant.presentation.endpoints_modulos - INFO - Catálogo de módulos recuperado: 4 módulos de 4 totales
2025-12-04 09:28:04,984 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 42.6ms
2025-12-04 09:28:06,834 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:28:06,835 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:28:06,835 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:28:06,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:06,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:06,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:06,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:06,835 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:06,837 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:06,837 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:28:06,837 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:28:06,837 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:28:06,857 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:28:06,857 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:28:06,861 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:06,864 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:06,867 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:06,877 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:06,887 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:06,897 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 3, Página: 1
2025-12-04 09:28:06,898 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 63.1ms
2025-12-04 09:28:06,900 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:28:06,900 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:28:06,900 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:28:06,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:06,900 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:06,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:06,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:06,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:06,901 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:06,901 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:28:06,901 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:28:06,901 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/
2025-12-04 09:28:06,923 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Superadmin 154134ad-a5eb-4f45-aef0-5f9aaa282c8e solicitando usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 - page: 1, limit: 10
2025-12-04 09:28:06,923 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo usuarios globales - cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43, page: 1, limit: 10
2025-12-04 09:28:06,926 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:06,929 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:06,933 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:06,941 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:06,949 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:06,957 - app.modules.superadmin.presentation.endpoints_usuarios - INFO - Usuarios del cliente ee7bfc14-995f-4209-b4b9-99c307534a43 recuperados - Total: 3, Página: 1
2025-12-04 09:28:06,958 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/clientes/ee7bfc14-995f-4209-b4b9-99c307534a43/usuarios/ 200 58.7ms
2025-12-04 09:28:12,058 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/2458d1ea-816b-4c3c-8d13-b90271f59558/actividad/
2025-12-04 09:28:12,059 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/2458d1ea-816b-4c3c-8d13-b90271f59558/actividad/ 200 0.8ms
2025-12-04 09:28:12,059 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/superadmin/usuarios/2458d1ea-816b-4c3c-8d13-b90271f59558/sesiones/
2025-12-04 09:28:12,060 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/superadmin/usuarios/2458d1ea-816b-4c3c-8d13-b90271f59558/sesiones/ 200 1.0ms
2025-12-04 09:28:12,062 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/2458d1ea-816b-4c3c-8d13-b90271f59558/actividad/
2025-12-04 09:28:12,068 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:28:12,068 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:28:12,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:12,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:12,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:12,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:12,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:12,069 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:12,069 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:28:12,070 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:28:12,070 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/2458d1ea-816b-4c3c-8d13-b90271f59558/actividad/
2025-12-04 09:28:12,072 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/superadmin/usuarios/2458d1ea-816b-4c3c-8d13-b90271f59558/sesiones/
2025-12-04 09:28:12,074 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Host 'backend.app.local:8000' es localhost/infraestructura, buscando tenant real en origin/referer
2025-12-04 09:28:12,074 - app.core.tenant.middleware - INFO - [HOST_DETECTION] Desarrollo: Tenant extraído de 'origin': platform.app.local:5173
2025-12-04 09:28:12,074 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:12,074 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:12,074 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:12,074 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Procesando host: 'platform.app.local'
2025-12-04 09:28:12,074 - app.core.tenant.middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'app.local'
2025-12-04 09:28:12,074 - app.core.tenant.middleware - INFO - [SUBDOMAIN] Detectado: 'platform'
2025-12-04 09:28:12,075 - app.core.tenant.middleware - INFO - [TENANT] Subdominio SUPERADMIN: platform -> Cliente ID: bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7
2025-12-04 09:28:12,075 - app.core.tenant.middleware - INFO - [TENANT] Metadata cargada: tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-12-04 09:28:12,075 - app.core.tenant.middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=bba6fbad-4090-4ab8-b44a-4e8f5bc0bdb7, tipo_instalacion=cloud, db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A, path=/api/v1/superadmin/usuarios/2458d1ea-816b-4c3c-8d13-b90271f59558/sesiones/
2025-12-04 09:28:12,103 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo actividad para usuario 2458d1ea-816b-4c3c-8d13-b90271f59558, cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:28:12,104 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [ACTIVIDAD] Usando cliente_id proporcionado: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:28:12,104 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:12,105 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - Obteniendo sesiones para usuario 2458d1ea-816b-4c3c-8d13-b90271f59558, cliente_id: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:28:12,105 - app.modules.superadmin.application.services.superadmin_usuario_service - INFO - [SESIONES] Usando cliente_id proporcionado: ee7bfc14-995f-4209-b4b9-99c307534a43
2025-12-04 09:28:12,105 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:12,108 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:12,109 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:12,115 - app.infrastructure.database.queries_async - WARNING - [QUERY] DEPRECATED: execute_query() recibió string SQL. Migrar a SQLAlchemy Core.
2025-12-04 09:28:12,115 - app.infrastructure.database.queries_async - WARNING - execute_query recibió params vacío, ejecutando query sin parámetros
2025-12-04 09:28:12,117 - app.core.application.base_service - ERROR - ERROR INESPERADO en obtener_sesiones_usuario: 1 validation error for RefreshTokenInfo
token_id
  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value='AF541731-C9E5-4EC5-A3D7-95DFDE4AAC08', input_type=str]
    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\core\application\base_service.py", line 52, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\modules\superadmin\application\services\superadmin_usuario_service.py", line 750, in obtener_sesiones_usuario
    sesion = RefreshTokenInfo(
             ^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for RefreshTokenInfo
token_id
  Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value='AF541731-C9E5-4EC5-A3D7-95DFDE4AAC08', input_type=str]
    For further information visit https://errors.pydantic.dev/2.10/v/int_parsing
2025-12-04 09:28:12,118 - app.modules.superadmin.presentation.endpoints_usuarios - ERROR - Error de negocio obteniendo sesiones de usuario 2458d1ea-816b-4c3c-8d13-b90271f59558: Error interno del servidor en obtener_sesiones_usuario
2025-12-04 09:28:12,119 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/superadmin/usuarios/2458d1ea-816b-4c3c-8d13-b90271f59558/sesiones/ 500 46.1ms
2025-12-04 09:28:12,121 - app.infrastructure.database.queries_async - ERROR - Error en execute_query async (string): (pyodbc.Error) ('07002', '[07002] [Microsoft][ODBC Driver 17 for SQL Server]COUNT field incorrect or syntax error (0) (SQLExecDirectW)')
[SQL: 
        SELECT COUNT(*) as total
        FROM dbo.auth_audit_log a
        WHERE a.usuario_id = ?
        ]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
