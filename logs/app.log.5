2025-11-18 01:44:28,312 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 15.5ms
2025-11-18 01:44:28,317 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-11-18 01:44:28,317 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:44:28,318 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 01:44:28,318 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 01:44:28,318 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:44:28,318 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 01:44:28,318 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 01:44:28,318 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:44:28,319 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/
2025-11-18 01:44:28,324 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 01:44:28,324 - app.services.rol_service - INFO - Obteniendo roles paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 01:44:28,327 - app.services.rol_service - INFO - Obtención paginada de roles para cliente 1 completada exitosamente
2025-11-18 01:44:28,328 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 10.7ms
2025-11-18 01:44:29,004 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-11-18 01:44:29,004 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:44:29,004 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 01:44:29,005 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 01:44:29,005 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:44:29,005 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 01:44:29,005 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 01:44:29,005 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:44:29,005 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/areas/
2025-11-18 01:44:29,011 - app.api.v1.endpoints.areas - INFO - Solicitud GET /areas/ recibida por usuario 1 del cliente 1 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-11-18 01:44:29,011 - app.services.area_service - INFO - Obteniendo áreas paginadas para cliente 1: skip=0, limit=10, search='None'
2025-11-18 01:44:29,015 - app.services.area_service - INFO - Paginación completada para cliente 1: 0 áreas de 0 totales
2025-11-18 01:44:29,015 - app.api.v1.endpoints.areas - INFO - Lista paginada de áreas recuperada para cliente 1 - Total: 0, Página: 1
2025-11-18 01:44:29,015 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 12.0ms
2025-11-18 01:44:29,018 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-11-18 01:44:29,018 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:44:29,018 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 01:44:29,019 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 01:44:29,019 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:44:29,019 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 01:44:29,019 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 01:44:29,019 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:44:29,019 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/areas/
2025-11-18 01:44:29,025 - app.api.v1.endpoints.areas - INFO - Solicitud GET /areas/ recibida por usuario 1 del cliente 1 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-11-18 01:44:29,025 - app.services.area_service - INFO - Obteniendo áreas paginadas para cliente 1: skip=0, limit=10, search='None'
2025-11-18 01:44:29,027 - app.services.area_service - INFO - Paginación completada para cliente 1: 0 áreas de 0 totales
2025-11-18 01:44:29,027 - app.api.v1.endpoints.areas - INFO - Lista paginada de áreas recuperada para cliente 1 - Total: 0, Página: 1
2025-11-18 01:44:29,027 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 9.6ms
2025-11-18 01:44:30,635 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-11-18 01:44:30,636 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:44:30,636 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 01:44:30,636 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 01:44:30,636 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:44:30,636 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 01:44:30,636 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 01:44:30,637 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:44:30,637 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/areas/list/
2025-11-18 01:44:30,642 - app.api.v1.endpoints.areas - INFO - Solicitud GET /areas/list/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 01:44:30,643 - app.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente 1
2025-11-18 01:44:30,645 - app.services.area_service - INFO - No se encontraron áreas activas para el cliente 1 en la lista simple
2025-11-18 01:44:30,645 - app.api.v1.endpoints.areas - INFO - Lista simple de áreas recuperada para cliente 1 - Total: 0 áreas activas
2025-11-18 01:44:30,646 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 11.1ms
2025-11-18 01:44:30,648 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/list/
2025-11-18 01:44:30,648 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:44:30,648 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 01:44:30,648 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 01:44:30,649 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:44:30,649 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 01:44:30,649 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 01:44:30,649 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:44:30,649 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/areas/list/
2025-11-18 01:44:30,655 - app.api.v1.endpoints.areas - INFO - Solicitud GET /areas/list/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 01:44:30,655 - app.services.area_service - INFO - Obteniendo lista simple de áreas activas para cliente 1
2025-11-18 01:44:30,656 - app.services.area_service - INFO - No se encontraron áreas activas para el cliente 1 en la lista simple
2025-11-18 01:44:30,656 - app.api.v1.endpoints.areas - INFO - Lista simple de áreas recuperada para cliente 1 - Total: 0 áreas activas
2025-11-18 01:44:30,656 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/list/ 200 8.8ms
2025-11-18 01:45:19,018 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 01:45:19,019 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:45:19,019 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 01:45:19,020 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 01:45:19,020 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:45:19,020 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 01:45:19,020 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 01:45:19,020 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:45:19,020 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 01:45:19,028 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 01:45:19,028 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 01:45:19,028 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 01:45:19,029 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 10.3ms
2025-11-18 01:45:25,280 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 01:45:25,280 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.4ms
2025-11-18 01:45:25,592 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 01:45:25,592 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:45:25,592 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 01:45:25,593 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 01:45:25,593 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:45:25,593 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 01:45:25,596 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 01:45:25,599 - app.core.encryption - ERROR - Token de encriptación inválido. Posibles causas: clave incorrecta o datos corruptos
2025-11-18 01:45:25,599 - app.core.multi_db - ERROR - [METADATA] Error al desencriptar credenciales para cliente 2: Credencial corrupta o clave de encriptación incorrecta
2025-11-18 01:45:25,600 - app.core.multi_db - WARNING - [METADATA] No se encontró configuración para cliente 2, usando Single-DB como fallback
2025-11-18 01:45:25,600 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:45:25,600 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 01:45:25,601 - app.core.auth - WARNING - [REFRESH] No se proporcionó refresh token. Cliente: web
2025-11-18 01:45:25,601 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 9.5ms
2025-11-18 01:45:42,040 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 01:45:42,041 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.6ms
2025-11-18 01:45:42,358 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 01:45:42,358 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:45:42,358 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 01:45:42,358 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 01:45:42,359 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:45:42,359 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 01:45:42,362 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 01:45:42,362 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:45:42,362 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 01:45:42,365 - app.api.v1.endpoints.auth - INFO - Cliente 2 resuelto y validado para login.
2025-11-18 01:45:42,365 - app.core.auth - INFO - [AUTH] Intento de login: username='admin_acme', cliente_id_destino=2
2025-11-18 01:45:42,365 - app.core.auth - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=2
2025-11-18 01:45:42,368 - app.core.auth - WARNING - [AUTH] Usuario NO ENCONTRADO: username='admin_acme', cliente_id_buscado=2
2025-11-18 01:45:42,369 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 401 11.1ms
2025-11-18 01:46:45,166 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 01:46:45,167 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.4ms
2025-11-18 01:46:45,472 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 01:46:45,472 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:46:45,473 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': techcorp.midominio.com:5173
2025-11-18 01:46:45,473 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 01:46:45,473 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:46:45,473 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 01:46:45,486 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 01:46:45,492 - app.core.encryption - ERROR - Token de encriptación inválido. Posibles causas: clave incorrecta o datos corruptos
2025-11-18 01:46:45,492 - app.core.multi_db - ERROR - [METADATA] Error al desencriptar credenciales para cliente 4: Credencial corrupta o clave de encriptación incorrecta
2025-11-18 01:46:45,493 - app.core.multi_db - WARNING - [METADATA] No se encontró configuración para cliente 4, usando Single-DB como fallback
2025-11-18 01:46:45,493 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:46:45,493 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 01:46:45,494 - app.core.auth - WARNING - [REFRESH] No se proporcionó refresh token. Cliente: web
2025-11-18 01:46:45,495 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 22.7ms
2025-11-18 01:46:59,371 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 01:46:59,371 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.5ms
2025-11-18 01:46:59,373 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 01:46:59,373 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:46:59,373 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': techcorp.midominio.com:5173
2025-11-18 01:46:59,373 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 01:46:59,374 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:46:59,374 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 01:46:59,376 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 01:46:59,376 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:46:59,377 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 01:46:59,379 - app.api.v1.endpoints.auth - INFO - Cliente 4 resuelto y validado para login.
2025-11-18 01:46:59,380 - app.core.auth - INFO - [AUTH] Intento de login: username='admin_tech', cliente_id_destino=4
2025-11-18 01:46:59,380 - app.core.auth - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=4
2025-11-18 01:46:59,610 - app.core.auth - INFO - Niveles calculados - Usuario 2: level=4, super_admin=False, type=tenant_admin
2025-11-18 01:46:59,610 - app.core.auth - INFO - [AUTH] Login exitoso: username='admin_tech', usuario_id=2, cliente_origen=4, cliente_destino=N/A, access_level=4, user_type=tenant_admin
2025-11-18 01:46:59,617 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 01:46:59,618 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 4, Usuario 2 - Cliente: web - Token ID: 1038
2025-11-18 01:46:59,618 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1038
2025-11-18 01:46:59,618 - app.api.v1.endpoints.auth - INFO - Usuario admin_tech autenticado exitosamente (WEB) para cliente 4
2025-11-18 01:46:59,619 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 245.9ms
2025-11-18 01:46:59,642 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 01:46:59,642 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.6ms
2025-11-18 01:46:59,644 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 01:46:59,645 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:46:59,645 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': techcorp.midominio.com:5173
2025-11-18 01:46:59,645 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 01:46:59,645 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:46:59,646 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 01:46:59,647 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 01:46:59,647 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:46:59,647 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 01:46:59,648 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 01:46:59,656 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 2 del cliente 4
2025-11-18 01:46:59,656 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 2
2025-11-18 01:46:59,658 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:46:59,658 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:46:59,659 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 2: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:46:59,659 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 2: Error de base de datos al obtener menú del usuario
2025-11-18 01:46:59,660 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 12.0ms
2025-11-18 01:46:59,660 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 15.6ms
2025-11-18 01:46:59,662 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 01:46:59,662 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:46:59,662 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': techcorp.midominio.com:5173
2025-11-18 01:46:59,662 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 01:46:59,662 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:46:59,663 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 01:46:59,664 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 01:46:59,664 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:46:59,664 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 01:46:59,668 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 2 del cliente 4
2025-11-18 01:46:59,668 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 2
2025-11-18 01:46:59,669 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:46:59,669 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:46:59,670 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 2: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:46:59,670 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 2: Error de base de datos al obtener menú del usuario
2025-11-18 01:46:59,671 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 9.4ms
2025-11-18 01:47:20,567 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 01:47:20,567 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:47:20,567 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 01:47:20,568 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 01:47:20,568 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:47:20,568 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 01:47:20,571 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 01:47:20,571 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:47:20,571 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 01:47:20,574 - app.api.v1.endpoints.auth - INFO - Cliente 2 resuelto y validado para login.
2025-11-18 01:47:20,574 - app.core.auth - INFO - [AUTH] Intento de login: username='admin_acme', cliente_id_destino=2
2025-11-18 01:47:20,574 - app.core.auth - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=2
2025-11-18 01:47:20,576 - app.core.auth - WARNING - [AUTH] Usuario NO ENCONTRADO: username='admin_acme', cliente_id_buscado=2
2025-11-18 01:47:20,577 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 401 9.6ms
2025-11-18 01:47:23,346 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 01:47:23,346 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.5ms
2025-11-18 01:47:23,349 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 01:47:23,349 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:47:23,349 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': innova.midominio.com:5173
2025-11-18 01:47:23,349 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.midominio.com'
2025-11-18 01:47:23,350 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:47:23,350 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-11-18 01:47:23,352 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=3
2025-11-18 01:47:23,357 - app.core.encryption - ERROR - Token de encriptación inválido. Posibles causas: clave incorrecta o datos corruptos
2025-11-18 01:47:23,358 - app.core.multi_db - ERROR - [METADATA] Error al desencriptar credenciales para cliente 3: Credencial corrupta o clave de encriptación incorrecta
2025-11-18 01:47:23,358 - app.core.multi_db - WARNING - [METADATA] No se encontró configuración para cliente 3, usando Single-DB como fallback
2025-11-18 01:47:23,359 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:47:23,359 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=3, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 01:47:23,360 - app.core.auth - WARNING - [REFRESH] No se proporcionó refresh token. Cliente: web
2025-11-18 01:47:23,361 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 12.3ms
2025-11-18 01:47:37,007 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 01:47:37,008 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.4ms
2025-11-18 01:47:37,009 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 01:47:37,010 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:47:37,010 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': innova.midominio.com:5173
2025-11-18 01:47:37,010 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'innova.midominio.com'
2025-11-18 01:47:37,010 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:47:37,010 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'innova'
2025-11-18 01:47:37,011 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='innova', Código='INNOVA002', ID=3
2025-11-18 01:47:37,011 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:47:37,012 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=3, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 01:47:37,014 - app.api.v1.endpoints.auth - INFO - Cliente 3 resuelto y validado para login.
2025-11-18 01:47:37,014 - app.core.auth - INFO - [AUTH] Intento de login: username='admin_innova', cliente_id_destino=3
2025-11-18 01:47:37,014 - app.core.auth - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=3
2025-11-18 01:47:37,017 - app.core.auth - WARNING - [AUTH] Usuario NO ENCONTRADO: username='admin_innova', cliente_id_buscado=3
2025-11-18 01:47:37,017 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 401 7.9ms
2025-11-18 01:47:52,014 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 01:47:52,014 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.4ms
2025-11-18 01:47:52,330 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 01:47:52,330 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:47:52,330 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': global.midominio.com:5173
2025-11-18 01:47:52,331 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'global.midominio.com'
2025-11-18 01:47:52,331 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:47:52,331 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-11-18 01:47:52,334 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='global', Código='GLOBAL004', ID=5
2025-11-18 01:47:52,337 - app.core.encryption - ERROR - Token de encriptación inválido. Posibles causas: clave incorrecta o datos corruptos
2025-11-18 01:47:52,337 - app.core.multi_db - ERROR - [METADATA] Error al desencriptar credenciales para cliente 5: Credencial corrupta o clave de encriptación incorrecta
2025-11-18 01:47:52,338 - app.core.multi_db - WARNING - [METADATA] No se encontró configuración para cliente 5, usando Single-DB como fallback
2025-11-18 01:47:52,338 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:47:52,338 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=5, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 01:47:52,341 - app.api.v1.endpoints.auth - INFO - Cliente 5 resuelto y validado para login.
2025-11-18 01:47:52,341 - app.core.auth - INFO - [AUTH] Intento de login: username='admin_global', cliente_id_destino=5
2025-11-18 01:47:52,341 - app.core.auth - INFO - [AUTH] Usuario regular. Buscando en BD del cliente_id=5
2025-11-18 01:47:52,562 - app.core.auth - INFO - Niveles calculados - Usuario 4: level=4, super_admin=False, type=tenant_admin
2025-11-18 01:47:52,562 - app.core.auth - INFO - [AUTH] Login exitoso: username='admin_global', usuario_id=4, cliente_origen=5, cliente_destino=N/A, access_level=4, user_type=tenant_admin
2025-11-18 01:47:52,569 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 01:47:52,569 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 5, Usuario 4 - Cliente: web - Token ID: 1039
2025-11-18 01:47:52,569 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1039
2025-11-18 01:47:52,570 - app.api.v1.endpoints.auth - INFO - Usuario admin_global autenticado exitosamente (WEB) para cliente 5
2025-11-18 01:47:52,570 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 240.5ms
2025-11-18 01:47:52,619 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 01:47:52,620 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.4ms
2025-11-18 01:47:52,622 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 01:47:52,623 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:47:52,623 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': global.midominio.com:5173
2025-11-18 01:47:52,623 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'global.midominio.com'
2025-11-18 01:47:52,623 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:47:52,623 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-11-18 01:47:52,624 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='global', Código='GLOBAL004', ID=5
2025-11-18 01:47:52,625 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:47:52,625 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=5, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 01:47:52,634 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 4 del cliente 5
2025-11-18 01:47:52,635 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 4
2025-11-18 01:47:52,636 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:47:52,636 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:47:52,637 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 4: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:47:52,637 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 4: Error de base de datos al obtener menú del usuario
2025-11-18 01:47:52,638 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 15.4ms
2025-11-18 01:47:52,640 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 01:47:52,640 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 01:47:52,640 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': global.midominio.com:5173
2025-11-18 01:47:52,641 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'global.midominio.com'
2025-11-18 01:47:52,641 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 01:47:52,641 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'global'
2025-11-18 01:47:52,642 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='global', Código='GLOBAL004', ID=5
2025-11-18 01:47:52,642 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 01:47:52,642 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=5, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 01:47:52,646 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 4 del cliente 5
2025-11-18 01:47:52,647 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 4
2025-11-18 01:47:52,648 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:47:52,648 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:47:52,650 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 4: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 01:47:52,650 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 4: Error de base de datos al obtener menú del usuario
2025-11-18 01:47:52,650 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 10.9ms
2025-11-18 02:09:58,619 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 02:09:58,620 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.5ms
2025-11-18 02:09:58,937 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 02:09:58,937 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:09:58,937 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:09:58,937 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:09:58,938 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:09:58,938 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:09:58,938 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:09:58,938 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:09:58,938 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 02:09:58,951 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 02:09:58,951 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 02:09:58,951 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 02:09:59,173 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 02:09:59,173 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 02:09:59,173 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 02:09:59,176 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 02:09:59,177 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1040
2025-11-18 02:09:59,177 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1040
2025-11-18 02:09:59,177 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 02:09:59,178 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 240.8ms
2025-11-18 02:09:59,193 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 02:09:59,194 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.7ms
2025-11-18 02:09:59,194 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 02:09:59,196 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.5ms
2025-11-18 02:09:59,198 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 02:09:59,198 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 02:09:59,199 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:09:59,199 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:09:59,199 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:09:59,199 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:09:59,199 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:09:59,200 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:09:59,200 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:09:59,200 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 02:09:59,210 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 02:09:59,211 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 02:09:59,212 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:09:59,212 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:09:59,213 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 1: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:09:59,213 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 1: Error de base de datos al obtener menú del usuario
2025-11-18 02:09:59,214 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 02:09:59,214 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 16.3ms
2025-11-18 02:09:59,214 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:09:59,214 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:09:59,215 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:09:59,215 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:09:59,215 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:09:59,215 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:09:59,215 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:09:59,215 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 02:09:59,216 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 02:09:59,223 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 02:09:59,223 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 02:09:59,234 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 02:09:59,234 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 02:09:59,235 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 36.9ms
2025-11-18 02:09:59,235 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 19.5ms
2025-11-18 02:09:59,236 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 22.2ms
2025-11-18 02:09:59,238 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 02:09:59,240 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 2.0ms
2025-11-18 02:09:59,240 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 02:09:59,240 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 02:09:59,241 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:09:59,241 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:09:59,242 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:09:59,242 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:09:59,242 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:09:59,242 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:09:59,242 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:09:59,242 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 02:09:59,247 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 02:09:59,249 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 02:09:59,249 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 02:09:59,250 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 02:09:59,250 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 10.0ms
2025-11-18 02:09:59,250 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:09:59,250 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:09:59,251 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:09:59,251 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:09:59,251 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:09:59,251 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:09:59,251 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:09:59,251 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 02:09:59,255 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 02:09:59,255 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 02:09:59,256 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:09:59,257 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:09:59,258 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 1: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:09:59,258 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 1: Error de base de datos al obtener menú del usuario
2025-11-18 02:09:59,259 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 18.7ms
2025-11-18 02:09:59,260 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 10.1ms
2025-11-18 02:09:59,262 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 02:09:59,262 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:09:59,262 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:09:59,263 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:09:59,263 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:09:59,263 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:09:59,263 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:09:59,263 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:09:59,263 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 02:09:59,267 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 02:09:59,267 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 02:09:59,271 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 02:09:59,272 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 02:09:59,272 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 02:09:59,273 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:09:59,273 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:09:59,273 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:09:59,273 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:09:59,273 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:09:59,273 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:09:59,274 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:09:59,274 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 02:09:59,278 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 02:09:59,279 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 02:09:59,280 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 02:09:59,280 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 18.0ms
2025-11-18 02:09:59,281 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 8.3ms
2025-11-18 02:10:14,835 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 02:10:14,835 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.6ms
2025-11-18 02:10:14,838 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 02:10:14,838 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:14,838 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:14,838 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:14,838 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:14,839 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:14,839 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:14,839 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:14,839 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 02:10:14,847 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 02:10:14,851 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 02:10:14,858 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 02:10:14,858 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 02:10:14,858 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 02:10:14,863 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 02:10:14,863 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1041
2025-11-18 02:10:14,863 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 1041
2025-11-18 02:10:14,864 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 02:10:14,864 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 26.6ms
2025-11-18 02:10:14,868 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-18 02:10:14,869 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.7ms
2025-11-18 02:10:14,872 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 02:10:14,872 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:14,872 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:14,872 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:14,873 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:14,873 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:14,873 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:14,873 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:14,873 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 02:10:14,876 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 02:10:14,876 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 02:10:14,890 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 02:10:14,890 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 02:10:14,891 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 19.5ms
2025-11-18 02:10:16,347 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 02:10:16,348 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:16,348 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:16,348 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:16,348 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:16,348 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:16,349 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:16,349 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:16,349 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 02:10:16,361 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 02:10:16,361 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 02:10:16,362 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:16,363 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:16,364 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 1: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:16,364 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 1: Error de base de datos al obtener menú del usuario
2025-11-18 02:10:16,365 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 17.3ms
2025-11-18 02:10:16,367 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 02:10:16,367 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:16,367 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:16,367 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:16,367 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:16,368 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:16,368 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:16,368 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:16,368 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 02:10:16,373 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 02:10:16,373 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 02:10:16,374 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:16,374 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:16,375 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 1: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:16,376 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 1: Error de base de datos al obtener menú del usuario
2025-11-18 02:10:16,376 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 9.6ms
2025-11-18 02:10:24,840 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 02:10:24,840 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:24,840 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:24,841 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:24,841 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:24,841 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:24,841 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:24,841 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:24,842 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 02:10:24,850 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 02:10:24,853 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 02:10:24,859 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 02:10:24,860 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 02:10:24,860 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 02:10:24,865 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 02:10:24,866 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1042
2025-11-18 02:10:24,866 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 1042
2025-11-18 02:10:24,866 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 02:10:24,867 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 27.3ms
2025-11-18 02:10:24,871 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 02:10:24,871 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:24,871 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:24,872 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:24,872 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:24,872 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:24,872 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:24,872 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:24,872 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 02:10:24,875 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 02:10:24,875 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 02:10:24,890 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 02:10:24,890 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 02:10:24,891 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 19.9ms
2025-11-18 02:10:24,903 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 02:10:24,903 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:24,903 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:24,903 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:24,904 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:24,904 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:24,904 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:24,904 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:24,904 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 02:10:24,913 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 02:10:24,914 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 02:10:24,915 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:24,915 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:24,917 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 1: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:24,917 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 1: Error de base de datos al obtener menú del usuario
2025-11-18 02:10:24,917 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 14.9ms
2025-11-18 02:10:24,919 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 02:10:24,920 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:24,920 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:24,920 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:24,920 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:24,920 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:24,921 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:24,921 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:24,921 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 02:10:24,925 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 02:10:24,925 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 02:10:24,926 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:24,926 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:24,927 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 1: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:24,928 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 1: Error de base de datos al obtener menú del usuario
2025-11-18 02:10:24,928 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 8.8ms
2025-11-18 02:10:29,121 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-18 02:10:29,122 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.5ms
2025-11-18 02:10:29,123 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 02:10:29,124 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:29,124 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:29,124 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:29,124 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:29,124 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:29,124 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:29,124 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:29,125 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 02:10:29,127 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 02:10:29,127 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 02:10:29,127 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 02:10:29,128 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 4.3ms
2025-11-18 02:10:41,624 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 02:10:41,625 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:41,625 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:41,625 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:41,625 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:41,625 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:41,626 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:41,626 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:41,626 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 02:10:41,630 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 02:10:41,630 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 02:10:41,630 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 02:10:41,852 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 02:10:41,852 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 02:10:41,852 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 02:10:41,853 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 02:10:41,854 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1043
2025-11-18 02:10:41,854 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1043
2025-11-18 02:10:41,854 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 02:10:41,855 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 230.4ms
2025-11-18 02:10:41,876 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 02:10:41,877 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:41,877 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:41,877 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:41,877 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:41,877 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:41,878 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:41,878 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:41,878 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 02:10:41,878 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 02:10:41,883 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 02:10:41,883 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 02:10:41,887 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:41,888 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:41,889 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 1: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:41,889 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 1: Error de base de datos al obtener menú del usuario
2025-11-18 02:10:41,889 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:41,889 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:41,890 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:41,890 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:41,890 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:41,890 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:41,890 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:41,890 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 02:10:41,900 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 02:10:41,900 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 02:10:41,911 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 02:10:41,912 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 02:10:41,912 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 36.2ms
2025-11-18 02:10:41,913 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 34.4ms
2025-11-18 02:10:41,915 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 02:10:41,916 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:41,916 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:41,916 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:41,916 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:41,916 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:41,917 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:41,917 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:41,917 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 02:10:41,923 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 02:10:41,925 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 02:10:41,925 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 02:10:41,926 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 02:10:41,926 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:41,926 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:41,926 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:41,927 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:41,927 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:41,927 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:41,927 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:41,927 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 02:10:41,932 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 02:10:41,932 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 02:10:41,933 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:41,933 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:41,934 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 1: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 02:10:41,935 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 1: Error de base de datos al obtener menú del usuario
2025-11-18 02:10:41,935 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 20.1ms
2025-11-18 02:10:41,936 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 9.9ms
2025-11-18 02:10:41,937 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 02:10:41,938 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:41,938 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:41,938 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:41,938 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:41,938 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:41,939 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:41,939 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:41,939 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 02:10:41,944 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 02:10:41,944 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 02:10:41,949 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 02:10:41,949 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 02:10:41,950 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 02:10:41,950 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 02:10:41,950 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 02:10:41,950 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 02:10:41,951 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 02:10:41,951 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 02:10:41,951 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 02:10:41,951 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 02:10:41,951 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 02:10:41,956 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 02:10:41,957 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 02:10:41,957 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 02:10:41,957 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 20.1ms
2025-11-18 02:10:41,958 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 8.8ms
2025-11-18 08:03:27,369 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 09:09:25,336 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /docs
2025-11-18 09:09:25,337 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:09:25,337 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 09:09:25,337 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 09:09:25,337 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:09:25,337 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:09:25,338 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:09:25,338 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:09:25,338 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/docs
2025-11-18 09:09:25,341 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /docs 200 5.2ms
2025-11-18 09:09:25,586 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /openapi.json
2025-11-18 09:09:25,587 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:09:25,587 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 09:09:25,587 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 09:09:25,588 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:09:25,588 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:09:25,588 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:09:25,588 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:09:25,588 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/openapi.json
2025-11-18 09:09:25,727 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /openapi.json 200 140.5ms
2025-11-18 09:10:10,540 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 09:10:10,540 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.5ms
2025-11-18 09:10:10,844 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 09:10:10,844 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:10,844 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:10,844 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:10,844 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:10,844 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:10,844 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:10,845 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:10,845 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 09:10:10,975 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 09:10:10,978 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 09:10:10,983 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 09:10:10,984 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 09:10:10,984 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 09:10:11,000 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 09:10:11,001 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1044
2025-11-18 09:10:11,001 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 1044
2025-11-18 09:10:11,001 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 09:10:11,002 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 158.0ms
2025-11-18 09:10:11,006 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-18 09:10:11,007 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.5ms
2025-11-18 09:10:11,009 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 09:10:11,009 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:11,009 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:11,010 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:11,010 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:11,010 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:11,010 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:11,010 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:11,010 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 09:10:11,013 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 09:10:11,013 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 09:10:11,031 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 09:10:11,031 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 09:10:11,032 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 23.0ms
2025-11-18 09:10:25,813 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 09:10:25,813 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.4ms
2025-11-18 09:10:25,815 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 09:10:25,815 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:25,815 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:25,815 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:25,815 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:25,816 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:25,816 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:25,816 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:25,816 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 09:10:25,822 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 09:10:25,822 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 09:10:25,822 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 09:10:26,063 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 09:10:26,063 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 09:10:26,063 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 09:10:26,065 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 09:10:26,065 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1045
2025-11-18 09:10:26,065 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1045
2025-11-18 09:10:26,065 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 09:10:26,066 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 251.2ms
2025-11-18 09:10:26,096 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 09:10:26,097 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.8ms
2025-11-18 09:10:26,099 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 09:10:26,099 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 0.5ms
2025-11-18 09:10:26,101 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:10:26,101 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:26,101 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:26,102 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:26,102 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:26,102 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:26,102 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:26,102 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:26,103 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:10:26,123 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:10:26,123 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:10:26,132 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 09:10:26,133 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 09:10:26,166 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 1: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 09:10:26,166 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 1: Error de base de datos al obtener menú del usuario
2025-11-18 09:10:26,167 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 09:10:26,167 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 66.6ms
2025-11-18 09:10:26,168 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 0.7ms
2025-11-18 09:10:26,170 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 09:10:26,170 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:26,170 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:26,171 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:26,171 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:26,171 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:26,171 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:26,171 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:26,171 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 09:10:26,172 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 09:10:26,182 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 09:10:26,182 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 09:10:26,193 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 09:10:26,194 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 09:10:26,194 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 22.4ms
2025-11-18 09:10:26,194 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 24.8ms
2025-11-18 09:10:26,196 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 09:10:26,197 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 0.7ms
2025-11-18 09:10:26,197 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 09:10:26,197 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:26,198 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:26,198 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:26,198 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:26,198 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:26,198 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:26,198 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:26,199 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 09:10:26,205 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 09:10:26,208 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 09:10:26,208 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 09:10:26,209 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 11.7ms
2025-11-18 09:10:26,210 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 09:10:26,210 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 0.5ms
2025-11-18 09:10:26,211 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:10:26,211 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:26,212 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:26,212 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:26,212 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:26,212 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:26,212 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:26,212 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:26,213 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:10:26,216 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:10:26,216 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:10:26,216 - app.db.queries - ERROR - Error en execute_procedure_params: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 09:10:26,217 - app.db.connection - ERROR - Error general en la gestión de conexión: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 175, in execute_procedure_params
    cursor.execute(query, tuple(params.values()))
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\app\db\connection.py", line 63, in get_db_connection
    yield conn
  File "D:\base_multi_tenant_fastapi\app\db\queries.py", line 187, in execute_procedure_params
    raise DatabaseError(
    ...<2 lines>...
    )
app.core.exceptions.DatabaseError: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 09:10:26,218 - app.services.menu_service - ERROR - Error de BD al obtener menú para usuario 1: Error en el procedimiento: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Could not find stored procedure 'sp_GetMenuForUser'. (2812) (SQLExecDirectW)")
2025-11-18 09:10:26,218 - app.api.v1.endpoints.menus - ERROR - Error de servicio en GET /getmenu/ para usuario 1: Error de base de datos al obtener menú del usuario
2025-11-18 09:10:26,219 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 500 7.5ms
2025-11-18 09:10:26,220 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 09:10:26,220 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:26,221 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:26,221 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:26,221 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:26,221 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:26,221 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:26,221 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:26,222 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 09:10:26,227 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 09:10:26,227 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 09:10:26,231 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 09:10:26,231 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 09:10:26,231 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 11.1ms
2025-11-18 09:10:26,233 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 09:10:26,233 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:26,234 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:26,234 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:26,234 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:26,234 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:26,234 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:26,234 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:26,235 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 09:10:26,238 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 09:10:26,239 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 09:10:26,239 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 09:10:26,240 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.0ms
2025-11-18 09:10:29,629 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:10:29,630 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:10:29,630 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 1.2ms
2025-11-18 09:10:29,631 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 1.1ms
2025-11-18 09:10:29,633 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:10:29,633 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:29,633 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:29,633 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:29,634 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:29,634 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:29,634 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:29,634 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:29,635 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:10:29,636 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.9ms
2025-11-18 09:10:29,638 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:10:29,639 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:29,639 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:29,639 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:29,639 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:29,639 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:29,640 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:29,640 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:29,640 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:10:29,641 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.6ms
2025-11-18 09:10:35,703 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos
2025-11-18 09:10:35,704 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos 200 0.8ms
2025-11-18 09:10:35,704 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos
2025-11-18 09:10:35,705 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos 200 0.8ms
2025-11-18 09:10:35,706 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 09:10:35,707 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:35,707 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:35,707 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:35,707 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:35,707 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:35,708 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:35,708 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:35,708 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 09:10:35,709 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 2.6ms
2025-11-18 09:10:35,711 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 09:10:35,712 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:35,712 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:35,712 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:35,712 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:35,713 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:35,713 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:35,713 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:35,713 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 09:10:35,714 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 3.0ms
2025-11-18 09:10:40,717 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:10:40,718 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:10:40,718 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 1.0ms
2025-11-18 09:10:40,718 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.8ms
2025-11-18 09:10:40,721 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:10:40,722 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:40,722 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:40,722 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:40,722 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:40,722 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:40,723 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:40,723 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:40,723 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:10:40,724 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.7ms
2025-11-18 09:10:40,726 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:10:40,726 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:40,727 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:40,728 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:40,728 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:40,728 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:40,728 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:40,728 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:40,729 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:10:40,730 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 4.3ms
2025-11-18 09:10:57,247 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:10:57,248 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:57,248 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:57,248 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:57,249 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:57,249 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:57,249 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:57,249 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:57,249 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:10:57,250 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.9ms
2025-11-18 09:10:57,253 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:10:57,253 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:10:57,253 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:10:57,253 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:10:57,254 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:10:57,254 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:10:57,254 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:10:57,254 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:10:57,254 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:10:57,255 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.8ms
2025-11-18 09:12:48,195 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:12:48,195 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:12:48,196 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:12:48,196 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:12:48,196 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:12:48,196 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:12:48,196 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:12:48,196 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:12:48,196 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:12:48,197 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.0ms
2025-11-18 09:14:33,692 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:14:33,692 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.8ms
2025-11-18 09:14:34,008 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:14:34,008 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:14:34,008 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:14:34,008 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:14:34,009 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:14:34,009 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:14:34,009 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:14:34,009 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:14:34,009 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:14:34,010 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.1ms
2025-11-18 09:23:00,372 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:23:00,373 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 1.1ms
2025-11-18 09:23:02,312 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 09:23:02,353 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:23:02,353 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:23:02,354 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:23:02,354 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:23:02,354 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:23:02,354 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:23:02,354 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:23:02,354 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:23:02,355 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:23:02,355 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.0ms
2025-11-18 09:34:17,370 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:34:17,371 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.6ms
2025-11-18 09:34:17,681 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:34:17,682 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:34:17,682 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:34:17,682 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:34:17,682 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:34:17,682 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:34:17,682 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:34:17,683 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:34:17,683 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:34:17,683 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.3ms
2025-11-18 09:35:00,132 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 09:35:00,133 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.7ms
2025-11-18 09:35:00,135 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 09:35:00,136 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:00,136 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:00,136 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:00,136 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:00,137 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:00,137 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:00,137 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:00,137 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 09:35:00,174 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 09:35:00,175 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 09:35:00,176 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 09:35:00,176 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 09:35:00,177 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 09:35:00,178 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 09:35:00,178 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1046
2025-11-18 09:35:00,178 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 1046
2025-11-18 09:35:00,179 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 09:35:00,179 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 44.1ms
2025-11-18 09:35:00,184 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-18 09:35:00,184 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.4ms
2025-11-18 09:35:00,186 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 09:35:00,186 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:00,186 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:00,187 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:00,187 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:00,187 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:00,187 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:00,187 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:00,187 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 09:35:00,189 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 09:35:00,190 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 09:35:00,192 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 09:35:00,192 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 09:35:00,193 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 7.0ms
2025-11-18 09:35:01,706 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 09:35:01,706 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.6ms
2025-11-18 09:35:01,708 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 09:35:01,709 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:35:01,709 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.2ms
2025-11-18 09:35:01,710 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:01,710 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:01,710 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:01,710 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:01,710 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:01,711 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:01,711 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:01,711 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:35:01,716 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:35:01,716 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:35:01,759 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:35:01,760 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 51.4ms
2025-11-18 09:35:01,762 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:35:01,763 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:01,763 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:01,763 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:01,763 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:01,763 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:01,763 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:01,764 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:01,764 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:35:01,768 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:35:01,768 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:35:01,769 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:35:01,769 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.1ms
2025-11-18 09:35:04,079 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-18 09:35:04,079 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.6ms
2025-11-18 09:35:04,081 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 09:35:04,081 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:04,081 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:04,082 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:04,082 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:04,082 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:04,082 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:04,082 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:04,082 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 09:35:04,084 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 09:35:04,085 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 09:35:04,085 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 09:35:04,086 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 4.5ms
2025-11-18 09:35:13,816 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 09:35:13,817 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.6ms
2025-11-18 09:35:13,819 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 09:35:13,819 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:13,819 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:13,820 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:13,820 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:13,820 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:13,820 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:13,820 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:13,820 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 09:35:13,825 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 09:35:13,825 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 09:35:13,825 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 09:35:14,062 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 09:35:14,062 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 09:35:14,062 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 09:35:14,064 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 09:35:14,064 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1047
2025-11-18 09:35:14,064 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1047
2025-11-18 09:35:14,064 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 09:35:14,065 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 246.0ms
2025-11-18 09:35:14,086 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 09:35:14,087 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.5ms
2025-11-18 09:35:14,090 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 09:35:14,090 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:35:14,091 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:14,091 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:14,091 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:14,091 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:14,091 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:14,092 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:14,092 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:14,092 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:35:14,092 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 2.8ms
2025-11-18 09:35:14,097 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:35:14,098 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:35:14,099 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:35:14,100 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 10.2ms
2025-11-18 09:35:14,102 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 09:35:14,103 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 0.9ms
2025-11-18 09:35:14,105 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 09:35:14,105 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:14,105 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:14,105 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:14,106 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:14,106 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:14,106 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:14,106 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:14,106 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 09:35:14,113 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 09:35:14,114 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 09:35:14,119 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 09:35:14,119 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 09:35:14,120 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 09:35:14,121 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 16.1ms
2025-11-18 09:35:14,121 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.7ms
2025-11-18 09:35:14,125 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 09:35:14,125 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:14,125 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:14,126 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:14,126 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:14,126 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:14,126 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:14,126 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:14,126 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 09:35:14,127 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 09:35:14,132 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 09:35:14,133 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 09:35:14,134 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 09:35:14,134 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 7.6ms
2025-11-18 09:35:14,134 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 9.9ms
2025-11-18 09:35:14,137 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 09:35:14,138 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 0.9ms
2025-11-18 09:35:14,138 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:35:14,139 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:14,139 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:14,139 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:14,139 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:14,139 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:14,140 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:14,140 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:14,140 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:35:14,145 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:35:14,145 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:35:14,146 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:35:14,147 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.7ms
2025-11-18 09:35:14,149 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 09:35:14,149 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:14,149 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:14,150 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:14,150 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:14,150 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:14,150 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:14,150 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:14,151 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 09:35:14,157 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 09:35:14,157 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 09:35:14,161 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 09:35:14,161 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 09:35:14,162 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 13.0ms
2025-11-18 09:35:14,164 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 09:35:14,164 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:14,164 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:14,164 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:14,165 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:14,165 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:14,165 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:14,165 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:14,165 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 09:35:14,171 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 09:35:14,171 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 09:35:14,172 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 09:35:14,172 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 8.4ms
2025-11-18 09:35:16,857 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:35:16,858 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.6ms
2025-11-18 09:35:16,858 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:35:16,860 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 1.7ms
2025-11-18 09:35:16,861 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:35:16,861 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:16,862 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:16,862 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:16,862 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:16,862 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:16,862 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:16,863 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:16,863 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:35:16,864 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:35:16,865 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:35:16,865 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:35:16,865 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:35:16,865 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:35:16,865 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:35:16,866 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:35:16,866 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:35:16,866 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:35:16,866 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 5.8ms
2025-11-18 09:35:16,868 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 4.0ms
2025-11-18 09:37:48,378 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:37:48,378 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:37:48,378 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:37:48,378 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:37:48,378 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:37:48,378 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:37:48,378 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:37:48,378 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:37:48,379 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:37:48,379 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 1.6ms
2025-11-18 09:38:51,371 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:38:51,371 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:38:51,371 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:38:51,371 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:38:51,371 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:38:51,372 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:38:51,372 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:38:51,372 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:38:51,372 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:38:51,373 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 1.9ms
2025-11-18 09:41:48,365 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:41:48,365 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.6ms
2025-11-18 09:41:48,677 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:41:48,677 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:48,677 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:48,677 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:48,677 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:48,678 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:48,678 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:48,678 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:48,678 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:41:48,679 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 1.8ms
2025-11-18 09:41:51,898 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos
2025-11-18 09:41:51,899 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos
2025-11-18 09:41:51,900 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos 200 1.1ms
2025-11-18 09:41:51,900 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos 200 1.1ms
2025-11-18 09:41:51,902 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 09:41:51,902 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:51,903 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:51,903 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:51,903 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:51,903 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:51,903 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:51,903 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:51,904 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 09:41:51,905 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 2.7ms
2025-11-18 09:41:51,907 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 09:41:51,907 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:51,908 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:51,908 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:51,908 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:51,908 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:51,908 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:51,908 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:51,908 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 09:41:51,909 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 2.4ms
2025-11-18 09:41:53,359 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:41:53,359 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:53,359 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:53,360 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:53,360 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:53,360 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:53,360 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:53,360 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:53,360 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:41:53,361 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.3ms
2025-11-18 09:41:53,363 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:41:53,363 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:53,363 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:53,364 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:53,364 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:53,364 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:53,364 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:53,364 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:53,364 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:41:53,365 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.5ms
2025-11-18 09:41:54,334 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:41:54,335 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:54,335 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:54,335 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:54,335 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:54,335 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:54,335 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:54,336 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:54,336 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:41:54,336 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.2ms
2025-11-18 09:41:56,338 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 09:41:56,338 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:56,338 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:56,339 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:56,339 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:56,339 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:56,339 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:56,339 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:56,340 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 09:41:56,354 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 09:41:56,356 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 09:41:56,357 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 09:41:56,358 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 09:41:56,358 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 09:41:56,360 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 09:41:56,361 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1048
2025-11-18 09:41:56,361 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 1048
2025-11-18 09:41:56,361 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 09:41:56,362 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 24.5ms
2025-11-18 09:41:56,368 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 09:41:56,368 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:56,368 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:56,369 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:56,369 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:56,369 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:56,369 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:56,369 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:56,370 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 09:41:56,371 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 09:41:56,371 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 09:41:56,373 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 09:41:56,373 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 09:41:56,374 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 6.1ms
2025-11-18 09:41:57,566 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:41:57,567 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:57,567 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:57,568 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:57,568 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:57,568 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:57,568 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:57,568 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:57,568 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:41:57,573 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:41:57,573 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:41:57,575 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:41:57,575 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.0ms
2025-11-18 09:41:57,578 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:41:57,579 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:57,579 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:57,579 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:57,579 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:57,579 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:57,580 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:57,580 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:57,580 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:41:57,585 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:41:57,585 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:41:57,587 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:41:57,587 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.1ms
2025-11-18 09:41:59,530 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 09:41:59,530 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:41:59,530 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:41:59,531 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:41:59,531 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:41:59,531 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:41:59,531 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:41:59,531 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:41:59,532 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 09:41:59,534 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 09:41:59,534 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 09:41:59,535 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 09:41:59,535 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 5.0ms
2025-11-18 09:42:09,604 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 09:42:09,604 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:42:09,605 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:42:09,605 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:42:09,605 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:42:09,605 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:42:09,605 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:42:09,605 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:42:09,605 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 09:42:09,607 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 09:42:09,608 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 09:42:09,608 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 09:42:09,823 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 09:42:09,823 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 09:42:09,823 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 09:42:09,824 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 09:42:09,825 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1049
2025-11-18 09:42:09,825 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1049
2025-11-18 09:42:09,825 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 09:42:09,825 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 221.6ms
2025-11-18 09:42:09,842 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:42:09,843 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:42:09,843 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:42:09,844 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:42:09,844 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:42:09,844 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:42:09,844 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:42:09,844 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:42:09,844 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:42:09,848 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:42:09,849 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:42:09,850 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:42:09,850 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.0ms
2025-11-18 09:42:09,853 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 09:42:09,853 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:42:09,854 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:42:09,854 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:42:09,854 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:42:09,854 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:42:09,854 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:42:09,854 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:42:09,855 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 09:42:09,860 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 09:42:09,860 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 09:42:09,865 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 09:42:09,865 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 09:42:09,866 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 12.7ms
2025-11-18 09:42:09,868 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 09:42:09,869 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:42:09,869 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:42:09,869 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:42:09,869 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:42:09,869 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:42:09,869 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:42:09,870 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:42:09,870 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 09:42:09,875 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 09:42:09,875 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 09:42:09,876 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 09:42:09,876 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 8.0ms
2025-11-18 09:42:09,878 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:42:09,879 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:42:09,879 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:42:09,879 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:42:09,879 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:42:09,879 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:42:09,880 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:42:09,880 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:42:09,880 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:42:09,884 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:42:09,885 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:42:09,886 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:42:09,886 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.0ms
2025-11-18 09:42:09,888 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 09:42:09,888 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:42:09,888 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:42:09,889 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:42:09,889 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:42:09,889 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:42:09,889 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:42:09,889 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:42:09,889 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 09:42:09,894 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 09:42:09,895 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 09:42:09,899 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 09:42:09,899 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 09:42:09,900 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 11.6ms
2025-11-18 09:42:09,902 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 09:42:09,902 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:42:09,902 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:42:09,903 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:42:09,903 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:42:09,903 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:42:09,903 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:42:09,903 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:42:09,903 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 09:42:09,908 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 09:42:09,909 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 09:42:09,909 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 09:42:09,910 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.8ms
2025-11-18 09:42:11,718 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:42:11,719 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:42:11,719 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:42:11,719 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:42:11,719 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:42:11,719 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:42:11,720 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:42:11,720 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:42:11,720 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:42:11,721 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.5ms
2025-11-18 09:42:11,722 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:42:11,722 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:42:11,722 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:42:11,723 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:42:11,723 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:42:11,723 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:42:11,723 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:42:11,723 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:42:11,723 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:42:11,724 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 1.9ms
2025-11-18 09:42:32,068 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:42:32,068 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:42:32,069 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:42:32,069 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:42:32,069 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:42:32,069 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:42:32,069 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:42:32,069 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:42:32,069 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:42:32,070 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 1.7ms
2025-11-18 09:45:03,409 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos
2025-11-18 09:45:03,410 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos
2025-11-18 09:45:03,410 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos 200 1.1ms
2025-11-18 09:45:03,410 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos 200 0.6ms
2025-11-18 09:45:03,726 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 09:45:03,726 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:03,727 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:03,727 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:03,727 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:03,727 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:03,727 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:03,727 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:03,728 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 09:45:03,728 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 2.1ms
2025-11-18 09:45:03,730 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 09:45:03,730 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:03,730 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:03,730 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:03,730 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:03,731 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:03,731 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:03,731 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:03,731 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 09:45:03,732 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 1.9ms
2025-11-18 09:45:04,418 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:45:04,418 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:04,418 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:04,419 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:04,419 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:04,419 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:04,419 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:04,419 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:04,419 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:45:04,420 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.5ms
2025-11-18 09:45:04,422 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:45:04,422 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:04,422 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:04,422 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:04,422 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:04,423 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:04,423 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:04,423 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:04,423 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:45:04,424 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.6ms
2025-11-18 09:45:09,902 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 09:45:09,902 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.4ms
2025-11-18 09:45:09,904 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 09:45:09,904 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:09,904 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:09,904 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:09,905 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:09,905 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:09,905 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:09,905 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:09,905 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 09:45:09,918 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 09:45:09,919 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 09:45:09,921 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 09:45:09,922 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 09:45:09,922 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 09:45:09,923 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 09:45:09,923 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1050
2025-11-18 09:45:09,924 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 1050
2025-11-18 09:45:09,924 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 09:45:09,924 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 20.4ms
2025-11-18 09:45:09,930 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-18 09:45:09,930 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.6ms
2025-11-18 09:45:09,932 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 09:45:09,933 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:09,933 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:09,933 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:09,933 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:09,933 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:09,934 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:09,934 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:09,934 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 09:45:09,935 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 09:45:09,936 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 09:45:09,938 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 09:45:09,938 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 09:45:09,939 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 6.8ms
2025-11-18 09:45:10,883 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:45:10,884 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:10,884 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:10,884 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:10,884 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:10,885 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:10,885 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:10,885 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:10,885 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:45:10,890 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:45:10,890 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:45:10,892 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:45:10,892 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.0ms
2025-11-18 09:45:10,894 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:45:10,895 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:10,895 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:10,895 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:10,895 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:10,895 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:10,895 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:10,896 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:10,896 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:45:10,901 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:45:10,901 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:45:10,902 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:45:10,902 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.4ms
2025-11-18 09:45:11,935 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-18 09:45:11,936 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.4ms
2025-11-18 09:45:11,937 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 09:45:11,937 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:11,938 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:11,938 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:11,938 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:11,938 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:11,938 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:11,938 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:11,938 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 09:45:11,940 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 09:45:11,941 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 09:45:11,941 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 09:45:11,941 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 3.8ms
2025-11-18 09:45:18,508 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 09:45:18,508 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:18,508 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:18,508 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:18,508 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:18,509 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:18,509 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:18,509 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:18,509 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 09:45:18,510 - app.core.auth - WARNING - [REFRESH] No se proporcionó refresh token. Cliente: web
2025-11-18 09:45:18,510 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 401 2.4ms
2025-11-18 09:45:31,435 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 09:45:31,436 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.5ms
2025-11-18 09:45:31,437 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 09:45:31,437 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:31,438 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:31,438 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:31,438 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:31,438 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:31,438 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:31,438 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:31,438 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 09:45:31,440 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 09:45:31,441 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 09:45:31,441 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 09:45:31,672 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 09:45:31,672 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 09:45:31,672 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 09:45:31,673 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 09:45:31,674 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1051
2025-11-18 09:45:31,674 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1051
2025-11-18 09:45:31,674 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 09:45:31,674 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 237.3ms
2025-11-18 09:45:31,692 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 09:45:31,693 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.9ms
2025-11-18 09:45:31,694 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 09:45:31,695 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 0.9ms
2025-11-18 09:45:31,697 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 09:45:31,698 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:45:31,698 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 09:45:31,698 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:31,698 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:31,699 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:31,699 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:31,699 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:31,699 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:31,699 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:31,699 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:45:31,700 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 2.8ms
2025-11-18 09:45:31,704 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:45:31,705 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:45:31,706 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:45:31,706 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 8.5ms
2025-11-18 09:45:31,708 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 10.0ms
2025-11-18 09:45:31,709 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 09:45:31,710 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 0.8ms
2025-11-18 09:45:31,710 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 09:45:31,711 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.3ms
2025-11-18 09:45:31,712 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 09:45:31,712 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:31,712 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:31,712 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:31,713 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:31,713 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:31,713 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:31,713 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:31,713 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 09:45:31,719 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 09:45:31,719 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 09:45:31,723 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 09:45:31,724 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 09:45:31,725 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 13.1ms
2025-11-18 09:45:31,727 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 09:45:31,727 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:31,727 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:31,727 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:31,727 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:31,728 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:31,728 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:31,728 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:31,728 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 09:45:31,733 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 09:45:31,734 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 09:45:31,734 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 09:45:31,734 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.6ms
2025-11-18 09:45:31,736 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 09:45:31,736 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:31,737 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:31,737 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:31,737 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:31,737 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:31,737 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:31,737 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:31,737 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 09:45:31,742 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 09:45:31,742 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 09:45:31,743 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 09:45:31,743 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.0ms
2025-11-18 09:45:31,745 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 09:45:31,745 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:31,745 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:31,746 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:31,746 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:31,746 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:31,746 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:31,746 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:31,746 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 09:45:31,751 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 09:45:31,751 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 09:45:31,755 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 09:45:31,755 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 09:45:31,756 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 11.1ms
2025-11-18 09:45:31,758 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 09:45:31,759 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:31,759 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:31,759 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:31,759 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:31,759 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:31,759 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:31,759 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:31,760 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 09:45:31,764 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 09:45:31,765 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 09:45:31,765 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 09:45:31,766 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.7ms
2025-11-18 09:45:33,861 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:45:33,862 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.9ms
2025-11-18 09:45:33,863 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 09:45:33,864 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.9ms
2025-11-18 09:45:33,865 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:45:33,865 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:33,865 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:33,865 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:33,865 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:33,865 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:33,866 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:33,866 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:33,866 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:45:33,867 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.3ms
2025-11-18 09:45:33,869 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 09:45:33,870 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:45:33,870 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:45:33,870 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:45:33,870 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:45:33,870 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:45:33,871 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:45:33,871 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:45:33,871 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 09:45:33,872 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.7ms
2025-11-18 09:51:07,393 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 09:51:08,232 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /docs
2025-11-18 09:51:08,233 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 09:51:08,233 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:51:08,233 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 09:51:08,258 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 09:51:08,261 - app.core.encryption - ERROR - Token de encriptación inválido. Posibles causas: clave incorrecta o datos corruptos
2025-11-18 09:51:08,261 - app.core.multi_db - ERROR - [METADATA] Error al desencriptar credenciales para cliente 4: Credencial corrupta o clave de encriptación incorrecta
2025-11-18 09:51:08,261 - app.core.multi_db - WARNING - [METADATA] No se encontró configuración para cliente 4, usando Single-DB como fallback
2025-11-18 09:51:08,261 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:51:08,262 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/docs
2025-11-18 09:51:08,262 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /docs 200 30.0ms
2025-11-18 09:51:08,352 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /openapi.json
2025-11-18 09:51:08,352 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 09:51:08,352 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:51:08,353 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 09:51:08,354 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 09:51:08,354 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:51:08,354 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/openapi.json
2025-11-18 09:51:08,487 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /openapi.json 200 135.2ms
2025-11-18 09:51:16,847 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/test
2025-11-18 09:51:16,847 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 09:51:16,847 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:51:16,847 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 09:51:16,848 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 09:51:16,848 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:51:16,849 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/test
2025-11-18 09:51:16,849 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/test 401 2.8ms
2025-11-18 09:51:26,836 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 09:51:26,836 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 09:51:26,836 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:51:26,836 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 09:51:26,837 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 09:51:26,838 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:51:26,838 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 09:51:26,843 - app.api.v1.endpoints.auth - INFO - Cliente 4 resuelto y validado para login.
2025-11-18 09:51:26,844 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=4
2025-11-18 09:51:26,844 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=4
2025-11-18 09:51:27,074 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 09:51:27,075 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=4, access_level=5, user_type=super_admin
2025-11-18 09:51:27,075 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=4
2025-11-18 09:51:27,079 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 09:51:27,080 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 4, Usuario 1 - Cliente: web - Token ID: 1052
2025-11-18 09:51:27,080 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1052
2025-11-18 09:51:27,080 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 4
2025-11-18 09:51:27,081 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 245.6ms
2025-11-18 09:51:36,004 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/test
2025-11-18 09:51:36,004 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 09:51:36,005 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:51:36,005 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 09:51:36,006 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 09:51:36,006 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:51:36,006 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/test
2025-11-18 09:51:36,007 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/test 401 3.0ms
2025-11-18 09:51:46,544 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/debug/access-levels
2025-11-18 09:51:46,544 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 09:51:46,544 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:51:46,544 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 09:51:46,546 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 09:51:46,546 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:51:46,546 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/debug/access-levels
2025-11-18 09:51:46,553 - app.api.deps - INFO - DIAGNÓSTICO NIVELES - Usuario 1: {'max_level': 5, 'super_admin_count': 1, 'total_roles': 1}
2025-11-18 09:51:46,554 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/debug/access-levels 200 10.2ms
2025-11-18 09:51:54,417 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/test
2025-11-18 09:51:54,418 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 09:51:54,418 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:51:54,418 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 09:51:54,419 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 09:51:54,420 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:51:54,420 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/test
2025-11-18 09:51:54,421 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/test 401 3.3ms
2025-11-18 09:52:10,628 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/test
2025-11-18 09:52:10,629 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:52:10,629 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:52:10,629 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:52:10,629 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:52:10,629 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:52:10,630 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:52:10,630 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:52:10,630 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/test
2025-11-18 09:52:10,630 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/test 401 2.2ms
2025-11-18 09:52:10,701 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /favicon.ico
2025-11-18 09:52:10,701 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 09:52:10,701 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 09:52:10,702 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 09:52:10,702 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:52:10,702 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 09:52:10,702 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 09:52:10,702 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:52:10,702 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/favicon.ico
2025-11-18 09:52:10,703 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /favicon.ico 404 2.1ms
2025-11-18 09:54:24,636 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 09:54:24,636 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 09:54:24,637 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:54:24,637 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 09:54:24,652 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 09:54:24,652 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:54:24,652 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 09:54:24,656 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 1, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 09:54:24,662 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 4 clientes
2025-11-18 09:54:24,663 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 27.1ms
2025-11-18 09:55:52,010 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 09:56:01,922 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/test
2025-11-18 09:56:01,924 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 09:56:01,924 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 09:56:01,924 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 09:56:01,954 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 09:56:01,955 - app.core.encryption - ERROR - Token de encriptación inválido. Posibles causas: clave incorrecta o datos corruptos
2025-11-18 09:56:01,955 - app.core.multi_db - ERROR - [METADATA] Error al desencriptar credenciales para cliente 4: Credencial corrupta o clave de encriptación incorrecta
2025-11-18 09:56:01,955 - app.core.multi_db - WARNING - [METADATA] No se encontró configuración para cliente 4, usando Single-DB como fallback
2025-11-18 09:56:01,955 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 09:56:01,956 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/test
2025-11-18 09:56:01,956 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/test 401 33.9ms
2025-11-18 09:58:44,541 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 10:00:45,390 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:00:45,391 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.4ms
2025-11-18 10:00:45,696 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:00:45,697 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:00:45,697 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:00:45,697 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:00:45,697 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:00:45,697 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:00:45,697 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:00:45,698 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:00:45,698 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:00:45,698 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.0ms
2025-11-18 10:00:52,969 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 10:00:52,970 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.8ms
2025-11-18 10:00:52,972 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 10:00:52,972 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:00:52,972 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:00:52,973 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:00:52,973 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:00:52,973 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:00:52,973 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:00:52,973 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:00:52,974 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 10:00:53,054 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 10:00:53,055 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 10:00:53,056 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:00:53,056 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:00:53,056 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 10:00:53,057 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:00:53,058 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1053
2025-11-18 10:00:53,058 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 1053
2025-11-18 10:00:53,058 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 10:00:53,058 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 86.5ms
2025-11-18 10:00:53,064 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-18 10:00:53,064 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.7ms
2025-11-18 10:00:53,066 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 10:00:53,066 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:00:53,066 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:00:53,067 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:00:53,067 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:00:53,067 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:00:53,067 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:00:53,067 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:00:53,067 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 10:00:53,069 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 10:00:53,069 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 10:00:53,071 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 10:00:53,071 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 10:00:53,072 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 5.7ms
2025-11-18 10:00:54,376 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:00:54,377 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.6ms
2025-11-18 10:00:54,379 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:00:54,380 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:00:54,380 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:00:54,380 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:00:54,380 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:00:54,381 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:00:54,381 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:00:54,381 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:00:54,381 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:00:54,382 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:00:54,382 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 2.6ms
2025-11-18 10:00:54,387 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:00:54,387 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:00:54,388 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:00:54,389 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.7ms
2025-11-18 10:00:54,391 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:00:54,392 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:00:54,392 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:00:54,392 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:00:54,392 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:00:54,393 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:00:54,393 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:00:54,393 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:00:54,393 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:00:54,397 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:00:54,397 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:00:54,398 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:00:54,399 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.6ms
2025-11-18 10:00:57,629 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-18 10:00:57,630 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.5ms
2025-11-18 10:00:57,631 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 10:00:57,632 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:00:57,632 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:00:57,632 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:00:57,632 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:00:57,632 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:00:57,632 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:00:57,632 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:00:57,633 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 10:00:57,635 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:00:57,635 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:00:57,635 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 10:00:57,636 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 4.4ms
2025-11-18 10:01:07,734 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 10:01:07,735 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.6ms
2025-11-18 10:01:07,736 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 10:01:07,737 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:01:07,737 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:01:07,737 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:01:07,737 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:01:07,737 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:01:07,737 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:01:07,737 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:01:07,738 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 10:01:07,740 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 10:01:07,741 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 10:01:07,741 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 10:01:07,971 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 10:01:07,971 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 10:01:07,972 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 10:01:07,973 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:01:07,973 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1054
2025-11-18 10:01:07,973 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1054
2025-11-18 10:01:07,973 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 10:01:07,974 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 237.6ms
2025-11-18 10:01:07,997 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:01:07,998 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.8ms
2025-11-18 10:01:08,001 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:01:08,002 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:01:08,002 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.2ms
2025-11-18 10:01:08,002 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:01:08,002 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:01:08,003 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:01:08,003 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:01:08,003 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:01:08,003 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:01:08,004 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:01:08,004 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:01:08,010 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:01:08,010 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:01:08,011 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:01:08,013 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 11.0ms
2025-11-18 10:01:08,014 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:01:08,014 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 0.4ms
2025-11-18 10:01:08,015 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:01:08,016 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:01:08,016 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:01:08,016 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:01:08,017 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:01:08,017 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:01:08,017 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:01:08,017 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:01:08,017 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:01:08,023 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:01:08,024 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:01:08,028 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:01:08,029 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:01:08,029 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:01:08,030 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 14.4ms
2025-11-18 10:01:08,030 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.5ms
2025-11-18 10:01:08,032 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:01:08,033 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:01:08,033 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:01:08,033 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:01:08,033 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:01:08,034 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:01:08,034 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:01:08,034 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:01:08,034 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:01:08,034 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:01:08,039 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:01:08,040 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:01:08,041 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:01:08,041 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 6.6ms
2025-11-18 10:01:08,041 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 9.1ms
2025-11-18 10:01:08,044 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:01:08,044 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 0.7ms
2025-11-18 10:01:08,045 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:01:08,046 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:01:08,046 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:01:08,046 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:01:08,046 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:01:08,046 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:01:08,046 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:01:08,047 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:01:08,047 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:01:08,051 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:01:08,051 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:01:08,052 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:01:08,053 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.3ms
2025-11-18 10:01:08,055 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:01:08,055 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:01:08,055 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:01:08,055 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:01:08,055 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:01:08,056 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:01:08,056 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:01:08,056 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:01:08,056 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:01:08,062 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:01:08,062 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:01:08,066 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:01:08,067 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:01:08,067 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 12.5ms
2025-11-18 10:01:08,069 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:01:08,069 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:01:08,069 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:01:08,070 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:01:08,070 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:01:08,070 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:01:08,070 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:01:08,070 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:01:08,070 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:01:08,076 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:01:08,077 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:01:08,077 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:01:08,077 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 8.5ms
2025-11-18 10:01:10,455 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:01:10,455 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.4ms
2025-11-18 10:01:10,458 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:01:10,458 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:01:10,458 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:01:10,458 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:01:10,459 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:01:10,459 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:01:10,459 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:01:10,459 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:01:10,459 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:01:10,461 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:01:10,461 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 3.6ms
2025-11-18 10:01:10,462 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 1.1ms
2025-11-18 10:01:10,464 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:01:10,464 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:01:10,465 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:01:10,465 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:01:10,465 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:01:10,465 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:01:10,465 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:01:10,466 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:01:10,466 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:01:10,467 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.6ms
2025-11-18 10:03:38,684 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:03:38,684 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:03:38,684 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:03:38,685 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:03:38,685 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:03:38,685 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:03:38,685 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:03:38,685 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:03:38,685 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:03:38,686 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 1.9ms
2025-11-18 10:03:45,381 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:03:45,382 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:03:45,382 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:03:45,382 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:03:45,382 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:03:45,382 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:03:45,383 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:03:45,383 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:03:45,383 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:03:45,383 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.1ms
2025-11-18 10:04:10,334 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /docs
2025-11-18 10:04:10,334 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 10:04:10,334 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:04:10,335 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 10:04:10,345 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 10:04:10,346 - app.core.encryption - ERROR - Token de encriptación inválido. Posibles causas: clave incorrecta o datos corruptos
2025-11-18 10:04:10,346 - app.core.multi_db - ERROR - [METADATA] Error al desencriptar credenciales para cliente 4: Credencial corrupta o clave de encriptación incorrecta
2025-11-18 10:04:10,347 - app.core.multi_db - WARNING - [METADATA] No se encontró configuración para cliente 4, usando Single-DB como fallback
2025-11-18 10:04:10,347 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:04:10,347 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/docs
2025-11-18 10:04:10,348 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /docs 200 14.0ms
2025-11-18 10:04:10,446 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /openapi.json
2025-11-18 10:04:10,447 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 10:04:10,447 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:04:10,447 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 10:04:10,449 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 10:04:10,449 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:04:10,449 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/openapi.json
2025-11-18 10:04:10,589 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /openapi.json 200 142.4ms
2025-11-18 10:04:18,479 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 10:04:18,480 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 10:04:18,480 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:04:18,480 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 10:04:18,481 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 10:04:18,481 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:04:18,481 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 10:04:18,483 - app.api.v1.endpoints.auth - INFO - Cliente 4 resuelto y validado para login.
2025-11-18 10:04:18,484 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=4
2025-11-18 10:04:18,484 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=4
2025-11-18 10:04:18,695 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 10:04:18,696 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=4, access_level=5, user_type=super_admin
2025-11-18 10:04:18,696 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=4
2025-11-18 10:04:18,697 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:04:18,697 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 4, Usuario 1 - Cliente: web - Token ID: 1055
2025-11-18 10:04:18,698 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1055
2025-11-18 10:04:18,698 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 4
2025-11-18 10:04:18,698 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 219.0ms
2025-11-18 10:04:31,859 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:04:31,860 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'techcorp.midominio.com'
2025-11-18 10:04:31,860 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:04:31,860 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'techcorp'
2025-11-18 10:04:31,861 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='techcorp', Código='TECH003', ID=4
2025-11-18 10:04:31,861 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:04:31,861 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=4, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:04:31,865 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:04:31,867 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:04:31,868 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.1ms
2025-11-18 10:05:16,834 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:05:16,835 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:05:16,835 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:05:16,835 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:05:16,836 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.7ms
2025-11-18 10:05:16,836 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.3ms
2025-11-18 10:05:16,836 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.2ms
2025-11-18 10:05:16,836 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.1ms
2025-11-18 10:05:17,143 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:05:17,143 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:05:17,144 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:05:17,144 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:05:17,144 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:05:17,144 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:05:17,144 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:05:17,144 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:05:17,144 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:05:17,144 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:05:17,145 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:05:17,145 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:05:17,149 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:05:17,149 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:05:17,153 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:05:17,153 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:05:17,154 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:05:17,154 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:05:17,154 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:05:17,155 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:05:17,155 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:05:17,155 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:05:17,155 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:05:17,155 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:05:17,156 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:05:17,156 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:05:17,156 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:05:17,156 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:05:17,156 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:05:17,156 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:05:17,156 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:05:17,157 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:05:17,157 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:05:17,157 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:05:17,157 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:05:17,157 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:05:17,157 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:05:17,158 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:05:17,158 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:05:17,158 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:05:17,163 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:05:17,164 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:05:17,168 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:05:17,168 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:05:17,173 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:05:17,173 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:05:17,174 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:05:17,178 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:05:17,179 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:05:17,179 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:05:17,180 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 37.3ms
2025-11-18 10:05:17,180 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 35.9ms
2025-11-18 10:05:17,181 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 35.9ms
2025-11-18 10:05:17,181 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 35.9ms
2025-11-18 10:05:18,119 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-11-18 10:05:18,120 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 0.8ms
2025-11-18 10:05:18,122 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-11-18 10:05:18,123 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 1.1ms
2025-11-18 10:05:18,123 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-11-18 10:05:18,123 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:05:18,123 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:05:18,124 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:05:18,124 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:05:18,124 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:05:18,124 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:05:18,124 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:05:18,125 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/
2025-11-18 10:05:18,132 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:05:18,133 - app.services.rol_service - INFO - Obteniendo roles paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:05:18,142 - app.services.rol_service - INFO - Obtención paginada de roles para cliente 1 completada exitosamente
2025-11-18 10:05:18,143 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-11-18 10:05:18,144 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 20.8ms
2025-11-18 10:05:18,144 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:05:18,144 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:05:18,144 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:05:18,145 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:05:18,145 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:05:18,145 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:05:18,145 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:05:18,145 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/
2025-11-18 10:05:18,151 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:05:18,151 - app.services.rol_service - INFO - Obteniendo roles paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:05:18,154 - app.services.rol_service - INFO - Obtención paginada de roles para cliente 1 completada exitosamente
2025-11-18 10:05:18,156 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 12.3ms
2025-11-18 10:05:23,400 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:05:23,401 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.6ms
2025-11-18 10:05:23,403 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:05:23,404 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:05:23,404 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:05:23,405 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:05:23,405 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:05:23,405 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:05:23,405 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:05:23,405 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:05:23,405 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:05:23,406 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:05:23,406 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 2.4ms
2025-11-18 10:05:23,407 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.9ms
2025-11-18 10:05:23,410 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:05:23,410 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:05:23,410 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:05:23,410 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:05:23,411 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:05:23,411 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:05:23,411 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:05:23,411 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:05:23,412 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:05:23,413 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 3.0ms
2025-11-18 10:07:32,052 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos
2025-11-18 10:07:32,053 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos
2025-11-18 10:07:32,053 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos 200 1.6ms
2025-11-18 10:07:32,053 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos 200 0.7ms
2025-11-18 10:07:54,957 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 10:07:54,997 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 10:07:54,997 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:07:54,998 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 10:07:54,998 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:07:54,998 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:07:54,998 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:07:54,998 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:07:54,998 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:07:54,998 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:07:54,999 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:07:54,999 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:07:54,999 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 10:07:54,999 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:07:54,999 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:07:54,999 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:07:54,999 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:07:54,999 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:07:55,000 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:07:55,000 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:07:55,000 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 10:07:55,000 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 3.0ms
2025-11-18 10:07:55,000 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 2.7ms
2025-11-18 10:07:55,001 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 4.4ms
2025-11-18 10:07:55,002 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 4.0ms
2025-11-18 10:07:55,003 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:07:55,004 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:07:55,004 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:07:55,004 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:07:55,004 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:07:55,004 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:07:55,004 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:07:55,005 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:07:55,005 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:07:55,006 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:07:55,006 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:07:55,006 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:07:55,006 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:07:55,006 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:07:55,007 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:07:55,007 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:07:55,007 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:07:55,007 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:07:55,008 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 4.5ms
2025-11-18 10:07:55,009 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 3.0ms
2025-11-18 10:07:58,485 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-11-18 10:07:58,485 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 1.0ms
2025-11-18 10:07:58,486 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-11-18 10:07:58,487 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 1.2ms
2025-11-18 10:07:58,489 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-11-18 10:07:58,489 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:07:58,489 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:07:58,489 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:07:58,490 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:07:58,490 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:07:58,490 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:07:58,490 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:07:58,490 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/areas/
2025-11-18 10:07:58,526 - app.api.v1.endpoints.areas - INFO - Solicitud GET /areas/ recibida por usuario 1 del cliente 1 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-11-18 10:07:58,526 - app.services.area_service - INFO - Obteniendo áreas paginadas para cliente 1: skip=0, limit=10, search='None'
2025-11-18 10:07:58,530 - app.services.area_service - INFO - Paginación completada para cliente 1: 0 áreas de 0 totales
2025-11-18 10:07:58,531 - app.api.v1.endpoints.areas - INFO - Lista paginada de áreas recuperada para cliente 1 - Total: 0, Página: 1
2025-11-18 10:07:58,532 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-11-18 10:07:58,532 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:07:58,532 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:07:58,532 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:07:58,532 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:07:58,532 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:07:58,533 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:07:58,533 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:07:58,533 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/areas/
2025-11-18 10:07:58,538 - app.api.v1.endpoints.areas - INFO - Solicitud GET /areas/ recibida por usuario 1 del cliente 1 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-11-18 10:07:58,538 - app.services.area_service - INFO - Obteniendo áreas paginadas para cliente 1: skip=0, limit=10, search='None'
2025-11-18 10:07:58,540 - app.services.area_service - INFO - Paginación completada para cliente 1: 0 áreas de 0 totales
2025-11-18 10:07:58,540 - app.api.v1.endpoints.areas - INFO - Lista paginada de áreas recuperada para cliente 1 - Total: 0, Página: 1
2025-11-18 10:07:58,540 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 51.5ms
2025-11-18 10:07:58,541 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 9.3ms
2025-11-18 10:07:59,109 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-11-18 10:07:59,110 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 0.9ms
2025-11-18 10:07:59,110 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-11-18 10:07:59,112 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 1.9ms
2025-11-18 10:07:59,116 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-11-18 10:07:59,117 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:07:59,117 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:07:59,118 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:07:59,118 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:07:59,118 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:07:59,118 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:07:59,118 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:07:59,118 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/
2025-11-18 10:07:59,119 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-11-18 10:07:59,125 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:07:59,125 - app.services.rol_service - INFO - Obteniendo roles paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:07:59,129 - app.services.rol_service - INFO - Obtención paginada de roles para cliente 1 completada exitosamente
2025-11-18 10:07:59,130 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:07:59,130 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:07:59,130 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:07:59,131 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:07:59,131 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:07:59,131 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:07:59,131 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:07:59,131 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/
2025-11-18 10:07:59,137 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:07:59,137 - app.services.rol_service - INFO - Obteniendo roles paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:07:59,140 - app.services.rol_service - INFO - Obtención paginada de roles para cliente 1 completada exitosamente
2025-11-18 10:07:59,140 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 24.3ms
2025-11-18 10:07:59,141 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 21.9ms
2025-11-18 10:08:00,772 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:08:00,773 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 1.0ms
2025-11-18 10:08:00,773 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:08:00,775 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 1.3ms
2025-11-18 10:08:00,776 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:08:00,776 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:08:00,776 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:08:00,776 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:08:00,777 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:08:00,777 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:08:00,777 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:08:00,777 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:08:00,778 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:08:00,779 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:08:00,779 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:08:00,779 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:08:00,780 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:08:00,780 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:08:00,780 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:08:00,780 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:08:00,780 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:08:00,780 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:08:00,781 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 5.2ms
2025-11-18 10:08:00,782 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 3.3ms
2025-11-18 10:08:09,091 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:08:09,091 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.7ms
2025-11-18 10:08:09,094 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:08:09,094 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:08:09,094 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:08:09,095 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:08:09,095 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:08:09,095 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:08:09,095 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:08:09,095 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:08:09,096 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:08:09,096 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 2.7ms
2025-11-18 10:09:34,288 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 10:09:57,650 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:09:57,652 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:09:57,653 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:09:57,654 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:09:57,654 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:09:57,654 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:09:57,654 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:09:57,655 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:09:57,655 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:09:57,656 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 401 5.5ms
2025-11-18 10:10:12,591 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 10:10:12,591 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:10:12,592 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:10:12,592 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:10:12,592 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:10:12,592 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:10:12,592 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:10:12,592 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:10:12,593 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 10:10:12,621 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 10:10:12,621 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 10:10:12,621 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 10:10:12,853 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 10:10:12,853 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 10:10:12,853 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 10:10:12,857 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:10:12,857 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1056
2025-11-18 10:10:12,858 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1056
2025-11-18 10:10:12,858 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 10:10:12,859 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 267.7ms
2025-11-18 10:10:20,227 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:10:20,228 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:10:20,228 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:10:20,228 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:10:20,228 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:10:20,228 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:10:20,229 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:10:20,229 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:10:20,229 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:10:20,236 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:10:20,243 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ N/A 15.1ms
2025-11-18 10:10:20,243 - app.core.exceptions - ERROR - Error no manejado: name 'request' is not defined
  + Exception Group Traceback (most recent call last):
  |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\app\main.py", line 96, in security_headers
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\app\main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\app\middleware\tenant_middleware.py", line 266, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\app\core\level_authorization.py", line 96, in wrapper
    |     return await func(*args, **kwargs)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\app\api\v1\endpoints\clientes.py", line 107, in listar_clientes
    |     logger.info(f"Headers recibidos: {dict(request.headers)}")
    |                                            ^^^^^^^
    | NameError: name 'request' is not defined
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\main.py", line 96, in security_headers
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\middleware\tenant_middleware.py", line 266, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\core\level_authorization.py", line 96, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\api\v1\endpoints\clientes.py", line 107, in listar_clientes
    logger.info(f"Headers recibidos: {dict(request.headers)}")
                                           ^^^^^^^
NameError: name 'request' is not defined
2025-11-18 10:10:41,010 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 10:10:41,855 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:10:41,856 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:10:41,856 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:10:41,856 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:10:41,856 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:10:41,856 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:10:41,857 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:10:41,857 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:10:41,857 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:10:41,890 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:10:41,891 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:10:41,891 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ N/A 36.2ms
2025-11-18 10:10:41,892 - app.core.exceptions - ERROR - Error no manejado: name 'request' is not defined
  + Exception Group Traceback (most recent call last):
  |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\app\main.py", line 96, in security_headers
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\app\main.py", line 87, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\app\middleware\tenant_middleware.py", line 266, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\app\core\level_authorization.py", line 96, in wrapper
    |     return await func(*args, **kwargs)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "D:\base_multi_tenant_fastapi\app\api\v1\endpoints\clientes.py", line 108, in listar_clientes
    |     logger.info(f"URL completa: {request.url}")
    |                                  ^^^^^^^
    | NameError: name 'request' is not defined
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\main.py", line 96, in security_headers
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\main.py", line 87, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Carlos\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\middleware\tenant_middleware.py", line 266, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\base_multi_tenant_fastapi\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\core\level_authorization.py", line 96, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\base_multi_tenant_fastapi\app\api\v1\endpoints\clientes.py", line 108, in listar_clientes
    logger.info(f"URL completa: {request.url}")
                                 ^^^^^^^
NameError: name 'request' is not defined
2025-11-18 10:10:57,641 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 10:10:58,098 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:10:58,098 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:10:58,098 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:10:58,099 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:10:58,099 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:10:58,099 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:10:58,100 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:10:58,102 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:10:58,102 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:10:58,134 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:10:58,135 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:10:58,135 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:10:58,135 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:10:58,137 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:10:58,137 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 39.4ms
2025-11-18 10:12:06,790 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 10:12:15,739 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:12:15,740 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:12:15,740 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:12:15,740 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:12:15,741 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:12:15,742 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:12:15,744 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:12:15,744 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:12:15,744 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:12:15,778 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:12:15,778 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDc5NTEyLCJpYXQiOjE3NjM0Nzg2MTIsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.khZeLBYWkx8V_bFzMO_34tU2s5GA5CcXHO9WmwKPawY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDgzNDEyLCJpYXQiOjE3NjM0Nzg2MTIsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.8En4CN7f50BkZKUUlY2sR4cvSxIaWWRR_bG6SULsleY'}
2025-11-18 10:12:15,778 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:12:15,779 - app.api.v1.endpoints.clientes - INFO - URL completa: http://127.0.0.1:8000/api/v1/clientes/?skip=0&limit=100&solo_activos=true
2025-11-18 10:12:15,779 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:12:15,779 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:12:15,780 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:12:15,781 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 41.8ms
2025-11-18 10:12:36,460 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-11-18 10:12:36,461 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/areas/
2025-11-18 10:12:36,461 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 1.0ms
2025-11-18 10:12:36,461 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/areas/ 200 0.7ms
2025-11-18 10:12:36,765 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-11-18 10:12:36,766 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:12:36,766 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:12:36,766 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:12:36,767 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:12:36,767 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:12:36,767 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:12:36,767 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:12:36,767 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/areas/
2025-11-18 10:12:36,768 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/areas/
2025-11-18 10:12:36,773 - app.api.v1.endpoints.areas - INFO - Solicitud GET /areas/ recibida por usuario 1 del cliente 1 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-11-18 10:12:36,773 - app.services.area_service - INFO - Obteniendo áreas paginadas para cliente 1: skip=0, limit=10, search='None'
2025-11-18 10:12:36,775 - app.services.area_service - INFO - Paginación completada para cliente 1: 0 áreas de 0 totales
2025-11-18 10:12:36,775 - app.api.v1.endpoints.areas - INFO - Lista paginada de áreas recuperada para cliente 1 - Total: 0, Página: 1
2025-11-18 10:12:36,775 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:12:36,775 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:12:36,775 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:12:36,776 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:12:36,776 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:12:36,776 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:12:36,776 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:12:36,776 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/areas/
2025-11-18 10:12:36,781 - app.api.v1.endpoints.areas - INFO - Solicitud GET /areas/ recibida por usuario 1 del cliente 1 - Paginación: skip=0, limit=10, Búsqueda: 'None'
2025-11-18 10:12:36,782 - app.services.area_service - INFO - Obteniendo áreas paginadas para cliente 1: skip=0, limit=10, search='None'
2025-11-18 10:12:36,783 - app.services.area_service - INFO - Paginación completada para cliente 1: 0 áreas de 0 totales
2025-11-18 10:12:36,784 - app.api.v1.endpoints.areas - INFO - Lista paginada de áreas recuperada para cliente 1 - Total: 0, Página: 1
2025-11-18 10:12:36,784 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 18.8ms
2025-11-18 10:12:36,785 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/areas/ 200 17.0ms
2025-11-18 10:12:38,646 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:12:38,647 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.5ms
2025-11-18 10:12:38,648 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes
2025-11-18 10:12:38,648 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes 200 0.5ms
2025-11-18 10:12:38,650 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:12:38,651 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:12:38,651 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:12:38,651 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:12:38,651 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:12:38,652 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:12:38,652 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:12:38,652 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:12:38,652 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:12:38,653 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes
2025-11-18 10:12:38,653 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:12:38,654 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:12:38,654 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:12:38,654 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:12:38,654 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:12:38,654 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:12:38,654 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:12:38,655 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes
2025-11-18 10:12:38,655 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 5.3ms
2025-11-18 10:12:38,656 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes 404 3.1ms
2025-11-18 10:12:50,538 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:12:50,539 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:12:50,539 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:12:50,539 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:12:50,539 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:12:50,539 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:12:50,539 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:12:50,539 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:12:50,540 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:12:50,544 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:12:50,544 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDc5NTEyLCJpYXQiOjE3NjM0Nzg2MTIsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.khZeLBYWkx8V_bFzMO_34tU2s5GA5CcXHO9WmwKPawY', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDgzNDEyLCJpYXQiOjE3NjM0Nzg2MTIsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.8En4CN7f50BkZKUUlY2sR4cvSxIaWWRR_bG6SULsleY'}
2025-11-18 10:12:50,545 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:12:50,545 - app.api.v1.endpoints.clientes - INFO - URL completa: http://127.0.0.1:8000/api/v1/clientes/?skip=0&limit=100&solo_activos=true
2025-11-18 10:12:50,548 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:12:50,549 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:12:50,553 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:12:50,554 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 15.7ms
2025-11-18 10:19:07,504 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:19:07,505 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:19:07,506 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:19:07,506 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:19:07,507 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 2.8ms
2025-11-18 10:19:07,507 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 2.0ms
2025-11-18 10:19:07,507 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.8ms
2025-11-18 10:19:07,508 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.7ms
2025-11-18 10:19:07,814 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:19:07,815 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:19:07,815 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:19:07,815 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:19:07,816 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:19:07,816 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:19:07,816 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:19:07,816 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:19:07,816 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:19:07,816 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:19:07,817 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:19:07,817 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-18 10:19:07,817 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:19:07,818 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:19:07,818 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:19:07,818 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:19:07,818 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:19:07,818 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:19:07,818 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:19:07,818 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:19:07,819 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:19:07,819 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:19:07,819 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:19:07,819 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:19:07,819 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:19:07,819 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:19:07,819 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:19:07,820 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:19:07,820 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:19:07,821 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-18 10:19:07,821 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-18 10:19:07,821 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:19:07,822 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:19:07,822 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:19:07,822 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:19:07,822 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:19:07,822 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:19:07,822 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:19:07,822 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:19:07,823 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-18 10:19:07,823 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 401 9.1ms
2025-11-18 10:19:07,824 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 401 7.4ms
2025-11-18 10:19:07,824 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 401 7.3ms
2025-11-18 10:19:07,824 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 401 4.6ms
2025-11-18 10:19:07,830 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 10:19:07,830 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.5ms
2025-11-18 10:19:07,832 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 10:19:07,833 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:19:07,833 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:19:07,833 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:19:07,833 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:19:07,833 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:19:07,833 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:19:07,834 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:19:07,834 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 10:19:07,847 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 10:19:07,848 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 10:19:07,849 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:19:07,849 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:19:07,850 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 10:19:07,851 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:19:07,851 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1057
2025-11-18 10:19:07,851 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 1057
2025-11-18 10:19:07,851 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 10:19:07,852 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 19.6ms
2025-11-18 10:19:07,856 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:19:07,856 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 0.3ms
2025-11-18 10:19:07,858 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:19:07,858 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:19:07,858 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:19:07,859 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:19:07,859 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:19:07,859 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:19:07,859 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:19:07,859 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:19:07,859 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:19:07,865 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:19:07,865 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:19:07,876 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:19:07,877 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:19:07,878 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 19.5ms
2025-11-18 10:19:11,879 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-11-18 10:19:11,880 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 0.8ms
2025-11-18 10:19:11,881 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/
2025-11-18 10:19:11,882 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/ 200 0.6ms
2025-11-18 10:19:11,883 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-11-18 10:19:11,884 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:19:11,884 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:19:11,884 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:19:11,885 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:19:11,885 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:19:11,885 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:19:11,885 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:19:11,885 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/
2025-11-18 10:19:11,892 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:19:11,892 - app.services.rol_service - INFO - Obteniendo roles paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:19:11,897 - app.services.rol_service - INFO - Obtención paginada de roles para cliente 1 completada exitosamente
2025-11-18 10:19:11,897 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/
2025-11-18 10:19:11,898 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:19:11,898 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:19:11,898 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:19:11,898 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:19:11,898 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:19:11,899 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:19:11,899 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:19:11,899 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/
2025-11-18 10:19:11,905 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:19:11,905 - app.services.rol_service - INFO - Obteniendo roles paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:19:11,909 - app.services.rol_service - INFO - Obtención paginada de roles para cliente 1 completada exitosamente
2025-11-18 10:19:11,910 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 26.3ms
2025-11-18 10:19:11,911 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/ 200 13.2ms
2025-11-18 10:26:23,828 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:26:23,829 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:26:23,829 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.3ms
2025-11-18 10:26:23,829 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.9ms
2025-11-18 10:26:24,145 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:26:24,145 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:24,145 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:24,145 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:24,146 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:24,146 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:24,146 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:24,146 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:24,146 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:26:24,147 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:26:24,157 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:26:24,158 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:26:24,158 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:26:24,158 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:26:24,158 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:26:24,159 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:26:24,160 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:26:24,160 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:24,161 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:24,161 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:24,161 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:24,161 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:24,161 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:24,161 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:24,162 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:26:24,165 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:26:24,166 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:26:24,166 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:26:24,166 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:26:24,166 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:26:24,166 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:26:24,167 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:26:24,168 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 23.3ms
2025-11-18 10:26:24,168 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 21.6ms
2025-11-18 10:26:31,900 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos
2025-11-18 10:26:31,900 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos 200 0.6ms
2025-11-18 10:26:31,903 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos
2025-11-18 10:26:31,903 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 10:26:31,904 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:31,904 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:31,904 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:31,904 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:31,904 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:31,905 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:31,905 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:31,905 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 10:26:31,905 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos 200 2.5ms
2025-11-18 10:26:31,906 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 3.1ms
2025-11-18 10:26:31,909 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 10:26:31,909 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:31,910 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:31,910 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:31,910 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:31,910 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:31,910 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:31,910 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:31,910 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 10:26:31,911 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 2.3ms
2025-11-18 10:26:34,486 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:26:34,486 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:26:34,487 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.3ms
2025-11-18 10:26:34,488 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.4ms
2025-11-18 10:26:34,490 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:26:34,490 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:34,490 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:34,491 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:34,491 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:34,491 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:34,491 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:34,491 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:34,491 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:26:34,496 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:26:34,496 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:26:34,496 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:26:34,496 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:26:34,496 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:26:34,497 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:26:34,498 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:26:34,499 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.5ms
2025-11-18 10:26:34,501 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:26:34,501 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:34,501 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:34,502 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:34,502 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:34,502 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:34,502 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:34,502 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:34,502 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:26:34,507 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:26:34,507 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:26:34,507 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:26:34,507 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:26:34,508 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:26:34,508 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:26:34,510 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:26:34,512 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/conexiones
2025-11-18 10:26:34,512 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 11.7ms
2025-11-18 10:26:34,513 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/conexiones 200 1.3ms
2025-11-18 10:26:34,516 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:26:34,516 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:34,516 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:34,516 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:34,516 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:34,517 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:34,517 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:34,517 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:34,517 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:26:34,520 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:26:34,521 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:26:34,521 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:26:34,521 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:26:34,521 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:26:34,521 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:26:34,523 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:26:34,523 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.0ms
2025-11-18 10:26:34,525 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones
2025-11-18 10:26:34,526 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:34,526 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:34,526 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:34,526 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:34,526 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:34,526 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:34,527 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:34,527 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones
2025-11-18 10:26:34,527 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones 404 2.3ms
2025-11-18 10:26:36,172 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 10:26:36,173 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:36,173 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:36,173 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:36,173 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:36,174 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:36,174 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:36,174 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:36,174 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 10:26:36,175 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 2.4ms
2025-11-18 10:26:36,176 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 10:26:36,177 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:36,177 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:36,177 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:36,177 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:36,177 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:36,178 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:36,178 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:36,178 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 10:26:36,179 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 2.2ms
2025-11-18 10:26:36,705 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:26:36,705 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:36,706 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:36,706 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:36,706 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:36,706 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:36,706 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:36,707 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:36,707 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:26:36,712 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:26:36,712 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:26:36,712 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:26:36,712 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:26:36,713 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:26:36,713 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:26:36,714 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:26:36,715 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.3ms
2025-11-18 10:26:36,717 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:26:36,717 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:36,718 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:36,718 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:36,718 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:36,718 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:36,718 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:36,719 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:36,719 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:26:36,723 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:26:36,723 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:26:36,723 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:26:36,723 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:26:36,724 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:26:36,724 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:26:36,725 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:26:36,726 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.1ms
2025-11-18 10:26:44,218 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 10:26:44,219 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:44,219 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:44,219 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:44,219 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:44,220 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:44,220 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:44,220 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:44,220 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 10:26:44,221 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 2.4ms
2025-11-18 10:26:44,222 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos
2025-11-18 10:26:44,222 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:44,223 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:44,223 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:44,223 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:44,223 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:44,223 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:44,223 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:44,224 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos
2025-11-18 10:26:44,224 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos 404 2.2ms
2025-11-18 10:26:44,777 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:26:44,777 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:44,777 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:44,778 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:44,778 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:44,778 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:44,778 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:44,778 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:44,778 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:26:44,784 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:26:44,784 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:26:44,784 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:26:44,784 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:26:44,785 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:26:44,785 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:26:44,786 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:26:44,787 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.4ms
2025-11-18 10:26:44,789 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:26:44,790 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:44,790 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:44,790 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:44,790 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:44,790 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:44,791 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:44,791 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:44,791 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:26:44,795 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:26:44,795 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:26:44,795 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:26:44,796 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:26:44,796 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:26:44,796 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:26:44,797 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:26:44,798 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.0ms
2025-11-18 10:26:44,801 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones
2025-11-18 10:26:44,801 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:44,801 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:44,802 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:44,802 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:44,802 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:44,802 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:44,802 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:44,802 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones
2025-11-18 10:26:44,803 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones 404 2.5ms
2025-11-18 10:26:44,805 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:26:44,805 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:26:44,805 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:26:44,805 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:26:44,806 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:26:44,806 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:26:44,806 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:26:44,806 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:26:44,806 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:26:44,810 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:26:44,810 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:26:44,811 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:26:44,811 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:26:44,811 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:26:44,811 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:26:44,812 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:26:44,813 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.9ms
2025-11-18 10:29:45,386 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/conexiones/
2025-11-18 10:29:45,387 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:29:45,387 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:45,387 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:45,387 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:45,387 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:45,388 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:45,388 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:45,388 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:45,388 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:29:45,388 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/conexiones/ 200 2.0ms
2025-11-18 10:29:45,398 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:29:45,399 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:29:45,399 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:29:45,400 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:29:45,400 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:29:45,400 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:29:45,401 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:29:45,402 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 15.7ms
2025-11-18 10:29:45,405 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones/
2025-11-18 10:29:45,405 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:45,405 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:45,406 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:45,406 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:45,406 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:45,406 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:45,406 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:45,407 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones/
2025-11-18 10:29:45,407 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones/ 404 2.5ms
2025-11-18 10:29:52,471 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:29:52,472 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:52,472 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:52,472 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:52,472 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:52,473 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:52,473 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:52,473 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:52,473 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:29:52,477 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:29:52,477 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:29:52,478 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:29:52,478 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:29:52,478 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:29:52,478 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:29:52,480 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:29:52,481 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.5ms
2025-11-18 10:29:52,483 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:29:52,483 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:52,483 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:52,483 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:52,484 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:52,484 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:52,484 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:52,484 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:52,484 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:29:52,489 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:29:52,490 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:29:52,490 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:29:52,490 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:29:52,490 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:29:52,491 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:29:52,492 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:29:52,493 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.2ms
2025-11-18 10:29:53,815 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-18 10:29:53,815 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 0.6ms
2025-11-18 10:29:53,818 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:29:53,819 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:53,819 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:53,819 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:53,819 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:53,819 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:53,820 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:53,820 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:53,820 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:29:53,820 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-18 10:29:53,825 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:29:53,825 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:29:53,829 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:29:53,829 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 9.2ms
2025-11-18 10:29:53,830 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 12.0ms
2025-11-18 10:29:53,832 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:29:53,832 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:53,832 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:53,833 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:53,833 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:53,833 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:53,833 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:53,833 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:53,833 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:29:53,837 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:29:53,837 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:29:53,838 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:29:53,839 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 6.9ms
2025-11-18 10:29:55,959 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:29:55,960 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:55,960 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:55,960 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:55,960 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:55,961 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:55,961 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:55,961 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:55,961 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:29:55,966 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:29:55,966 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:29:55,966 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:29:55,967 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:29:55,967 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:29:55,967 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:29:55,969 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:29:55,970 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.1ms
2025-11-18 10:29:55,971 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:29:55,972 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:55,972 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:55,972 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:55,972 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:55,972 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:55,973 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:55,973 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:55,973 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:29:55,993 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:29:55,994 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:29:55,994 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:29:55,994 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:29:55,995 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:29:55,995 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:29:56,000 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:29:56,002 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones/
2025-11-18 10:29:56,003 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 31.7ms
2025-11-18 10:29:56,004 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:56,004 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:56,004 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:56,005 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:56,005 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:56,005 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:56,005 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:56,005 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones/
2025-11-18 10:29:56,007 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones/ 404 5.2ms
2025-11-18 10:29:56,009 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:29:56,010 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:56,010 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:56,010 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:56,010 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:56,010 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:56,010 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:56,011 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:56,011 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:29:56,016 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:29:56,017 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:29:56,017 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:29:56,017 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:29:56,017 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:29:56,017 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:29:56,019 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:29:56,020 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.5ms
2025-11-18 10:29:58,073 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:29:58,073 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:58,074 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:58,074 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:58,074 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:58,074 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:58,074 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:58,075 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:58,075 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:29:58,080 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:29:58,080 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:29:58,082 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:29:58,083 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 9.6ms
2025-11-18 10:29:58,085 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:29:58,086 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:29:58,086 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:29:58,086 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:29:58,086 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:29:58,086 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:29:58,087 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:29:58,087 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:29:58,087 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:29:58,092 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:29:58,092 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:29:58,094 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:29:58,095 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 9.4ms
2025-11-18 10:30:30,271 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 10:30:30,271 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:30:30,272 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:30:30,272 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:30:30,272 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:30:30,272 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:30:30,272 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:30:30,273 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:30:30,273 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 10:30:30,273 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-18 10:30:30,274 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 401 2.5ms
2025-11-18 10:30:36,180 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/1
2025-11-18 10:30:36,180 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:30:36,180 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:30:36,181 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:30:36,181 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:30:36,181 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:30:36,181 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:30:36,181 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:30:36,181 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/1
2025-11-18 10:30:36,182 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-18 10:30:36,182 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/1 401 2.4ms
2025-11-18 10:31:11,018 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:31:11,018 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:31:11,018 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:31:11,018 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:31:11,018 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:31:11,019 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:31:11,019 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:31:11,019 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:31:11,019 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:31:11,030 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:31:11,030 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:31:11,031 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:31:11,031 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:31:11,031 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:31:11,031 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:31:11,033 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:31:11,033 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 15.7ms
2025-11-18 10:31:11,035 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:31:11,036 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:31:11,036 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:31:11,036 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:31:11,036 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:31:11,036 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:31:11,037 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:31:11,037 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:31:11,037 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:31:11,041 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:31:11,041 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgwMDQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.rNpLAnhQvtmEZVHwxCVlzzhQfCK-4GWIKs7EpPAi7Gk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDgzOTQ3LCJpYXQiOjE3NjM0NzkxNDcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.7h6mK-ACe0q2KkY6E2iCnW6D42ToW74d1KGXK2h6j3E'}
2025-11-18 10:31:11,041 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:31:11,041 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:31:11,042 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:31:11,042 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:31:11,043 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:31:11,044 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.1ms
2025-11-18 10:36:57,196 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:36:57,197 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:36:57,197 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:36:57,197 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:36:57,197 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:36:57,197 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:36:57,197 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:36:57,198 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:36:57,198 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:36:57,199 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-18 10:36:57,199 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 401 2.9ms
2025-11-18 10:36:57,200 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:36:57,201 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:36:57,201 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:36:57,201 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:36:57,201 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:36:57,201 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:36:57,201 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:36:57,202 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:36:57,202 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:36:57,202 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-18 10:36:57,203 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 401 2.5ms
2025-11-18 10:36:57,512 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 10:36:57,512 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.6ms
2025-11-18 10:36:57,514 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 10:36:57,514 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:36:57,514 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:36:57,515 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:36:57,515 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:36:57,515 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:36:57,515 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:36:57,515 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:36:57,515 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 10:36:57,527 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 10:36:57,528 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 10:36:57,529 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:36:57,529 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:36:57,529 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 10:36:57,530 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:36:57,530 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1058
2025-11-18 10:36:57,530 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 1058
2025-11-18 10:36:57,530 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 10:36:57,531 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 16.9ms
2025-11-18 10:36:57,535 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:36:57,535 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:36:57,536 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:36:57,536 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:36:57,536 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:36:57,536 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:36:57,536 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:36:57,536 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:36:57,536 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:36:57,540 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:36:57,540 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:36:57,541 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:36:57,541 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 6.3ms
2025-11-18 10:36:59,531 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:36:59,531 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.9ms
2025-11-18 10:36:59,532 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:36:59,533 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.9ms
2025-11-18 10:36:59,534 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:36:59,534 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:36:59,535 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:36:59,535 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:36:59,535 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:36:59,535 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:36:59,535 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:36:59,536 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:36:59,536 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:36:59,540 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:36:59,540 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgxMTE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.oHCgCxokpHMbaFWrardfVJdrleZ16wIAPxa9imdZhao', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDg1MDE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.wgs3bEFwKB_ghjkgsYUqam4uwutTOLhX8JGM3fu4Q0s'}
2025-11-18 10:36:59,541 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:36:59,541 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:36:59,541 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:36:59,541 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:36:59,543 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:36:59,544 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.6ms
2025-11-18 10:36:59,545 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:36:59,546 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:36:59,546 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:36:59,546 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:36:59,546 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:36:59,546 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:36:59,547 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:36:59,547 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:36:59,547 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:36:59,551 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:36:59,551 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgxMTE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.oHCgCxokpHMbaFWrardfVJdrleZ16wIAPxa9imdZhao', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDg1MDE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.wgs3bEFwKB_ghjkgsYUqam4uwutTOLhX8JGM3fu4Q0s'}
2025-11-18 10:36:59,552 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:36:59,552 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:36:59,552 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:36:59,552 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:36:59,554 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:36:59,555 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones/
2025-11-18 10:36:59,555 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.5ms
2025-11-18 10:36:59,555 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:36:59,555 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:36:59,555 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:36:59,555 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:36:59,555 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:36:59,556 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:36:59,556 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:36:59,556 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones/
2025-11-18 10:36:59,557 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones/ 404 2.7ms
2025-11-18 10:36:59,558 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:36:59,559 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:36:59,559 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:36:59,559 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:36:59,559 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:36:59,559 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:36:59,559 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:36:59,559 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:36:59,560 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:36:59,563 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:36:59,563 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgxMTE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.oHCgCxokpHMbaFWrardfVJdrleZ16wIAPxa9imdZhao', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDg1MDE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.wgs3bEFwKB_ghjkgsYUqam4uwutTOLhX8JGM3fu4Q0s'}
2025-11-18 10:36:59,563 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:36:59,563 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:36:59,564 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:36:59,564 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:36:59,565 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:36:59,566 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.6ms
2025-11-18 10:37:04,272 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/5/conexiones/
2025-11-18 10:37:04,273 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:37:04,273 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:37:04,273 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:37:04,274 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:37:04,274 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:37:04,274 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:37:04,274 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:37:04,274 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:37:04,274 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:37:04,275 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/5/conexiones/ 200 2.5ms
2025-11-18 10:37:04,278 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:37:04,278 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgxMTE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.oHCgCxokpHMbaFWrardfVJdrleZ16wIAPxa9imdZhao', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDg1MDE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.wgs3bEFwKB_ghjkgsYUqam4uwutTOLhX8JGM3fu4Q0s'}
2025-11-18 10:37:04,279 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:37:04,279 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:37:04,279 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:37:04,279 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:37:04,280 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:37:04,281 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.3ms
2025-11-18 10:37:04,282 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/5/conexiones/
2025-11-18 10:37:04,283 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:37:04,283 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:37:04,283 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:37:04,283 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:37:04,283 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:37:04,284 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:37:04,284 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:37:04,284 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/5/conexiones/
2025-11-18 10:37:04,285 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/5/conexiones/ 404 2.5ms
2025-11-18 10:37:08,679 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:37:08,679 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:37:08,680 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:37:08,680 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:37:08,680 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:37:08,680 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:37:08,680 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:37:08,680 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:37:08,681 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:37:08,681 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones/
2025-11-18 10:37:08,684 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:37:08,684 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgxMTE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.oHCgCxokpHMbaFWrardfVJdrleZ16wIAPxa9imdZhao', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDg1MDE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.wgs3bEFwKB_ghjkgsYUqam4uwutTOLhX8JGM3fu4Q0s'}
2025-11-18 10:37:08,684 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:37:08,685 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:37:08,685 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:37:08,685 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:37:08,686 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:37:08,687 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:37:08,687 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:37:08,687 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:37:08,687 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:37:08,687 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:37:08,687 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:37:08,688 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:37:08,688 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones/
2025-11-18 10:37:08,689 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.5ms
2025-11-18 10:37:08,689 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones/ 404 8.0ms
2025-11-18 10:37:10,582 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:37:10,582 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:37:10,582 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:37:10,582 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:37:10,583 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:37:10,583 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:37:10,583 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:37:10,583 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:37:10,583 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:37:10,587 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:37:10,587 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgxMTE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.oHCgCxokpHMbaFWrardfVJdrleZ16wIAPxa9imdZhao', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDg1MDE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.wgs3bEFwKB_ghjkgsYUqam4uwutTOLhX8JGM3fu4Q0s'}
2025-11-18 10:37:10,587 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:37:10,587 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:37:10,588 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:37:10,588 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:37:10,589 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:37:10,590 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.9ms
2025-11-18 10:37:10,890 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/3/conexiones/
2025-11-18 10:37:10,891 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/3/conexiones/ 200 0.6ms
2025-11-18 10:37:10,892 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/3/conexiones/
2025-11-18 10:37:10,893 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:37:10,893 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:37:10,893 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:37:10,893 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:37:10,893 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:37:10,894 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:37:10,894 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:37:10,894 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/3/conexiones/
2025-11-18 10:37:10,895 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/3/conexiones/ 404 2.1ms
2025-11-18 10:37:32,072 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 10:37:32,072 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:37:32,072 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:37:32,072 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:37:32,072 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:37:32,073 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:37:32,073 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:37:32,073 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:37:32,073 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 10:37:32,074 - app.api.deps - WARNING - Error de validación JWT: Signature has expired.
2025-11-18 10:37:32,074 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 401 2.5ms
2025-11-18 10:38:08,312 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /docs
2025-11-18 10:38:08,313 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:38:08,313 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:38:08,313 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:38:08,313 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:38:08,313 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:38:08,314 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:38:08,314 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:38:08,314 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/docs
2025-11-18 10:38:08,314 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /docs 200 2.1ms
2025-11-18 10:38:08,427 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /openapi.json
2025-11-18 10:38:08,427 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:38:08,427 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:38:08,428 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:38:08,428 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:38:08,428 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:38:08,428 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:38:08,428 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:38:08,429 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/openapi.json
2025-11-18 10:38:08,587 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /openapi.json 200 160.2ms
2025-11-18 10:38:20,355 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 10:38:20,355 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:38:20,355 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:38:20,356 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:38:20,356 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:38:20,356 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:38:20,356 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:38:20,356 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:38:20,356 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 10:38:20,359 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 10:38:20,359 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 10:38:20,360 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 10:38:20,589 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 10:38:20,589 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 10:38:20,589 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 10:38:20,590 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:38:20,591 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 1059
2025-11-18 10:38:20,591 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 1059
2025-11-18 10:38:20,591 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 10:38:20,592 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 236.8ms
2025-11-18 10:38:27,827 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:38:27,828 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:38:27,828 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:38:27,828 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:38:27,828 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:38:27,829 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:38:27,829 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:38:27,829 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:38:27,829 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:38:27,833 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:38:27,834 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': '127.0.0.1:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgxMjAwLCJpYXQiOjE3NjM0ODAzMDAsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.6n07wO7K1xUkAJBlL0kNVU-zJCVf5SqmCbED-tLsNco', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'accept': 'application/json', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'sec-ch-ua-mobile': '?0', 'sec-fetch-site': 'same-origin', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg1MTAwLCJpYXQiOjE3NjM0ODAzMDAsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.htSMcErlLO7uQjLg6o9BYEw22ZpL8G5lbnwwPoX4NgA'}
2025-11-18 10:38:27,835 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:38:27,836 - app.api.v1.endpoints.clientes - INFO - URL completa: http://127.0.0.1:8000/api/v1/clientes/?skip=0&limit=100&solo_activos=true
2025-11-18 10:38:27,836 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:38:27,836 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:38:27,839 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:38:27,840 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 13.1ms
2025-11-18 10:38:37,274 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:38:37,274 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:38:37,274 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:38:37,275 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:38:37,275 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:38:37,275 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:38:37,275 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:38:37,275 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:38:37,275 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:38:37,279 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 100, solo_activos: True
2025-11-18 10:38:37,280 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 100
2025-11-18 10:38:37,289 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:38:37,290 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 16.6ms
2025-11-18 10:38:49,393 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 10:38:49,393 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:38:49,394 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 10:38:49,394 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 10:38:49,394 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:38:49,394 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:38:49,394 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:38:49,394 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:38:49,395 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 10:38:49,399 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 10:38:49,399 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 10:38:49,410 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 10:38:49,410 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 17.6ms
2025-11-18 10:39:08,752 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:39:08,753 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:39:08,753 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:39:08,753 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:39:08,754 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:39:08,754 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:39:08,754 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:39:08,754 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:39:08,754 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:39:08,755 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones/
2025-11-18 10:39:08,758 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:39:08,758 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgxMTE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.oHCgCxokpHMbaFWrardfVJdrleZ16wIAPxa9imdZhao', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDg1MDE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.wgs3bEFwKB_ghjkgsYUqam4uwutTOLhX8JGM3fu4Q0s'}
2025-11-18 10:39:08,758 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:39:08,759 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:39:08,759 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:39:08,759 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:39:08,760 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:39:08,761 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:39:08,761 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:39:08,761 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:39:08,761 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:39:08,761 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:39:08,761 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:39:08,762 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:39:08,762 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones/
2025-11-18 10:39:08,762 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.0ms
2025-11-18 10:39:08,763 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones/ 404 8.0ms
2025-11-18 10:41:25,050 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/conexiones/
2025-11-18 10:41:25,050 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/conexiones/ 200 0.6ms
2025-11-18 10:41:25,366 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones/
2025-11-18 10:41:25,367 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:41:25,367 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:41:25,367 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:41:25,367 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:41:25,367 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:41:25,367 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:41:25,368 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:41:25,368 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones/
2025-11-18 10:41:25,368 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones/ 404 2.2ms
2025-11-18 10:41:31,027 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:41:31,028 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.8ms
2025-11-18 10:41:31,030 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/3/conexiones/
2025-11-18 10:41:31,030 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:41:31,030 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:41:31,031 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:41:31,031 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:41:31,031 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:41:31,031 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:41:31,031 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:41:31,031 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:41:31,031 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:41:31,032 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/3/conexiones/ 200 2.0ms
2025-11-18 10:41:31,064 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:41:31,064 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgxMTE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.oHCgCxokpHMbaFWrardfVJdrleZ16wIAPxa9imdZhao', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDg1MDE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.wgs3bEFwKB_ghjkgsYUqam4uwutTOLhX8JGM3fu4Q0s'}
2025-11-18 10:41:31,065 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:41:31,065 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:41:31,065 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:41:31,065 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:41:31,066 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:41:31,067 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 37.0ms
2025-11-18 10:41:31,069 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/3/conexiones/
2025-11-18 10:41:31,069 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:41:31,070 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:41:31,070 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:41:31,070 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:41:31,070 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:41:31,070 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:41:31,070 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:41:31,071 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/3/conexiones/
2025-11-18 10:41:31,071 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/3/conexiones/ 404 2.1ms
2025-11-18 10:41:34,311 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:41:34,311 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/conexiones/
2025-11-18 10:41:34,312 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.1ms
2025-11-18 10:41:34,312 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/conexiones/ 200 0.6ms
2025-11-18 10:41:34,314 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:41:34,314 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:41:34,315 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:41:34,315 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:41:34,315 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:41:34,315 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:41:34,315 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:41:34,315 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:41:34,315 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:41:34,316 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones/
2025-11-18 10:41:34,320 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:41:34,320 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzYzNDgxMTE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.oHCgCxokpHMbaFWrardfVJdrleZ16wIAPxa9imdZhao', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiZXhwIjoxNzY0MDg1MDE3LCJpYXQiOjE3NjM0ODAyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.wgs3bEFwKB_ghjkgsYUqam4uwutTOLhX8JGM3fu4Q0s'}
2025-11-18 10:41:34,320 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:41:34,320 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:41:34,321 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:41:34,321 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:41:34,322 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:41:34,322 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:41:34,323 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:41:34,323 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:41:34,323 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:41:34,323 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:41:34,323 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:41:34,323 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:41:34,324 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones/
2025-11-18 10:41:34,324 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.2ms
2025-11-18 10:41:34,324 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones/ 404 8.8ms
2025-11-18 10:51:42,299 - app.middleware.tenant_middleware - INFO - [TENANT_MW] Inicializado - BASE_DOMAIN=midominio.com, SYSTEM_ID=1
2025-11-18 10:52:03,298 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 10:52:03,299 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.6ms
2025-11-18 10:52:03,608 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 10:52:03,609 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:03,609 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 10:52:03,609 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 10:52:03,609 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:03,609 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 10:52:03,741 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 10:52:03,746 - app.core.encryption - ERROR - Token de encriptación inválido. Posibles causas: clave incorrecta o datos corruptos
2025-11-18 10:52:03,747 - app.core.multi_db - ERROR - [METADATA] Error al desencriptar credenciales para cliente 2: Credencial corrupta o clave de encriptación incorrecta
2025-11-18 10:52:03,747 - app.core.multi_db - WARNING - [METADATA] No se encontró configuración para cliente 2, usando Single-DB como fallback
2025-11-18 10:52:03,748 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:03,748 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 10:52:03,758 - app.api.v1.endpoints.auth - INFO - Cliente 2 resuelto y validado para login.
2025-11-18 10:52:03,758 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=2
2025-11-18 10:52:03,758 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=2
2025-11-18 10:52:04,001 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 10:52:04,001 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=2, access_level=5, user_type=super_admin
2025-11-18 10:52:04,002 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=2
2025-11-18 10:52:04,009 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:52:04,009 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 2, Usuario 1 - Cliente: web - Token ID: 2044
2025-11-18 10:52:04,009 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 2044
2025-11-18 10:52:04,010 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 2
2025-11-18 10:52:04,012 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 403.1ms
2025-11-18 10:52:04,065 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:52:04,066 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.5ms
2025-11-18 10:52:04,068 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:52:04,069 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:52:04,070 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.5ms
2025-11-18 10:52:04,070 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:52:04,070 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:04,070 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 10:52:04,071 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 10:52:04,071 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:04,071 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 10:52:04,072 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 10:52:04,073 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:04,073 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:52:04,073 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 4.5ms
2025-11-18 10:52:04,092 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:52:04,092 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:52:04,134 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:52:04,136 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:52:04,136 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 66.4ms
2025-11-18 10:52:04,137 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:04,137 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 10:52:04,137 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 10:52:04,137 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:04,137 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 10:52:04,138 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 10:52:04,138 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:04,138 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:52:04,148 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:52:04,149 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:52:04,159 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:52:04,159 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:52:04,160 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:52:04,161 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:52:04,161 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 25.2ms
2025-11-18 10:52:04,161 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.3ms
2025-11-18 10:52:04,162 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.1ms
2025-11-18 10:52:04,163 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:52:04,164 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:04,164 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 10:52:04,164 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 10:52:04,164 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:04,164 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 10:52:04,165 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 10:52:04,165 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:04,165 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:52:04,172 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:52:04,176 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:52:04,176 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:52:04,177 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:52:04,177 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:04,178 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 10:52:04,178 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 10:52:04,178 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:04,178 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 10:52:04,179 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 10:52:04,179 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:04,180 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:52:04,180 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 16.7ms
2025-11-18 10:52:04,184 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:52:04,184 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:52:04,185 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:52:04,186 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.6ms
2025-11-18 10:52:04,188 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:52:04,188 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:04,189 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 10:52:04,189 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 10:52:04,189 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:04,189 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 10:52:04,190 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 10:52:04,190 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:04,190 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:52:04,196 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:52:04,197 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:52:04,201 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:52:04,201 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:52:04,201 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:52:04,202 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:04,202 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 10:52:04,202 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 10:52:04,202 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:04,202 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 10:52:04,203 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 10:52:04,203 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:04,203 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:52:04,208 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:52:04,209 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:52:04,210 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:52:04,210 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 22.3ms
2025-11-18 10:52:04,211 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 9.5ms
2025-11-18 10:52:27,635 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-18 10:52:27,635 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.5ms
2025-11-18 10:52:27,636 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 10:52:27,637 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:27,637 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host extraído de 'origin': acme.midominio.com:5173
2025-11-18 10:52:27,637 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'acme.midominio.com'
2025-11-18 10:52:27,637 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:27,637 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Detectado: 'acme'
2025-11-18 10:52:27,638 - app.middleware.tenant_middleware - INFO - [TENANT] Cliente resuelto: Subdominio='acme', Código='ACME001', ID=2
2025-11-18 10:52:27,638 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:27,639 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=2, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 10:52:27,641 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] No se proporcionó refresh token - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 10:52:27,641 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 4.8ms
2025-11-18 10:52:33,617 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 10:52:33,618 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.6ms
2025-11-18 10:52:33,936 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 10:52:33,937 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:33,937 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:33,937 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:33,937 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:33,937 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:33,938 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:33,938 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:33,938 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 10:52:33,946 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 10:52:33,948 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 10:52:33,952 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:52:33,953 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:52:33,953 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 10:52:33,954 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:52:33,955 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2045
2025-11-18 10:52:33,955 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 2045
2025-11-18 10:52:33,955 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 10:52:33,956 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 19.0ms
2025-11-18 10:52:33,959 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-18 10:52:33,960 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.3ms
2025-11-18 10:52:33,961 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 10:52:33,961 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:33,962 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:33,962 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:33,962 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:33,962 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:33,962 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:33,962 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:33,962 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 10:52:33,964 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 10:52:33,964 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 10:52:33,976 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 10:52:33,976 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 10:52:33,976 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 15.3ms
2025-11-18 10:52:36,459 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:52:36,460 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:52:36,461 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.3ms
2025-11-18 10:52:36,461 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.9ms
2025-11-18 10:52:36,463 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:52:36,463 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:36,464 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:36,464 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:36,464 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:36,464 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:36,464 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:36,465 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:36,466 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:52:36,475 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:52:36,475 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:52:36,476 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:52:36,477 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 13.4ms
2025-11-18 10:52:36,479 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:52:36,480 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:36,480 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:36,480 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:36,480 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:36,481 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:36,481 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:36,481 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:36,481 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:52:36,484 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:52:36,485 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:52:36,486 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:52:36,486 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 6.9ms
2025-11-18 10:52:38,458 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-18 10:52:38,459 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.5ms
2025-11-18 10:52:38,460 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 10:52:38,460 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:38,460 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:38,461 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:38,461 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:38,461 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:38,461 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:38,461 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:38,461 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 10:52:38,464 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:52:38,464 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:52:38,465 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 10:52:38,465 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 5.3ms
2025-11-18 10:52:47,716 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 10:52:47,717 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.7ms
2025-11-18 10:52:47,719 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 10:52:47,719 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:47,720 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:47,720 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:47,720 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:47,720 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:47,720 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:47,721 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:47,721 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 10:52:47,724 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 10:52:47,724 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 10:52:47,725 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 10:52:47,935 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 10:52:47,935 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 10:52:47,936 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 10:52:47,937 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:52:47,937 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2046
2025-11-18 10:52:47,937 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 2046
2025-11-18 10:52:47,937 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 10:52:47,938 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 218.9ms
2025-11-18 10:52:47,957 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:52:47,958 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.1ms
2025-11-18 10:52:47,959 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:52:47,959 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:47,959 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:47,959 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:47,960 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:47,960 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:47,960 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:47,960 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:47,960 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:52:47,965 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:52:47,966 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:52:47,967 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:52:47,968 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.4ms
2025-11-18 10:52:47,970 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:52:47,971 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:52:47,971 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.0ms
2025-11-18 10:52:47,972 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:52:47,972 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.2ms
2025-11-18 10:52:47,972 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:47,973 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:47,973 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:47,973 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:47,973 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:47,973 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:47,973 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:47,974 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:52:47,980 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:52:47,980 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:52:47,984 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:52:47,984 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:52:47,986 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 14.5ms
2025-11-18 10:52:47,987 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:52:47,988 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.0ms
2025-11-18 10:52:47,989 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:52:47,989 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:47,990 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:47,990 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:47,990 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:47,990 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:47,990 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:47,990 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:47,991 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:52:47,994 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:52:47,994 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:52:47,995 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:52:47,996 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.1ms
2025-11-18 10:52:47,997 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:52:47,998 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:47,998 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:47,998 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:47,998 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:47,998 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:47,998 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:47,998 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:47,999 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:52:48,004 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:52:48,004 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:52:48,004 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:52:48,005 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.6ms
2025-11-18 10:52:48,007 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:52:48,007 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:48,007 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:48,007 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:48,007 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:48,008 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:48,008 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:48,008 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:48,008 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:52:48,013 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:52:48,013 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:52:48,017 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:52:48,017 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:52:48,017 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 10.5ms
2025-11-18 10:52:48,019 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:52:48,020 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:48,020 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:48,020 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:48,020 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:48,020 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:48,020 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:48,021 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:48,021 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:52:48,025 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:52:48,026 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:52:48,026 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:52:48,027 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.3ms
2025-11-18 10:52:49,183 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:52:49,183 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.5ms
2025-11-18 10:52:49,186 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:52:49,186 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:49,186 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:49,186 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:49,186 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:49,187 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:49,187 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:49,187 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:49,187 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:52:49,192 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:52:49,192 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMDY3LCJpYXQiOjE3NjM0ODExNjcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.az0vEa35bP116ZVLT8hLXkrSumcAEEURol0_7Y3e3no', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg1OTY3LCJpYXQiOjE3NjM0ODExNjcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.-sZsXELbERKui_KQpU6PdoSJ6TfV_vPfCjFed6FKjEo'}
2025-11-18 10:52:49,192 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:52:49,193 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:52:49,193 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:52:49,193 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:52:49,196 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:52:49,197 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 11.6ms
2025-11-18 10:52:49,199 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:52:49,200 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:49,200 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:49,200 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:49,201 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:49,201 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:49,201 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:49,201 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:49,201 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:52:49,205 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:52:49,206 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMDY3LCJpYXQiOjE3NjM0ODExNjcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.az0vEa35bP116ZVLT8hLXkrSumcAEEURol0_7Y3e3no', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg1OTY3LCJpYXQiOjE3NjM0ODExNjcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.-sZsXELbERKui_KQpU6PdoSJ6TfV_vPfCjFed6FKjEo'}
2025-11-18 10:52:49,206 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:52:49,206 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:52:49,207 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:52:49,207 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:52:49,208 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:52:49,209 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.6ms
2025-11-18 10:52:51,058 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-18 10:52:51,058 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-18 10:52:51,059 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.2ms
2025-11-18 10:52:51,059 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.1ms
2025-11-18 10:52:51,064 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:52:51,064 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:51,064 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:51,064 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:51,064 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:51,065 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:51,065 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:51,065 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:51,065 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:52:51,070 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:52:51,070 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:52:51,076 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:52:51,077 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 13.0ms
2025-11-18 10:52:51,079 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:52:51,079 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:51,079 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:51,079 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:51,079 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:51,080 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:51,080 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:51,080 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:51,080 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:52:51,084 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:52:51,084 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:52:51,085 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:52:51,085 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 6.8ms
2025-11-18 10:52:53,184 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:52:53,185 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.8ms
2025-11-18 10:52:53,186 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:52:53,187 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.8ms
2025-11-18 10:52:53,188 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:52:53,189 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:53,189 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:53,189 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:53,189 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:53,189 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:53,189 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:53,190 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:53,190 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:52:53,195 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:52:53,195 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMDY3LCJpYXQiOjE3NjM0ODExNjcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.az0vEa35bP116ZVLT8hLXkrSumcAEEURol0_7Y3e3no', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg1OTY3LCJpYXQiOjE3NjM0ODExNjcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.-sZsXELbERKui_KQpU6PdoSJ6TfV_vPfCjFed6FKjEo'}
2025-11-18 10:52:53,195 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:52:53,196 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:52:53,196 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:52:53,196 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:52:53,198 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:52:53,199 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.6ms
2025-11-18 10:52:53,201 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:52:53,202 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:53,202 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:53,202 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:53,202 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:53,203 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:53,203 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:53,203 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:53,203 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:52:53,208 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:52:53,208 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMDY3LCJpYXQiOjE3NjM0ODExNjcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.az0vEa35bP116ZVLT8hLXkrSumcAEEURol0_7Y3e3no', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg1OTY3LCJpYXQiOjE3NjM0ODExNjcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.-sZsXELbERKui_KQpU6PdoSJ6TfV_vPfCjFed6FKjEo'}
2025-11-18 10:52:53,209 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:52:53,209 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:52:53,209 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:52:53,209 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:52:53,211 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:52:53,212 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/conexiones/
2025-11-18 10:52:53,212 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.8ms
2025-11-18 10:52:53,213 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/conexiones/ 200 0.8ms
2025-11-18 10:52:53,214 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:52:53,214 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:53,214 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:53,214 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:53,215 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:53,215 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:53,215 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:53,215 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:53,215 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:52:53,219 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:52:53,219 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMDY3LCJpYXQiOjE3NjM0ODExNjcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.az0vEa35bP116ZVLT8hLXkrSumcAEEURol0_7Y3e3no', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg1OTY3LCJpYXQiOjE3NjM0ODExNjcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.-sZsXELbERKui_KQpU6PdoSJ6TfV_vPfCjFed6FKjEo'}
2025-11-18 10:52:53,219 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:52:53,219 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:52:53,220 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:52:53,220 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:52:53,221 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:52:53,222 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones/
2025-11-18 10:52:53,223 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:52:53,223 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:52:53,223 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:52:53,223 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:52:53,223 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:52:53,223 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:52:53,224 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:52:53,224 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones/
2025-11-18 10:52:53,224 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.4ms
2025-11-18 10:52:53,225 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones/ 404 3.5ms
2025-11-18 10:53:25,890 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 10:53:25,890 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.7ms
2025-11-18 10:53:25,892 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 10:53:25,893 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:25,893 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:25,894 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:25,894 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:25,894 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:25,894 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:25,894 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:25,895 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 10:53:25,898 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 10:53:25,899 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 10:53:25,901 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:53:25,902 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:53:25,902 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 10:53:25,904 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:53:25,905 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2047
2025-11-18 10:53:25,905 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 2047
2025-11-18 10:53:25,905 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 10:53:25,906 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 13.3ms
2025-11-18 10:53:25,913 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-18 10:53:25,914 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.5ms
2025-11-18 10:53:25,916 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 10:53:25,916 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:25,916 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:25,917 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:25,917 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:25,917 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:25,917 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:25,917 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:25,917 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 10:53:25,919 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 10:53:25,920 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 10:53:25,923 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 10:53:25,923 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 10:53:25,924 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 7.9ms
2025-11-18 10:53:26,767 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:53:26,768 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.8ms
2025-11-18 10:53:26,768 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:53:26,769 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.9ms
2025-11-18 10:53:26,772 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:53:26,773 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:26,773 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:26,773 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:26,773 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:26,774 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:26,774 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:26,774 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:26,774 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:53:26,778 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:53:26,779 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:53:26,780 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:53:26,780 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:53:26,781 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:26,781 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:26,781 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:26,781 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:26,781 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:26,781 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:26,782 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:26,782 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:53:26,786 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:53:26,786 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:53:26,787 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:53:26,788 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 15.7ms
2025-11-18 10:53:26,789 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.7ms
2025-11-18 10:53:28,531 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-18 10:53:28,532 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.4ms
2025-11-18 10:53:28,533 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 10:53:28,534 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:28,534 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:28,534 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:28,534 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:28,534 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:28,534 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:28,534 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:28,535 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 10:53:28,537 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:53:28,538 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:53:28,538 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 10:53:28,539 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 5.3ms
2025-11-18 10:53:37,337 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 10:53:37,338 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.6ms
2025-11-18 10:53:37,339 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 10:53:37,340 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:37,340 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:37,340 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:37,340 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:37,340 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:37,340 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:37,340 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:37,340 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 10:53:37,343 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 10:53:37,343 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 10:53:37,343 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 10:53:37,560 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 10:53:37,560 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 10:53:37,560 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 10:53:37,561 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:53:37,562 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2048
2025-11-18 10:53:37,562 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 2048
2025-11-18 10:53:37,562 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 10:53:37,563 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 223.4ms
2025-11-18 10:53:37,583 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:53:37,583 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.6ms
2025-11-18 10:53:37,586 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:53:37,587 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 1.1ms
2025-11-18 10:53:37,587 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:53:37,588 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:37,588 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:37,588 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:37,588 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:37,589 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:37,589 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:37,589 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:37,589 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:53:37,595 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:53:37,595 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:53:37,596 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:53:37,598 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:53:37,598 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 10.8ms
2025-11-18 10:53:37,598 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:37,598 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:37,599 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:37,599 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:37,599 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:37,599 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:37,599 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:37,600 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:53:37,606 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:53:37,606 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:53:37,611 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:53:37,611 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:53:37,612 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:53:37,613 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 15.5ms
2025-11-18 10:53:37,614 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.5ms
2025-11-18 10:53:37,618 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 10:53:37,619 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:53:37,619 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:37,619 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:37,620 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:37,620 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:37,620 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:37,620 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:37,620 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:37,621 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:53:37,621 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 2.8ms
2025-11-18 10:53:37,627 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:53:37,629 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:53:37,629 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:53:37,630 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 11.5ms
2025-11-18 10:53:37,632 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 10:53:37,633 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 0.7ms
2025-11-18 10:53:37,633 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:53:37,633 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:37,634 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:37,634 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:37,634 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:37,634 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:37,634 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:37,635 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:37,635 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:53:37,640 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:53:37,640 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:53:37,641 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:53:37,642 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:53:37,642 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.3ms
2025-11-18 10:53:37,643 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:37,643 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:37,643 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:37,643 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:37,643 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:37,643 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:37,643 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:37,643 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:53:37,648 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:53:37,648 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:53:37,653 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:53:37,653 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:53:37,654 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 10:53:37,655 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 13.0ms
2025-11-18 10:53:37,655 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 1.2ms
2025-11-18 10:53:37,658 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:53:37,659 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:37,659 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:37,659 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:37,659 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:37,659 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:37,660 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:37,660 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:37,660 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:53:37,665 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:53:37,666 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:53:37,666 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:53:37,667 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 8.8ms
2025-11-18 10:53:40,239 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:53:40,240 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.5ms
2025-11-18 10:53:40,241 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:53:40,242 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.1ms
2025-11-18 10:53:40,242 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:53:40,243 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:40,243 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:40,243 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:40,243 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:40,243 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:40,243 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:40,243 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:40,244 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:53:40,258 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:53:40,258 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMTE3LCJpYXQiOjE3NjM0ODEyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.F6Ml0FWwwEhG-FB8HB-aAm6dzklgw_HB5PlmY-4xbW0', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2MDE3LCJpYXQiOjE3NjM0ODEyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.-crPGv6z0MSlpYzkPNlmjdC412AywrECXErFtzd-9IA'}
2025-11-18 10:53:40,259 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:53:40,259 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:53:40,259 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:53:40,259 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:53:40,261 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:53:40,262 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:53:40,262 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 20.2ms
2025-11-18 10:53:40,263 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:40,263 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:40,263 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:40,263 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:40,263 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:40,263 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:40,263 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:40,264 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:53:40,270 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:53:40,271 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMTE3LCJpYXQiOjE3NjM0ODEyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.F6Ml0FWwwEhG-FB8HB-aAm6dzklgw_HB5PlmY-4xbW0', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2MDE3LCJpYXQiOjE3NjM0ODEyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.-crPGv6z0MSlpYzkPNlmjdC412AywrECXErFtzd-9IA'}
2025-11-18 10:53:40,271 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:53:40,271 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:53:40,271 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:53:40,271 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:53:40,273 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:53:40,274 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 12.3ms
2025-11-18 10:53:40,281 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:53:40,281 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/2/conexiones/
2025-11-18 10:53:40,282 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.1ms
2025-11-18 10:53:40,282 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/2/conexiones/ 200 0.7ms
2025-11-18 10:53:40,285 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:53:40,285 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:40,285 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:40,286 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:40,286 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:40,286 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:40,286 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:40,286 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:40,286 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:53:40,287 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/2/conexiones/
2025-11-18 10:53:40,290 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:53:40,291 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMTE3LCJpYXQiOjE3NjM0ODEyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.F6Ml0FWwwEhG-FB8HB-aAm6dzklgw_HB5PlmY-4xbW0', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2MDE3LCJpYXQiOjE3NjM0ODEyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.-crPGv6z0MSlpYzkPNlmjdC412AywrECXErFtzd-9IA'}
2025-11-18 10:53:40,291 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:53:40,291 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:53:40,291 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:53:40,291 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:53:40,292 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:53:40,293 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:53:40,293 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:53:40,293 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:53:40,293 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:53:40,293 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:53:40,293 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:53:40,293 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:53:40,294 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/2/conexiones/
2025-11-18 10:53:40,294 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.4ms
2025-11-18 10:53:40,294 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/2/conexiones/ 404 7.7ms
2025-11-18 10:57:53,371 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 10:57:53,372 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2
2025-11-18 10:57:53,372 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.9ms
2025-11-18 10:57:53,373 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2 200 0.7ms
2025-11-18 10:57:53,681 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:57:53,681 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:57:53,682 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:57:53,682 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:57:53,682 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:57:53,682 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:57:53,682 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:57:53,682 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:57:53,682 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:57:53,683 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 10:57:53,694 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:57:53,694 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMTE3LCJpYXQiOjE3NjM0ODEyMTcsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.F6Ml0FWwwEhG-FB8HB-aAm6dzklgw_HB5PlmY-4xbW0', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2MDE3LCJpYXQiOjE3NjM0ODEyMTcsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.-crPGv6z0MSlpYzkPNlmjdC412AywrECXErFtzd-9IA'}
2025-11-18 10:57:53,694 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:57:53,695 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:57:53,695 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:57:53,695 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:57:53,696 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:57:53,696 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:57:53,697 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:57:53,697 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:57:53,697 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:57:53,697 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:57:53,697 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:57:53,697 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:57:53,697 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 10:57:53,700 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 10:57:53,701 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 10:57:53,704 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 10:57:53,704 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 23.0ms
2025-11-18 10:57:53,704 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 21.8ms
2025-11-18 10:58:01,617 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 10:58:01,617 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:01,617 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:01,618 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:01,618 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:01,618 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:01,618 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:01,618 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:01,618 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 10:58:01,621 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 10:58:01,622 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 10:58:01,627 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:58:01,627 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:58:01,628 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 10:58:01,640 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:58:01,641 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2049
2025-11-18 10:58:01,641 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 2049
2025-11-18 10:58:01,641 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 10:58:01,642 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 25.3ms
2025-11-18 10:58:01,647 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 10:58:01,648 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:01,648 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:01,648 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:01,648 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:01,648 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:01,649 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:01,649 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:01,649 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 10:58:01,650 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 10:58:01,650 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 10:58:01,652 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 10:58:01,653 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 10:58:01,653 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 6.0ms
2025-11-18 10:58:02,655 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:58:02,655 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:02,655 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:02,656 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:02,656 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:02,656 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:02,656 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:02,656 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:02,656 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:58:02,660 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:58:02,661 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:58:02,661 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:58:02,662 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.4ms
2025-11-18 10:58:02,664 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:58:02,665 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:02,665 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:02,665 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:02,665 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:02,665 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:02,665 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:02,666 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:02,666 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:58:02,670 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:58:02,670 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:58:02,671 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:58:02,671 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 6.9ms
2025-11-18 10:58:03,817 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 10:58:03,818 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:03,818 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:03,818 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:03,818 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:03,818 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:03,818 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:03,818 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:03,819 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 10:58:03,821 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:58:03,821 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:58:03,822 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 10:58:03,822 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 4.7ms
2025-11-18 10:58:13,958 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 10:58:13,959 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:13,959 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:13,959 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:13,959 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:13,959 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:13,960 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:13,960 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:13,960 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 10:58:13,962 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 10:58:13,962 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 10:58:13,962 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 10:58:14,172 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 10:58:14,172 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 10:58:14,172 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 10:58:14,173 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:58:14,174 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2050
2025-11-18 10:58:14,174 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 2050
2025-11-18 10:58:14,174 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 10:58:14,174 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 216.0ms
2025-11-18 10:58:14,191 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:58:14,192 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:14,192 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:14,192 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:14,192 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:14,193 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:14,193 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:14,193 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:14,193 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:58:14,198 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:58:14,198 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:58:14,199 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:58:14,200 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.5ms
2025-11-18 10:58:14,202 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:58:14,202 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:14,202 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:14,203 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:14,203 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:14,203 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:14,203 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:14,203 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:14,203 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:58:14,209 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:58:14,209 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:58:14,213 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:58:14,214 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:58:14,214 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 12.4ms
2025-11-18 10:58:14,216 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:58:14,217 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:14,217 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:14,217 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:14,217 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:14,217 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:14,217 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:14,218 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:14,218 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:58:14,222 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:58:14,223 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:58:14,223 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:58:14,223 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:58:14,224 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:14,224 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:14,224 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:14,224 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:14,224 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:14,224 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:14,224 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:14,225 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:58:14,228 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:58:14,229 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:58:14,229 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:58:14,230 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 13.7ms
2025-11-18 10:58:14,230 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.0ms
2025-11-18 10:58:14,232 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:58:14,232 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:14,233 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:14,233 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:14,233 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:14,233 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:14,233 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:14,233 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:14,234 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:58:14,238 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:58:14,238 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:58:14,241 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:58:14,241 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:58:14,242 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:58:14,242 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:14,242 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:14,242 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:14,243 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:14,243 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:14,243 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:14,243 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:14,243 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:58:14,248 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:58:14,248 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:58:14,248 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:58:14,249 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 17.1ms
2025-11-18 10:58:14,249 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.6ms
2025-11-18 10:58:15,916 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:58:15,916 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:15,917 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:15,917 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:15,917 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:15,917 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:15,917 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:15,917 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:15,918 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:58:15,921 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:58:15,922 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMzk0LCJpYXQiOjE3NjM0ODE0OTQsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.lNQaWolkAen6VB5u1VRIwd-Z-ZKKkaOkDDE2Tficq20', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2Mjk0LCJpYXQiOjE3NjM0ODE0OTQsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.LY0ocZSooBPcFh128GsZfCGRvn--JDoMAstQN6Go33I'}
2025-11-18 10:58:15,922 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:58:15,922 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:58:15,922 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:58:15,923 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:58:15,924 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:58:15,925 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.1ms
2025-11-18 10:58:15,926 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:58:15,927 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:15,927 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:15,928 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:15,928 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:15,928 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:15,928 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:15,928 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:15,928 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:58:15,933 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:58:15,933 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMzk0LCJpYXQiOjE3NjM0ODE0OTQsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.lNQaWolkAen6VB5u1VRIwd-Z-ZKKkaOkDDE2Tficq20', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2Mjk0LCJpYXQiOjE3NjM0ODE0OTQsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.LY0ocZSooBPcFh128GsZfCGRvn--JDoMAstQN6Go33I'}
2025-11-18 10:58:15,933 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 10:58:15,933 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 10:58:15,933 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:58:15,934 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 10:58:15,935 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:58:15,936 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.2ms
2025-11-18 10:58:16,826 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:58:16,826 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:16,826 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:16,827 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:16,827 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:16,827 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:16,827 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:16,827 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:16,827 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:58:16,832 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:58:16,832 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:58:16,833 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:58:16,834 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 7.8ms
2025-11-18 10:58:16,835 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:58:16,835 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:16,836 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:16,836 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:16,836 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:16,836 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:16,836 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:16,837 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:16,837 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:58:16,840 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:58:16,840 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:58:16,841 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:58:16,842 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 6.6ms
2025-11-18 10:58:17,945 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:58:17,945 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:17,945 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:17,945 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:17,946 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:17,946 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:17,946 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:17,946 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:17,946 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:58:17,949 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:58:17,950 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMzk0LCJpYXQiOjE3NjM0ODE0OTQsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.lNQaWolkAen6VB5u1VRIwd-Z-ZKKkaOkDDE2Tficq20', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2Mjk0LCJpYXQiOjE3NjM0ODE0OTQsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.LY0ocZSooBPcFh128GsZfCGRvn--JDoMAstQN6Go33I'}
2025-11-18 10:58:17,950 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:58:17,950 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:58:17,950 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:58:17,950 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:58:17,952 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:58:17,953 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.2ms
2025-11-18 10:58:17,955 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:58:17,956 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:17,956 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:17,956 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:17,956 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:17,956 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:17,956 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:17,957 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:17,957 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:58:17,961 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:58:17,961 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMzk0LCJpYXQiOjE3NjM0ODE0OTQsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.lNQaWolkAen6VB5u1VRIwd-Z-ZKKkaOkDDE2Tficq20', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2Mjk0LCJpYXQiOjE3NjM0ODE0OTQsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.LY0ocZSooBPcFh128GsZfCGRvn--JDoMAstQN6Go33I'}
2025-11-18 10:58:17,961 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:58:17,961 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:58:17,961 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:58:17,962 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:58:17,963 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:58:17,964 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 10:58:17,964 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.3ms
2025-11-18 10:58:17,965 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:17,965 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:17,965 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:17,965 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:17,965 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:17,965 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:17,966 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:17,966 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 10:58:17,969 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 10:58:17,969 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 10:58:17,970 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 10:58:17,971 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 7.3ms
2025-11-18 10:58:17,973 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:58:17,973 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:58:17,973 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:58:17,973 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:58:17,974 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:58:17,974 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:58:17,974 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:58:17,974 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:58:17,974 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:58:17,978 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:58:17,978 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyMzk0LCJpYXQiOjE3NjM0ODE0OTQsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.lNQaWolkAen6VB5u1VRIwd-Z-ZKKkaOkDDE2Tficq20', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2Mjk0LCJpYXQiOjE3NjM0ODE0OTQsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.LY0ocZSooBPcFh128GsZfCGRvn--JDoMAstQN6Go33I'}
2025-11-18 10:58:17,978 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:58:17,978 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:58:17,978 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:58:17,978 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:58:17,980 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:58:17,981 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.8ms
2025-11-18 10:59:24,541 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 10:59:24,541 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:24,541 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:24,541 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:24,542 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:24,542 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:24,542 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:24,542 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:24,542 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 10:59:24,546 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 10:59:24,547 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 10:59:24,548 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:59:24,548 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:59:24,548 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 10:59:24,549 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:59:24,549 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2051
2025-11-18 10:59:24,550 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 2051
2025-11-18 10:59:24,550 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 10:59:24,550 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 9.3ms
2025-11-18 10:59:24,554 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 10:59:24,554 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:24,554 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:24,554 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:24,554 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:24,554 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:24,554 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:24,554 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:24,555 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 10:59:24,556 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 10:59:24,556 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 10:59:24,557 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 10:59:24,558 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 10:59:24,558 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 4.3ms
2025-11-18 10:59:26,306 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:59:26,307 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:26,307 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:26,307 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:26,307 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:26,307 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:26,307 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:26,308 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:26,308 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:59:26,313 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:59:26,313 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:59:26,314 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:59:26,315 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.7ms
2025-11-18 10:59:26,317 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:59:26,317 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:26,317 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:26,317 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:26,318 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:26,318 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:26,318 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:26,318 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:26,318 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:59:26,322 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:59:26,323 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:59:26,324 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:59:26,324 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.7ms
2025-11-18 10:59:30,337 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 10:59:30,337 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:30,337 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:30,337 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:30,337 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:30,337 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:30,338 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:30,338 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:30,338 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 10:59:30,340 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 10:59:30,340 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 10:59:30,341 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 10:59:30,341 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 4.3ms
2025-11-18 10:59:38,604 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 10:59:38,605 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:38,605 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:38,605 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:38,605 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:38,606 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:38,606 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:38,606 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:38,606 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 10:59:38,608 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 10:59:38,608 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 10:59:38,609 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 10:59:38,817 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 10:59:38,817 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 10:59:38,817 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 10:59:38,819 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 10:59:38,819 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2052
2025-11-18 10:59:38,819 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 2052
2025-11-18 10:59:38,819 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 10:59:38,820 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 215.5ms
2025-11-18 10:59:38,834 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:59:38,835 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:38,835 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:38,835 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:38,835 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:38,836 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:38,836 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:38,836 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:38,836 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:59:38,842 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:59:38,842 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:59:38,843 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:59:38,844 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.2ms
2025-11-18 10:59:38,846 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:59:38,846 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:38,846 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:38,847 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:38,847 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:38,847 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:38,847 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:38,847 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:38,847 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:59:38,852 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:59:38,852 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:59:38,857 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:59:38,858 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:59:38,858 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 12.4ms
2025-11-18 10:59:38,860 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:59:38,861 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:38,861 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:38,861 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:38,861 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:38,861 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:38,861 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:38,862 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:38,862 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:59:38,866 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:59:38,867 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:59:38,867 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:59:38,868 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.2ms
2025-11-18 10:59:38,869 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 10:59:38,870 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:38,870 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:38,870 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:38,870 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:38,870 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:38,870 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:38,870 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:38,871 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 10:59:38,875 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 10:59:38,875 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 10:59:38,876 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 10:59:38,877 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.3ms
2025-11-18 10:59:38,878 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 10:59:38,879 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:38,879 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:38,879 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:38,879 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:38,879 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:38,880 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:38,880 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:38,880 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 10:59:38,884 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 10:59:38,884 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 10:59:38,887 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 10:59:38,888 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 10:59:38,888 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 9.7ms
2025-11-18 10:59:38,891 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 10:59:38,891 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:38,891 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:38,891 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:38,891 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:38,892 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:38,892 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:38,892 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:38,892 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 10:59:38,896 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 10:59:38,897 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 10:59:38,897 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 10:59:38,897 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 6.9ms
2025-11-18 10:59:40,306 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:59:40,307 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:40,307 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:40,307 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:40,308 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:40,308 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:40,308 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:40,308 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:40,308 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:59:40,313 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:59:40,313 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:59:40,315 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:59:40,316 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 9.8ms
2025-11-18 10:59:40,318 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 10:59:40,319 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:40,319 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:40,319 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:40,319 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:40,320 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:40,320 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:40,320 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:40,320 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 10:59:40,325 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 10:59:40,325 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 10:59:40,327 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 10:59:40,327 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 9.0ms
2025-11-18 10:59:40,838 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:59:40,839 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:40,839 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:40,839 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:40,840 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:40,840 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:40,840 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:40,840 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:40,840 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:59:40,845 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:59:40,846 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyNDc4LCJpYXQiOjE3NjM0ODE1NzgsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.1y2tnpLZLHvfMlhEzVI3BvVWohfZ8bv9ooOcIxKEb98', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2Mzc4LCJpYXQiOjE3NjM0ODE1NzgsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.WpEC7VahL8ezN6X0tYIH_bxugjdI3kw1RwdfrEMW0fw'}
2025-11-18 10:59:40,846 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:59:40,846 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:59:40,846 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:59:40,846 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:59:40,848 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:59:40,848 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.0ms
2025-11-18 10:59:40,850 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:59:40,851 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:40,851 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:40,851 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:40,851 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:40,851 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:40,851 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:40,852 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:40,852 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:59:40,855 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:59:40,856 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyNDc4LCJpYXQiOjE3NjM0ODE1NzgsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.1y2tnpLZLHvfMlhEzVI3BvVWohfZ8bv9ooOcIxKEb98', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2Mzc4LCJpYXQiOjE3NjM0ODE1NzgsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.WpEC7VahL8ezN6X0tYIH_bxugjdI3kw1RwdfrEMW0fw'}
2025-11-18 10:59:40,856 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:59:40,856 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:59:40,856 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:59:40,856 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:59:40,858 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:59:40,859 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 10:59:40,859 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.2ms
2025-11-18 10:59:40,860 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:40,860 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:40,860 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:40,860 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:40,860 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:40,860 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:40,861 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:40,861 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 10:59:40,864 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 10:59:40,864 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 10:59:40,865 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 10:59:40,866 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 7.2ms
2025-11-18 10:59:40,868 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 10:59:40,868 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 10:59:40,868 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 10:59:40,868 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 10:59:40,868 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 10:59:40,868 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 10:59:40,869 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 10:59:40,869 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 10:59:40,869 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 10:59:40,872 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 10:59:40,872 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyNDc4LCJpYXQiOjE3NjM0ODE1NzgsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.1y2tnpLZLHvfMlhEzVI3BvVWohfZ8bv9ooOcIxKEb98', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2Mzc4LCJpYXQiOjE3NjM0ODE1NzgsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.WpEC7VahL8ezN6X0tYIH_bxugjdI3kw1RwdfrEMW0fw'}
2025-11-18 10:59:40,873 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 10:59:40,873 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 10:59:40,873 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 10:59:40,873 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 10:59:40,875 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 10:59:40,876 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.4ms
2025-11-18 11:00:26,075 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 11:00:26,075 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:26,076 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:26,076 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:26,076 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:26,076 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:26,076 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:26,076 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:26,077 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 11:00:26,079 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 11:00:26,080 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 11:00:26,081 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 11:00:26,082 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 11:00:26,082 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 11:00:26,084 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 11:00:26,084 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2053
2025-11-18 11:00:26,084 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 2053
2025-11-18 11:00:26,085 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 11:00:26,085 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 10.3ms
2025-11-18 11:00:26,090 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 11:00:26,090 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:26,090 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:26,090 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:26,090 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:26,091 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:26,091 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:26,091 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:26,091 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 11:00:26,093 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 11:00:26,093 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 11:00:26,095 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 11:00:26,096 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 11:00:26,096 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 6.7ms
2025-11-18 11:00:28,808 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:00:28,809 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:28,809 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:28,809 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:28,809 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:28,810 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:28,810 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:28,810 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:28,810 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:00:28,814 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:00:28,814 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:00:28,816 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:00:28,816 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.9ms
2025-11-18 11:00:28,819 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:00:28,820 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:28,820 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:28,820 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:28,820 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:28,821 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:28,821 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:28,821 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:28,821 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:00:28,826 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:00:28,826 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:00:28,827 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:00:28,828 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.2ms
2025-11-18 11:00:30,301 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 11:00:30,302 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:30,302 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:30,302 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:30,302 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:30,302 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:30,302 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:30,302 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:30,302 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 11:00:30,305 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 11:00:30,305 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 11:00:30,305 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 11:00:30,306 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 4.6ms
2025-11-18 11:00:38,060 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 11:00:38,060 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:38,060 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:38,061 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:38,061 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:38,061 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:38,061 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:38,061 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:38,062 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 11:00:38,064 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 11:00:38,064 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 11:00:38,064 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 11:00:38,280 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 11:00:38,280 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 11:00:38,280 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 11:00:38,281 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 11:00:38,282 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2054
2025-11-18 11:00:38,282 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 2054
2025-11-18 11:00:38,282 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 11:00:38,283 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 222.7ms
2025-11-18 11:00:38,297 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:00:38,298 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:38,298 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:38,298 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:38,298 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:38,298 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:38,298 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:38,299 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:38,299 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:00:38,304 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:00:38,305 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:00:38,306 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:00:38,307 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 11:00:38,308 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 11:00:38,308 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 10.7ms
2025-11-18 11:00:38,308 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:38,308 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:38,308 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:38,309 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:38,309 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:38,309 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:38,309 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:38,309 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 11:00:38,310 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:38,310 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:38,310 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:38,310 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:38,310 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:38,311 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:38,311 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:38,311 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 11:00:38,317 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 11:00:38,318 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 11:00:38,319 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 11:00:38,323 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 11:00:38,324 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 11:00:38,327 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 11:00:38,327 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 11:00:38,328 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 20.7ms
2025-11-18 11:00:38,328 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 20.7ms
2025-11-18 11:00:38,331 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:00:38,331 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:38,331 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:38,331 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:38,332 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:38,332 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:38,332 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:38,332 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:38,332 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:00:38,336 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:00:38,336 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:00:38,337 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:00:38,338 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 11:00:38,338 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 11:00:38,339 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:38,339 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:38,339 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:38,339 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:38,339 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:38,339 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:38,339 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:38,340 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 11:00:38,340 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:38,340 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:38,340 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:38,340 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:38,341 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:38,341 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:38,341 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:38,341 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 11:00:38,341 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 10.8ms
2025-11-18 11:00:38,347 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 11:00:38,347 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 11:00:38,352 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 11:00:38,352 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 11:00:38,356 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 11:00:38,357 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 11:00:38,357 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 11:00:38,358 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 19.7ms
2025-11-18 11:00:38,358 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 19.6ms
2025-11-18 11:00:40,459 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:00:40,459 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:40,460 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:40,460 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:40,460 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:40,460 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:40,460 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:40,460 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:40,461 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:00:40,466 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:00:40,466 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:00:40,468 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:00:40,469 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 10.2ms
2025-11-18 11:00:40,471 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:00:40,472 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:40,472 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:40,472 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:40,472 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:40,472 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:40,473 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:40,473 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:40,473 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:00:40,477 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:00:40,477 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:00:40,479 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:00:40,479 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 8.3ms
2025-11-18 11:00:41,259 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:00:41,259 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:41,260 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:41,260 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:41,260 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:41,260 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:41,260 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:41,260 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:41,261 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:00:41,264 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:00:41,265 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyNTM4LCJpYXQiOjE3NjM0ODE2MzgsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Dq9pfTGzsM1TYKxL_8HEG--1124ddtUrL0AmL5G5KPI', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2NDM4LCJpYXQiOjE3NjM0ODE2MzgsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.XBvcv0WhOLhLr4pFdij7mG-9hQDtUm33T36982B3OIs'}
2025-11-18 11:00:41,265 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:00:41,266 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:00:41,266 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:00:41,266 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:00:41,268 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:00:41,269 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.2ms
2025-11-18 11:00:41,271 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:00:41,272 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:41,272 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:41,272 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:41,273 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:41,273 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:41,273 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:41,273 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:41,273 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:00:41,278 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:00:41,278 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyNTM4LCJpYXQiOjE3NjM0ODE2MzgsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Dq9pfTGzsM1TYKxL_8HEG--1124ddtUrL0AmL5G5KPI', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2NDM4LCJpYXQiOjE3NjM0ODE2MzgsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.XBvcv0WhOLhLr4pFdij7mG-9hQDtUm33T36982B3OIs'}
2025-11-18 11:00:41,278 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:00:41,278 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:00:41,279 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:00:41,279 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:00:41,280 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:00:41,281 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:00:41,282 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.2ms
2025-11-18 11:00:41,282 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:41,282 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:41,282 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:41,282 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:41,283 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:41,283 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:41,283 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:41,283 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:00:41,287 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 11:00:41,287 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 11:00:41,288 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 11:00:41,289 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 8.1ms
2025-11-18 11:00:41,291 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:00:41,291 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:00:41,291 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:00:41,291 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:00:41,291 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:00:41,292 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:00:41,292 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:00:41,292 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:00:41,292 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:00:41,295 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:00:41,296 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgyNTM4LCJpYXQiOjE3NjM0ODE2MzgsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Dq9pfTGzsM1TYKxL_8HEG--1124ddtUrL0AmL5G5KPI', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg2NDM4LCJpYXQiOjE3NjM0ODE2MzgsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.XBvcv0WhOLhLr4pFdij7mG-9hQDtUm33T36982B3OIs'}
2025-11-18 11:00:41,296 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:00:41,296 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:00:41,296 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:00:41,296 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:00:41,297 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:00:41,298 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.7ms
2025-11-18 11:09:40,634 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 11:09:40,634 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.4ms
2025-11-18 11:09:40,943 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 11:09:40,943 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:09:40,943 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:09:40,943 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:09:40,943 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:09:40,943 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:09:40,944 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:09:40,944 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:09:40,944 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 11:09:40,957 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 11:09:40,962 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 11:09:40,964 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 11:09:40,964 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 11:09:40,964 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 11:09:40,965 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 11:09:40,966 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2055
2025-11-18 11:09:40,966 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 2055
2025-11-18 11:09:40,966 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 11:09:40,967 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 24.1ms
2025-11-18 11:09:40,972 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-18 11:09:40,973 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.4ms
2025-11-18 11:09:40,975 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 11:09:40,975 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:09:40,975 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:09:40,975 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:09:40,976 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:09:40,976 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:09:40,977 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:09:40,977 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:09:40,977 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 11:09:40,979 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 11:09:40,979 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 11:09:40,981 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 11:09:40,981 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 11:09:40,981 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 6.9ms
2025-11-18 11:10:22,253 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 11:10:22,253 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:10:22,254 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:10:22,254 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:10:22,254 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:10:22,254 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:10:22,254 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:10:22,254 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:10:22,255 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 11:10:22,257 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 11:10:22,258 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 11:10:22,259 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 11:10:22,260 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 11:10:22,260 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 11:10:22,261 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 11:10:22,262 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2056
2025-11-18 11:10:22,262 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 2056
2025-11-18 11:10:22,262 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 11:10:22,263 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 10.0ms
2025-11-18 11:10:22,270 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 11:10:22,270 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:10:22,270 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:10:22,270 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:10:22,270 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:10:22,270 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:10:22,270 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:10:22,271 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:10:22,271 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 11:10:22,272 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 11:10:22,273 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 11:10:22,274 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 11:10:22,274 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 11:10:22,275 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 5.3ms
2025-11-18 11:20:56,115 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 11:20:56,116 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 11:20:56,116 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.0ms
2025-11-18 11:20:56,116 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.7ms
2025-11-18 11:20:56,431 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:20:56,432 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:20:56,432 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:20:56,432 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:20:56,432 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:20:56,433 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:20:56,433 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:20:56,433 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:20:56,433 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:20:56,444 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:20:56,445 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:20:56,445 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:20:56,446 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 14.6ms
2025-11-18 11:20:56,448 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:20:56,448 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:20:56,449 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:20:56,449 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:20:56,449 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:20:56,449 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:20:56,449 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:20:56,450 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:20:56,450 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:20:56,454 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:20:56,454 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:20:56,455 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:20:56,455 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.4ms
2025-11-18 11:20:58,024 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-18 11:20:58,024 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.4ms
2025-11-18 11:20:58,026 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 11:20:58,026 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:20:58,026 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:20:58,027 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:20:58,027 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:20:58,027 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:20:58,027 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:20:58,027 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:20:58,027 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 11:20:58,030 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 11:20:58,030 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 11:20:58,031 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 11:20:58,031 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 5.2ms
2025-11-18 11:21:11,069 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 11:21:11,069 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.6ms
2025-11-18 11:21:11,071 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 11:21:11,071 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:11,071 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:11,071 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:11,072 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:11,072 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:11,072 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:11,072 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:11,072 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 11:21:11,075 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 11:21:11,075 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 11:21:11,075 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 11:21:11,285 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 11:21:11,286 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 11:21:11,286 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 11:21:11,288 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 11:21:11,288 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2057
2025-11-18 11:21:11,288 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 2057
2025-11-18 11:21:11,289 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 11:21:11,289 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 218.1ms
2025-11-18 11:21:11,307 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 11:21:11,308 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 0.9ms
2025-11-18 11:21:11,308 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:21:11,308 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:11,308 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:11,309 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:11,309 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:11,309 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:11,309 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:11,310 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:11,310 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:21:11,316 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:21:11,316 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:21:11,317 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:21:11,318 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.7ms
2025-11-18 11:21:11,319 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 11:21:11,319 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 0.5ms
2025-11-18 11:21:11,320 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 11:21:11,321 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:11,321 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:11,321 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:11,321 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:11,322 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:11,322 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:11,322 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:11,322 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 11:21:11,329 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 11:21:11,329 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 11:21:11,335 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 11:21:11,335 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 11:21:11,336 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 11:21:11,337 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 16.1ms
2025-11-18 11:21:11,337 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 0.7ms
2025-11-18 11:21:11,339 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:21:11,340 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:11,340 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:11,340 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:11,340 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:11,340 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:11,340 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:11,341 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:11,341 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:21:11,341 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 11:21:11,344 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:21:11,344 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:21:11,345 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:21:11,346 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 4.6ms
2025-11-18 11:21:11,346 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.0ms
2025-11-18 11:21:11,349 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 11:21:11,349 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:11,350 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:11,350 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:11,350 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:11,350 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:11,350 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:11,350 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:11,351 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 11:21:11,355 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 11:21:11,356 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 11:21:11,356 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 11:21:11,357 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 8.0ms
2025-11-18 11:21:11,359 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 11:21:11,359 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:11,359 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:11,359 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:11,360 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:11,360 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:11,360 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:11,360 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:11,360 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 11:21:11,366 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 11:21:11,366 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 11:21:11,370 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 11:21:11,370 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 11:21:11,370 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 11.6ms
2025-11-18 11:21:11,372 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 11:21:11,372 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:11,373 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:11,373 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:11,373 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:11,373 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:11,373 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:11,373 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:11,373 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 11:21:11,378 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 11:21:11,379 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 11:21:11,379 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 11:21:11,380 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.7ms
2025-11-18 11:21:15,658 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 11:21:15,658 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.5ms
2025-11-18 11:21:15,661 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:21:15,661 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:15,662 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:15,662 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:15,662 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:15,662 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:15,662 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:15,663 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:15,663 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:21:15,668 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:21:15,668 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgzNzcxLCJpYXQiOjE3NjM0ODI4NzEsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.2g68ZfIU2P0f63dIgrLIlbGijZpYIT361iPSZE_KIUk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3NjcxLCJpYXQiOjE3NjM0ODI4NzEsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.GQWgOren0N0PRkKEcQrhjG7XDCRhKosqp3rw-KBGiQw'}
2025-11-18 11:21:15,669 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 11:21:15,669 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 11:21:15,669 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:21:15,669 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 11:21:15,671 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:21:15,672 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 11.2ms
2025-11-18 11:21:15,674 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:21:15,675 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:15,675 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:15,675 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:15,675 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:15,676 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:15,676 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:15,676 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:15,676 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:21:15,681 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:21:15,681 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgzNzcxLCJpYXQiOjE3NjM0ODI4NzEsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.2g68ZfIU2P0f63dIgrLIlbGijZpYIT361iPSZE_KIUk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3NjcxLCJpYXQiOjE3NjM0ODI4NzEsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.GQWgOren0N0PRkKEcQrhjG7XDCRhKosqp3rw-KBGiQw'}
2025-11-18 11:21:15,681 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 11:21:15,681 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 11:21:15,682 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:21:15,682 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 11:21:15,684 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:21:15,685 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.4ms
2025-11-18 11:21:17,126 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-18 11:21:17,127 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-18 11:21:17,127 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.2ms
2025-11-18 11:21:17,128 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 1.0ms
2025-11-18 11:21:17,129 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:21:17,130 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:17,130 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:17,130 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:17,131 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:17,131 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:17,131 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:17,131 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:17,131 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:21:17,137 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:21:17,137 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:21:17,138 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:21:17,139 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 9.5ms
2025-11-18 11:21:17,141 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:21:17,141 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:17,141 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:17,141 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:17,142 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:17,142 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:17,142 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:17,142 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:17,142 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:21:17,145 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:21:17,145 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:21:17,146 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:21:17,147 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 5.9ms
2025-11-18 11:21:18,310 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 11:21:18,311 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.0ms
2025-11-18 11:21:18,312 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 11:21:18,313 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 1.0ms
2025-11-18 11:21:18,314 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:21:18,314 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:18,314 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:18,314 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:18,315 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:18,315 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:18,315 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:18,315 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:18,315 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:21:18,321 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:21:18,322 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgzNzcxLCJpYXQiOjE3NjM0ODI4NzEsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.2g68ZfIU2P0f63dIgrLIlbGijZpYIT361iPSZE_KIUk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3NjcxLCJpYXQiOjE3NjM0ODI4NzEsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.GQWgOren0N0PRkKEcQrhjG7XDCRhKosqp3rw-KBGiQw'}
2025-11-18 11:21:18,322 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:21:18,322 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:21:18,322 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:21:18,322 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:21:18,324 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:21:18,325 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.9ms
2025-11-18 11:21:18,326 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:21:18,327 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:18,327 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:18,327 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:18,327 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:18,327 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:18,328 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:18,328 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:18,328 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:21:18,332 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:21:18,333 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgzNzcxLCJpYXQiOjE3NjM0ODI4NzEsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.2g68ZfIU2P0f63dIgrLIlbGijZpYIT361iPSZE_KIUk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3NjcxLCJpYXQiOjE3NjM0ODI4NzEsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.GQWgOren0N0PRkKEcQrhjG7XDCRhKosqp3rw-KBGiQw'}
2025-11-18 11:21:18,333 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:21:18,333 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:21:18,333 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:21:18,334 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:21:18,335 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:21:18,336 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2
2025-11-18 11:21:18,336 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.7ms
2025-11-18 11:21:18,337 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2 200 1.3ms
2025-11-18 11:21:18,339 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:21:18,340 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:18,340 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:18,341 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:18,341 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:18,341 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:18,341 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:18,341 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:18,341 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:21:18,345 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:21:18,345 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDgzNzcxLCJpYXQiOjE3NjM0ODI4NzEsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.2g68ZfIU2P0f63dIgrLIlbGijZpYIT361iPSZE_KIUk', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3NjcxLCJpYXQiOjE3NjM0ODI4NzEsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.GQWgOren0N0PRkKEcQrhjG7XDCRhKosqp3rw-KBGiQw'}
2025-11-18 11:21:18,346 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:21:18,346 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:21:18,346 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:21:18,346 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:21:18,347 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:21:18,348 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:21:18,348 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:21:18,349 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:21:18,349 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:21:18,349 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:21:18,349 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:21:18,349 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:21:18,349 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:21:18,349 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:21:18,353 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 11:21:18,354 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 11:21:18,355 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 11:21:18,355 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 16.0ms
2025-11-18 11:21:18,356 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 8.2ms
2025-11-18 11:25:58,385 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/refresh/
2025-11-18 11:25:58,385 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/refresh/ 200 0.5ms
2025-11-18 11:25:58,701 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 11:25:58,701 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:25:58,701 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:25:58,701 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:25:58,701 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:25:58,702 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:25:58,702 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:25:58,702 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:25:58,702 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 11:25:58,712 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 11:25:58,713 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 11:25:58,714 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 11:25:58,715 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 11:25:58,715 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 11:25:58,715 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 11:25:58,716 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2058
2025-11-18 11:25:58,716 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 2058
2025-11-18 11:25:58,716 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 11:25:58,716 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 15.8ms
2025-11-18 11:25:58,722 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/me/
2025-11-18 11:25:58,722 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/me/ 200 0.4ms
2025-11-18 11:25:58,724 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 11:25:58,724 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:25:58,724 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:25:58,724 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:25:58,724 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:25:58,724 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:25:58,724 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:25:58,725 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:25:58,725 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 11:25:58,726 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 11:25:58,726 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 11:25:58,728 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 11:25:58,728 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 11:25:58,729 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 5.2ms
2025-11-18 11:26:01,241 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 11:26:01,242 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.8ms
2025-11-18 11:26:01,242 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 11:26:01,244 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.3ms
2025-11-18 11:26:01,246 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:26:01,246 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:01,246 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:01,246 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:01,247 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:01,247 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:01,247 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:01,247 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:01,247 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:26:01,252 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:26:01,252 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:26:01,254 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:26:01,255 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:26:01,255 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:01,255 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:01,256 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:01,256 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:01,256 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:01,256 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:01,256 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:01,256 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:26:01,260 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:26:01,260 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:26:01,261 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:26:01,262 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 16.1ms
2025-11-18 11:26:01,262 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.6ms
2025-11-18 11:26:04,554 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/logout/
2025-11-18 11:26:04,555 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/logout/ 200 0.6ms
2025-11-18 11:26:04,557 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 11:26:04,557 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:04,557 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:04,558 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:04,558 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:04,558 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:04,558 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:04,558 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:04,558 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 11:26:04,561 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 11:26:04,561 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 11:26:04,561 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 11:26:04,562 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 4.9ms
2025-11-18 11:26:14,484 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/auth/login/
2025-11-18 11:26:14,484 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/auth/login/ 200 0.6ms
2025-11-18 11:26:14,800 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 11:26:14,800 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:14,800 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:14,800 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:14,800 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:14,801 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:14,801 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:14,801 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:14,801 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 11:26:14,803 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 11:26:14,803 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 11:26:14,803 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 11:26:15,012 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 11:26:15,013 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 11:26:15,013 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 11:26:15,014 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 11:26:15,014 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2059
2025-11-18 11:26:15,015 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 2059
2025-11-18 11:26:15,015 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 11:26:15,015 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 215.6ms
2025-11-18 11:26:15,034 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 11:26:15,035 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 0.6ms
2025-11-18 11:26:15,036 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 11:26:15,037 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 0.6ms
2025-11-18 11:26:15,038 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 11:26:15,039 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 0.6ms
2025-11-18 11:26:15,040 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:26:15,041 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:15,041 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:15,041 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:15,041 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:15,041 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:15,042 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:15,042 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:15,042 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:26:15,048 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:26:15,048 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:26:15,049 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:26:15,050 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/menus/getmenu/
2025-11-18 11:26:15,051 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/usuarios/
2025-11-18 11:26:15,052 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/menus/getmenu/ 200 1.8ms
2025-11-18 11:26:15,052 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 12.1ms
2025-11-18 11:26:15,053 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/usuarios/ 200 2.0ms
2025-11-18 11:26:15,054 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 11:26:15,055 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:15,056 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:15,056 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:15,056 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:15,056 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:15,056 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:15,056 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:15,057 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 11:26:15,063 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 11:26:15,063 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 11:26:15,069 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 11:26:15,069 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 11:26:15,071 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/roles/all-active/
2025-11-18 11:26:15,071 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 11:26:15,071 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 17.0ms
2025-11-18 11:26:15,072 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:15,072 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:15,072 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:15,072 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:15,072 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:15,072 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:15,073 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:15,073 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 11:26:15,073 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/roles/all-active/ 200 2.4ms
2025-11-18 11:26:15,079 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 11:26:15,080 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 11:26:15,080 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 11:26:15,081 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 10.2ms
2025-11-18 11:26:15,083 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:26:15,083 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:15,083 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:15,084 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:15,084 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:15,084 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:15,084 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:15,084 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:15,084 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:26:15,089 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:26:15,089 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:26:15,090 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:26:15,091 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 11:26:15,091 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:15,091 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:15,092 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:15,092 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:15,092 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:15,092 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:15,092 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:15,092 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 11:26:15,093 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 10.1ms
2025-11-18 11:26:15,097 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 11:26:15,097 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 11:26:15,102 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 11:26:15,102 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 11:26:15,103 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 12.1ms
2025-11-18 11:26:15,105 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 11:26:15,105 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:15,105 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:15,106 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:15,106 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:15,106 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:15,106 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:15,106 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:15,106 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 11:26:15,111 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 11:26:15,112 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 11:26:15,112 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 11:26:15,112 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.8ms
2025-11-18 11:26:17,683 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 11:26:17,684 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.9ms
2025-11-18 11:26:17,685 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 11:26:17,685 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.9ms
2025-11-18 11:26:17,687 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:17,687 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:17,687 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:17,688 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:17,688 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:17,688 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:17,688 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:17,688 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:17,689 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:17,694 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:17,694 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:17,695 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 11:26:17,695 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 11:26:17,695 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:17,695 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 11:26:17,697 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:17,698 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:17,698 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:17,698 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:17,698 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:17,698 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:17,699 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:17,699 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:17,699 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:17,699 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:17,704 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:17,704 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:17,705 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 11:26:17,705 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 11:26:17,705 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:17,705 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 11:26:17,707 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:17,707 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 20.6ms
2025-11-18 11:26:17,708 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.5ms
2025-11-18 11:26:18,387 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-18 11:26:18,388 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 0.9ms
2025-11-18 11:26:18,388 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-18 11:26:18,389 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 0.9ms
2025-11-18 11:26:18,392 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:26:18,392 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:18,392 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:18,392 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:18,392 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:18,393 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:18,393 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:18,393 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:18,393 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:26:18,394 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:26:18,398 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:26:18,399 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:26:18,400 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:26:18,400 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:18,401 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:18,401 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:18,401 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:18,401 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:18,401 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:18,401 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:18,402 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:26:18,406 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:26:18,407 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:26:18,408 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:26:18,409 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 17.2ms
2025-11-18 11:26:18,409 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 15.5ms
2025-11-18 11:26:19,563 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 11:26:19,563 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.5ms
2025-11-18 11:26:19,564 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 11:26:19,565 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.4ms
2025-11-18 11:26:19,565 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:19,566 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:19,566 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:19,566 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:19,566 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:19,566 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:19,566 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:19,567 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:19,567 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:19,571 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:19,572 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:19,572 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:26:19,572 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:26:19,572 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:19,573 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:26:19,574 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:19,575 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:19,576 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:19,576 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:19,576 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:19,576 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:19,576 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:19,577 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:19,577 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:19,577 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:19,581 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:19,581 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:19,582 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:26:19,582 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:26:19,582 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:19,582 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:26:19,584 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:19,584 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 18.8ms
2025-11-18 11:26:19,585 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.9ms
2025-11-18 11:26:19,593 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 11:26:19,593 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2
2025-11-18 11:26:19,594 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.8ms
2025-11-18 11:26:19,594 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2 200 0.6ms
2025-11-18 11:26:19,596 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:19,597 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:19,597 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:19,597 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:19,597 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:19,597 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:19,597 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:19,597 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:19,598 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:19,598 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:26:19,601 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:19,602 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:19,602 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:26:19,602 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:26:19,602 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:19,602 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:26:19,603 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:19,604 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:19,604 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:19,604 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:19,604 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:19,604 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:19,605 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:19,605 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:19,605 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:26:19,609 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 11:26:19,609 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 11:26:19,610 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 11:26:19,611 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 14.2ms
2025-11-18 11:26:19,611 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 13.0ms
2025-11-18 11:26:45,073 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/clientes/
2025-11-18 11:26:45,074 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/2
2025-11-18 11:26:45,074 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/clientes/ 200 0.8ms
2025-11-18 11:26:45,075 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/2 200 1.0ms
2025-11-18 11:26:45,076 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:45,077 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:45,077 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:45,077 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:45,077 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:45,077 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:45,077 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:45,077 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:45,078 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:45,081 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:45,081 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:45,082 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:26:45,082 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:26:45,082 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:45,082 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:26:45,083 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:45,084 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:26:45,084 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:45,084 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:45,084 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:45,084 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:45,084 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:45,084 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:45,085 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:45,085 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:26:45,088 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 11:26:45,088 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 11:26:45,089 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 11:26:45,089 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 13.1ms
2025-11-18 11:26:45,090 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 6.4ms
2025-11-18 11:26:49,526 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:26:49,526 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:49,526 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:49,527 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:49,527 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:49,527 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:49,527 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:49,527 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:49,528 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:26:49,532 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:26:49,533 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:26:49,534 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:26:49,535 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 9.2ms
2025-11-18 11:26:49,537 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:26:49,538 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:49,538 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:49,538 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:49,538 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:49,538 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:49,538 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:49,539 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:49,539 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:26:49,543 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:26:49,543 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:26:49,544 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:26:49,545 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 7.7ms
2025-11-18 11:26:50,591 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:50,591 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:50,591 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:50,592 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:50,592 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:50,592 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:50,592 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:50,592 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:50,592 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:50,596 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:50,597 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:50,597 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 11:26:50,597 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 11:26:50,597 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:50,597 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 11:26:50,599 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:50,600 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.3ms
2025-11-18 11:26:50,602 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:50,603 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:50,603 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:50,603 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:50,603 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:50,603 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:50,603 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:50,604 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:50,604 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:50,609 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:50,609 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:50,609 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 11:26:50,610 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 11:26:50,610 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:50,610 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 11:26:50,611 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:50,612 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.0ms
2025-11-18 11:26:51,897 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:26:51,897 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:51,898 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:51,898 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:51,898 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:51,898 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:51,898 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:51,898 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:51,899 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:26:51,903 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:26:51,903 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:26:51,905 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:26:51,906 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 8.7ms
2025-11-18 11:26:51,910 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:26:51,910 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:51,911 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:51,911 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:51,911 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:51,911 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:51,911 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:51,911 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:51,912 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:26:51,916 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:26:51,916 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:26:51,917 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:26:51,918 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 8.5ms
2025-11-18 11:26:53,031 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:53,032 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:53,032 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:53,032 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:53,033 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:53,033 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:53,033 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:53,033 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:53,033 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:53,037 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:53,037 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:53,037 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:26:53,038 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:26:53,038 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:53,038 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:26:53,040 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:53,041 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.5ms
2025-11-18 11:26:53,043 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:53,043 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:53,044 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:53,044 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:53,044 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:53,044 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:53,044 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:53,045 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:53,045 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:53,049 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:53,050 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:53,050 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:26:53,050 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:26:53,050 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:53,050 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:26:53,052 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:53,053 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:26:53,054 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 10.8ms
2025-11-18 11:26:53,054 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:53,054 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:53,054 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:53,054 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:53,055 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:53,055 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:53,055 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:53,055 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:26:53,059 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 11:26:53,059 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 11:26:53,060 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 11:26:53,062 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 8.2ms
2025-11-18 11:26:53,063 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:53,063 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:53,064 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:53,064 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:53,064 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:53,064 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:53,064 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:53,064 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:53,064 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:53,068 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:53,068 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:53,068 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:26:53,068 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:26:53,068 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:53,069 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:26:53,070 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:53,071 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.7ms
2025-11-18 11:26:56,428 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/5
2025-11-18 11:26:56,429 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:56,429 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:56,429 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:56,429 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:56,430 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:56,430 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:56,430 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:56,430 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:56,430 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:56,430 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/5 200 2.4ms
2025-11-18 11:26:56,434 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:56,434 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:56,434 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:26:56,434 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:26:56,435 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:56,435 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:26:56,436 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:56,437 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 7.9ms
2025-11-18 11:26:56,438 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/5
2025-11-18 11:26:56,438 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:56,438 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:56,439 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:56,439 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:56,439 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:56,439 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:56,439 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:56,439 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/5
2025-11-18 11:26:56,444 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/5 recibida
2025-11-18 11:26:56,444 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 5
2025-11-18 11:26:56,445 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 5: 1 conexiones
2025-11-18 11:26:56,445 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/5 200 7.6ms
2025-11-18 11:26:59,242 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/3
2025-11-18 11:26:59,243 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:26:59,243 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:59,244 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:59,244 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:59,244 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:59,244 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:59,244 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:59,244 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:59,244 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:26:59,245 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/3 200 2.3ms
2025-11-18 11:26:59,249 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:26:59,249 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:26:59,249 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:26:59,249 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:26:59,249 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:26:59,249 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:26:59,251 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:26:59,252 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.8ms
2025-11-18 11:26:59,253 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/3
2025-11-18 11:26:59,254 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:26:59,254 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:26:59,254 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:26:59,254 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:26:59,254 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:26:59,255 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:26:59,255 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:26:59,255 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/3
2025-11-18 11:26:59,259 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/3 recibida
2025-11-18 11:26:59,259 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 3
2025-11-18 11:26:59,260 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 3: 1 conexiones
2025-11-18 11:26:59,261 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/3 200 8.0ms
2025-11-18 11:27:00,936 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/1
2025-11-18 11:27:00,936 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:27:00,936 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:27:00,937 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:27:00,937 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:27:00,937 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:27:00,937 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:27:00,937 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:27:00,937 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:27:00,938 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:27:00,938 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/1 200 2.3ms
2025-11-18 11:27:00,941 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:27:00,941 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:27:00,941 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:27:00,942 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:27:00,942 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:27:00,942 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:27:00,943 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:27:00,945 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.6ms
2025-11-18 11:27:00,946 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/1
2025-11-18 11:27:00,947 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:27:00,947 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:27:00,947 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:27:00,947 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:27:00,947 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:27:00,947 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:27:00,948 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:27:00,948 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/1
2025-11-18 11:27:00,953 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/1 recibida
2025-11-18 11:27:00,953 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 1
2025-11-18 11:27:00,954 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 1: 0 conexiones
2025-11-18 11:27:00,954 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/1 200 8.2ms
2025-11-18 11:27:05,265 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/clientes/4
2025-11-18 11:27:05,266 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:27:05,266 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:27:05,266 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:27:05,266 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:27:05,267 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:27:05,267 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:27:05,267 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:27:05,267 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:27:05,267 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:27:05,267 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/clientes/4 200 2.7ms
2025-11-18 11:27:05,271 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:27:05,271 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:27:05,271 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:27:05,271 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:27:05,271 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:27:05,271 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:27:05,273 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:27:05,274 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.0ms
2025-11-18 11:27:05,275 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/4
2025-11-18 11:27:05,275 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:27:05,275 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:27:05,276 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:27:05,276 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:27:05,276 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:27:05,276 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:27:05,276 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:27:05,276 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/4
2025-11-18 11:27:05,280 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/4 recibida
2025-11-18 11:27:05,280 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 4
2025-11-18 11:27:05,282 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 4: 2 conexiones
2025-11-18 11:27:05,282 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/4 200 7.8ms
2025-11-18 11:27:07,361 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:27:07,362 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:27:07,362 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:27:07,362 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:27:07,362 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:27:07,363 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:27:07,363 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:27:07,363 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:27:07,363 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:27:07,363 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:27:07,367 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:27:07,367 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:27:07,368 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:27:07,368 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:27:07,368 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:27:07,368 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:27:07,370 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:27:07,370 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:27:07,370 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:27:07,370 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:27:07,371 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:27:07,371 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:27:07,371 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:27:07,371 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:27:07,371 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:27:07,375 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 11:27:07,375 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 11:27:07,376 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 11:27:07,376 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 15.0ms
2025-11-18 11:27:07,377 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 13.3ms
2025-11-18 11:31:20,022 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:31:20,022 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:31:20,022 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:31:20,023 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:31:20,023 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:31:20,023 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:31:20,023 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:31:20,023 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:31:20,023 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:31:20,024 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/5
2025-11-18 11:31:20,035 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:31:20,035 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:31:20,036 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:31:20,036 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:31:20,036 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:31:20,036 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:31:20,038 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:31:20,038 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:31:20,038 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:31:20,038 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:31:20,039 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:31:20,039 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:31:20,039 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:31:20,039 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:31:20,039 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/5
2025-11-18 11:31:20,043 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/5 recibida
2025-11-18 11:31:20,043 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 5
2025-11-18 11:31:20,044 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 5: 1 conexiones
2025-11-18 11:31:20,045 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 23.3ms
2025-11-18 11:31:20,045 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/5 200 21.5ms
2025-11-18 11:31:25,731 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:31:25,731 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:31:25,731 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:31:25,732 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:31:25,732 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:31:25,732 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:31:25,732 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:31:25,732 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:31:25,732 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:31:25,736 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:31:25,736 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:31:25,737 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:31:25,737 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:31:25,737 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:31:25,737 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:31:25,738 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:31:25,739 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.3ms
2025-11-18 11:31:25,740 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/4
2025-11-18 11:31:25,741 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:31:25,741 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:31:25,741 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:31:25,741 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:31:25,741 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:31:25,741 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:31:25,742 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:31:25,742 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/4
2025-11-18 11:31:25,746 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/4 recibida
2025-11-18 11:31:25,746 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 4
2025-11-18 11:31:25,747 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 4: 2 conexiones
2025-11-18 11:31:25,748 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/4 200 7.5ms
2025-11-18 11:31:29,111 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:31:29,112 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:31:29,112 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:31:29,112 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:31:29,112 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:31:29,112 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:31:29,113 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:31:29,113 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:31:29,113 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:31:29,113 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/3
2025-11-18 11:31:29,117 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:31:29,117 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:31:29,118 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:31:29,118 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:31:29,118 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:31:29,118 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:31:29,119 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:31:29,120 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:31:29,120 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:31:29,120 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:31:29,120 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:31:29,120 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:31:29,120 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:31:29,121 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:31:29,121 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/3
2025-11-18 11:31:29,124 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/3 recibida
2025-11-18 11:31:29,124 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 3
2025-11-18 11:31:29,125 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 3: 1 conexiones
2025-11-18 11:31:29,126 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 14.4ms
2025-11-18 11:31:29,126 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/3 200 12.7ms
2025-11-18 11:31:32,793 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:31:32,793 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:31:32,794 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:31:32,794 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:31:32,794 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:31:32,794 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:31:32,794 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:31:32,794 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:31:32,795 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:31:32,795 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:31:32,798 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:31:32,798 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:31:32,798 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:31:32,799 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:31:32,799 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:31:32,799 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:31:32,800 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:31:32,801 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:31:32,801 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:31:32,801 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:31:32,801 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:31:32,801 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:31:32,801 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:31:32,802 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:31:32,802 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:31:32,805 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 11:31:32,805 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 11:31:32,806 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 11:31:32,807 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 14.2ms
2025-11-18 11:31:32,807 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 12.4ms
2025-11-18 11:33:30,113 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:33:30,114 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:33:30,114 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:33:30,114 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:33:30,114 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:33:30,115 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:33:30,115 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:33:30,115 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:33:30,115 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:33:30,126 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 11:33:30,126 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 11:33:30,127 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 11:33:30,127 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 14.0ms
2025-11-18 11:33:53,600 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/conexiones/2/test
2025-11-18 11:33:53,601 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/conexiones/2/test 200 0.6ms
2025-11-18 11:33:53,603 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/conexiones/2/test
2025-11-18 11:33:53,603 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:33:53,603 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:33:53,603 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:33:53,603 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:33:53,604 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:33:53,604 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:33:53,604 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:33:53,604 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/2/test
2025-11-18 11:33:53,604 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/conexiones/2/test 404 1.8ms
2025-11-18 11:34:10,199 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:34:10,199 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:34:10,200 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:34:10,200 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:34:10,200 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:34:10,200 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:34:10,200 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:34:10,200 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:34:10,201 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:34:10,204 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:34:10,204 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:34:10,206 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:34:10,206 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 7.2ms
2025-11-18 11:34:10,208 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:34:10,208 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:34:10,209 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:34:10,209 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:34:10,209 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:34:10,209 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:34:10,209 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:34:10,209 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:34:10,209 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:34:10,213 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:34:10,213 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:34:10,214 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:34:10,214 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 6.6ms
2025-11-18 11:34:21,368 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:34:21,369 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:34:21,369 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:34:21,369 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:34:21,369 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:34:21,369 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:34:21,369 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:34:21,370 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:34:21,370 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:34:21,374 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:34:21,374 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:34:21,375 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 11:34:21,375 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 11:34:21,375 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:34:21,375 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 11:34:21,377 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:34:21,378 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.3ms
2025-11-18 11:34:21,379 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:34:21,380 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:34:21,380 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:34:21,380 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:34:21,380 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:34:21,380 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:34:21,381 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:34:21,381 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:34:21,381 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:34:21,385 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:34:21,386 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0MDc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.Ki8hPhrJfb3yeGYMI05CD2a8NdMaqxh2yVhqI5EeTs8', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg3OTc1LCJpYXQiOjE3NjM0ODMxNzUsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.ZAqyqjIlHsXoFm18AYsiF04uveU6nIuNXLORxcCL60c'}
2025-11-18 11:34:21,386 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 11:34:21,386 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 11:34:21,386 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:34:21,387 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 11:34:21,388 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:34:21,389 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.5ms
2025-11-18 11:34:41,527 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/refresh/
2025-11-18 11:34:41,528 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:34:41,528 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:34:41,528 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:34:41,528 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:34:41,529 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:34:41,529 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:34:41,529 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:34:41,529 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/refresh/
2025-11-18 11:34:41,531 - app.services.refresh_token_service - INFO - [VALIDATE-TOKEN] Token válido para cliente 1, usuario 1 - Cliente: web
2025-11-18 11:34:41,532 - app.core.auth - INFO - [REFRESH] Token validado exitosamente (BD OK) para usuario: superadmin (Cliente: 1, Level: 1, Type: user)
2025-11-18 11:34:41,533 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 11:34:41,533 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 11:34:41,533 - app.api.v1.endpoints.auth - WARNING - [REFRESH] Token antiguo ya estaba revocado o no existía para superadmin
2025-11-18 11:34:41,534 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 11:34:41,535 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2060
2025-11-18 11:34:41,535 - app.api.v1.endpoints.auth - INFO - [REFRESH] Nuevo token almacenado - ID: 2060
2025-11-18 11:34:41,535 - app.api.v1.endpoints.auth - INFO - [REFRESH-WEB] Token refrescado exitosamente para usuario: superadmin
2025-11-18 11:34:41,535 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/refresh/ 200 8.0ms
2025-11-18 11:34:41,540 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/auth/me/
2025-11-18 11:34:41,540 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:34:41,540 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:34:41,540 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:34:41,540 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:34:41,540 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:34:41,541 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:34:41,541 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:34:41,541 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/me/
2025-11-18 11:34:41,542 - app.api.v1.endpoints.auth - INFO - Solicitud /me/ recibida para usuario: superadmin
2025-11-18 11:34:41,542 - app.services.usuario_service - INFO - Obteniendo usuario completo ID 1 para cliente 1
2025-11-18 11:34:41,544 - app.services.usuario_service - INFO - Usuario completo obtenido exitosamente: ID 1 con 1 roles activos
2025-11-18 11:34:41,545 - app.api.v1.endpoints.auth - INFO - Datos completos del usuario superadmin recuperados (tipo: user, roles: 1)
2025-11-18 11:34:41,545 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/auth/me/ 200 5.6ms
2025-11-18 11:34:44,691 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:34:44,691 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:34:44,692 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:34:44,692 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:34:44,692 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:34:44,692 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:34:44,692 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:34:44,692 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:34:44,693 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:34:44,697 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:34:44,698 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:34:44,699 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:34:44,699 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 8.2ms
2025-11-18 11:34:44,702 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:34:44,702 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:34:44,702 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:34:44,703 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:34:44,703 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:34:44,703 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:34:44,703 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:34:44,703 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:34:44,703 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:34:44,707 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:34:44,708 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:34:44,709 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:34:44,709 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 7.7ms
2025-11-18 11:34:54,553 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/logout/
2025-11-18 11:34:54,554 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:34:54,554 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:34:54,554 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:34:54,554 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:34:54,555 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:34:54,555 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:34:54,555 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:34:54,555 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/logout/
2025-11-18 11:34:54,557 - app.db.queries - INFO - Actualización exitosa, filas afectadas: -1
2025-11-18 11:34:54,558 - app.services.refresh_token_service - WARNING - [REVOKE-TOKEN] Token no encontrado o ya estaba revocado para cliente 1, usuario 1
2025-11-18 11:34:54,558 - app.api.v1.endpoints.auth - WARNING - [LOGOUT-WEB] Token no encontrado en BD - Cliente: 1, Usuario: 1 (superadmin)
2025-11-18 11:34:54,558 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/logout/ 200 4.9ms
2025-11-18 11:35:29,959 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 11:35:29,960 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:29,960 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:29,960 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:29,960 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:29,960 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:29,961 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:29,961 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:29,961 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 11:35:29,963 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 11:35:29,963 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 11:35:29,963 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 11:35:30,171 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 11:35:30,171 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 11:35:30,171 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 11:35:30,173 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 11:35:30,173 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2061
2025-11-18 11:35:30,173 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 2061
2025-11-18 11:35:30,174 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 11:35:30,174 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 214.8ms
2025-11-18 11:35:30,196 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:35:30,197 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:30,197 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:30,198 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:30,198 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:30,198 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:30,198 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:30,199 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:30,199 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:35:30,203 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:35:30,204 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:35:30,205 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:35:30,205 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 9.0ms
2025-11-18 11:35:30,208 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 11:35:30,209 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:30,209 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:30,209 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:30,209 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:30,210 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:30,210 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:30,210 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:30,210 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 11:35:30,218 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 11:35:30,218 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 11:35:30,223 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 11:35:30,223 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 11:35:30,224 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 11:35:30,224 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:30,224 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:30,224 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:30,224 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:30,224 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:30,225 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:30,225 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:30,225 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 11:35:30,231 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 11:35:30,232 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 11:35:30,232 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 11:35:30,232 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 24.4ms
2025-11-18 11:35:30,233 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 9.9ms
2025-11-18 11:35:30,235 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/menus/getmenu/
2025-11-18 11:35:30,236 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:30,236 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:30,236 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:30,236 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:30,236 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:30,237 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:30,237 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:30,237 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/menus/getmenu/
2025-11-18 11:35:30,241 - app.api.v1.endpoints.menus - INFO - Solicitud GET /menus/getmenu/ recibida para usuario ID: 1 del cliente 1
2025-11-18 11:35:30,241 - app.services.menu_service - INFO - Obteniendo menú filtrado para usuario_id: 1
2025-11-18 11:35:30,243 - app.services.menu_service - INFO - No se encontraron menús permitidos para el usuario ID: 1.
2025-11-18 11:35:30,243 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/usuarios/
2025-11-18 11:35:30,244 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:30,244 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:30,244 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:30,244 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:30,245 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:30,245 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:30,245 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:30,245 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/usuarios/
2025-11-18 11:35:30,249 - app.api.v1.endpoints.usuarios - INFO - Solicitud GET /usuarios/ recibida por usuario 1 del cliente 1 - Paginación: page=1, limit=10, Búsqueda: 'None'
2025-11-18 11:35:30,250 - app.services.usuario_service - INFO - Obteniendo usuarios paginados para cliente 1: page=1, limit=10, search='None'
2025-11-18 11:35:30,253 - app.services.usuario_service - INFO - Obtención paginada de usuarios completada exitosamente
2025-11-18 11:35:30,254 - app.api.v1.endpoints.usuarios - INFO - Lista paginada de usuarios recuperada para cliente 1 - Total: 1, Página: 1
2025-11-18 11:35:30,255 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/menus/getmenu/ 200 19.7ms
2025-11-18 11:35:30,256 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/usuarios/ 200 12.4ms
2025-11-18 11:35:30,257 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/roles/all-active/
2025-11-18 11:35:30,258 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:30,258 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:30,258 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:30,258 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:30,259 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:30,259 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:30,259 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:30,259 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/roles/all-active/
2025-11-18 11:35:30,264 - app.api.v1.endpoints.roles - INFO - Solicitud GET /roles/all-active/ recibida por usuario 1 del cliente 1 para lista simple
2025-11-18 11:35:30,264 - app.services.rol_service - INFO - Se encontraron 0 roles activos para cliente 1
2025-11-18 11:35:30,265 - app.api.v1.endpoints.roles - INFO - Lista simple de roles activos recuperada para cliente 1 - Total: 0
2025-11-18 11:35:30,265 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/roles/all-active/ 200 7.9ms
2025-11-18 11:35:32,496 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:35:32,496 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:32,497 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:32,497 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:32,497 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:32,497 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:32,497 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:32,497 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:32,498 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:35:32,501 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:35:32,501 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0NjMwLCJpYXQiOjE3NjM0ODM3MzAsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.U-agOIcHbpnVijsBT136IIl79UCeoKuG9fUwsBOeiPE', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg4NTMwLCJpYXQiOjE3NjM0ODM3MzAsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.yKaqDvL4A-EenfVbGBKxe9PxjZnTWgXIBNsmhVGZ9sg'}
2025-11-18 11:35:32,501 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 11:35:32,501 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 11:35:32,502 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:35:32,502 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 11:35:32,504 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:35:32,504 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 8.5ms
2025-11-18 11:35:32,507 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:35:32,507 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:32,507 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:32,508 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:32,508 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:32,508 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:32,508 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:32,508 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:32,509 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:35:32,514 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:35:32,514 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0NjMwLCJpYXQiOjE3NjM0ODM3MzAsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.U-agOIcHbpnVijsBT136IIl79UCeoKuG9fUwsBOeiPE', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg4NTMwLCJpYXQiOjE3NjM0ODM3MzAsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.yKaqDvL4A-EenfVbGBKxe9PxjZnTWgXIBNsmhVGZ9sg'}
2025-11-18 11:35:32,514 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=10, solo_activos=True
2025-11-18 11:35:32,514 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=10
2025-11-18 11:35:32,514 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:35:32,515 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 10, solo_activos: True por usuario: superadmin
2025-11-18 11:35:32,516 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:35:32,516 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.8ms
2025-11-18 11:35:35,215 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:35:35,216 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:35,216 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:35,216 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:35,216 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:35,217 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:35,217 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:35,217 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:35,217 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:35:35,223 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:35:35,223 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:35:35,224 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:35:35,225 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 9.4ms
2025-11-18 11:35:35,227 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:35:35,227 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:35,227 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:35,227 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:35,228 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:35,228 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:35,228 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:35,228 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:35,228 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:35:35,235 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:35:35,235 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:35:35,237 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:35:35,238 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 10.8ms
2025-11-18 11:35:39,114 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:35:39,115 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:39,115 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:39,115 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:39,115 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:39,115 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:39,115 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:39,116 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:39,116 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:35:39,120 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:35:39,120 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0NjMwLCJpYXQiOjE3NjM0ODM3MzAsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.U-agOIcHbpnVijsBT136IIl79UCeoKuG9fUwsBOeiPE', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg4NTMwLCJpYXQiOjE3NjM0ODM3MzAsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.yKaqDvL4A-EenfVbGBKxe9PxjZnTWgXIBNsmhVGZ9sg'}
2025-11-18 11:35:39,121 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:35:39,121 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:35:39,121 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:35:39,121 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:35:39,123 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:35:39,124 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 9.4ms
2025-11-18 11:35:39,126 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:35:39,127 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:39,127 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:39,127 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:39,127 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:39,127 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:39,128 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:39,128 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:39,128 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:35:39,142 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:35:39,143 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0NjMwLCJpYXQiOjE3NjM0ODM3MzAsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.U-agOIcHbpnVijsBT136IIl79UCeoKuG9fUwsBOeiPE', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg4NTMwLCJpYXQiOjE3NjM0ODM3MzAsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.yKaqDvL4A-EenfVbGBKxe9PxjZnTWgXIBNsmhVGZ9sg'}
2025-11-18 11:35:39,143 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:35:39,143 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:35:39,143 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:35:39,143 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:35:39,145 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:35:39,146 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:35:39,146 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 20.3ms
2025-11-18 11:35:39,147 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:39,147 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:39,147 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:39,147 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:39,148 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:39,148 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:39,148 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:39,148 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:35:39,156 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 11:35:39,156 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 11:35:39,157 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 11:35:39,158 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 12.2ms
2025-11-18 11:35:39,160 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/clientes/
2025-11-18 11:35:39,160 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:35:39,160 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:35:39,161 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:35:39,162 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:35:39,162 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:35:39,162 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:35:39,162 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:35:39,162 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/clientes/
2025-11-18 11:35:39,166 - app.api.v1.endpoints.clientes - INFO - SOLICITUD RECIBIDA en /clientes/
2025-11-18 11:35:39,166 - app.api.v1.endpoints.clientes - INFO - Headers recibidos: {'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"Windows"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzYzNDg0NjMwLCJpYXQiOjE3NjM0ODM3MzAsInR5cGUiOiJhY2Nlc3MiLCJhY2Nlc3NfbGV2ZWwiOjEsImlzX3N1cGVyX2FkbWluIjpmYWxzZSwidXNlcl90eXBlIjoidXNlciJ9.U-agOIcHbpnVijsBT136IIl79UCeoKuG9fUwsBOeiPE', 'x-client-type': 'web', 'accept': 'application/json, text/plain, */*', 'sec-ch-ua': '"Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'sec-ch-ua-mobile': '?0', 'origin': 'http://localhost:5173', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:5173/', 'accept-encoding': 'gzip, deflate, br, zstd', 'accept-language': 'es-ES,es;q=0.9,en;q=0.8', 'cookie': 'refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzdXBlcmFkbWluIiwiY2xpZW50ZV9pZCI6MSwiZXNfc3VwZXJhZG1pbiI6dHJ1ZSwiZXhwIjoxNzY0MDg4NTMwLCJpYXQiOjE3NjM0ODM3MzAsInR5cGUiOiJyZWZyZXNoIiwiYWNjZXNzX2xldmVsIjoxLCJpc19zdXBlcl9hZG1pbiI6ZmFsc2UsInVzZXJfdHlwZSI6InVzZXIifQ.yKaqDvL4A-EenfVbGBKxe9PxjZnTWgXIBNsmhVGZ9sg'}
2025-11-18 11:35:39,166 - app.api.v1.endpoints.clientes - INFO - Query params: skip=0, limit=100, solo_activos=True
2025-11-18 11:35:39,167 - app.api.v1.endpoints.clientes - INFO - URL completa: http://localhost:8000/api/v1/clientes/?skip=0&limit=100
2025-11-18 11:35:39,167 - app.api.v1.endpoints.clientes - INFO - Usuario: superadmin
2025-11-18 11:35:39,167 - app.api.v1.endpoints.clientes - INFO - Solicitud GET /clientes/ recibida - skip: 0, limit: 100, solo_activos: True por usuario: superadmin
2025-11-18 11:35:39,175 - app.api.v1.endpoints.clientes - INFO - Lista de clientes recuperada: 5 clientes
2025-11-18 11:35:39,176 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/clientes/ 200 16.7ms
2025-11-18 11:38:41,968 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:38:41,968 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:38:41,968 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 11:38:41,969 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 11:38:41,969 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:38:41,969 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:38:41,969 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:38:41,969 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:38:41,969 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:38:41,970 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 401 2.4ms
2025-11-18 11:38:53,196 - app.main - INFO - [SYSTEM] 127.0.0.1 -> POST /api/v1/auth/login/
2025-11-18 11:38:53,196 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:38:53,196 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 11:38:53,197 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 11:38:53,197 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:38:53,197 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:38:53,197 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:38:53,197 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:38:53,197 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/auth/login/
2025-11-18 11:38:53,208 - app.api.v1.endpoints.auth - INFO - Cliente 1 resuelto y validado para login.
2025-11-18 11:38:53,208 - app.core.auth - INFO - [AUTH] Intento de login: username='superadmin', cliente_id_destino=1
2025-11-18 11:38:53,208 - app.core.auth - INFO - [AUTH] SUPERADMIN detectado. Buscando en BD ADMIN (cliente_id=1), accediendo a cliente_id=1
2025-11-18 11:38:53,420 - app.core.auth - INFO - Niveles calculados - Usuario 1: level=5, super_admin=True, type=super_admin
2025-11-18 11:38:53,421 - app.core.auth - INFO - [AUTH] Login exitoso: username='superadmin', usuario_id=1, cliente_origen=1, cliente_destino=1, access_level=5, user_type=super_admin
2025-11-18 11:38:53,421 - app.api.v1.endpoints.auth - INFO - [LOGIN] Superadmin accediendo a cliente_id=1
2025-11-18 11:38:53,422 - app.db.queries - INFO - Inserción exitosa, filas afectadas: -1
2025-11-18 11:38:53,422 - app.services.refresh_token_service - INFO - [STORE-TOKEN] Cliente 1, Usuario 1 - Cliente: web - Token ID: 2062
2025-11-18 11:38:53,423 - app.api.v1.endpoints.auth - INFO - [LOGIN-WEB] Token almacenado en BD - ID: 2062
2025-11-18 11:38:53,423 - app.api.v1.endpoints.auth - INFO - Usuario superadmin autenticado exitosamente (WEB) para cliente 1
2025-11-18 11:38:53,423 - app.main - INFO - [SYSTEM] 127.0.0.1 <- POST /api/v1/auth/login/ 200 227.6ms
2025-11-18 11:38:58,733 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/conexiones/clientes/2
2025-11-18 11:38:58,734 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:38:58,734 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: 127.0.0.1:8000
2025-11-18 11:38:58,734 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: '127.0.0.1'
2025-11-18 11:38:58,734 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:38:58,734 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: '127.0.0.1'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:38:58,734 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: 127.0.0.1:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:38:58,735 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:38:58,735 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/conexiones/clientes/2
2025-11-18 11:38:58,738 - app.api.v1.endpoints.conexiones - INFO - Solicitud GET /conexiones/clientes/2 recibida
2025-11-18 11:38:58,738 - app.services.conexion_service - INFO - Obteniendo conexiones para cliente ID: 2
2025-11-18 11:38:58,743 - app.api.v1.endpoints.conexiones - INFO - Conexiones recuperadas para cliente 2: 2 conexiones
2025-11-18 11:38:58,744 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/conexiones/clientes/2 200 11.3ms
2025-11-18 11:47:04,999 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-18 11:47:04,999 - app.main - INFO - [SYSTEM] 127.0.0.1 -> OPTIONS /api/v1/modulos/
2025-11-18 11:47:05,000 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 0.8ms
2025-11-18 11:47:05,000 - app.main - INFO - [SYSTEM] 127.0.0.1 <- OPTIONS /api/v1/modulos/ 200 0.7ms
2025-11-18 11:47:05,317 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:47:05,318 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
2025-11-18 11:47:05,318 - app.middleware.tenant_middleware - WARNING - [HOST_DETECTION] No se pudo extraer host real de origin/referer, usando: localhost:8000
2025-11-18 11:47:05,318 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] Procesando host: 'localhost'
2025-11-18 11:47:05,318 - app.middleware.tenant_middleware - INFO - [SUBDOMAIN] BASE_DOMAIN: 'midominio.com'
2025-11-18 11:47:05,318 - app.middleware.tenant_middleware - WARNING - [SUBDOMAIN] No se detectó subdominio válido en: 'localhost'. Verifica BASE_DOMAIN='midominio.com'
2025-11-18 11:47:05,318 - app.middleware.tenant_middleware - WARNING - [TENANT] Sin subdominio en Host: localhost:8000. Usando Cliente ID por defecto: 1 (SYSTEM)
2025-11-18 11:47:05,319 - app.middleware.tenant_middleware - INFO - [TENANT] Metadata cargada: db_type=single, bd=bd_hybrid_sistema_central, servidor=N/A
2025-11-18 11:47:05,319 - app.middleware.tenant_middleware - INFO - [TENANT] CONTEXTO ESTABLECIDO: cliente_id=1, db_type=single, bd=bd_hybrid_sistema_central, path=/api/v1/modulos/
2025-11-18 11:47:05,331 - app.api.v1.endpoints.modulos - INFO - Solicitud GET /modulos/ recibida - skip: 0, limit: 20, solo_activos: True
2025-11-18 11:47:05,331 - app.services.modulo_service - INFO - Obteniendo catálogo de módulos - skip: 0, limit: 20
2025-11-18 11:47:05,332 - app.api.v1.endpoints.modulos - INFO - Catálogo de módulos recuperado: 4 módulos
2025-11-18 11:47:05,333 - app.main - INFO - [SYSTEM] 127.0.0.1 <- GET /api/v1/modulos/ 200 15.7ms
2025-11-18 11:47:05,335 - app.main - INFO - [SYSTEM] 127.0.0.1 -> GET /api/v1/modulos/
2025-11-18 11:47:05,335 - app.middleware.tenant_middleware - INFO - [HOST_DETECTION] Host es localhost, buscando host real en origin/referer
