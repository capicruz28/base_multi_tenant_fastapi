================================================================================
AUDITOR√çA DE QUERIES TEXTCLAUSE/STRING
================================================================================

Total de issues encontrados: 591
  - Alta severidad: 448
  - Media severidad: 143

================================================================================
üî¥ ALTA SEVERIDAD - Requiere correcci√≥n inmediata
================================================================================

Archivo: app\main.py
L√≠nea: 179
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                        "Access-Control-Allow-Origin": origin,
                        "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS, PATCH",
                        # ‚úÖ CORRECCI√ìN CR√çTICA: Agregar X-Client-Type expl√≠citamente
                        "Access-Control-Allow-Headers"
--------------------------------------------------------------------------------

Archivo: app\api\deps.py
L√≠nea: 8
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
- L√≥gica pesada movida a servicios dedicados
- get_user_auth_context() para contexto m√≠nimo
- build_user_with_roles() para objetos completos cuando se necesiten
"""
from fastapi import Depends, HTTPException, status, Request
from fastapi.security import OAuth2PasswordBearer
from jose import JWTError
--------------------------------------------------------------------------------

Archivo: app\api\deps.py
L√≠nea: 8
Tabla: usuario
Tipo: text()
Issue: Query con text() toca tabla usuario sin cliente_id visible
Contexto:
- L√≥gica pesada movida a servicios dedicados
- get_user_auth_context() para contexto m√≠nimo
- build_user_with_roles() para objetos completos cuando se necesiten
"""
from fastapi import Depends, HTTPException, status, Request
from fastapi.security import OAuth2PasswordBearer
from jose import JWTError
--------------------------------------------------------------------------------

Archivo: app\api\deps_backup.py
L√≠nea: 131
Tabla: usuario
Tipo: text()
Issue: Query con text() toca tabla usuario sin cliente_id visible
Contexto:
        
        # ‚úÖ FASE 4B: Usar par√°metros nombrados con text().bindparams()
        result = await execute_query(
            text(IS_USER_SUPER_ADMIN).bindparams(
                usuario_id=usuario_id
            )
        )
        
        if result and len(result) > 0:
            is_super_a
--------------------------------------------------------------------------------

Archivo: app\api\deps_backup.py
L√≠nea: 133
Tabla: usuario
Tipo: text()
Issue: Query con text() toca tabla usuario sin cliente_id visible
Contexto:
        result = await execute_query(
            text(IS_USER_SUPER_ADMIN).bindparams(
                usuario_id=usuario_id
            )
        )
        
        if result and len(result) > 0:
            is_super_admin = result[0].get('is_super_admin', 0) > 0
            logger.debug(f"Usuario
--------------------------------------------------------------------------------

Archivo: app\core\auth\user_builder.py
L√≠nea: 84
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            # Fallback: buscar sin filtro de cliente (para casos edge)
            user_query = select(UsuarioTable).where(
                and_(
                    UsuarioTable.c.nombre_usuario == username,
                    UsuarioTable.c.es_eliminado == False
                )
            )
  
--------------------------------------------------------------------------------

Archivo: app\core\auth\user_context.py
L√≠nea: 16
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.infrastructure.database.tables import UsuarioTable, UsuarioRolTable, RolTable
from sqlalchemy import select, func, and_, or_

logger = logging.getLogger(__name__)


@dataclass
class CurrentUserContext:
    """
    Contexto m√≠nimo del usuario autenticado.
    
    Contiene solo la informaci√≥
--------------------------------------------------------------------------------

Archivo: app\core\auth\user_context.py
L√≠nea: 16
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.infrastructure.database.tables import UsuarioTable, UsuarioRolTable, RolTable
from sqlalchemy import select, func, and_, or_

logger = logging.getLogger(__name__)


@dataclass
class CurrentUserContext:
    """
    Contexto m√≠nimo del usuario autenticado.
    
    Contiene solo la informaci√≥
--------------------------------------------------------------------------------

Archivo: app\core\auth\user_context.py
L√≠nea: 104
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            # Fallback: buscar sin filtro de cliente (para casos edge)
            user_query = select(UsuarioTable).where(
                and_(
                    UsuarioTable.c.nombre_usuario == username,
                    UsuarioTable.c.es_eliminado == False
                )
            )
  
--------------------------------------------------------------------------------

Archivo: app\core\auth\user_context.py
L√≠nea: 186
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
            
            roles_query = select(
                RolTable.c.rol_id,
                RolTable.c.nombre,
                RolTable.c.nivel_acceso,
                RolTable.c.codigo_rol
            ).select_from(
                UsuarioRolTable.join(RolTable, UsuarioRolTable.c.rol_id == Ro
--------------------------------------------------------------------------------

Archivo: app\core\auth\user_context.py
L√≠nea: 186
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            
            roles_query = select(
                RolTable.c.rol_id,
                RolTable.c.nombre,
                RolTable.c.nivel_acceso,
                RolTable.c.codigo_rol
            ).select_from(
                UsuarioRolTable.join(RolTable, UsuarioRolTable.c.rol_id == Ro
--------------------------------------------------------------------------------

Archivo: app\core\tenant\routing.py
L√≠nea: 87
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    from app.infrastructure.database.tables import ClienteConexionTable, ClienteTable
    from sqlalchemy import select, text
    
    # Query para obtener metadata de conexi√≥n usando SQLAlchemy Core
    query = select(
        ClienteConexionTable.c.conexion_id,
        ClienteConexionTable.c.servi
--------------------------------------------------------------------------------

Archivo: app\core\tenant\routing.py
L√≠nea: 90
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    # Query para obtener metadata de conexi√≥n usando SQLAlchemy Core
    query = select(
        ClienteConexionTable.c.conexion_id,
        ClienteConexionTable.c.servidor,
        ClienteConexionTable.c.puerto,
        ClienteConexionTable.c.nombre_bd,
        ClienteConexionTable.c.usuario_encrip
--------------------------------------------------------------------------------

Archivo: app\core\tenant\routing.py
L√≠nea: 343
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                    from app.infrastructure.database.tables import ClienteConexionTable
                    query_conexion = select(
                        ClienteConexionTable.c.conexion_id,
                        ClienteConexionTable.c.servidor,
                        ClienteConexionTable.c.pue
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\connection_async.py
L√≠nea: 12
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    async with get_db_connection() as session:
        result = await session.execute(select(UsuarioTable))
        rows = result.fetchall()
"""

import logging
from typing import AsyncIterator, Optional, Union
from contextlib import asynccontextmanager
from enum import Enum
from uuid import UUID

f
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\connection_async.py
L√≠nea: 270
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        async with get_db_connection() as session:
            result = await session.execute(select(UsuarioTable))
            rows = result.fetchall()
    """
    if not ASYNC_AVAILABLE or not AIOODBC_AVAILABLE:
        raise ImportError(
            "Dependencias async no disponibles. "
         
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 285
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
IS_USER_SUPER_ADMIN = """
SELECT COUNT(*) as is_super_admin
FROM usuario_rol ur
INNER JOIN rol r ON ur.rol_id = r.rol_id
WHERE ur.usuario_id = ? 
  AND ur.es_activo = 1
  AND r.es_activo = 1
  AND r.codigo_rol = 'SUPER_ADMIN'
  AND r.nivel_acceso = 5
"""

# Query para obtener el nivel m√≠nimo requeri
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 285
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
IS_USER_SUPER_ADMIN = """
SELECT COUNT(*) as is_super_admin
FROM usuario_rol ur
INNER JOIN rol r ON ur.rol_id = r.rol_id
WHERE ur.usuario_id = ? 
  AND ur.es_activo = 1
  AND r.es_activo = 1
  AND r.codigo_rol = 'SUPER_ADMIN'
  AND r.nivel_acceso = 5
"""

# Query para obtener el nivel m√≠nimo requeri
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 285
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
IS_USER_SUPER_ADMIN = """
SELECT COUNT(*) as is_super_admin
FROM usuario_rol ur
INNER JOIN rol r ON ur.rol_id = r.rol_id
WHERE ur.usuario_id = ? 
  AND ur.es_activo = 1
  AND r.es_activo = 1
  AND r.codigo_rol = 'SUPER_ADMIN'
  AND r.nivel_acceso = 5
"""

# Query para obtener el nivel m√≠nimo requeri
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 297
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
GET_MIN_REQUIRED_ACCESS_LEVEL = """
SELECT MIN(nivel_acceso) as min_required_level
FROM rol 
WHERE nombre IN ({}) 
  AND es_activo = 1
"""

# NUEVA QUERY: Obtener informaci√≥n completa de niveles (M√ÅS ROBUSTA)
GET_USER_ACCESS_LEVEL_INFO_COMPLETE = """
SELECT 
    ISNULL(MAX(r.nivel_acceso), 1) as max
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 319
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
GET_USER_ROLES_WITH_LEVELS = """
SELECT 
    r.rol_id,
    r.nombre,
    r.descripcion,
    r.nivel_acceso,
    r.codigo_rol,
    r.es_activo
FROM usuario_rol ur
INNER JOIN rol r ON ur.rol_id = r.rol_id
WHERE ur.usuario_id = ? 
  AND ur.es_activo = 1
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 319
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
GET_USER_ROLES_WITH_LEVELS = """
SELECT 
    r.rol_id,
    r.nombre,
    r.descripcion,
    r.nivel_acceso,
    r.codigo_rol,
    r.es_activo
FROM usuario_rol ur
INNER JOIN rol r ON ur.rol_id = r.rol_id
WHERE ur.usuario_id = ? 
  AND ur.es_activo = 1
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 319
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
GET_USER_ROLES_WITH_LEVELS = """
SELECT 
    r.rol_id,
    r.nombre,
    r.descripcion,
    r.nivel_acceso,
    r.codigo_rol,
    r.es_activo
FROM usuario_rol ur
INNER JOIN rol r ON ur.rol_id = r.rol_id
WHERE ur.usuario_id = ? 
  AND ur.es_activo = 1
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 577
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
WITH UserRoles AS (
    SELECT
        u.usuario_id,
        u.nombre_usuario,
        u.correo,
        u.contrasena, 
        u.nombre,
        u.apellido,
        u.es_activo,
        u.correo_confirmado,
        u.fecha_creacion,
        u.fecha_ultimo_acceso,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 577
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
WITH UserRoles AS (
    SELECT
        u.usuario_id,
        u.nombre_usuario,
        u.correo,
        u.contrasena, 
        u.nombre,
        u.apellido,
        u.es_activo,
        u.correo_confirmado,
        u.fecha_creacion,
        u.fecha_ultimo_acceso,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 1101
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
)
OUTPUT INSERTED.log_id, INSERTED.fecha_evento
VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
"""

INSERT_LOG_SINCRONIZACION_USUARIO = """
INSERT INTO log_sincronizacion_usuario (
    cliente_origen_id,
    cliente_destino_id,
    usuario_id,
    tipo_sincronizacion,
    direccion,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 1101
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
)
OUTPUT INSERTED.log_id, INSERTED.fecha_evento
VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
"""

INSERT_LOG_SINCRONIZACION_USUARIO = """
INSERT INTO log_sincronizacion_usuario (
    cliente_origen_id,
    cliente_destino_id,
    usuario_id,
    tipo_sincronizacion,
    direccion,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 1105
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:

INSERT_LOG_SINCRONIZACION_USUARIO = """
INSERT INTO log_sincronizacion_usuario (
    cliente_origen_id,
    cliente_destino_id,
    usuario_id,
    tipo_sincronizacion,
    direccion,
    operacion,
    estado,
    mensaje_error,
    campos_sincronizados,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 1105
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

INSERT_LOG_SINCRONIZACION_USUARIO = """
INSERT INTO log_sincronizacion_usuario (
    cliente_origen_id,
    cliente_destino_id,
    usuario_id,
    tipo_sincronizacion,
    direccion,
    operacion,
    estado,
    mensaje_error,
    campos_sincronizados,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 1106
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
INSERT_LOG_SINCRONIZACION_USUARIO = """
INSERT INTO log_sincronizacion_usuario (
    cliente_origen_id,
    cliente_destino_id,
    usuario_id,
    tipo_sincronizacion,
    direccion,
    operacion,
    estado,
    mensaje_error,
    campos_sincronizados,
    cambios_detectados,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 1106
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
INSERT_LOG_SINCRONIZACION_USUARIO = """
INSERT INTO log_sincronizacion_usuario (
    cliente_origen_id,
    cliente_destino_id,
    usuario_id,
    tipo_sincronizacion,
    direccion,
    operacion,
    estado,
    mensaje_error,
    campos_sincronizados,
    cambios_detectados,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 1256
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

SELECT_CLIENT_CONNECTION_METADATA = """
SELECT 
    cc.conexion_id,
    cc.servidor,
    cc.puerto,
    cc.nombre_bd,
    cc.usuario_encriptado,
    cc.password_encriptado,
    cc.tipo_bd,
    cc.usa_ssl,
    c.tipo_instalacion,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries.py
L√≠nea: 1257
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
SELECT_CLIENT_CONNECTION_METADATA = """
SELECT 
    cc.conexion_id,
    cc.servidor,
    cc.puerto,
    cc.nombre_bd,
    cc.usuario_encriptado,
    cc.password_encriptado,
    cc.tipo_bd,
    cc.usa_ssl,
    c.tipo_instalacion,
    c.metadata_json
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 8
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
- Usa SQLAlchemy AsyncSession
- Acepta objetos SQLAlchemy Core (Select, Update, Delete, Insert)
- Aplica filtro de tenant autom√°ticamente

USO:
    from app.infrastructure.database.queries_async import execute_query
    
    query = select(UsuarioTable).where(UsuarioTable.c.nombre_usuario == usernam
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 14
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    
    query = select(UsuarioTable).where(UsuarioTable.c.nombre_usuario == username)
    results = await execute_query(query)
"""

from typing import List, Dict, Any, Optional, Union, Tuple
from uuid import UUID
from sqlalchemy import Select, Update, Delete, Insert, text, TextClause
from sqlalchem
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 190
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                # Si es SELECT, obtener resultados
                if isinstance(query, Select):
                    rows = result.fetchall()
                    columns = result.keys()
                    return [dict(zip(columns, row)) for row in rows]
                else:
                    # U
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 218
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
                await session.rollback()
                logger.error(f"Error en execute_query async (TextClause): {str(e)}")
                raise DatabaseError(
                    detail=f"Error en la consulta: {str(e)}",
                    internal_code="DB_QUERY_ERROR"
                )
    
 
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 327
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
    Args:
        query: Consulta SQL (string), objeto SQLAlchemy Core (Select), o TextClause
        params: Par√°metros opcionales (tupla o dict). Si es tupla y query tiene '?', se convierte a par√°metros nombrados.
        connection_type: Tipo de conexi√≥n (DEFAULT o ADMIN)
    
    Returns:
      
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 336
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
        # ‚úÖ FASE 5: Usar routing centralizado
        async with _get_connection_context(connection_type) as session:
            try:
                result = await session.execute(query)
                row = result.fetchone()
                
                if row:
                    columns = 
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 353
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
    
    elif isinstance(query, TextClause):
        # ‚úÖ Aceptar TextClause (resultado de text().bindparams())
        async with _get_connection_context(connection_type) as session:
            try:
                result = await session.execute(query)
                row = result.fetchone()
      
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 354
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
    elif isinstance(query, TextClause):
        # ‚úÖ Aceptar TextClause (resultado de text().bindparams())
        async with _get_connection_context(connection_type) as session:
            try:
                result = await session.execute(query)
                row = result.fetchone()
           
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 355
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
        # ‚úÖ Aceptar TextClause (resultado de text().bindparams())
        async with _get_connection_context(connection_type) as session:
            try:
                result = await session.execute(query)
                row = result.fetchone()
                
                if row:
          
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 366
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
                await session.rollback()
                logger.error(f"Error en execute_auth_query async (TextClause): {str(e)}")
                raise DatabaseError(
                    detail=f"Error en la autenticaci√≥n: {str(e)}",
                    internal_code="DB_AUTH_ERROR"
               
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 400
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
                            query_text = query_text.replace("?", f":{key}", 1)
                        query = text(query_text).bindparams(**params)
                else:
                    logger.warning(f"execute_auth_query recibi√≥ params de tipo inesperado: {type(params)}, ejecutando query sin p
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 403
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
                    logger.warning(f"execute_auth_query recibi√≥ params de tipo inesperado: {type(params)}, ejecutando query sin par√°metros")
                    query = text(query)
            else:
                query = text(query)
        else:
            query = text(query)
        
        as
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 405
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
            else:
                query = text(query)
        else:
            query = text(query)
        
        async with _get_connection_context(connection_type) as session:
            try:
                result = await session.execute(query)
                row = result.fetchone()
        
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 407
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
        else:
            query = text(query)
        
        async with _get_connection_context(connection_type) as session:
            try:
                result = await session.execute(query)
                row = result.fetchone()
                
                if row:
                    c
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 409
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
        
        async with _get_connection_context(connection_type) as session:
            try:
                result = await session.execute(query)
                row = result.fetchone()
                
                if row:
                    columns = result.keys()
                    ret
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 495
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
                await session.rollback()
                logger.error(f"Error en execute_insert async (TextClause): {str(e)}")
                raise DatabaseError(
                    detail=f"Error en la inserci√≥n: {str(e)}",
                    internal_code="DB_INSERT_ERROR"
                )
   
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 495
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                await session.rollback()
                logger.error(f"Error en execute_insert async (TextClause): {str(e)}")
                raise DatabaseError(
                    detail=f"Error en la inserci√≥n: {str(e)}",
                    internal_code="DB_INSERT_ERROR"
                )
   
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 545
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                await session.rollback()
                logger.error(f"Error en execute_insert async (string): {str(e)}")
                raise DatabaseError(
                    detail=f"Error en la inserci√≥n: {str(e)}",
                    internal_code="DB_INSERT_ERROR"
                )
    els
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 619
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
                await session.rollback()
                logger.error(f"Error en execute_update async (TextClause): {str(e)}")
                raise DatabaseError(
                    detail=f"Error en la actualizaci√≥n: {str(e)}",
                    internal_code="DB_UPDATE_ERROR"
                )
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 619
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                await session.rollback()
                logger.error(f"Error en execute_update async (TextClause): {str(e)}")
                raise DatabaseError(
                    detail=f"Error en la actualizaci√≥n: {str(e)}",
                    internal_code="DB_UPDATE_ERROR"
                )
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries_async.py
L√≠nea: 669
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                await session.rollback()
                logger.error(f"Error en execute_update async (string): {str(e)}")
                raise DatabaseError(
                    detail=f"Error en la actualizaci√≥n: {str(e)}",
                    internal_code="DB_UPDATE_ERROR"
                )
   
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\query_builder.py
L√≠nea: 16
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    where_clause, params = SafeQueryBuilder.build_where_clause(filters)
    query = f"SELECT * FROM usuarios WHERE {where_clause}"
    results = execute_query(query, params)
"""

import re
import logging
from typing import Dict, Any, List, Tuple, Optional

logger = logging.getLogger(__name__)


--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\query_optimizer.py
L√≠nea: 256
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    from app.infrastructure.database.queries_async import execute_query
    from sqlalchemy import select
    
    if not usuario_ids:
        return {}
    
    # Query √∫nica con JOIN para todos los usuarios
    query = (
        select(
            UsuarioRolTable.c.usuario_id,
            RolTabl
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\query_optimizer.py
L√≠nea: 256
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    from app.infrastructure.database.queries_async import execute_query
    from sqlalchemy import select
    
    if not usuario_ids:
        return {}
    
    # Query √∫nica con JOIN para todos los usuarios
    query = (
        select(
            UsuarioRolTable.c.usuario_id,
            RolTabl
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\query_optimizer.py
L√≠nea: 263
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    query = (
        select(
            UsuarioRolTable.c.usuario_id,
            RolTable.c.rol_id,
            RolTable.c.nombre,
            RolTable.c.descripcion,
            RolTable.c.nivel_acceso,
            RolTable.c.codigo_rol,
            RolTable.c.es_activo
        )
        .select
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\query_optimizer.py
L√≠nea: 263
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    query = (
        select(
            UsuarioRolTable.c.usuario_id,
            RolTable.c.rol_id,
            RolTable.c.nombre,
            RolTable.c.descripcion,
            RolTable.c.nivel_acceso,
            RolTable.c.codigo_rol,
            RolTable.c.es_activo
        )
        .select
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 8
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
- GET_USER_ACCESS_LEVEL_INFO_COMPLETE ‚Üí queries.auth.auth_queries
- SELECT_USUARIOS_PAGINATED ‚Üí queries.users.user_queries
- SELECT_ROLES_PAGINATED ‚Üí queries.rbac.rbac_queries
- GET_AREAS_PAGINATED_QUERY ‚Üí queries.menus.menu_queries
- INSERT_AUTH_AUDIT_LOG ‚Üí queries.audit.audit_queries
- ... (ver do
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 8
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
- GET_USER_ACCESS_LEVEL_INFO_COMPLETE ‚Üí queries.auth.auth_queries
- SELECT_USUARIOS_PAGINATED ‚Üí queries.users.user_queries
- SELECT_ROLES_PAGINATED ‚Üí queries.rbac.rbac_queries
- GET_AREAS_PAGINATED_QUERY ‚Üí queries.menus.menu_queries
- INSERT_AUTH_AUDIT_LOG ‚Üí queries.audit.audit_queries
- ... (ver do
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 8
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
- GET_USER_ACCESS_LEVEL_INFO_COMPLETE ‚Üí queries.auth.auth_queries
- SELECT_USUARIOS_PAGINATED ‚Üí queries.users.user_queries
- SELECT_ROLES_PAGINATED ‚Üí queries.rbac.rbac_queries
- GET_AREAS_PAGINATED_QUERY ‚Üí queries.menus.menu_queries
- INSERT_AUTH_AUDIT_LOG ‚Üí queries.audit.audit_queries
- ... (ver do
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 9
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
- SELECT_USUARIOS_PAGINATED ‚Üí queries.users.user_queries
- SELECT_ROLES_PAGINATED ‚Üí queries.rbac.rbac_queries
- GET_AREAS_PAGINATED_QUERY ‚Üí queries.menus.menu_queries
- INSERT_AUTH_AUDIT_LOG ‚Üí queries.audit.audit_queries
- ... (ver docs/MIGRACION_QUERIES.md para mapeo completo)

Este archivo ser√° el
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 9
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
- SELECT_USUARIOS_PAGINATED ‚Üí queries.users.user_queries
- SELECT_ROLES_PAGINATED ‚Üí queries.rbac.rbac_queries
- GET_AREAS_PAGINATED_QUERY ‚Üí queries.menus.menu_queries
- INSERT_AUTH_AUDIT_LOG ‚Üí queries.audit.audit_queries
- ... (ver docs/MIGRACION_QUERIES.md para mapeo completo)

Este archivo ser√° el
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 9
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
- SELECT_USUARIOS_PAGINATED ‚Üí queries.users.user_queries
- SELECT_ROLES_PAGINATED ‚Üí queries.rbac.rbac_queries
- GET_AREAS_PAGINATED_QUERY ‚Üí queries.menus.menu_queries
- INSERT_AUTH_AUDIT_LOG ‚Üí queries.audit.audit_queries
- ... (ver docs/MIGRACION_QUERIES.md para mapeo completo)

Este archivo ser√° el
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 11
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
- GET_AREAS_PAGINATED_QUERY ‚Üí queries.menus.menu_queries
- INSERT_AUTH_AUDIT_LOG ‚Üí queries.audit.audit_queries
- ... (ver docs/MIGRACION_QUERIES.md para mapeo completo)

Este archivo ser√° eliminado en FASE 3 despu√©s de migraci√≥n completa.

Constantes SQL para queries comunes.

FASE 4B: Modulo centra
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 56
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.infrastructure.database.queries.users import (
    SELECT_USUARIOS_PAGINATED,
    COUNT_USUARIOS_PAGINATED,
    SELECT_USUARIOS_PAGINATED_MULTI_DB,
    COUNT_USUARIOS_PAGINATED_MULTI_DB,
    GET_USER_COMPLETE_OPTIMIZED_JSON,
    GET_USER_COMPLETE_OPTIMIZED_XML,
)

# ========================
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 58
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    COUNT_USUARIOS_PAGINATED,
    SELECT_USUARIOS_PAGINATED_MULTI_DB,
    COUNT_USUARIOS_PAGINATED_MULTI_DB,
    GET_USER_COMPLETE_OPTIMIZED_JSON,
    GET_USER_COMPLETE_OPTIMIZED_XML,
)

# ============================================
# ‚úÖ FASE 2: RE-EXPORTS DESDE queries.rbac (COMPATIBILIDAD)
# =====
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 69
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.infrastructure.database.queries.rbac import (
    SELECT_ROLES_PAGINATED,
    COUNT_ROLES_PAGINATED,
    SELECT_PERMISOS_POR_ROL,
    DEACTIVATE_ROL,
    REACTIVATE_ROL,
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

# ============================================
# ‚úÖ FASE 2: RE-EXP
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 71
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    COUNT_ROLES_PAGINATED,
    SELECT_PERMISOS_POR_ROL,
    DEACTIVATE_ROL,
    REACTIVATE_ROL,
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

# ============================================
# ‚úÖ FASE 2: RE-EXPORTS DESDE queries.auth (REFRESH TOKENS)
# ========================================
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 74
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    REACTIVATE_ROL,
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

# ============================================
# ‚úÖ FASE 2: RE-EXPORTS DESDE queries.auth (REFRESH TOKENS)
# ============================================

from app.infrastructure.database.queries.auth import (
    INSERT_REFR
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 75
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

# ============================================
# ‚úÖ FASE 2: RE-EXPORTS DESDE queries.auth (REFRESH TOKENS)
# ============================================

from app.infrastructure.database.queries.auth import (
    INSERT_REFRESH_TOKEN,
    GET_R
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 99
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
from app.infrastructure.database.queries.audit import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

# ============================================
# ‚úÖ FASE 2: RE-EXPORTS DESDE queries.menus (COMPATIBILIDAD)
# ============================================

from app.infrastruct
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 99
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
from app.infrastructure.database.queries.audit import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

# ============================================
# ‚úÖ FASE 2: RE-EXPORTS DESDE queries.menus (COMPATIBILIDAD)
# ============================================

from app.infrastruct
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 99
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.infrastructure.database.queries.audit import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

# ============================================
# ‚úÖ FASE 2: RE-EXPORTS DESDE queries.menus (COMPATIBILIDAD)
# ============================================

from app.infrastruct
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 100
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

# ============================================
# ‚úÖ FASE 2: RE-EXPORTS DESDE queries.menus (COMPATIBILIDAD)
# ============================================

from app.infrastructure.database.queries.menus import (
    GET_AREAS_PAGINA
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 100
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

# ============================================
# ‚úÖ FASE 2: RE-EXPORTS DESDE queries.menus (COMPATIBILIDAD)
# ============================================

from app.infrastructure.database.queries.menus import (
    GET_AREAS_PAGINA
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\sql_constants.py
L√≠nea: 100
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

# ============================================
# ‚úÖ FASE 2: RE-EXPORTS DESDE queries.menus (COMPATIBILIDAD)
# ============================================

from app.infrastructure.database.queries.menus import (
    GET_AREAS_PAGINA
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\tables.py
L√≠nea: 13
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    
    query = select(UsuarioTable).where(UsuarioTable.c.nombre_usuario == username)
    result = await execute_query(query)
"""

from sqlalchemy import (
    Table, Column, Integer, String, Boolean, DateTime, Date, 
    ForeignKey, Text, Index, UniqueConstraint, CheckConstraint,
    MetaData, Num
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\tables.py
L√≠nea: 231
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    Column('rol_id', UNIQUEIDENTIFIER, ForeignKey('rol.rol_id', ondelete='CASCADE'), nullable=False),
    Column('menu_id', UNIQUEIDENTIFIER, ForeignKey('modulo_menu.menu_id', ondelete='CASCADE'), nullable=False),
    
    # Permisos granulares
    Column('puede_ver', Boolean, nullable=False, server
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\tables_modulos.py
L√≠nea: 196
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    Column('plantilla_id', UNIQUEIDENTIFIER, primary_key=True),
    Column('modulo_id', UNIQUEIDENTIFIER, ForeignKey('modulo.modulo_id', ondelete='CASCADE'), nullable=False),
    
    # Definici√≥n del rol
    Column('nombre_rol', String(50), nullable=False),
    Column('descripcion', String(255), nu
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 37
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    REVOKE_ALL_USER_TOKENS,
    DELETE_EXPIRED_TOKENS,
    GET_ACTIVE_SESSIONS_BY_USER,
    GET_ALL_ACTIVE_SESSIONS,
    REVOKE_REFRESH_TOKEN_BY_ID,
)

from .users import (
    SELECT_USUARIOS_PAGINATED,
    COUNT_USUARIOS_PAGINATED,
    SELECT_USUARIOS_PAGINATED_MULTI_DB,
    COUNT_USUARIOS_PAGINAT
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 44
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from .users import (
    SELECT_USUARIOS_PAGINATED,
    COUNT_USUARIOS_PAGINATED,
    SELECT_USUARIOS_PAGINATED_MULTI_DB,
    COUNT_USUARIOS_PAGINATED_MULTI_DB,
    GET_USER_COMPLETE_OPTIMIZED_JSON,
    GET_USER_COMPLETE_OPTIMIZED_XML,
)

from .rbac import (
    SELECT_ROLES_PAGINATED,
    COUNT_ROL
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 44
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from .users import (
    SELECT_USUARIOS_PAGINATED,
    COUNT_USUARIOS_PAGINATED,
    SELECT_USUARIOS_PAGINATED_MULTI_DB,
    COUNT_USUARIOS_PAGINATED_MULTI_DB,
    GET_USER_COMPLETE_OPTIMIZED_JSON,
    GET_USER_COMPLETE_OPTIMIZED_XML,
)

from .rbac import (
    SELECT_ROLES_PAGINATED,
    COUNT_ROL
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 46
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    COUNT_USUARIOS_PAGINATED,
    SELECT_USUARIOS_PAGINATED_MULTI_DB,
    COUNT_USUARIOS_PAGINATED_MULTI_DB,
    GET_USER_COMPLETE_OPTIMIZED_JSON,
    GET_USER_COMPLETE_OPTIMIZED_XML,
)

from .rbac import (
    SELECT_ROLES_PAGINATED,
    COUNT_ROLES_PAGINATED,
    SELECT_PERMISOS_POR_ROL,
    DEACT
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 46
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    COUNT_USUARIOS_PAGINATED,
    SELECT_USUARIOS_PAGINATED_MULTI_DB,
    COUNT_USUARIOS_PAGINATED_MULTI_DB,
    GET_USER_COMPLETE_OPTIMIZED_JSON,
    GET_USER_COMPLETE_OPTIMIZED_XML,
)

from .rbac import (
    SELECT_ROLES_PAGINATED,
    COUNT_ROLES_PAGINATED,
    SELECT_PERMISOS_POR_ROL,
    DEACT
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 53
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from .rbac import (
    SELECT_ROLES_PAGINATED,
    COUNT_ROLES_PAGINATED,
    SELECT_PERMISOS_POR_ROL,
    DEACTIVATE_ROL,
    REACTIVATE_ROL,
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

from .menus import (
    GET_AREAS_PAGINATED_QUERY,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 55
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    COUNT_ROLES_PAGINATED,
    SELECT_PERMISOS_POR_ROL,
    DEACTIVATE_ROL,
    REACTIVATE_ROL,
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

from .menus import (
    GET_AREAS_PAGINATED_QUERY,
    COUNT_AREAS_QUERY,
    GET_AREA_BY_ID_QUERY,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 58
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    REACTIVATE_ROL,
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

from .menus import (
    GET_AREAS_PAGINATED_QUERY,
    COUNT_AREAS_QUERY,
    GET_AREA_BY_ID_QUERY,
    CHECK_AREA_EXISTS_BY_NAME_QUERY,
    CREATE_AREA_QUERY,
    UPDATE_AREA_BASE_QUERY_TEMPLATE,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 59
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

from .menus import (
    GET_AREAS_PAGINATED_QUERY,
    COUNT_AREAS_QUERY,
    GET_AREA_BY_ID_QUERY,
    CHECK_AREA_EXISTS_BY_NAME_QUERY,
    CREATE_AREA_QUERY,
    UPDATE_AREA_BASE_QUERY_TEMPLATE,
    TOGGLE_AREA_STATUS_QUERY,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 85
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
from .audit import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    # Auth
    "GET_USER_MAX_ACCESS_LEVEL",
    "IS_USER_SUPER_ADMIN",
    "GET_USER_ACCESS_LEVEL_INFO_COMPLETE",
    "INSERT_REFRESH_TOKEN",
    "GET_REFRESH_TOKEN_BY_HASH",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 85
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
from .audit import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    # Auth
    "GET_USER_MAX_ACCESS_LEVEL",
    "IS_USER_SUPER_ADMIN",
    "GET_USER_ACCESS_LEVEL_INFO_COMPLETE",
    "INSERT_REFRESH_TOKEN",
    "GET_REFRESH_TOKEN_BY_HASH",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 85
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from .audit import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    # Auth
    "GET_USER_MAX_ACCESS_LEVEL",
    "IS_USER_SUPER_ADMIN",
    "GET_USER_ACCESS_LEVEL_INFO_COMPLETE",
    "INSERT_REFRESH_TOKEN",
    "GET_REFRESH_TOKEN_BY_HASH",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 86
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    # Auth
    "GET_USER_MAX_ACCESS_LEVEL",
    "IS_USER_SUPER_ADMIN",
    "GET_USER_ACCESS_LEVEL_INFO_COMPLETE",
    "INSERT_REFRESH_TOKEN",
    "GET_REFRESH_TOKEN_BY_HASH",
    "REVOKE_REFRESH_TOKEN",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 86
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    # Auth
    "GET_USER_MAX_ACCESS_LEVEL",
    "IS_USER_SUPER_ADMIN",
    "GET_USER_ACCESS_LEVEL_INFO_COMPLETE",
    "INSERT_REFRESH_TOKEN",
    "GET_REFRESH_TOKEN_BY_HASH",
    "REVOKE_REFRESH_TOKEN",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 86
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    # Auth
    "GET_USER_MAX_ACCESS_LEVEL",
    "IS_USER_SUPER_ADMIN",
    "GET_USER_ACCESS_LEVEL_INFO_COMPLETE",
    "INSERT_REFRESH_TOKEN",
    "GET_REFRESH_TOKEN_BY_HASH",
    "REVOKE_REFRESH_TOKEN",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 94
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    "GET_USER_ACCESS_LEVEL_INFO_COMPLETE",
    "INSERT_REFRESH_TOKEN",
    "GET_REFRESH_TOKEN_BY_HASH",
    "REVOKE_REFRESH_TOKEN",
    "REVOKE_REFRESH_TOKEN_BY_USER",
    "REVOKE_ALL_USER_TOKENS",
    "DELETE_EXPIRED_TOKENS",
    "GET_ACTIVE_SESSIONS_BY_USER",
    "GET_ALL_ACTIVE_SESSIONS",
    "RE
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 99
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    "REVOKE_ALL_USER_TOKENS",
    "DELETE_EXPIRED_TOKENS",
    "GET_ACTIVE_SESSIONS_BY_USER",
    "GET_ALL_ACTIVE_SESSIONS",
    "REVOKE_REFRESH_TOKEN_BY_ID",
    # Users
    "SELECT_USUARIOS_PAGINATED",
    "COUNT_USUARIOS_PAGINATED",
    "SELECT_USUARIOS_PAGINATED_MULTI_DB",
    "COUNT_USUARIOS_PA
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 104
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    # Users
    "SELECT_USUARIOS_PAGINATED",
    "COUNT_USUARIOS_PAGINATED",
    "SELECT_USUARIOS_PAGINATED_MULTI_DB",
    "COUNT_USUARIOS_PAGINATED_MULTI_DB",
    "GET_USER_COMPLETE_OPTIMIZED_JSON",
    "GET_USER_COMPLETE_OPTIMIZED_XML",
    # RBAC
    "SELECT_ROLES_PAGINATED",
    "COUNT_ROLES_PAG
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 104
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    # Users
    "SELECT_USUARIOS_PAGINATED",
    "COUNT_USUARIOS_PAGINATED",
    "SELECT_USUARIOS_PAGINATED_MULTI_DB",
    "COUNT_USUARIOS_PAGINATED_MULTI_DB",
    "GET_USER_COMPLETE_OPTIMIZED_JSON",
    "GET_USER_COMPLETE_OPTIMIZED_XML",
    # RBAC
    "SELECT_ROLES_PAGINATED",
    "COUNT_ROLES_PAG
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 106
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    "COUNT_USUARIOS_PAGINATED",
    "SELECT_USUARIOS_PAGINATED_MULTI_DB",
    "COUNT_USUARIOS_PAGINATED_MULTI_DB",
    "GET_USER_COMPLETE_OPTIMIZED_JSON",
    "GET_USER_COMPLETE_OPTIMIZED_XML",
    # RBAC
    "SELECT_ROLES_PAGINATED",
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
    "
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 106
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    "COUNT_USUARIOS_PAGINATED",
    "SELECT_USUARIOS_PAGINATED_MULTI_DB",
    "COUNT_USUARIOS_PAGINATED_MULTI_DB",
    "GET_USER_COMPLETE_OPTIMIZED_JSON",
    "GET_USER_COMPLETE_OPTIMIZED_XML",
    # RBAC
    "SELECT_ROLES_PAGINATED",
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
    "
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 111
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    # RBAC
    "SELECT_ROLES_PAGINATED",
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
    "DEACTIVATE_ROL",
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
    # Menus
    "GET_AREAS_PAGINATED_QUERY",
    "COUNT_AREAS_QUERY",
    "GET_AREA_BY_ID_QUERY",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 113
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
    "DEACTIVATE_ROL",
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
    # Menus
    "GET_AREAS_PAGINATED_QUERY",
    "COUNT_AREAS_QUERY",
    "GET_AREA_BY_ID_QUERY",
    "CHECK_AREA_EXISTS_BY_NAME_QUERY",
  
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 116
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
    # Menus
    "GET_AREAS_PAGINATED_QUERY",
    "COUNT_AREAS_QUERY",
    "GET_AREA_BY_ID_QUERY",
    "CHECK_AREA_EXISTS_BY_NAME_QUERY",
    "CREATE_AREA_QUERY",
    "UPDATE_AREA_BASE_QUERY_TEMPLATE",
    "TOGGLE_AREA_STA
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 117
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
    # Menus
    "GET_AREAS_PAGINATED_QUERY",
    "COUNT_AREAS_QUERY",
    "GET_AREA_BY_ID_QUERY",
    "CHECK_AREA_EXISTS_BY_NAME_QUERY",
    "CREATE_AREA_QUERY",
    "UPDATE_AREA_BASE_QUERY_TEMPLATE",
    "TOGGLE_AREA_STATUS_QUERY",
    "GET_A
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 129
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
    "SELECT_MENU_BY_ID",
    "UPDATE_MENU_TEMPLATE",
    "DEACTIVATE_MENU",
    "REACTIVATE_MENU",
    "CHECK_MENU_EXISTS",
    "CHECK_AREA_EXISTS",
    "GET_MENUS_BY_AREA_FOR_TREE_QUERY",
    "GET_MAX_ORDEN_FOR_SIBLINGS",
    "GET_MAX_ORDEN_FOR_ROOT",
    "GET_ALL_MENUS_ADMIN",
    # Audit
    "INS
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 139
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
    # Audit
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 139
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
    # Audit
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 139
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    # Audit
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 140
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 140
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\__init__.py
L√≠nea: 140
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 47
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:

INSERT_LOG_SINCRONIZACION_USUARIO = """
INSERT INTO log_sincronizacion_usuario (
    cliente_origen_id,
    cliente_destino_id,
    usuario_id,
    tipo_sincronizacion,
    direccion,
    operacion,
    estado,
    mensaje_error,
    campos_sincronizados,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 47
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

INSERT_LOG_SINCRONIZACION_USUARIO = """
INSERT INTO log_sincronizacion_usuario (
    cliente_origen_id,
    cliente_destino_id,
    usuario_id,
    tipo_sincronizacion,
    direccion,
    operacion,
    estado,
    mensaje_error,
    campos_sincronizados,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 48
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
INSERT_LOG_SINCRONIZACION_USUARIO = """
INSERT INTO log_sincronizacion_usuario (
    cliente_origen_id,
    cliente_destino_id,
    usuario_id,
    tipo_sincronizacion,
    direccion,
    operacion,
    estado,
    mensaje_error,
    campos_sincronizados,
    cambios_detectados,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 48
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
INSERT_LOG_SINCRONIZACION_USUARIO = """
INSERT INTO log_sincronizacion_usuario (
    cliente_origen_id,
    cliente_destino_id,
    usuario_id,
    tipo_sincronizacion,
    direccion,
    operacion,
    estado,
    mensaje_error,
    campos_sincronizados,
    cambios_detectados,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 65
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
)
OUTPUT INSERTED.log_id, INSERTED.fecha_sincronizacion
VALUES (
    :cliente_origen_id,
    :cliente_destino_id,
    :usuario_id,
    :tipo_sincronizacion,
    :direccion,
    :operacion,
    :estado,
    :mensaje_error,
    :campos_sincronizados,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 86
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 86
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 86
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 87
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 87
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\audit_queries.py
L√≠nea: 87
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 13
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
from .audit_queries import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 13
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
from .audit_queries import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 13
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from .audit_queries import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 14
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 14
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 14
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)

__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 18
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 18
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 18
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
__all__ = [
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 19
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 19
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\audit\__init__.py
L√≠nea: 19
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    "INSERT_AUTH_AUDIT_LOG",
    "INSERT_LOG_SINCRONIZACION_USUARIO",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\auth\auth_queries.py
L√≠nea: 41
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
IS_USER_SUPER_ADMIN = """
SELECT COUNT(*) as is_super_admin
FROM usuario_rol ur
INNER JOIN rol r ON ur.rol_id = r.rol_id
WHERE ur.usuario_id = :usuario_id 
  AND ur.es_activo = 1
  AND r.es_activo = 1
  AND r.codigo_rol = 'SUPER_ADMIN'
  AND r.nivel_acceso = 5
"""

GET_USER_ACCESS_LEVEL_INFO_COMPLET
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\auth\auth_queries.py
L√≠nea: 41
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
IS_USER_SUPER_ADMIN = """
SELECT COUNT(*) as is_super_admin
FROM usuario_rol ur
INNER JOIN rol r ON ur.rol_id = r.rol_id
WHERE ur.usuario_id = :usuario_id 
  AND ur.es_activo = 1
  AND r.es_activo = 1
  AND r.codigo_rol = 'SUPER_ADMIN'
  AND r.nivel_acceso = 5
"""

GET_USER_ACCESS_LEVEL_INFO_COMPLET
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\auth\auth_queries.py
L√≠nea: 41
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
IS_USER_SUPER_ADMIN = """
SELECT COUNT(*) as is_super_admin
FROM usuario_rol ur
INNER JOIN rol r ON ur.rol_id = r.rol_id
WHERE ur.usuario_id = :usuario_id 
  AND ur.es_activo = 1
  AND r.es_activo = 1
  AND r.codigo_rol = 'SUPER_ADMIN'
  AND r.nivel_acceso = 5
"""

GET_USER_ACCESS_LEVEL_INFO_COMPLET
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\rbac_queries.py
L√≠nea: 7
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
QUERIES INCLUIDAS:
- SELECT_ROLES_PAGINATED
- COUNT_ROLES_PAGINATED
- SELECT_PERMISOS_POR_ROL
- DEACTIVATE_ROL
- REACTIVATE_ROL
- DELETE_PERMISOS_POR_ROL
- INSERT_PERMISO_ROL
"""

# ============================================
# QUERIES PARA ROLES (MULTI-TENANT)
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\rbac_queries.py
L√≠nea: 9
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
- COUNT_ROLES_PAGINATED
- SELECT_PERMISOS_POR_ROL
- DEACTIVATE_ROL
- REACTIVATE_ROL
- DELETE_PERMISOS_POR_ROL
- INSERT_PERMISO_ROL
"""

# ============================================
# QUERIES PARA ROLES (MULTI-TENANT)
# ============================================

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\rbac_queries.py
L√≠nea: 12
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
- REACTIVATE_ROL
- DELETE_PERMISOS_POR_ROL
- INSERT_PERMISO_ROL
"""

# ============================================
# QUERIES PARA ROLES (MULTI-TENANT)
# ============================================

SELECT_ROLES_PAGINATED = """
SELECT 
    r.rol_id,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\rbac_queries.py
L√≠nea: 13
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
- DELETE_PERMISOS_POR_ROL
- INSERT_PERMISO_ROL
"""

# ============================================
# QUERIES PARA ROLES (MULTI-TENANT)
# ============================================

SELECT_ROLES_PAGINATED = """
SELECT 
    r.rol_id,
    r.nombre,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\rbac_queries.py
L√≠nea: 124
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
__all__ = [
    "SELECT_ROLES_PAGINATED",
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
    "DEACTIVATE_ROL",
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\rbac_queries.py
L√≠nea: 126
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
    "DEACTIVATE_ROL",
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\rbac_queries.py
L√≠nea: 129
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\rbac_queries.py
L√≠nea: 130
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\__init__.py
L√≠nea: 13
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from .rbac_queries import (
    SELECT_ROLES_PAGINATED,
    COUNT_ROLES_PAGINATED,
    SELECT_PERMISOS_POR_ROL,
    DEACTIVATE_ROL,
    REACTIVATE_ROL,
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

__all__ = [
    "SELECT_ROLES_PAGINATED",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\__init__.py
L√≠nea: 15
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    COUNT_ROLES_PAGINATED,
    SELECT_PERMISOS_POR_ROL,
    DEACTIVATE_ROL,
    REACTIVATE_ROL,
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

__all__ = [
    "SELECT_ROLES_PAGINATED",
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\__init__.py
L√≠nea: 18
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    REACTIVATE_ROL,
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

__all__ = [
    "SELECT_ROLES_PAGINATED",
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
    "DEACTIVATE_ROL",
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\__init__.py
L√≠nea: 19
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    DELETE_PERMISOS_POR_ROL,
    INSERT_PERMISO_ROL,
)

__all__ = [
    "SELECT_ROLES_PAGINATED",
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
    "DEACTIVATE_ROL",
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\__init__.py
L√≠nea: 23
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
__all__ = [
    "SELECT_ROLES_PAGINATED",
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
    "DEACTIVATE_ROL",
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\__init__.py
L√≠nea: 25
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    "COUNT_ROLES_PAGINATED",
    "SELECT_PERMISOS_POR_ROL",
    "DEACTIVATE_ROL",
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\__init__.py
L√≠nea: 28
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    "REACTIVATE_ROL",
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\rbac\__init__.py
L√≠nea: 29
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    "DELETE_PERMISOS_POR_ROL",
    "INSERT_PERMISO_ROL",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 7
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
QUERIES INCLUIDAS:
- SELECT_USUARIOS_PAGINATED
- COUNT_USUARIOS_PAGINATED
- SELECT_USUARIOS_PAGINATED_MULTI_DB
- COUNT_USUARIOS_PAGINATED_MULTI_DB
- GET_USER_COMPLETE_OPTIMIZED_JSON
- GET_USER_COMPLETE_OPTIMIZED_XML
"""

# ============================================
# QUERIES PARA USUARIOS (MULTI-T
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 9
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
- COUNT_USUARIOS_PAGINATED
- SELECT_USUARIOS_PAGINATED_MULTI_DB
- COUNT_USUARIOS_PAGINATED_MULTI_DB
- GET_USER_COMPLETE_OPTIMIZED_JSON
- GET_USER_COMPLETE_OPTIMIZED_XML
"""

# ============================================
# QUERIES PARA USUARIOS (MULTI-TENANT)
# ======================================
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 19
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

SELECT_USUARIOS_PAGINATED = """
WITH UserRoles AS (
    SELECT
        u.usuario_id,
        u.nombre_usuario,
        u.correo,
        u.contrasena, 
        u.nombre,
        u.apellido,
        u.es_activo,
        u.correo_confirmado,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 19
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

SELECT_USUARIOS_PAGINATED = """
WITH UserRoles AS (
    SELECT
        u.usuario_id,
        u.nombre_usuario,
        u.correo,
        u.contrasena, 
        u.nombre,
        u.apellido,
        u.es_activo,
        u.correo_confirmado,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 21
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
WITH UserRoles AS (
    SELECT
        u.usuario_id,
        u.nombre_usuario,
        u.correo,
        u.contrasena, 
        u.nombre,
        u.apellido,
        u.es_activo,
        u.correo_confirmado,
        u.fecha_creacion,
        u.fecha_ultimo_acceso,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 21
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
WITH UserRoles AS (
    SELECT
        u.usuario_id,
        u.nombre_usuario,
        u.correo,
        u.contrasena, 
        u.nombre,
        u.apellido,
        u.es_activo,
        u.correo_confirmado,
        u.fecha_creacion,
        u.fecha_ultimo_acceso,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 88
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
WITH UserRoles AS (
    SELECT
        u.usuario_id,
        u.nombre_usuario,
        u.correo,
        u.contrasena, 
        u.nombre,
        u.apellido,
        u.es_activo,
        u.correo_confirmado,
        u.fecha_creacion,
        u.fecha_ultimo_acceso,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 88
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
WITH UserRoles AS (
    SELECT
        u.usuario_id,
        u.nombre_usuario,
        u.correo,
        u.contrasena, 
        u.nombre,
        u.apellido,
        u.es_activo,
        u.correo_confirmado,
        u.fecha_creacion,
        u.fecha_ultimo_acceso,
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 139
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
COUNT_USUARIOS_PAGINATED_MULTI_DB = """
SELECT COUNT(DISTINCT u.usuario_id)
FROM usuario u
WHERE
    u.es_eliminado = 0
    AND (:buscar IS NULL OR (
        u.nombre_usuario LIKE :buscar_pattern OR
        u.correo LIKE :buscar_pattern OR
        u.nombre LIKE :buscar_pattern OR
        u.apellido 
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 279
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
__all__ = [
    "SELECT_USUARIOS_PAGINATED",
    "COUNT_USUARIOS_PAGINATED",
    "SELECT_USUARIOS_PAGINATED_MULTI_DB",
    "COUNT_USUARIOS_PAGINATED_MULTI_DB",
    "GET_USER_COMPLETE_OPTIMIZED_JSON",
    "GET_USER_COMPLETE_OPTIMIZED_XML",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\user_queries.py
L√≠nea: 281
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    "COUNT_USUARIOS_PAGINATED",
    "SELECT_USUARIOS_PAGINATED_MULTI_DB",
    "COUNT_USUARIOS_PAGINATED_MULTI_DB",
    "GET_USER_COMPLETE_OPTIMIZED_JSON",
    "GET_USER_COMPLETE_OPTIMIZED_XML",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\__init__.py
L√≠nea: 13
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from .user_queries import (
    SELECT_USUARIOS_PAGINATED,
    COUNT_USUARIOS_PAGINATED,
    SELECT_USUARIOS_PAGINATED_MULTI_DB,
    COUNT_USUARIOS_PAGINATED_MULTI_DB,
    GET_USER_COMPLETE_OPTIMIZED_JSON,
    GET_USER_COMPLETE_OPTIMIZED_XML,
)

__all__ = [
    "SELECT_USUARIOS_PAGINATED",
    "COUN
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\__init__.py
L√≠nea: 15
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    COUNT_USUARIOS_PAGINATED,
    SELECT_USUARIOS_PAGINATED_MULTI_DB,
    COUNT_USUARIOS_PAGINATED_MULTI_DB,
    GET_USER_COMPLETE_OPTIMIZED_JSON,
    GET_USER_COMPLETE_OPTIMIZED_XML,
)

__all__ = [
    "SELECT_USUARIOS_PAGINATED",
    "COUNT_USUARIOS_PAGINATED",
    "SELECT_USUARIOS_PAGINATED_MULTI
--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\__init__.py
L√≠nea: 22
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
__all__ = [
    "SELECT_USUARIOS_PAGINATED",
    "COUNT_USUARIOS_PAGINATED",
    "SELECT_USUARIOS_PAGINATED_MULTI_DB",
    "COUNT_USUARIOS_PAGINATED_MULTI_DB",
    "GET_USER_COMPLETE_OPTIMIZED_JSON",
    "GET_USER_COMPLETE_OPTIMIZED_XML",
]

--------------------------------------------------------------------------------

Archivo: app\infrastructure\database\queries\users\__init__.py
L√≠nea: 24
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    "COUNT_USUARIOS_PAGINATED",
    "SELECT_USUARIOS_PAGINATED_MULTI_DB",
    "COUNT_USUARIOS_PAGINATED_MULTI_DB",
    "GET_USER_COMPLETE_OPTIMIZED_JSON",
    "GET_USER_COMPLETE_OPTIMIZED_XML",
]

--------------------------------------------------------------------------------

Archivo: app\modules\auth\presentation\endpoints_auth_config.py
L√≠nea: 19
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

from app.modules.auth.presentation.schemas import AuthConfigRead, AuthConfigUpdate
from app.modules.auth.application.services.auth_config_service import AuthConfigService
from app.api.deps import RoleChecker

logger = logging.getLogger(__name__)

router = APIRouter()

# Dependencia para requerir ro
--------------------------------------------------------------------------------

Archivo: app\modules\auth\presentation\endpoints_sso.py
L√≠nea: 48
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    SsoProvider, SSOConfigAzure, SSOConfigGoogle,
    FederacionBase, FederacionCreate, FederacionUpdate, FederacionRead
)

logger = logging.getLogger(__name__)

router = APIRouter()

# Dependencia para requerir rol ADMIN o SUPER_ADMIN
require_admin = RoleChecker(["ADMIN", "SUPER_ADMIN"])


--------------------------------------------------------------------------------

Archivo: app\modules\auth\presentation\endpoints_sso.py
L√≠nea: 178
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

@router.delete(
    "/{provider_id}/",
    summary="Eliminar proveedor SSO",
    description="""
    Elimina (desactiva) un proveedor de identidad configurado.
    
    **Permisos requeridos:**
    - Rol 'ADMIN' o 'SUPER_ADMIN'
    
    **Par√°metros de ruta:**
    - provider_id: ID del proveedor a 
--------------------------------------------------------------------------------

Archivo: app\modules\auth\application\services\auth_service.py
L√≠nea: 122
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                query = """
                SELECT 
                    ISNULL(MAX(r.nivel_acceso), 1) as max_level,
                    COUNT(CASE WHEN r.codigo_rol = 'SUPER_ADMIN' AND r.nivel_acceso = 5 THEN 1 END) as super_admin_count,
                    COUNT(*) as total_roles
                F
--------------------------------------------------------------------------------

Archivo: app\modules\auth\application\services\auth_service.py
L√≠nea: 122
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                query = """
                SELECT 
                    ISNULL(MAX(r.nivel_acceso), 1) as max_level,
                    COUNT(CASE WHEN r.codigo_rol = 'SUPER_ADMIN' AND r.nivel_acceso = 5 THEN 1 END) as super_admin_count,
                    COUNT(*) as total_roles
                F
--------------------------------------------------------------------------------

Archivo: app\modules\auth\application\services\auth_service.py
L√≠nea: 122
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
                query = """
                SELECT 
                    ISNULL(MAX(r.nivel_acceso), 1) as max_level,
                    COUNT(CASE WHEN r.codigo_rol = 'SUPER_ADMIN' AND r.nivel_acceso = 5 THEN 1 END) as super_admin_count,
                    COUNT(*) as total_roles
                F
--------------------------------------------------------------------------------

Archivo: app\modules\auth\infrastructure\repositories\usuario_repository.py
L√≠nea: 141
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
        query_roles = """
            SELECT 
                r.rol_id,
                r.codigo_rol,
                r.nombre_rol,
                r.descripcion,
                r.es_activo,
                ur.es_activo as asignacion_activa
            FROM rol r
            INNER JOIN usuario_rol 
--------------------------------------------------------------------------------

Archivo: app\modules\auth\infrastructure\repositories\usuario_repository.py
L√≠nea: 141
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        query_roles = """
            SELECT 
                r.rol_id,
                r.codigo_rol,
                r.nombre_rol,
                r.descripcion,
                r.es_activo,
                ur.es_activo as asignacion_activa
            FROM rol r
            INNER JOIN usuario_rol 
--------------------------------------------------------------------------------

Archivo: app\modules\auth\infrastructure\repositories\usuario_repository.py
L√≠nea: 141
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
        query_roles = """
            SELECT 
                r.rol_id,
                r.codigo_rol,
                r.nombre_rol,
                r.descripcion,
                r.es_activo,
                ur.es_activo as asignacion_activa
            FROM rol r
            INNER JOIN usuario_rol 
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints.py
L√≠nea: 24
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.modules.menus.presentation.schemas import (
    MenuResponse, MenuCreate, MenuUpdate, MenuReadSingle, MenuItem
)
from app.modules.users.presentation.schemas import UsuarioReadWithRoles # Para dependencia de usuario

# Importar Servicio
from app.modules.menus.application.services.menu_servic
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints.py
L√≠nea: 24
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.modules.menus.presentation.schemas import (
    MenuResponse, MenuCreate, MenuUpdate, MenuReadSingle, MenuItem
)
from app.modules.users.presentation.schemas import UsuarioReadWithRoles # Para dependencia de usuario

# Importar Servicio
from app.modules.menus.application.services.menu_servic
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints.py
L√≠nea: 309
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
)
async def update_menu_endpoint(
    menu_id: UUID = Path(..., title="ID del Men√∫", description="El ID del √≠tem de men√∫ a actualizar"),
    menu_in: MenuUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints.py
L√≠nea: 309
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
)
async def update_menu_endpoint(
    menu_id: UUID = Path(..., title="ID del Men√∫", description="El ID del √≠tem de men√∫ a actualizar"),
    menu_in: MenuUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints.py
L√≠nea: 311
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    menu_id: UUID = Path(..., title="ID del Men√∫", description="El ID del √≠tem de men√∫ a actualizar"),
    menu_in: MenuUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente un √≠tem de men√∫ existente.

    A
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints.py
L√≠nea: 311
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    menu_id: UUID = Path(..., title="ID del Men√∫", description="El ID del √≠tem de men√∫ a actualizar"),
    menu_in: MenuUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente un √≠tem de men√∫ existente.

    A
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints.py
L√≠nea: 360
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
# ----------------------------------------------------------------------
@router.delete(
    "/{menu_id}/",
    status_code=status.HTTP_200_OK,
    response_model=Dict[str, Any],
    summary="Desactivar un √≠tem de men√∫ (Borrado L√≥gico) (Admin)",
    description="""
    Desactiva un √≠tem de men√∫ esta
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints_areas.py
L√≠nea: 23
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
# Schemas para √°reas
from app.modules.menus.presentation.schemas import AreaCreate, AreaUpdate, AreaRead, PaginatedAreaResponse, AreaSimpleList

# Servicio de √°reas con manejo de errores mejorado
from app.modules.menus.application.services.area_service import AreaService

# Sistema de excepciones pe
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints_areas.py
L√≠nea: 213
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    description="""
    Devuelve una lista simplificada de √°reas activas **del cliente actual** para uso en selectores o listas desplegables.
    
    **Permisos requeridos:**
    - Rol 'Administrador'
    
    **Respuestas:**
    - 200: Lista simple recuperada exitosamente
    - 500: Error interno 
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints_areas.py
L√≠nea: 230
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    
    Ideal para componentes UI que necesitan solo ID y nombre (selectores, combobox, etc.).
    
    Args:
        current_user: Usuario autenticado y activo (inyectado por dependencia).
        
    Returns:
        List[AreaSimpleList]: Lista de √°reas activas con ID y nombre
        
    Raise
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints_areas.py
L√≠nea: 362
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    area_id: UUID = Path(..., description="ID del √°rea"),
    area_in: AreaUpdate = Body(...),
    current_user: Any = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente un √°rea existente **del cliente del usuario**.
    
    Args:
        area_id: Identificador √∫n
--------------------------------------------------------------------------------

Archivo: app\modules\menus\presentation\endpoints_areas.py
L√≠nea: 419
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

@router.delete(
    "/{area_id}/",
    response_model=AreaRead,
    status_code=status.HTTP_200_OK,
    summary="Desactivar un √°rea (Borrado L√≥gico)",
    description="""
    Desactiva un √°rea estableciendo su estado 'es_activo' a False (borrado l√≥gico).
    **Solo puede desactivar √°reas de su mism
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_cliente_modulo.py
L√≠nea: 24
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ClienteModuloRead, ClienteModuloCreate, ClienteModuloUpdate
)
from app.modules.modulos.application.services.cliente_modulo_service import ClienteModuloService
from app.core.exceptions import CustomException
from app.api.deps import get_curre
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_cliente_modulo.py
L√≠nea: 24
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ClienteModuloRead, ClienteModuloCreate, ClienteModuloUpdate
)
from app.modules.modulos.application.services.cliente_modulo_service import ClienteModuloService
from app.core.exceptions import CustomException
from app.api.deps import get_curre
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_menus.py
L√≠nea: 11
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ModuloMenuRead, ModuloMenuCreate, ModuloMenuUpdate, MenuUsuarioResponse
)
from app.modules.modulos.application.services.modulo_menu_service import ModuloMenuService
from app.core.exceptions import CustomException
from app.api.deps import get
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_menus.py
L√≠nea: 11
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ModuloMenuRead, ModuloMenuCreate, ModuloMenuUpdate, MenuUsuarioResponse
)
from app.modules.modulos.application.services.modulo_menu_service import ModuloMenuService
from app.core.exceptions import CustomException
from app.api.deps import get
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_menus.py
L√≠nea: 152
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    menu_id: UUID = Path(..., description="ID del men√∫"),
    menu_data: ModuloMenuUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """Actualiza un men√∫ existente."""
    try:
        menu = await ModuloMenuService.actualizar_menu(menu_id, menu_dat
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_menus.py
L√≠nea: 152
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    menu_id: UUID = Path(..., description="ID del men√∫"),
    menu_data: ModuloMenuUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """Actualiza un men√∫ existente."""
    try:
        menu = await ModuloMenuService.actualizar_menu(menu_id, menu_dat
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_menus.py
L√≠nea: 167
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

@router.delete(
    "/{menu_id}/",
    status_code=status.HTTP_200_OK,
    summary="Eliminar men√∫"
)
@require_super_admin()
async def eliminar_menu(
    menu_id: UUID = Path(..., description="ID del men√∫"),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """Elimina 
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_menus.py
L√≠nea: 167
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

@router.delete(
    "/{menu_id}/",
    status_code=status.HTTP_200_OK,
    summary="Eliminar men√∫"
)
@require_super_admin()
async def eliminar_menu(
    menu_id: UUID = Path(..., description="ID del men√∫"),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """Elimina 
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_modulos.py
L√≠nea: 21
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ModuloRead, ModuloCreate, ModuloUpdate, ModuloResponse, PaginatedModuloResponse
)
from app.modules.modulos.application.services.modulo_service import ModuloService
from app.core.exceptions import CustomException
from app.api.deps import get_
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_modulos.py
L√≠nea: 21
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ModuloRead, ModuloCreate, ModuloUpdate, ModuloResponse, PaginatedModuloResponse
)
from app.modules.modulos.application.services.modulo_service import ModuloService
from app.core.exceptions import CustomException
from app.api.deps import get_
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_modulos.py
L√≠nea: 293
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    modulo_id: UUID = Path(..., description="ID del m√≥dulo"),
    modulo_data: ModuloUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """Actualiza un m√≥dulo existente en el cat√°logo del sistema. Solo accesible para super administradores."""
    log
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_modulos.py
L√≠nea: 293
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    modulo_id: UUID = Path(..., description="ID del m√≥dulo"),
    modulo_data: ModuloUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """Actualiza un m√≥dulo existente en el cat√°logo del sistema. Solo accesible para super administradores."""
    log
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_plantillas.py
L√≠nea: 11
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ModuloRolPlantillaRead, ModuloRolPlantillaCreate, ModuloRolPlantillaUpdate
)
from app.modules.modulos.application.services.modulo_rol_plantilla_service import ModuloRolPlantillaService
from app.core.exceptions import CustomException
from app
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_plantillas.py
L√≠nea: 11
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ModuloRolPlantillaRead, ModuloRolPlantillaCreate, ModuloRolPlantillaUpdate
)
from app.modules.modulos.application.services.modulo_rol_plantilla_service import ModuloRolPlantillaService
from app.core.exceptions import CustomException
from app
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_plantillas.py
L√≠nea: 102
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    plantilla_id: UUID = Path(..., description="ID de la plantilla"),
    plantilla_data: ModuloRolPlantillaUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """Actualiza una plantilla existente."""
    try:
        plantilla = await ModuloRolPlanti
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_plantillas.py
L√≠nea: 102
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    plantilla_id: UUID = Path(..., description="ID de la plantilla"),
    plantilla_data: ModuloRolPlantillaUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """Actualiza una plantilla existente."""
    try:
        plantilla = await ModuloRolPlanti
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_plantillas.py
L√≠nea: 117
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

@router.delete(
    "/{plantilla_id}/",
    status_code=status.HTTP_200_OK,
    summary="Eliminar plantilla"
)
@require_super_admin()
async def eliminar_plantilla(
    plantilla_id: UUID = Path(..., description="ID de la plantilla"),
    current_user: UsuarioReadWithRoles = Depends(get_current_acti
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_plantillas.py
L√≠nea: 117
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

@router.delete(
    "/{plantilla_id}/",
    status_code=status.HTTP_200_OK,
    summary="Eliminar plantilla"
)
@require_super_admin()
async def eliminar_plantilla(
    plantilla_id: UUID = Path(..., description="ID de la plantilla"),
    current_user: UsuarioReadWithRoles = Depends(get_current_acti
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_secciones.py
L√≠nea: 10
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

from app.modules.modulos.presentation.schemas import ModuloSeccionRead, ModuloSeccionCreate, ModuloSeccionUpdate
from app.modules.modulos.application.services.modulo_seccion_service import ModuloSeccionService
from app.core.exceptions import CustomException
from app.api.deps import get_current_acti
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_secciones.py
L√≠nea: 10
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

from app.modules.modulos.presentation.schemas import ModuloSeccionRead, ModuloSeccionCreate, ModuloSeccionUpdate
from app.modules.modulos.application.services.modulo_seccion_service import ModuloSeccionService
from app.core.exceptions import CustomException
from app.api.deps import get_current_acti
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_secciones.py
L√≠nea: 100
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    seccion_id: UUID = Path(..., description="ID de la secci√≥n"),
    seccion_data: ModuloSeccionUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """Actualiza una secci√≥n existente."""
    try:
        seccion = await ModuloSeccionService.actualiza
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_secciones.py
L√≠nea: 100
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    seccion_id: UUID = Path(..., description="ID de la secci√≥n"),
    seccion_data: ModuloSeccionUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """Actualiza una secci√≥n existente."""
    try:
        seccion = await ModuloSeccionService.actualiza
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_secciones.py
L√≠nea: 115
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

@router.delete(
    "/{seccion_id}/",
    status_code=status.HTTP_200_OK,
    summary="Eliminar secci√≥n"
)
@require_super_admin()
async def eliminar_seccion(
    seccion_id: UUID = Path(..., description="ID de la secci√≥n"),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
)
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\endpoints_secciones.py
L√≠nea: 115
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

@router.delete(
    "/{seccion_id}/",
    status_code=status.HTTP_200_OK,
    summary="Eliminar secci√≥n"
)
@require_super_admin()
async def eliminar_seccion(
    seccion_id: UUID = Path(..., description="ID de la secci√≥n"),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
)
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\schemas.py
L√≠nea: 326
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

class ClienteModuloUpdate(BaseModel):
    """Schema para actualizar configuraci√≥n de m√≥dulo activo."""
    esta_activo: Optional[bool] = None
    fecha_vencimiento: Optional[datetime] = None
    modo_prueba: Optional[bool] = None
    fecha_fin_prueba: Optional[datetime] = None
    configuracion_jso
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\presentation\schemas.py
L√≠nea: 430
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

class ModuloRolPlantillaUpdate(BaseModel):
    """Schema para actualizar una plantilla."""
    nombre_rol: Optional[str] = Field(None, max_length=50)
    descripcion: Optional[str] = Field(None, max_length=255)
    nivel_acceso: Optional[int] = Field(None, ge=1, le=5)
    permisos_json: Optional[st
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\cliente_modulo_service.py
L√≠nea: 36
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ClienteModuloCreate, ClienteModuloUpdate, ClienteModuloRead
)
from app.modules.modulos.application.helpers.rol_plantilla_applier import aplicar_plantillas_roles
from app.infrastructure.database.connection_async import DatabaseConnection

log
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\cliente_modulo_service.py
L√≠nea: 336
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            stmt = (
                update(ClienteModuloTable)
                .where(ClienteModuloTable.c.cliente_modulo_id == cliente_modulo_id)
                .values(
                    esta_activo=True,
                    fecha_vencimiento=modulo_data.fecha_vencimiento,
                    
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\cliente_modulo_service.py
L√≠nea: 564
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        
        update_dict = {}
        if limite_usuarios is not None:
            update_dict['limite_usuarios'] = limite_usuarios
        if limite_registros is not None:
            update_dict['limite_registros'] = limite_registros
        if limite_transacciones_mes is not None:
            
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\cliente_modulo_service.py
L√≠nea: 566
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        if limite_usuarios is not None:
            update_dict['limite_usuarios'] = limite_usuarios
        if limite_registros is not None:
            update_dict['limite_registros'] = limite_registros
        if limite_transacciones_mes is not None:
            update_dict['limite_transacciones_
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_menu_service.py
L√≠nea: 17
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
import logging
from sqlalchemy import select, update, delete, and_, or_, func as sql_func, Integer, case
from uuid import UUID

from app.infrastructure.database.tables_modulos import ModuloMenuTable, ModuloTable, ModuloSeccionTable, ClienteModuloTable
from app.infrastructure.database.tables import R
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_menu_service.py
L√≠nea: 17
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
import logging
from sqlalchemy import select, update, delete, and_, or_, func as sql_func, Integer, case
from uuid import UUID

from app.infrastructure.database.tables_modulos import ModuloMenuTable, ModuloTable, ModuloSeccionTable, ClienteModuloTable
from app.infrastructure.database.tables import R
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_menu_service.py
L√≠nea: 22
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.infrastructure.database.tables import RolMenuPermisoTable, UsuarioRolTable
from app.infrastructure.database.queries_async import execute_query, execute_insert, execute_update, execute_procedure_params
from app.core.exceptions import (
    ValidationError,
    ConflictError,
    NotFoundErro
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_menu_service.py
L√≠nea: 22
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.infrastructure.database.tables import RolMenuPermisoTable, UsuarioRolTable
from app.infrastructure.database.queries_async import execute_query, execute_insert, execute_update, execute_procedure_params
from app.core.exceptions import (
    ValidationError,
    ConflictError,
    NotFoundErro
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_menu_service.py
L√≠nea: 32
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ModuloMenuCreate, ModuloMenuUpdate, ModuloMenuRead, MenuUsuarioResponse
)
from app.modules.modulos.application.helpers.menu_transformer import transformar_sp_menu_usuario
from app.infrastructure.database.connection_async import DatabaseConne
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_menu_service.py
L√≠nea: 927
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                query_raw = f"""
                SELECT p.menu_id,
                       MAX(CAST(p.puede_ver AS INT)) AS puede_ver,
                       MAX(CAST(p.puede_crear AS INT)) AS puede_crear,
                       MAX(CAST(p.puede_editar AS INT)) AS puede_editar,
                      
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_menu_service.py
L√≠nea: 927
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                query_raw = f"""
                SELECT p.menu_id,
                       MAX(CAST(p.puede_ver AS INT)) AS puede_ver,
                       MAX(CAST(p.puede_crear AS INT)) AS puede_crear,
                       MAX(CAST(p.puede_editar AS INT)) AS puede_editar,
                      
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_menu_service.py
L√≠nea: 927
Tabla: rol_menu_permiso
Tipo: sql_string
Issue: Query SQL directa toca tabla rol_menu_permiso sin cliente_id visible
Contexto:
                query_raw = f"""
                SELECT p.menu_id,
                       MAX(CAST(p.puede_ver AS INT)) AS puede_ver,
                       MAX(CAST(p.puede_crear AS INT)) AS puede_crear,
                       MAX(CAST(p.puede_editar AS INT)) AS puede_editar,
                      
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_menu_service.py
L√≠nea: 927
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
                query_raw = f"""
                SELECT p.menu_id,
                       MAX(CAST(p.puede_ver AS INT)) AS puede_ver,
                       MAX(CAST(p.puede_crear AS INT)) AS puede_crear,
                       MAX(CAST(p.puede_editar AS INT)) AS puede_editar,
                      
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 17
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
import json
from sqlalchemy import select, update, delete, and_, func as sql_func
from uuid import UUID

from app.infrastructure.database.tables_modulos import ModuloRolPlantillaTable, ModuloTable
from app.infrastructure.database.queries_async import execute_query, execute_insert, execute_update
fro
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 21
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.infrastructure.database.tables_modulos import ModuloRolPlantillaTable, ModuloTable
from app.infrastructure.database.queries_async import execute_query, execute_insert, execute_update
from app.core.exceptions import (
    ValidationError,
    ConflictError,
    NotFoundError,
    ServiceErro
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 31
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.modules.modulos.presentation.schemas import (
    ModuloRolPlantillaCreate, ModuloRolPlantillaUpdate, ModuloRolPlantillaRead
)
from app.infrastructure.database.connection_async import DatabaseConnection

logger = logging.getLogger(__name__)


class ModuloRolPlantillaService(BaseService):
  
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 66
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
        # Preparar datos para inserci√≥n
        insert_data = {
            'modulo_id': plantilla_data.modulo_id,
            'nombre_rol': plantilla_data.nombre_rol,
            'descripcion': plantilla_data.descripcion,
            'nivel_acceso': plantilla_data.nivel_acceso,
            'permiso
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 136
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    @BaseService.handle_service_errors
    async def actualizar_plantilla(plantilla_id: UUID, plantilla_data: ModuloRolPlantillaUpdate) -> ModuloRolPlantillaRead:
        """
        Actualiza una plantilla existente.
        Solo accesible para SUPER ADMIN.
        """
        logger.info(f"Actuali
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 151
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

        update_dict = plantilla_data.model_dump(exclude_unset=True)
        
        # Validar JSON de permisos si se est√° actualizando
        if 'permisos_json' in update_dict and update_dict['permisos_json']:
            await ModuloRolPlantillaService.validar_json_permisos(
                upda
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 154
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
        # Validar JSON de permisos si se est√° actualizando
        if 'permisos_json' in update_dict and update_dict['permisos_json']:
            await ModuloRolPlantillaService.validar_json_permisos(
                update_dict['permisos_json'],
                plantilla_existente.modulo_id
      
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 156
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
            await ModuloRolPlantillaService.validar_json_permisos(
                update_dict['permisos_json'],
                plantilla_existente.modulo_id
            )

        if not update_dict:
            raise ValidationError(
                detail="No se proporcionaron campos para actual
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 160
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

        if not update_dict:
            raise ValidationError(
                detail="No se proporcionaron campos para actualizar.",
                internal_code="NO_UPDATE_FIELDS"
            )

        stmt = (
            update(ModuloRolPlantillaTable)
            .where(ModuloRolPlantillaTab
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 163
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                detail="No se proporcionaron campos para actualizar.",
                internal_code="NO_UPDATE_FIELDS"
            )

        stmt = (
            update(ModuloRolPlantillaTable)
            .where(ModuloRolPlantillaTable.c.plantilla_id == plantilla_id)
            .values(**update_
--------------------------------------------------------------------------------

Archivo: app\modules\modulos\application\services\modulo_rol_plantilla_service.py
L√≠nea: 182
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                detail="No se pudo actualizar la plantilla.",
                internal_code="PLANTILLA_UPDATE_FAILED"
            )

        logger.info(f"Plantilla ID {plantilla_id} actualizada exitosamente.")
        return ModuloRolPlantillaRead(**resultado)

    @staticmethod
    @BaseService.ha
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 24
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
# Importar Schemas
from app.modules.rbac.presentation.schemas import RolCreate, RolUpdate, RolRead, PaginatedRolResponse, PermisoRead, PermisoUpdatePayload

# Importar Servicio
from app.modules.rbac.application.services.rol_service import RolService

# Importar Excepciones personalizadas
from app.co
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 236
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    Devuelve una lista de todos los roles activos **del cliente actual y roles del sistema**.
    Ideal para selectores y listas desplegables en interfaces de usuario.

    **Permisos requeridos:**
    - Rol 'Administrador'

    **Respuestas:**
    - 200: Lista simple recuperada exitosamente
    - 5
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 236
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    Devuelve una lista de todos los roles activos **del cliente actual y roles del sistema**.
    Ideal para selectores y listas desplegables en interfaces de usuario.

    **Permisos requeridos:**
    - Rol 'Administrador'

    **Respuestas:**
    - 200: Lista simple recuperada exitosamente
    - 5
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 377
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
)
async def update_rol(
    rol_id: UUID = Path(..., description="ID del rol"),
    rol_in: RolUpdate = Body(...),
    current_user: Any = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente un rol existente **del cliente del usuario**.

    Args:
        rol_id: Id
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 377
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
)
async def update_rol(
    rol_id: UUID = Path(..., description="ID del rol"),
    rol_in: RolUpdate = Body(...),
    current_user: Any = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente un rol existente **del cliente del usuario**.

    Args:
        rol_id: Id
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 379
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    rol_id: UUID = Path(..., description="ID del rol"),
    rol_in: RolUpdate = Body(...),
    current_user: Any = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente un rol existente **del cliente del usuario**.

    Args:
        rol_id: Identificador √∫nico del ro
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 379
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    rol_id: UUID = Path(..., description="ID del rol"),
    rol_in: RolUpdate = Body(...),
    current_user: Any = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente un rol existente **del cliente del usuario**.

    Args:
        rol_id: Identificador √∫nico del ro
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 398
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    
    update_data = rol_in.model_dump(exclude_unset=True)
    if not update_data:
         logger.warning(f"Intento de actualizar rol {rol_id} sin datos")
         raise HTTPException(
             status_code=status.HTTP_400_BAD_REQUEST,
             detail="Se debe proporcionar al menos un camp
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 399
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    update_data = rol_in.model_dump(exclude_unset=True)
    if not update_data:
         logger.warning(f"Intento de actualizar rol {rol_id} sin datos")
         raise HTTPException(
             status_code=status.HTTP_400_BAD_REQUEST,
             detail="Se debe proporcionar al menos un campo par
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 433
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
# ----------------------------------------------------------------------
@router.delete(
    "/{rol_id}/",
    response_model=RolRead,
    summary="Desactivar un rol (Borrado L√≥gico)",
    description="""
    Desactiva un rol estableciendo su estado 'es_activo' a False (borrado l√≥gico).

    **Permi
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 495
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    except Exception as e:
        logger.exception(f"Error inesperado en endpoint DELETE /roles/{rol_id}/")
        raise HTTPException(status_code=status.HTTP_500_INTERNAL_SERVER_ERROR, detail="Error interno del servidor al desactivar el rol.")


# -------------------------------------------------
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 653
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
)
async def update_permisos_rol(
    rol_id: UUID = Path(..., title="ID del Rol", description="El ID del rol cuyos permisos se actualizar√°n"),
    payload: PermisoUpdatePayload = Body(..., description="Objeto que contiene la lista completa de los nuevos permisos para el rol"),
    current_user: Any 
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 655
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    rol_id: UUID = Path(..., title="ID del Rol", description="El ID del rol cuyos permisos se actualizar√°n"),
    payload: PermisoUpdatePayload = Body(..., description="Objeto que contiene la lista completa de los nuevos permisos para el rol"),
    current_user: Any = Depends(get_current_active_user
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints.py
L√≠nea: 655
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    rol_id: UUID = Path(..., title="ID del Rol", description="El ID del rol cuyos permisos se actualizar√°n"),
    payload: PermisoUpdatePayload = Body(..., description="Objeto que contiene la lista completa de los nuevos permisos para el rol"),
    current_user: Any = Depends(get_current_active_user
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints_permisos.py
L√≠nea: 24
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
# ‚úÖ Importar Schemas actualizados desde schemas.py
from app.modules.rbac.presentation.schemas import PermisoRead, PermisoBase, RolMenuPermisoRead, RolMenuPermisoUpdate

# ‚úÖ Schema para crear/actualizar permisos sin menu_id (viene de la URL)
class PermisoCreateUpdate(BaseModel):
    """
    Schema pa
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints_permisos.py
L√≠nea: 98
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    menu_id: UUID = Path(..., description="ID del men√∫"),
    permisos_in: PermisoCreateUpdate = Body(...),
    current_user: Any = Depends(get_current_active_user)
):
    """
    Asigna o actualiza los permisos `puede_ver`, `puede_editar`, `puede_eliminar`
    para el `rol_id` sobre el `menu_id`.


--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints_permisos.py
L√≠nea: 292
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
# ----------------------------------------------------------------------
@router.delete(
    "/roles/{rol_id}/menus/{menu_id}/",
    response_model=Dict[str, str],
    summary="Revocar el permiso de un rol sobre un men√∫",
    description="""
    Elimina (revoca) la asignaci√≥n de permisos entre un ro
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\endpoints_permisos.py
L√≠nea: 343
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    except Exception as e:
        logger.exception(f"Error inesperado en endpoint DELETE /permisos/roles/{rol_id}/menus/{menu_id}/")
        raise HTTPException(status_code=status.HTTP_500_INTERNAL_SERVER_ERROR, detail="Error interno del servidor al revocar el permiso.")
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\schemas.py
L√≠nea: 255
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

class RolUpdate(BaseModel):
    """
    Schema para actualizaci√≥n parcial de roles.
    
    Todos los campos son opcionales.
    """
    
    nombre: Optional[str] = Field(
        None,
        min_length=3,
        max_length=50,
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\schemas.py
L√≠nea: 473
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

class PermisoUpdatePayload(BaseModel):
    """
    Schema para actualizaci√≥n masiva de permisos de un rol.
    """
    
    permisos: List[PermisoBase] = Field(
        ...,
        description="Lista completa de permisos para asignar al rol",
        examples=[[
            {"menu_id": 1, "puede_v
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\schemas.py
L√≠nea: 648
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

class RolMenuPermisoUpdate(BaseModel):
    """
    Schema para actualizaci√≥n parcial de permisos rol-men√∫.
    
    ‚úÖ ACTUALIZADO: Incluye todos los permisos extendidos de la tabla rol_menu_permiso.
    
    Todos los campos son opcionales y solo se validan los que se proporcionen.
    Dise√±ado esp
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\schemas.py
L√≠nea: 648
Tabla: rol_menu_permiso
Tipo: sql_string
Issue: Query SQL directa toca tabla rol_menu_permiso sin cliente_id visible
Contexto:

class RolMenuPermisoUpdate(BaseModel):
    """
    Schema para actualizaci√≥n parcial de permisos rol-men√∫.
    
    ‚úÖ ACTUALIZADO: Incluye todos los permisos extendidos de la tabla rol_menu_permiso.
    
    Todos los campos son opcionales y solo se validan los que se proporcionen.
    Dise√±ado esp
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\schemas.py
L√≠nea: 714
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    @model_validator(mode='after')
    def validar_consistencia_permisos_parciales(self) -> 'RolMenuPermisoUpdate':
        """
        Valida consistencias en actualizaciones parciales de permisos.
        
        Aplica las mismas reglas de negocio que el validador base, pero
        considerando
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\presentation\schemas.py
L√≠nea: 835
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

class RolMenuPermisoBulkUpdate(BaseModel):
    """
    Schema para actualizaci√≥n masiva de permisos rol-men√∫.
    
    Utilizado en operaciones que actualizan m√∫ltiples permisos
    simult√°neamente para un rol espec√≠fico.
    """
    
    permisos: dict[UUID, Dict[str, bool]] = Field(
        ...,

--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 12
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.infrastructure.database.queries_async import (
    execute_query, execute_insert, execute_update
)
from app.infrastructure.database.sql_constants import (
    COUNT_ROLES_PAGINATED, SELECT_ROLES_PAGINATED,
    DEACTIVATE_ROL, REACTIVATE_ROL,
    SELECT_PERMISOS_POR_ROL, DELETE_PERMISOS_POR_
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 15
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.infrastructure.database.sql_constants import (
    COUNT_ROLES_PAGINATED, SELECT_ROLES_PAGINATED,
    DEACTIVATE_ROL, REACTIVATE_ROL,
    SELECT_PERMISOS_POR_ROL, DELETE_PERMISOS_POR_ROL, INSERT_PERMISO_ROL
)

# üìã SCHEMAS
from app.modules.rbac.presentation.schemas import (
    RolRead, Pagi
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 17
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    DEACTIVATE_ROL, REACTIVATE_ROL,
    SELECT_PERMISOS_POR_ROL, DELETE_PERMISOS_POR_ROL, INSERT_PERMISO_ROL
)

# üìã SCHEMAS
from app.modules.rbac.presentation.schemas import (
    RolRead, PaginatedRolResponse, PermisoRead, PermisoUpdatePayload, PermisoBase
)

# üö® EXCEPCIONES - Nuevo sistema de mane
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 22
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.modules.rbac.presentation.schemas import (
    RolRead, PaginatedRolResponse, PermisoRead, PermisoUpdatePayload, PermisoBase
)

# üö® EXCEPCIONES - Nuevo sistema de manejo de errores
from app.core.exceptions import (
    ValidationError, NotFoundError, ConflictError, ServiceError, DatabaseErr
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 718
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                    if field != 'es_activo' or rol_data[field] != rol_actual.get(field):
                        update_parts.append(f"{db_field} = ?")
                        params.append(rol_data[field])
                        campos_actualizados = True

            if not campos_actualizados:
 
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 738
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
            # ‚úÖ FASE 2: Usar await
            result = await execute_update(update_query, tuple(params))

            if not result:
                logger.error(f"La actualizaci√≥n del rol ID {rol_id} no devolvi√≥ resultados")
                raise ServiceError(
                    status_code=500,

--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 745
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                    detail="Error al actualizar el rol",
                    internal_code="ROLE_UPDATE_FAILED"
                )

            # üîÑ CONVERTIR TIPOS DE DATOS
            if 'es_activo' in result and isinstance(result['es_activo'], int):
                result['es_activo'] = bool(result
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 762
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                detail="Error de base de datos al actualizar rol",
                internal_code="ROLE_UPDATE_DB_ERROR"
            )
        except Exception as e:
            logger.exception(f"Error inesperado actualizando rol {rol_id}: {str(e)}")
            raise ServiceError(
                s
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 769
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                detail="Error interno al actualizar rol",
                internal_code="ROLE_UPDATE_UNEXPECTED_ERROR"
            )

    @staticmethod
    @BaseService.handle_service_errors
    async def desactivar_rol(rol_id: UUID) -> Dict:
        """
        Desactiva un rol (borrado l√≥gico).
  
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 1090
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    @BaseService.handle_service_errors
    async def actualizar_permisos_rol(rol_id: UUID, permisos_payload: PermisoUpdatePayload) -> None:
        """
        Actualiza TODOS los permisos de un rol en una transacci√≥n at√≥mica.
        
        üîÑ ACTUALIZACI√ìN AT√ìMICA:
        - Elimina permisos exis
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 1096
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
        - Elimina permisos existentes
        - Inserta nuevos permisos
        - Transacci√≥n para garantizar consistencia
        
        Args:
            rol_id: ID del rol a actualizar
            permisos_payload: Payload con la nueva lista de permisos
            
        Raises:
            
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 1200
Tabla: rol
Tipo: text()
Issue: Query con text() toca tabla rol sin cliente_id visible
Contexto:
                            }
                            await session.execute(text(insert_query), params)
                            insert_count += 1
                        logger.debug(f"Insertados {insert_count} permisos para rol {rol_id}")
                    else:
                        lo
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 1200
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                            }
                            await session.execute(text(insert_query), params)
                            insert_count += 1
                        logger.debug(f"Insertados {insert_count} permisos para rol {rol_id}")
                    else:
                        lo
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 1201
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                            await session.execute(text(insert_query), params)
                            insert_count += 1
                        logger.debug(f"Insertados {insert_count} permisos para rol {rol_id}")
                    else:
                        logger.debug(f"No hay nuevos per
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 1202
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                            insert_count += 1
                        logger.debug(f"Insertados {insert_count} permisos para rol {rol_id}")
                    else:
                        logger.debug(f"No hay nuevos permisos para insertar para rol {rol_id}")
                    
                 
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 1204
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                    else:
                        logger.debug(f"No hay nuevos permisos para insertar para rol {rol_id}")
                    
                    # Commit de la transacci√≥n
                    await session.commit()
                    logger.info(f"Permisos actualizados exitosament
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 1222
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                detail="Error de base de datos al actualizar permisos",
                internal_code="ROLE_PERMISSIONS_UPDATE_DB_ERROR"
            )
        except Exception as e:
            logger.exception(f"Error inesperado en actualizar_permisos_rol: {e}")
            raise ServiceError(
    
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\application\services\rol_service.py
L√≠nea: 1229
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                detail="Error interno al actualizar permisos",
                internal_code="ROLE_PERMISSIONS_UPDATE_UNEXPECTED_ERROR"
            )
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\infrastructure\repositories\permiso_repository.py
L√≠nea: 67
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
        query = """
            SELECT 
                p.*,
                rp.es_activo as asignacion_activa
            FROM permiso p
            INNER JOIN rol_permiso rp ON p.permiso_id = rp.permiso_id
            WHERE rp.rol_id = :rol_id
            AND rp.es_activo = 1
            AND p.es_
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\infrastructure\repositories\permiso_repository.py
L√≠nea: 103
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
        query = """
            SELECT DISTINCT
                p.*
            FROM permiso p
            INNER JOIN rol_permiso rp ON p.permiso_id = rp.permiso_id
            INNER JOIN rol r ON rp.rol_id = r.rol_id
            INNER JOIN usuario_rol ur ON r.rol_id = ur.rol_id
            WHERE ur
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\infrastructure\repositories\permiso_repository.py
L√≠nea: 103
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        query = """
            SELECT DISTINCT
                p.*
            FROM permiso p
            INNER JOIN rol_permiso rp ON p.permiso_id = rp.permiso_id
            INNER JOIN rol r ON rp.rol_id = r.rol_id
            INNER JOIN usuario_rol ur ON r.rol_id = ur.rol_id
            WHERE ur
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\infrastructure\repositories\permiso_repository.py
L√≠nea: 103
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
        query = """
            SELECT DISTINCT
                p.*
            FROM permiso p
            INNER JOIN rol_permiso rp ON p.permiso_id = rp.permiso_id
            INNER JOIN rol r ON rp.rol_id = r.rol_id
            INNER JOIN usuario_rol ur ON r.rol_id = ur.rol_id
            WHERE ur
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\infrastructure\repositories\rol_repository.py
L√≠nea: 99
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
        query_permisos = """
            SELECT 
                p.permiso_id,
                p.codigo_permiso,
                p.nombre as nombre_permiso,
                p.descripcion as descripcion_permiso,
                p.es_activo as permiso_activo,
                rp.es_activo as asignacion
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\infrastructure\repositories\rol_repository.py
L√≠nea: 144
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
        query = f"""
            SELECT 
                r.*,
                ur.fecha_asignacion,
                ur.es_activo as asignacion_activa
            FROM {self.table_name} r
            INNER JOIN usuario_rol ur ON r.rol_id = ur.rol_id
            WHERE ur.usuario_id = :usuario_id
      
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\infrastructure\repositories\rol_repository.py
L√≠nea: 144
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        query = f"""
            SELECT 
                r.*,
                ur.fecha_asignacion,
                ur.es_activo as asignacion_activa
            FROM {self.table_name} r
            INNER JOIN usuario_rol ur ON r.rol_id = ur.rol_id
            WHERE ur.usuario_id = :usuario_id
      
--------------------------------------------------------------------------------

Archivo: app\modules\rbac\infrastructure\repositories\rol_repository.py
L√≠nea: 144
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
        query = f"""
            SELECT 
                r.*,
                ur.fecha_asignacion,
                ur.es_activo as asignacion_activa
            FROM {self.table_name} r
            INNER JOIN usuario_rol ur ON r.rol_id = ur.rol_id
            WHERE ur.usuario_id = :usuario_id
      
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\presentation\schemas.py
L√≠nea: 261
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    direccion: str = Field(..., description="Direcci√≥n (push/pull/bidireccional)")
    operacion: str = Field(..., description="Operaci√≥n (create/update/delete)")
    estado: str = Field(..., description="Estado (exitoso/fallido/parcial/pendiente)")
    mensaje_error: Optional[str] = Field(None, des
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 8
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
# ‚úÖ FASE 2: Migrar a queries_async
from app.infrastructure.database.queries_async import execute_insert
from app.infrastructure.database.sql_constants import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)
from app.infrastructure.database.connection_async import DatabaseConnect
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 8
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
# ‚úÖ FASE 2: Migrar a queries_async
from app.infrastructure.database.queries_async import execute_insert
from app.infrastructure.database.sql_constants import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)
from app.infrastructure.database.connection_async import DatabaseConnect
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 8
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
# ‚úÖ FASE 2: Migrar a queries_async
from app.infrastructure.database.queries_async import execute_insert
from app.infrastructure.database.sql_constants import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)
from app.infrastructure.database.connection_async import DatabaseConnect
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 10
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
from app.infrastructure.database.sql_constants import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)
from app.infrastructure.database.connection_async import DatabaseConnection
from app.core.exceptions import DatabaseError
from app.core.application.base_service import BaseServ
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 10
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
from app.infrastructure.database.sql_constants import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)
from app.infrastructure.database.connection_async import DatabaseConnection
from app.core.exceptions import DatabaseError
from app.core.application.base_service import BaseServ
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 10
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.infrastructure.database.sql_constants import (
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)
from app.infrastructure.database.connection_async import DatabaseConnection
from app.core.exceptions import DatabaseError
from app.core.application.base_service import BaseServ
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 11
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)
from app.infrastructure.database.connection_async import DatabaseConnection
from app.core.exceptions import DatabaseError
from app.core.application.base_service import BaseService
from sqlalchemy import text

logger = logging.getLog
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 11
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)
from app.infrastructure.database.connection_async import DatabaseConnection
from app.core.exceptions import DatabaseError
from app.core.application.base_service import BaseService
from sqlalchemy import text

logger = logging.getLog
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 11
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    INSERT_AUTH_AUDIT_LOG,
    INSERT_LOG_SINCRONIZACION_USUARIO,
)
from app.infrastructure.database.connection_async import DatabaseConnection
from app.core.exceptions import DatabaseError
from app.core.application.base_service import BaseService
from sqlalchemy import text

logger = logging.getLog
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 120
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
            # ‚úÖ FASE 4B: Usar par√°metros nombrados directamente (ya est√°n en la constante)
            query = INSERT_AUTH_AUDIT_LOG

            # ‚úÖ FASE 2: Usar await con text().bindparams()
            # ‚úÖ CORRECCI√ìN: auth_audit_log existe tanto en BD central como en BD dedicada
            # Par
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 120
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            # ‚úÖ FASE 4B: Usar par√°metros nombrados directamente (ya est√°n en la constante)
            query = INSERT_AUTH_AUDIT_LOG

            # ‚úÖ FASE 2: Usar await con text().bindparams()
            # ‚úÖ CORRECCI√ìN: auth_audit_log existe tanto en BD central como en BD dedicada
            # Par
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 232
Tabla: log_sincronizacion_usuario
Tipo: text()
Issue: Query con text() toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:

            # ‚úÖ FASE 4B: Usar par√°metros nombrados con text().bindparams()
            result = await execute_insert(
                text(INSERT_LOG_SINCRONIZACION_USUARIO).bindparams(
                    cliente_origen_id=cliente_origen_id,
                    cliente_destino_id=cliente_destino_i
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 232
Tabla: usuario
Tipo: text()
Issue: Query con text() toca tabla usuario sin cliente_id visible
Contexto:

            # ‚úÖ FASE 4B: Usar par√°metros nombrados con text().bindparams()
            result = await execute_insert(
                text(INSERT_LOG_SINCRONIZACION_USUARIO).bindparams(
                    cliente_origen_id=cliente_origen_id,
                    cliente_destino_id=cliente_destino_i
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 233
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
            # ‚úÖ FASE 4B: Usar par√°metros nombrados con text().bindparams()
            result = await execute_insert(
                text(INSERT_LOG_SINCRONIZACION_USUARIO).bindparams(
                    cliente_origen_id=cliente_origen_id,
                    cliente_destino_id=cliente_destino_id
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 233
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            # ‚úÖ FASE 4B: Usar par√°metros nombrados con text().bindparams()
            result = await execute_insert(
                text(INSERT_LOG_SINCRONIZACION_USUARIO).bindparams(
                    cliente_origen_id=cliente_origen_id,
                    cliente_destino_id=cliente_destino_id
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 234
Tabla: log_sincronizacion_usuario
Tipo: text()
Issue: Query con text() toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
            result = await execute_insert(
                text(INSERT_LOG_SINCRONIZACION_USUARIO).bindparams(
                    cliente_origen_id=cliente_origen_id,
                    cliente_destino_id=cliente_destino_id,
                    usuario_id=usuario_id,
                    tipo_sincr
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 234
Tabla: usuario
Tipo: text()
Issue: Query con text() toca tabla usuario sin cliente_id visible
Contexto:
            result = await execute_insert(
                text(INSERT_LOG_SINCRONIZACION_USUARIO).bindparams(
                    cliente_origen_id=cliente_origen_id,
                    cliente_destino_id=cliente_destino_id,
                    usuario_id=usuario_id,
                    tipo_sincr
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 234
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
            result = await execute_insert(
                text(INSERT_LOG_SINCRONIZACION_USUARIO).bindparams(
                    cliente_origen_id=cliente_origen_id,
                    cliente_destino_id=cliente_destino_id,
                    usuario_id=usuario_id,
                    tipo_sincr
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\audit_service.py
L√≠nea: 234
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            result = await execute_insert(
                text(INSERT_LOG_SINCRONIZACION_USUARIO).bindparams(
                    cliente_origen_id=cliente_origen_id,
                    cliente_destino_id=cliente_destino_id,
                    usuario_id=usuario_id,
                    tipo_sincr
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\superadmin_auditoria_service.py
L√≠nea: 308
Tabla: auth_audit_log
Tipo: sql_string
Issue: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
Contexto:
        query = """
        SELECT 
            a.*,
            u.nombre_usuario,
            u.correo
        FROM dbo.auth_audit_log a
        LEFT JOIN dbo.usuario u ON a.usuario_id = u.usuario_id
        WHERE a.log_id = :log_id
        """
        
        # ‚úÖ CORRECCI√ìN: L√≥gica optimizada par
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\superadmin_auditoria_service.py
L√≠nea: 308
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        query = """
        SELECT 
            a.*,
            u.nombre_usuario,
            u.correo
        FROM dbo.auth_audit_log a
        LEFT JOIN dbo.usuario u ON a.usuario_id = u.usuario_id
        WHERE a.log_id = :log_id
        """
        
        # ‚úÖ CORRECCI√ìN: L√≥gica optimizada par
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\superadmin_auditoria_service.py
L√≠nea: 767
Tabla: log_sincronizacion_usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
Contexto:
        data_query = f"""
        SELECT 
            l.*,
            u.nombre_usuario,
            u.correo,
            ue.nombre_usuario as ejecutor_nombre_usuario,
            ue.correo as ejecutor_correo
        FROM dbo.log_sincronizacion_usuario l
        LEFT JOIN dbo.usuario u ON l.usuario
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\superadmin_auditoria_service.py
L√≠nea: 767
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        data_query = f"""
        SELECT 
            l.*,
            u.nombre_usuario,
            u.correo,
            ue.nombre_usuario as ejecutor_nombre_usuario,
            ue.correo as ejecutor_correo
        FROM dbo.log_sincronizacion_usuario l
        LEFT JOIN dbo.usuario u ON l.usuario
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\superadmin_usuario_service.py
L√≠nea: 335
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
            query = """
            SELECT 
                r.rol_id,
                r.nombre,
                r.codigo_rol,
                r.nivel_acceso,
                r.es_rol_sistema,
                ur.fecha_asignacion,
                ur.es_activo
            FROM dbo.rol r
            INN
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\superadmin_usuario_service.py
L√≠nea: 335
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            query = """
            SELECT 
                r.rol_id,
                r.nombre,
                r.codigo_rol,
                r.nivel_acceso,
                r.es_rol_sistema,
                ur.fecha_asignacion,
                ur.es_activo
            FROM dbo.rol r
            INN
--------------------------------------------------------------------------------

Archivo: app\modules\superadmin\application\services\superadmin_usuario_service.py
L√≠nea: 335
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
            query = """
            SELECT 
                r.rol_id,
                r.nombre,
                r.codigo_rol,
                r.nivel_acceso,
                r.es_rol_sistema,
                ur.fecha_asignacion,
                ur.es_activo
            FROM dbo.rol r
            INN
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\presentation\schemas.py
L√≠nea: 938
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

class ConexionUpdate(BaseModel):
    """
    Esquema para la actualizaci√≥n parcial de una conexi√≥n.
    Todos los campos son opcionales, incluyendo credenciales.
    """
    servidor: Optional[str] = Field(None, max_length=255)
    puerto: Optional[int] = None
    nombre_bd: Optional[str] = Field(N
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\presentation\schemas.py
L√≠nea: 1121
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

class ModuloActivoUpdate(BaseModel):
    """
    Esquema para la actualizaci√≥n parcial de un m√≥dulo activo.
    Permite modificar configuraciones y l√≠mites sin cambiar el estado de activaci√≥n.
    """
    configuracion_json: Optional[Dict[str, Any]] = None
    limite_usuarios: Optional[int] = None

--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 227
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.servidor,
            INSERTED.puerto,
            INSERTED.nombre_bd,
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            IN
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 228
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.puerto,
            INSERTED.nombre_bd,
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
      
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 229
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.nombre_bd,
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 230
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
            INSERTED.es_solo_le
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 234
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,

--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 235
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ult
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 236
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.max_pool_size,
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_c
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 237
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 238
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.cr
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 239
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        VALUES ({', '.jo
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 240
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        VALUES ({', '.join(['?'] * len(fields))})
      
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 241
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        VALUES ({', '.join(['?'] * len(fields))})
        """

        # ‚úÖ FASE 2: Usar await
        
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 242
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        VALUES ({', '.join(['?'] * len(fields))})
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await execute_insert(qu
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 243
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        VALUES ({', '.join(['?'] * len(fields))})
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await execute_insert(query, tuple(params), connection_type=Datab
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 244
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        VALUES ({', '.join(['?'] * len(fields))})
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await execute_insert(query, tuple(params), connection_type=DatabaseConnection.ADMIN)
        if not r
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 284
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        # Construir query din√°mica
        update_fields = []
        params = []
        
        for field, value in conexion_data.dict(exclude_unset=True).items():
            if value is not None and field not in ['usuario', 'password']:
                update_fields.append(f"{field} = ?")
     
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 289
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            if value is not None and field not in ['usuario', 'password']:
                update_fields.append(f"{field} = ?")
                params.append(value)
                
        # Manejar actualizaci√≥n de credenciales
        if conexion_data.usuario or conexion_data.password:
          
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 298
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            )
            update_fields.append("usuario_encriptado = ?")
            params.append(credenciales_encriptadas["usuario_encriptado"])
            update_fields.append("password_encriptado = ?")
            params.append(credenciales_encriptadas["password_encriptado"])
                
 
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 300
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            params.append(credenciales_encriptadas["usuario_encriptado"])
            update_fields.append("password_encriptado = ?")
            params.append(credenciales_encriptadas["password_encriptado"])
                
        if not update_fields:
            raise ValidationError(
         
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 318
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.servidor,
            INSERTED.puerto,
            INSERTED.nombre_bd,
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            IN
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 319
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.puerto,
            INSERTED.nombre_bd,
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
      
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 320
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.nombre_bd,
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 321
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
            INSERTED.es_solo_le
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 325
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,

--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 326
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ult
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 327
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.max_pool_size,
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_c
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 328
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 329
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.cr
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 330
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_i
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 331
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_id = ?
        """

        # ‚úÖ F
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 332
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_id = ?
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await ex
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 333
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_id = ?
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await execute_update(query, tuple(params), 
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 334
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_id = ?
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await execute_update(query, tuple(params), connection_type=DatabaseConnection.ADMIN)
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 335
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_id = ?
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await execute_update(query, tuple(params), connection_type=DatabaseConnection.ADMIN)
        if not resultado:
          
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 417
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.servidor,
            INSERTED.puerto,
            INSERTED.nombre_bd,
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            IN
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 418
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.puerto,
            INSERTED.nombre_bd,
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
      
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 419
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.nombre_bd,
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 420
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.usuario_encriptado,
            INSERTED.password_encriptado,
            INSERTED.connection_string_encriptado,
            INSERTED.tipo_bd,
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
            INSERTED.es_solo_le
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 424
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.usa_ssl,
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,

--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 425
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.timeout_segundos,
            INSERTED.max_pool_size,
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ult
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 426
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.max_pool_size,
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_c
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 427
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.es_solo_lectura,
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 428
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.es_conexion_principal,
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.cr
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 429
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.es_activo,
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_i
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 430
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.ultima_conexion_exitosa,
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_id = ?
        """

        # ‚úÖ F
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 431
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.ultimo_error,
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_id = ?
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await ex
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 432
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.fecha_ultimo_error,
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_id = ?
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await execute_update(query, (conexion_id,),
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 433
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.fecha_creacion,
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_id = ?
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await execute_update(query, (conexion_id,), connection_type=DatabaseConnection.ADMIN
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\conexion_service.py
L√≠nea: 434
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.fecha_actualizacion,
            INSERTED.creado_por_usuario_id
        WHERE conexion_id = ?
        """

        # ‚úÖ FASE 2: Usar await
        resultado = await execute_update(query, (conexion_id,), connection_type=DatabaseConnection.ADMIN)
        if not resultado:
         
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\modulo_activo_service.py
L√≠nea: 268
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            
            query_update = """
            UPDATE cliente_modulo_activo
            SET esta_activo = 1,
                fecha_vencimiento = :fecha_vencimiento,
                configuracion_json = :configuracion_json,
                limite_usuarios = :limite_usuarios,
                
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\modulo_activo_service.py
L√≠nea: 269
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            query_update = """
            UPDATE cliente_modulo_activo
            SET esta_activo = 1,
                fecha_vencimiento = :fecha_vencimiento,
                configuracion_json = :configuracion_json,
                limite_usuarios = :limite_usuarios,
                limite_regist
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\modulo_activo_service.py
L√≠nea: 327
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                INSERTED.modulo_id,
                INSERTED.esta_activo,
                INSERTED.fecha_activacion,
                INSERTED.fecha_vencimiento,
                INSERTED.configuracion_json,
                INSERTED.limite_usuarios,
                INSERTED.limite_registros
          
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\modulo_activo_service.py
L√≠nea: 328
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                INSERTED.esta_activo,
                INSERTED.fecha_activacion,
                INSERTED.fecha_vencimiento,
                INSERTED.configuracion_json,
                INSERTED.limite_usuarios,
                INSERTED.limite_registros
            VALUES ({', '.join([f':param_{i}' 
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\modulo_activo_service.py
L√≠nea: 329
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                INSERTED.fecha_activacion,
                INSERTED.fecha_vencimiento,
                INSERTED.configuracion_json,
                INSERTED.limite_usuarios,
                INSERTED.limite_registros
            VALUES ({', '.join([f':param_{i}' for i in range(len(fields))])})
      
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\modulo_activo_service.py
L√≠nea: 411
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.modulo_id,
            INSERTED.esta_activo,
            INSERTED.fecha_activacion,
            INSERTED.fecha_vencimiento,
            INSERTED.configuracion_json,
            INSERTED.limite_usuarios,
            INSERTED.limite_registros
        WHERE cliente_modulo_activo_id
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\modulo_activo_service.py
L√≠nea: 412
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            INSERTED.esta_activo,
            INSERTED.fecha_activacion,
            INSERTED.fecha_vencimiento,
            INSERTED.configuracion_json,
            INSERTED.limite_usuarios,
            INSERTED.limite_registros
        WHERE cliente_modulo_activo_id = :modulo_activo_id
        """
--------------------------------------------------------------------------------

Archivo: app\modules\tenant\application\services\tenant_service.py
L√≠nea: 88
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        query = """
        SELECT 
            cma.cliente_modulo_activo_id,
            cm.modulo_id,
            cm.codigo_modulo,
            cm.nombre,
            cm.descripcion,
            cma.esta_activo,
            cma.fecha_activacion,
            cma.fecha_vencimiento,
            cma.c
--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\endpoints.py
L√≠nea: 28
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    UsuarioCreate,
    UsuarioUpdate,
    UsuarioRead,
    UsuarioReadWithRoles,
    PaginatedUsuarioResponse,
    UsuarioRolRead
)
from app.modules.rbac.presentation.schemas import RolRead

# Importar Servicios
from app.modules.users.application.services.user_service import UsuarioService

--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\endpoints.py
L√≠nea: 28
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    UsuarioCreate,
    UsuarioUpdate,
    UsuarioRead,
    UsuarioReadWithRoles,
    PaginatedUsuarioResponse,
    UsuarioRolRead
)
from app.modules.rbac.presentation.schemas import RolRead

# Importar Servicios
from app.modules.users.application.services.user_service import UsuarioService

--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\endpoints.py
L√≠nea: 310
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    usuario_id: UUID = Path(..., description="ID del usuario"),
    usuario_in: UsuarioUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente un usuario existente.
    
    Args:
        usuario_id: Identific
--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\endpoints.py
L√≠nea: 310
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    usuario_id: UUID = Path(..., description="ID del usuario"),
    usuario_in: UsuarioUpdate = Body(...),
    current_user: UsuarioReadWithRoles = Depends(get_current_active_user)
):
    """
    Endpoint para actualizar parcialmente un usuario existente.
    
    Args:
        usuario_id: Identific
--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\endpoints.py
L√≠nea: 361
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

@router.delete(
    "/{usuario_id}/",
    response_model=dict,
    summary="Eliminar l√≥gicamente un usuario",
    description="""
    Realiza un borrado l√≥gico de un usuario estableciendo 'es_eliminado' a True y 'es_activo' a False.
    
    **Permisos requeridos:**
    - Rol 'Administrador'
    
 
--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\endpoints.py
L√≠nea: 361
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

@router.delete(
    "/{usuario_id}/",
    response_model=dict,
    summary="Eliminar l√≥gicamente un usuario",
    description="""
    Realiza un borrado l√≥gico de un usuario estableciendo 'es_eliminado' a True y 'es_activo' a False.
    
    **Permisos requeridos:**
    - Rol 'Administrador'
    
 
--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\endpoints.py
L√≠nea: 422
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
    except Exception as e:
        logger.exception(f"Error inesperado en endpoint DELETE /usuarios/{usuario_id}/")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Error interno del servidor al eliminar el usuario."
        )


# --- EN
--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\endpoints.py
L√≠nea: 422
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
    except Exception as e:
        logger.exception(f"Error inesperado en endpoint DELETE /usuarios/{usuario_id}/")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Error interno del servidor al eliminar el usuario."
        )


# --- EN
--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\endpoints.py
L√≠nea: 503
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

@router.delete(
    "/{usuario_id}/roles/{rol_id}/",
    response_model=UsuarioRolRead,
    summary="Revocar un rol de un usuario",
    description="""
    Revoca (desactiva) la asignaci√≥n de un rol espec√≠fico para un usuario.
    
    **Permisos requeridos:**
    - Rol 'Administrador'
    
    **P
--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\endpoints.py
L√≠nea: 503
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

@router.delete(
    "/{usuario_id}/roles/{rol_id}/",
    response_model=UsuarioRolRead,
    summary="Revocar un rol de un usuario",
    description="""
    Revoca (desactiva) la asignaci√≥n de un rol espec√≠fico para un usuario.
    
    **Permisos requeridos:**
    - Rol 'Administrador'
    
    **P
--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\schemas.py
L√≠nea: 236
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

class UsuarioUpdate(BaseModel):
    """
    Schema para actualizaci√≥n parcial de usuarios (PATCH).
    
    Todos los campos son opcionales y solo se validan los que se proporcionen.
    """
    
    nombre_usuario: Optional[str] = Field(
        None,
        min_length=3,
        max_length=100,
--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\schemas.py
L√≠nea: 568
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:

class UsuarioRolUpdate(BaseModel):
    """
    Schema para actualizaci√≥n del estado de asignaciones usuario-rol.
    
    Utilizado espec√≠ficamente para activar/desactivar asignaciones
    existentes sin modificar las relaciones fundamentales.
    """
    
    es_activo: bool = Field(
        ...,

--------------------------------------------------------------------------------

Archivo: app\modules\users\presentation\schemas.py
L√≠nea: 568
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:

class UsuarioRolUpdate(BaseModel):
    """
    Schema para actualizaci√≥n del estado de asignaciones usuario-rol.
    
    Utilizado espec√≠ficamente para activar/desactivar asignaciones
    existentes sin modificar las relaciones fundamentales.
    """
    
    es_activo: bool = Field(
        ...,

--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 11
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.infrastructure.database.queries_async import (
    execute_query, execute_insert, execute_update, execute_auth_query
)
from app.infrastructure.database.sql_constants import (
    SELECT_USUARIOS_PAGINATED, COUNT_USUARIOS_PAGINATED
)

# üìã SCHEMAS
from app.modules.users.presentation.schemas i
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 11
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.infrastructure.database.queries_async import (
    execute_query, execute_insert, execute_update, execute_auth_query
)
from app.infrastructure.database.sql_constants import (
    SELECT_USUARIOS_PAGINATED, COUNT_USUARIOS_PAGINATED
)

# üìã SCHEMAS
from app.modules.users.presentation.schemas i
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 14
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
from app.infrastructure.database.sql_constants import (
    SELECT_USUARIOS_PAGINATED, COUNT_USUARIOS_PAGINATED
)

# üìã SCHEMAS
from app.modules.users.presentation.schemas import UsuarioReadWithRoles, PaginatedUsuarioResponse
from app.modules.rbac.presentation.schemas import RolRead

# üîê SEGURIDAD
fr
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 14
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
from app.infrastructure.database.sql_constants import (
    SELECT_USUARIOS_PAGINATED, COUNT_USUARIOS_PAGINATED
)

# üìã SCHEMAS
from app.modules.users.presentation.schemas import UsuarioReadWithRoles, PaginatedUsuarioResponse
from app.modules.rbac.presentation.schemas import RolRead

# üîê SEGURIDAD
fr
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 177
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
            query = """
            SELECT COUNT(*) as is_super_admin
            FROM usuario_rol ur
            INNER JOIN rol r ON ur.rol_id = r.rol_id
            WHERE ur.usuario_id = ? 
              AND ur.es_activo = 1
              AND r.es_activo = 1
              AND r.codigo_rol = 'SUPER
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 177
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            query = """
            SELECT COUNT(*) as is_super_admin
            FROM usuario_rol ur
            INNER JOIN rol r ON ur.rol_id = r.rol_id
            WHERE ur.usuario_id = ? 
              AND ur.es_activo = 1
              AND r.es_activo = 1
              AND r.codigo_rol = 'SUPER
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 177
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
            query = """
            SELECT COUNT(*) as is_super_admin
            FROM usuario_rol ur
            INNER JOIN rol r ON ur.rol_id = r.rol_id
            WHERE ur.usuario_id = ? 
              AND ur.es_activo = 1
              AND r.es_activo = 1
              AND r.codigo_rol = 'SUPER
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 485
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                # Valores por defecto en caso de error
                usuario_completo.update({
                    'access_level': 1,
                    'is_super_admin': False,
                    'user_type': 'user'
                })
            
            logger.info(f"Usuario completo obte
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 485
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                # Valores por defecto en caso de error
                usuario_completo.update({
                    'access_level': 1,
                    'is_super_admin': False,
                    'user_type': 'user'
                })
            
            logger.info(f"Usuario completo obte
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 850
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            # üõ†Ô∏è CONSTRUIR ACTUALIZACI√ìN DIN√ÅMICA
            update_parts = []
            params_update = []
            campos_permitidos = {
                'nombre_usuario', 'correo', 'nombre', 'apellido', 'dni', 'telefono',
                'proveedor_autenticacion', 'es_activo'
            }


--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 851
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            update_parts = []
            params_update = []
            campos_permitidos = {
                'nombre_usuario', 'correo', 'nombre', 'apellido', 'dni', 'telefono',
                'proveedor_autenticacion', 'es_activo'
            }

            campos_actualizados = False
          
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 860
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                if field in usuario_data and usuario_data[field] is not None:
                    update_parts.append(f"{field} = ?")
                    params_update.append(usuario_data[field])
                    campos_actualizados = True

            if not campos_actualizados:
                
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 861
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                    update_parts.append(f"{field} = ?")
                    params_update.append(usuario_data[field])
                    campos_actualizados = True

            if not campos_actualizados:
                logger.info(f"No hay campos v√°lidos para actualizar para usuario ID {usuario_i
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 908
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                detail="Error de base de datos al actualizar usuario",
                internal_code="USER_UPDATE_DB_ERROR"
            )
        except Exception as e:
            logger.exception(f"Error inesperado al actualizar usuario {usuario_id}: {str(e)}")
            raise ServiceError(
    
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1081
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                    get_assignment_query = """
                    SELECT usuario_rol_id, usuario_id, rol_id, fecha_asignacion, es_activo
                    FROM dbo.usuario_rol WHERE usuario_rol_id = ?
                    """
                    # ‚úÖ FASE 2: Usar await
                    final_res
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1081
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                    get_assignment_query = """
                    SELECT usuario_rol_id, usuario_id, rol_id, fecha_asignacion, es_activo
                    FROM dbo.usuario_rol WHERE usuario_rol_id = ?
                    """
                    # ‚úÖ FASE 2: Usar await
                    final_res
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1081
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
                    get_assignment_query = """
                    SELECT usuario_rol_id, usuario_id, rol_id, fecha_asignacion, es_activo
                    FROM dbo.usuario_rol WHERE usuario_rol_id = ?
                    """
                    # ‚úÖ FASE 2: Usar await
                    final_res
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1096
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                    logger.info(f"Reactivando asignaci√≥n existente para usuario {usuario_id}, rol {rol_id}")
                    update_query = """
                    UPDATE dbo.usuario_rol
                    SET es_activo = 1, fecha_asignacion = GETDATE()
                    OUTPUT INSERTED.usuar
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1096
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                    logger.info(f"Reactivando asignaci√≥n existente para usuario {usuario_id}, rol {rol_id}")
                    update_query = """
                    UPDATE dbo.usuario_rol
                    SET es_activo = 1, fecha_asignacion = GETDATE()
                    OUTPUT INSERTED.usuar
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1096
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
                    logger.info(f"Reactivando asignaci√≥n existente para usuario {usuario_id}, rol {rol_id}")
                    update_query = """
                    UPDATE dbo.usuario_rol
                    SET es_activo = 1, fecha_asignacion = GETDATE()
                    OUTPUT INSERTED.usuar
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1097
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                    update_query = """
                    UPDATE dbo.usuario_rol
                    SET es_activo = 1, fecha_asignacion = GETDATE()
                    OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                           INSERTED.fecha_asignacion, INSERT
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1097
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                    update_query = """
                    UPDATE dbo.usuario_rol
                    SET es_activo = 1, fecha_asignacion = GETDATE()
                    OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                           INSERTED.fecha_asignacion, INSERT
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1097
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
                    update_query = """
                    UPDATE dbo.usuario_rol
                    SET es_activo = 1, fecha_asignacion = GETDATE()
                    OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                           INSERTED.fecha_asignacion, INSERT
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1099
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                    SET es_activo = 1, fecha_asignacion = GETDATE()
                    OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                           INSERTED.fecha_asignacion, INSERTED.es_activo
                    WHERE usuario_rol_id = ?
                    """

--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1099
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                    SET es_activo = 1, fecha_asignacion = GETDATE()
                    OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                           INSERTED.fecha_asignacion, INSERTED.es_activo
                    WHERE usuario_rol_id = ?
                    """

--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1099
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
                    SET es_activo = 1, fecha_asignacion = GETDATE()
                    OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                           INSERTED.fecha_asignacion, INSERTED.es_activo
                    WHERE usuario_rol_id = ?
                    """

--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1100
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                    OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                           INSERTED.fecha_asignacion, INSERTED.es_activo
                    WHERE usuario_rol_id = ?
                    """
                    result = execute_update(update_query, (assignmen
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1100
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                    OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                           INSERTED.fecha_asignacion, INSERTED.es_activo
                    WHERE usuario_rol_id = ?
                    """
                    result = execute_update(update_query, (assignmen
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1100
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
                    OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                           INSERTED.fecha_asignacion, INSERTED.es_activo
                    WHERE usuario_rol_id = ?
                    """
                    result = execute_update(update_query, (assignmen
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1103
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                    """
                    result = execute_update(update_query, (assignment['usuario_rol_id'],))
                    if not result:
                        raise ServiceError(
                            status_code=500,
                            detail="Error reactivando la asig
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1103
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                    """
                    result = execute_update(update_query, (assignment['usuario_rol_id'],))
                    if not result:
                        raise ServiceError(
                            status_code=500,
                            detail="Error reactivando la asig
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1103
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
                    """
                    result = execute_update(update_query, (assignment['usuario_rol_id'],))
                    if not result:
                        raise ServiceError(
                            status_code=500,
                            detail="Error reactivando la asig
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1195
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                get_assignment_query = """
                SELECT usuario_rol_id, usuario_id, rol_id, fecha_asignacion, es_activo
                FROM dbo.usuario_rol WHERE usuario_rol_id = ?
                """
                final_result = execute_query(get_assignment_query, (assignment['usuario_
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1195
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                get_assignment_query = """
                SELECT usuario_rol_id, usuario_id, rol_id, fecha_asignacion, es_activo
                FROM dbo.usuario_rol WHERE usuario_rol_id = ?
                """
                final_result = execute_query(get_assignment_query, (assignment['usuario_
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1195
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
                get_assignment_query = """
                SELECT usuario_rol_id, usuario_id, rol_id, fecha_asignacion, es_activo
                FROM dbo.usuario_rol WHERE usuario_rol_id = ?
                """
                final_result = execute_query(get_assignment_query, (assignment['usuario_
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1203
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
            logger.info(f"Desactivando asignaci√≥n para usuario {usuario_id}, rol {rol_id}")
            update_query = """
            UPDATE dbo.usuario_rol
            SET es_activo = 0
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fe
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1203
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            logger.info(f"Desactivando asignaci√≥n para usuario {usuario_id}, rol {rol_id}")
            update_query = """
            UPDATE dbo.usuario_rol
            SET es_activo = 0
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fe
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1203
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
            logger.info(f"Desactivando asignaci√≥n para usuario {usuario_id}, rol {rol_id}")
            update_query = """
            UPDATE dbo.usuario_rol
            SET es_activo = 0
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fe
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1204
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
            update_query = """
            UPDATE dbo.usuario_rol
            SET es_activo = 0
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fecha_asignacion, INSERTED.es_activo
            WHERE usuario_rol_id = ? AND es_activo = 1
  
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1204
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            update_query = """
            UPDATE dbo.usuario_rol
            SET es_activo = 0
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fecha_asignacion, INSERTED.es_activo
            WHERE usuario_rol_id = ? AND es_activo = 1
  
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1204
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
            update_query = """
            UPDATE dbo.usuario_rol
            SET es_activo = 0
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fecha_asignacion, INSERTED.es_activo
            WHERE usuario_rol_id = ? AND es_activo = 1
  
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1206
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
            SET es_activo = 0
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fecha_asignacion, INSERTED.es_activo
            WHERE usuario_rol_id = ? AND es_activo = 1
            """
            
            result = execute_update(upd
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1206
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            SET es_activo = 0
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fecha_asignacion, INSERTED.es_activo
            WHERE usuario_rol_id = ? AND es_activo = 1
            """
            
            result = execute_update(upd
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1206
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
            SET es_activo = 0
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fecha_asignacion, INSERTED.es_activo
            WHERE usuario_rol_id = ? AND es_activo = 1
            """
            
            result = execute_update(upd
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1207
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fecha_asignacion, INSERTED.es_activo
            WHERE usuario_rol_id = ? AND es_activo = 1
            """
            
            result = execute_update(update_query, (assignment['usuari
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1207
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fecha_asignacion, INSERTED.es_activo
            WHERE usuario_rol_id = ? AND es_activo = 1
            """
            
            result = execute_update(update_query, (assignment['usuari
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1207
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
            OUTPUT INSERTED.usuario_rol_id, INSERTED.usuario_id, INSERTED.rol_id,
                   INSERTED.fecha_asignacion, INSERTED.es_activo
            WHERE usuario_rol_id = ? AND es_activo = 1
            """
            
            result = execute_update(update_query, (assignment['usuari
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1211
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
            
            result = execute_update(update_query, (assignment['usuario_rol_id'],))

            if not result:
                logger.warning(f"No se pudo desactivar la asignaci√≥n ID {assignment['usuario_rol_id']}")
                get_assignment_query = """
                SELECT usuar
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1211
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
            
            result = execute_update(update_query, (assignment['usuario_rol_id'],))

            if not result:
                logger.warning(f"No se pudo desactivar la asignaci√≥n ID {assignment['usuario_rol_id']}")
                get_assignment_query = """
                SELECT usuar
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1211
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
            
            result = execute_update(update_query, (assignment['usuario_rol_id'],))

            if not result:
                logger.warning(f"No se pudo desactivar la asignaci√≥n ID {assignment['usuario_rol_id']}")
                get_assignment_query = """
                SELECT usuar
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1216
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                get_assignment_query = """
                SELECT usuario_rol_id, usuario_id, rol_id, fecha_asignacion, es_activo
                FROM dbo.usuario_rol WHERE usuario_rol_id = ?
                """
                final_result = execute_query(get_assignment_query, (assignment['usuario_
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1216
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
                get_assignment_query = """
                SELECT usuario_rol_id, usuario_id, rol_id, fecha_asignacion, es_activo
                FROM dbo.usuario_rol WHERE usuario_rol_id = ?
                """
                final_result = execute_query(get_assignment_query, (assignment['usuario_
--------------------------------------------------------------------------------

Archivo: app\modules\users\application\services\user_service.py
L√≠nea: 1216
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
                get_assignment_query = """
                SELECT usuario_rol_id, usuario_id, rol_id, fecha_asignacion, es_activo
                FROM dbo.usuario_rol WHERE usuario_rol_id = ?
                """
                final_result = execute_query(get_assignment_query, (assignment['usuario_
--------------------------------------------------------------------------------

Archivo: app\modules\users\infrastructure\repositories\user_repository.py
L√≠nea: 102
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
        query_roles = """
            SELECT 
                r.rol_id,
                r.codigo_rol,
                r.nombre as nombre_rol,
                r.descripcion as descripcion_rol,
                r.nivel_acceso,
                r.es_activo as rol_activo,
                ur.fecha_asignaci
--------------------------------------------------------------------------------

Archivo: app\modules\users\infrastructure\repositories\user_repository.py
L√≠nea: 102
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        query_roles = """
            SELECT 
                r.rol_id,
                r.codigo_rol,
                r.nombre as nombre_rol,
                r.descripcion as descripcion_rol,
                r.nivel_acceso,
                r.es_activo as rol_activo,
                ur.fecha_asignaci
--------------------------------------------------------------------------------

Archivo: app\modules\users\infrastructure\repositories\user_repository.py
L√≠nea: 102
Tabla: usuario_rol
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario_rol sin cliente_id visible
Contexto:
        query_roles = """
            SELECT 
                r.rol_id,
                r.codigo_rol,
                r.nombre as nombre_rol,
                r.descripcion as descripcion_rol,
                r.nivel_acceso,
                r.es_activo as rol_activo,
                ur.fecha_asignaci
--------------------------------------------------------------------------------

Archivo: app\modules\users\infrastructure\repositories\user_repository.py
L√≠nea: 133
Tabla: rol
Tipo: sql_string
Issue: Query SQL directa toca tabla rol sin cliente_id visible
Contexto:
                query_permisos = """
                    SELECT 
                        p.permiso_id,
                        p.codigo_permiso,
                        p.nombre as nombre_permiso,
                        p.descripcion as descripcion_permiso,
                        p.es_activo as pe
--------------------------------------------------------------------------------

Archivo: app\modules\users\infrastructure\repositories\user_repository.py
L√≠nea: 183
Tabla: usuario
Tipo: sql_string
Issue: Query SQL directa toca tabla usuario sin cliente_id visible
Contexto:
        query = f"""
            SELECT * FROM {self.table_name}
            WHERE es_eliminado = 0
            AND (
                nombre_usuario LIKE :search_pattern OR
                correo LIKE :search_pattern OR
                nombre LIKE :search_pattern OR
                apellido LIKE :se
--------------------------------------------------------------------------------

================================================================================
Reporte por Archivo
================================================================================


app\api\deps.py: 3 issues
  üî¥ L√≠nea 8: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 8: Query con text() toca tabla usuario sin cliente_id visible
  üü° L√≠nea 131: Query con text() toca tabla usuario (verificar uso de cliente_id)

app\api\deps_backup.py: 10 issues
  üü° L√≠nea 72: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 72: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 74: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 74: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 102: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 102: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 104: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 104: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 131: Query con text() toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 133: Query con text() toca tabla usuario sin cliente_id visible

app\core\auth\user_builder.py: 4 issues
  üü° L√≠nea 34: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 34: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 47: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 84: Query SQL directa toca tabla usuario sin cliente_id visible

app\core\auth\user_context.py: 10 issues
  üî¥ L√≠nea 16: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 16: Query SQL directa toca tabla usuario sin cliente_id visible
  üü° L√≠nea 38: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 38: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 66: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 104: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 186: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 186: Query SQL directa toca tabla usuario sin cliente_id visible
  üü° L√≠nea 237: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 237: Query con text() toca tabla usuario (verificar uso de cliente_id)

app\core\security\query_auditor.py: 3 issues
  üü° L√≠nea 34: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 34: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 352: Query con text() toca tabla usuario (verificar uso de cliente_id)

app\core\tenant\routing.py: 3 issues
  üî¥ L√≠nea 87: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 90: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 343: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\connection_async.py: 2 issues
  üî¥ L√≠nea 12: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 270: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\queries.py: 17 issues
  üî¥ L√≠nea 285: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 285: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 285: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 297: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 319: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 319: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 319: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 577: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 577: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1101: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 1101: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1105: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 1105: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1106: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 1106: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1256: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1257: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\queries\__init__.py: 32 issues
  üî¥ L√≠nea 37: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 44: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 44: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 46: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 46: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 53: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 55: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 58: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 59: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 85: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 85: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 85: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 86: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 86: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 86: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 94: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 99: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 104: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 104: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 106: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 106: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 111: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 113: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 116: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 117: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 129: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 139: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 139: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 139: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 140: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 140: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 140: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\queries\audit\__init__.py: 12 issues
  üî¥ L√≠nea 13: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 13: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 13: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 14: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 14: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 14: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 18: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 18: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 18: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 19: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 19: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 19: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\queries\audit\audit_queries.py: 11 issues
  üî¥ L√≠nea 47: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 47: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 48: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 48: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 65: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 86: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 86: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 86: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 87: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 87: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 87: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\queries\auth\auth_queries.py: 6 issues
  üü° L√≠nea 22: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 22: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 22: Query con text() toca tabla usuario_rol (verificar uso de cliente_id)
  üî¥ L√≠nea 41: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 41: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 41: Query SQL directa toca tabla usuario_rol sin cliente_id visible

app\infrastructure\database\queries\rbac\__init__.py: 8 issues
  üî¥ L√≠nea 13: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 15: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 18: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 19: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 23: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 25: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 28: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 29: Query SQL directa toca tabla rol sin cliente_id visible

app\infrastructure\database\queries\rbac\rbac_queries.py: 8 issues
  üî¥ L√≠nea 7: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 9: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 12: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 13: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 124: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 126: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 129: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 130: Query SQL directa toca tabla rol sin cliente_id visible

app\infrastructure\database\queries\users\__init__.py: 4 issues
  üî¥ L√≠nea 13: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 15: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 22: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 24: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\queries\users\user_queries.py: 11 issues
  üî¥ L√≠nea 7: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 9: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 19: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 19: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 21: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 21: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 88: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 88: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 139: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 279: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 281: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\queries_async.py: 49 issues
  üî¥ L√≠nea 8: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 14: Query SQL directa toca tabla usuario sin cliente_id visible
  üü° L√≠nea 115: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 117: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 185: Query con text() toca tabla rol (verificar uso de cliente_id)
  üî¥ L√≠nea 190: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 207: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 208: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 210: Query con text() toca tabla rol (verificar uso de cliente_id)
  üî¥ L√≠nea 218: Query con text() toca tabla rol sin cliente_id visible
  üü° L√≠nea 287: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 290: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 292: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 294: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 297: Query con text() toca tabla rol (verificar uso de cliente_id)
  üî¥ L√≠nea 327: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 336: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 353: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 354: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 355: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 366: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 400: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 403: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 405: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 407: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 409: Query con text() toca tabla rol sin cliente_id visible
  üü° L√≠nea 452: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 476: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 477: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 478: Query con text() toca tabla rol (verificar uso de cliente_id)
  üî¥ L√≠nea 495: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 495: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 524: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 526: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 528: Query con text() toca tabla rol (verificar uso de cliente_id)
  üî¥ L√≠nea 545: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 577: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 600: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 601: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 602: Query con text() toca tabla rol (verificar uso de cliente_id)
  üî¥ L√≠nea 619: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 619: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 648: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 650: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 652: Query con text() toca tabla rol (verificar uso de cliente_id)
  üî¥ L√≠nea 669: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 698: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 700: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 701: Query con text() toca tabla rol (verificar uso de cliente_id)

app\infrastructure\database\query_builder.py: 1 issues
  üî¥ L√≠nea 16: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\query_optimizer.py: 4 issues
  üî¥ L√≠nea 256: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 256: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 263: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 263: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\sql_constants.py: 19 issues
  üî¥ L√≠nea 8: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 8: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 8: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 9: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 9: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 9: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 11: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 56: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 58: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 69: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 71: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 74: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 75: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 99: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 99: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 99: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 100: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 100: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 100: Query SQL directa toca tabla usuario sin cliente_id visible

app\infrastructure\database\tables.py: 2 issues
  üî¥ L√≠nea 13: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 231: Query SQL directa toca tabla rol sin cliente_id visible

app\infrastructure\database\tables_modulos.py: 1 issues
  üî¥ L√≠nea 196: Query SQL directa toca tabla rol sin cliente_id visible

app\main.py: 1 issues
  üî¥ L√≠nea 179: Query SQL directa toca tabla rol sin cliente_id visible

app\modules\auth\application\services\auth_service.py: 18 issues
  üü° L√≠nea 116: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 116: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 116: Query con text() toca tabla usuario_rol (verificar uso de cliente_id)
  üî¥ L√≠nea 122: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 122: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 122: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üü° L√≠nea 132: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 134: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 142: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 234: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 238: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 267: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 274: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 286: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 293: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 579: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 593: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 754: Query con text() toca tabla usuario (verificar uso de cliente_id)

app\modules\auth\application\services\refresh_token_service.py: 10 issues
  üü° L√≠nea 90: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 110: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 113: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 225: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 267: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 307: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 309: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 344: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 426: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 428: Query con text() toca tabla usuario (verificar uso de cliente_id)

app\modules\auth\infrastructure\repositories\usuario_repository.py: 8 issues
  üü° L√≠nea 69: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 108: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 108: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 141: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 141: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 141: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üü° L√≠nea 162: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 162: Query con text() toca tabla usuario (verificar uso de cliente_id)

app\modules\auth\presentation\endpoints_auth_config.py: 1 issues
  üî¥ L√≠nea 19: Query SQL directa toca tabla rol sin cliente_id visible

app\modules\auth\presentation\endpoints_sso.py: 2 issues
  üî¥ L√≠nea 48: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 178: Query SQL directa toca tabla rol sin cliente_id visible

app\modules\menus\presentation\endpoints.py: 7 issues
  üî¥ L√≠nea 24: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 24: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 309: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 309: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 311: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 311: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 360: Query SQL directa toca tabla rol sin cliente_id visible

app\modules\menus\presentation\endpoints_areas.py: 5 issues
  üî¥ L√≠nea 23: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 213: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 230: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 362: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 419: Query SQL directa toca tabla rol sin cliente_id visible

app\modules\modulos\application\services\cliente_modulo_service.py: 4 issues
  üî¥ L√≠nea 36: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 336: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 564: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 566: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\modulos\application\services\modulo_menu_service.py: 9 issues
  üî¥ L√≠nea 17: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 17: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 22: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 22: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 32: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 927: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 927: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 927: Query SQL directa toca tabla rol_menu_permiso sin cliente_id visible
  üî¥ L√≠nea 927: Query SQL directa toca tabla usuario_rol sin cliente_id visible

app\modules\modulos\application\services\modulo_rol_plantilla_service.py: 11 issues
  üî¥ L√≠nea 17: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 21: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 31: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 66: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 136: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 151: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 154: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 156: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 160: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 163: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 182: Query SQL directa toca tabla rol sin cliente_id visible

app\modules\modulos\presentation\endpoints_cliente_modulo.py: 2 issues
  üî¥ L√≠nea 24: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 24: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\modulos\presentation\endpoints_menus.py: 6 issues
  üî¥ L√≠nea 11: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 11: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 152: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 152: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 167: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 167: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\modulos\presentation\endpoints_modulos.py: 4 issues
  üî¥ L√≠nea 21: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 21: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 293: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 293: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\modulos\presentation\endpoints_plantillas.py: 6 issues
  üî¥ L√≠nea 11: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 11: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 102: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 102: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 117: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 117: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\modulos\presentation\endpoints_secciones.py: 6 issues
  üî¥ L√≠nea 10: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 10: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 100: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 100: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 115: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 115: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\modulos\presentation\schemas.py: 2 issues
  üî¥ L√≠nea 326: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 430: Query SQL directa toca tabla rol sin cliente_id visible

app\modules\rbac\application\services\rol_service.py: 40 issues
  üî¥ L√≠nea 12: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 15: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 17: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 22: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 149: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 222: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 222: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 222: Query con text() toca tabla usuario_rol (verificar uso de cliente_id)
  üü° L√≠nea 242: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 242: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 244: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 244: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 525: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 545: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 547: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 590: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 592: Query con text() toca tabla rol (verificar uso de cliente_id)
  üî¥ L√≠nea 718: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 738: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 745: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 762: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 769: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 810: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 816: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 897: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 903: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 968: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 1051: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 1057: Query con text() toca tabla rol (verificar uso de cliente_id)
  üî¥ L√≠nea 1090: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1096: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 1174: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 1174: Query con text() toca tabla rol_menu_permiso (verificar uso de cliente_id)
  üî¥ L√≠nea 1200: Query con text() toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1200: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1201: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1202: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1204: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1222: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1229: Query SQL directa toca tabla rol sin cliente_id visible

app\modules\rbac\infrastructure\repositories\permiso_repository.py: 7 issues
  üî¥ L√≠nea 67: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 80: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 80: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 103: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 103: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 103: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üü° L√≠nea 123: Query con text() toca tabla usuario (verificar uso de cliente_id)

app\modules\rbac\infrastructure\repositories\rol_repository.py: 8 issues
  üî¥ L√≠nea 99: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 115: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 115: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 144: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 144: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 144: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üü° L√≠nea 161: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 161: Query con text() toca tabla usuario (verificar uso de cliente_id)

app\modules\rbac\presentation\endpoints.py: 14 issues
  üî¥ L√≠nea 24: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 236: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 236: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 377: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 377: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 379: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 379: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 398: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 399: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 433: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 495: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 653: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 655: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 655: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\rbac\presentation\endpoints_permisos.py: 4 issues
  üî¥ L√≠nea 24: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 98: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 292: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 343: Query SQL directa toca tabla rol sin cliente_id visible

app\modules\rbac\presentation\schemas.py: 6 issues
  üî¥ L√≠nea 255: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 473: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 648: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 648: Query SQL directa toca tabla rol_menu_permiso sin cliente_id visible
  üî¥ L√≠nea 714: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 835: Query SQL directa toca tabla rol sin cliente_id visible

app\modules\superadmin\application\services\audit_service.py: 25 issues
  üî¥ L√≠nea 8: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 8: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 8: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 10: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 10: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 10: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 11: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 11: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 11: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 120: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 120: Query SQL directa toca tabla usuario sin cliente_id visible
  üü° L√≠nea 122: Query con text() toca tabla auth_audit_log (verificar uso de cliente_id)
  üü° L√≠nea 122: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 128: Query con text() toca tabla auth_audit_log (verificar uso de cliente_id)
  üü° L√≠nea 128: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 152: Query con text() toca tabla auth_audit_log (verificar uso de cliente_id)
  üü° L√≠nea 152: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 232: Query con text() toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 232: Query con text() toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 233: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 233: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 234: Query con text() toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 234: Query con text() toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 234: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 234: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\superadmin\application\services\superadmin_auditoria_service.py: 7 issues
  üü° L√≠nea 228: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 308: Query SQL directa toca tabla auth_audit_log sin cliente_id visible
  üî¥ L√≠nea 308: Query SQL directa toca tabla usuario sin cliente_id visible
  üü° L√≠nea 387: Query con text() toca tabla auth_audit_log (verificar uso de cliente_id)
  üü° L√≠nea 586: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 767: Query SQL directa toca tabla log_sincronizacion_usuario sin cliente_id visible
  üî¥ L√≠nea 767: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\superadmin\application\services\superadmin_usuario_service.py: 3 issues
  üî¥ L√≠nea 335: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 335: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 335: Query SQL directa toca tabla usuario_rol sin cliente_id visible

app\modules\superadmin\presentation\schemas.py: 1 issues
  üî¥ L√≠nea 261: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\tenant\application\services\cliente_service.py: 2 issues
  üü° L√≠nea 615: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 646: Query con text() toca tabla usuario (verificar uso de cliente_id)

app\modules\tenant\application\services\conexion_service.py: 52 issues
  üü° L√≠nea 63: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 89: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 143: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 227: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 228: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 229: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 230: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 234: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 235: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 236: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 237: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 238: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 239: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 240: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 241: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 242: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 243: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 244: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 284: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 289: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 298: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 300: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 318: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 319: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 320: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 321: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 325: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 326: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 327: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 328: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 329: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 330: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 331: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 332: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 333: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 334: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 335: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 417: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 418: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 419: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 420: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 424: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 425: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 426: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 427: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 428: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 429: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 430: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 431: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 432: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 433: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 434: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\tenant\application\services\modulo_activo_service.py: 9 issues
  üü° L√≠nea 255: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 268: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 269: Query SQL directa toca tabla usuario sin cliente_id visible
  üü° L√≠nea 288: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 327: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 328: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 329: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 411: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 412: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\tenant\application\services\tenant_service.py: 1 issues
  üî¥ L√≠nea 88: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\tenant\presentation\schemas.py: 2 issues
  üî¥ L√≠nea 938: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1121: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\users\application\services\user_service.py: 67 issues
  üî¥ L√≠nea 11: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 11: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 14: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 14: Query SQL directa toca tabla usuario sin cliente_id visible
  üü° L√≠nea 110: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 110: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 110: Query con text() toca tabla usuario_rol (verificar uso de cliente_id)
  üî¥ L√≠nea 177: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 177: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 177: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üü° L√≠nea 298: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 298: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 485: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 485: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 850: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 851: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 860: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 861: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 908: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1081: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1081: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1081: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1096: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1096: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1096: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1097: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1097: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1097: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1099: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1099: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1099: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1100: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1100: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1100: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1103: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1103: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1103: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1195: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1195: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1195: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1203: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1203: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1203: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1204: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1204: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1204: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1206: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1206: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1206: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1207: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1207: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1207: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1211: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1211: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1211: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üî¥ L√≠nea 1216: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 1216: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 1216: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üü° L√≠nea 1342: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 1352: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 1358: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 1360: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 1399: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 1407: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 1407: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üü° L√≠nea 1409: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 1409: Query con text() toca tabla usuario (verificar uso de cliente_id)

app\modules\users\infrastructure\repositories\user_repository.py: 8 issues
  üî¥ L√≠nea 102: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 102: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 102: Query SQL directa toca tabla usuario_rol sin cliente_id visible
  üü° L√≠nea 125: Query con text() toca tabla rol (verificar uso de cliente_id)
  üî¥ L√≠nea 133: Query SQL directa toca tabla rol sin cliente_id visible
  üü° L√≠nea 146: Query con text() toca tabla rol (verificar uso de cliente_id)
  üü° L√≠nea 146: Query con text() toca tabla usuario (verificar uso de cliente_id)
  üî¥ L√≠nea 183: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\users\presentation\endpoints.py: 10 issues
  üî¥ L√≠nea 28: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 28: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 310: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 310: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 361: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 361: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 422: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 422: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 503: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 503: Query SQL directa toca tabla usuario sin cliente_id visible

app\modules\users\presentation\schemas.py: 3 issues
  üî¥ L√≠nea 236: Query SQL directa toca tabla usuario sin cliente_id visible
  üî¥ L√≠nea 568: Query SQL directa toca tabla rol sin cliente_id visible
  üî¥ L√≠nea 568: Query SQL directa toca tabla usuario sin cliente_id visible